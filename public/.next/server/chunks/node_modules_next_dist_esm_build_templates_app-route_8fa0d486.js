module.exports=[59954,e=>{"use strict";let t,r,n,i,s,a,o,l,u,c,h;e.s(["handler",()=>KN,"patchFetch",()=>KA,"routeModule",()=>KF,"serverHooks",()=>KT,"workAsyncStorage",()=>KR,"workUnitAsyncStorage",()=>KI],59954);var f,p,d,m,g,b=e.i(47909),y=e.i(74017),x=e.i(96250),v=e.i(59756),S=e.i(61916),_=e.i(69741),w=e.i(16795),k=e.i(87718),O=e.i(95169),E=e.i(47587),C=e.i(66012),F=e.i(70101),R=e.i(26937),I=e.i(10372),T=e.i(93695);e.i(52474);var A=e.i(220);e.s(["GET",()=>KO,"POST",()=>KE],44838);var N="7.7.4";let M=e=>{console.warn(`⚠️ [uploadthing][deprecated] ${e}`)},j=function(e,t){if("function"==typeof e)return function(){return e(arguments)?t.apply(this,arguments):e=>t(e,...arguments)};switch(e){case 0:case 1:throw RangeError(`Invalid arity ${e}`);case 2:return function(e,r){return arguments.length>=2?t(e,r):function(r){return t(r,e)}};case 3:return function(e,r,n){return arguments.length>=3?t(e,r,n):function(n){return t(n,e,r)}};case 4:return function(e,r,n,i){return arguments.length>=4?t(e,r,n,i):function(i){return t(i,e,r,n)}};case 5:return function(e,r,n,i,s){return arguments.length>=5?t(e,r,n,i,s):function(s){return t(s,e,r,n,i)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(e){return t(e,...r)}}}},P=e=>e,D=e=>()=>e,$=D(void 0),z="effect/GlobalValue",L=(e,r)=>(t||(globalThis[z]??=new Map,t=globalThis[z]),t.has(e)||t.set(e,r()),t.get(e)),U=e=>"object"==typeof e&&null!==e,B=j(2,(e,t)=>(e=>U(e)||"function"==typeof e)(e)&&t in e),q=((e,t)=>B(e,"_tag")&&e._tag===t,Symbol.for("effect/Gen/GenKind"));Symbol.iterator;class J{self;called=!1;constructor(e){this.self=e}next(e){return this.called?{value:e,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(e){return{value:e,done:!0}}throw(e){throw e}[Symbol.iterator](){return new J(this.self)}}let H=Symbol.for("effect/Utils/YieldWrap");class V{#e;constructor(e){this.#e=e}[H](){return this.#e}}let W=L("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0})),K={effect_internal_function:e=>e()};K.effect_internal_function(()=>Error().stack)?.includes("effect_internal_function")===!0&&K.effect_internal_function;let G=L(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),Z=Symbol.for("effect/Hash"),Q=e=>{if(!0===W.enabled)return 0;switch(typeof e){case"number":return er(e);case"bigint":return en(e.toString(10));case"boolean":case"symbol":return en(String(e));case"string":return en(e);case"undefined":return en("undefined");case"function":case"object":if(null===e)return en("null");if(e instanceof Date)return Q(e.toISOString());if(e instanceof URL)return Q(e.href);else if(et(e))return e[Z]();else return Y(e);default:throw Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},Y=e=>(G.has(e)||G.set(e,er(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),G.get(e)),X=e=>t=>53*t^e,ee=e=>0xbfffffff&e|e>>>1&0x40000000,et=e=>B(e,Z),er=e=>{if(e!=e||e===1/0)return 0;let t=0|e;for(t!==e&&(t^=0xffffffff*e);e>0xffffffff;)t^=e/=0xffffffff;return ee(t)},en=e=>{let t=5381,r=e.length;for(;r;)t=33*t^e.charCodeAt(--r);return ee(t)},ei=function(){if(1==arguments.length){let e=arguments[0];return function(t){return Object.defineProperty(e,Z,{value:()=>t,enumerable:!1}),t}}let e=arguments[0],t=arguments[1];return Object.defineProperty(e,Z,{value:()=>t,enumerable:!1}),t},es=Symbol.for("effect/Equal");function ea(){return 1==arguments.length?e=>eo(e,arguments[0]):eo(arguments[0],arguments[1])}function eo(e,t){if(e===t)return!0;let r=typeof e;if(r!==typeof t)return!1;if("object"===r||"function"===r){if(null!==e&&null!==t){if(el(e)&&el(t))if(Q(e)===Q(t)&&e[es](t))return!0;else return!!W.enabled&&!!W.tester&&W.tester(e,t);else if(e instanceof Date&&t instanceof Date)return e.toISOString()===t.toISOString();else if(e instanceof URL&&t instanceof URL)return e.href===t.href}if(W.enabled){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((e,r)=>eo(e,t[r]));if(Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){let r=Object.keys(e),n=Object.keys(t);if(r.length===n.length){for(let n of r)if(!(n in t&&eo(e[n],t[n])))return!!W.tester&&W.tester(e,t);return!0}}return!!W.tester&&W.tester(e,t)}}return!!W.enabled&&!!W.tester&&W.tester(e,t)}let el=e=>B(e,es),eu=Symbol.for("nodejs.util.inspect.custom"),ec=e=>{try{let t;if(B(e,"toJSON")&&(t=e.toJSON,"function"==typeof t)&&0===e.toJSON.length)return e.toJSON();if(Array.isArray(e))return e.map(ec)}catch{return{}}return em(e)},eh=e=>JSON.stringify(e,null,2),ef=Symbol.for("effect/Inspectable/Redactable"),ep=e=>"object"==typeof e&&null!==e&&ef in e,ed=L("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),em=e=>ep(e)&&void 0!==ed.fiberRefs?e[ef](ed.fiberRefs):e,eg=(e,t)=>{switch(t.length){case 0:return e;case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let e=0,n=t.length;e<n;e++)r=t[e](r);return r}}},eb=Symbol.for("effect/Effect"),ey=Symbol.for("effect/Stream"),ex=Symbol.for("effect/Sink"),ev=Symbol.for("effect/Channel"),eS={_R:e=>e,_E:e=>e,_A:e=>e,_V:"3.17.7"},e_={[eb]:eS,[ey]:eS,[ex]:{_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},[ev]:{_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},[es](e){return this===e},[Z](){return ei(this,Y(this))},[Symbol.iterator](){return new J(new V(this))},pipe(){return eg(this,arguments)}},ew={[Z](){return ei(this,((e,t)=>{let r=12289;for(let n=0;n<t.length;n++)r^=function(e,t,r,n,i,s,a,o,l){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return n(r(t(e)));case 5:return i(n(r(t(e))));case 6:return s(i(n(r(t(e)))));case 7:return a(s(i(n(r(t(e))))));case 8:return o(a(s(i(n(r(t(e)))))));case 9:return l(o(a(s(i(n(r(t(e))))))));default:{let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return e}}}(en(t[n]),X(Q(e[t[n]])));return ee(r)})(this,Object.keys(this)))},[es](e){let t=Object.keys(this),r=Object.keys(e);if(t.length!==r.length)return!1;for(let r of t)if(!(r in e&&ea(this[r],e[r])))return!1;return!0}},ek=Symbol.for("effect/Option"),eO={...e_,[ek]:{_A:e=>e},[eu](){return this.toJSON()},toString(){return eh(this.toJSON())}},eE=Object.assign(Object.create(eO),{_tag:"Some",_op:"Some",[es](e){return eR(e)&&eT(e)&&ea(this.value,e.value)},[Z](){return ei(this,X(Q(this._tag))(Q(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:ec(this.value)}}}),eC=Q("None"),eF=Object.assign(Object.create(eO),{_tag:"None",_op:"None",[es]:e=>eR(e)&&eI(e),[Z]:()=>eC,toJSON(){return{_id:"Option",_tag:this._tag}}}),eR=e=>B(e,ek),eI=e=>"None"===e._tag,eT=e=>"Some"===e._tag,eA=Object.create(eF),eN=e=>{let t=Object.create(eE);return t.value=e,t},eM=Symbol.for("effect/Either"),ej={...e_,[eM]:{_R:e=>e},[eu](){return this.toJSON()},toString(){return eh(this.toJSON())}},eP=Object.assign(Object.create(ej),{_tag:"Right",_op:"Right",[es](e){return e$(e)&&eL(e)&&ea(this.right,e.right)},[Z](){return X(Q(this._tag))(Q(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:ec(this.right)}}}),eD=Object.assign(Object.create(ej),{_tag:"Left",_op:"Left",[es](e){return e$(e)&&ez(e)&&ea(this.left,e.left)},[Z](){return X(Q(this._tag))(Q(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:ec(this.left)}}}),e$=e=>B(e,eM),ez=e=>"Left"===e._tag,eL=e=>"Right"===e._tag,eU=e=>{let t=Object.create(eD);return t.left=e,t},eB=e=>{let t=Object.create(eP);return t.right=e,t},eq=j(2,(e,t)=>eL(e)?eB(t(e.right)):eU(e.left)),eJ=j(2,(e,t)=>ez(e)?eU(e.left):t(e.right)),eH=((e,t,r)=>eJ(e,e=>eq(t,t=>r(e,t))),e=>e.length>0),eV=j(2,(e,t)=>eI(e)?eA:eN(t(e.value))),eW=j(2,(e,t)=>eI(e)?eA:t(e.value)),eK=((e,t)=>eW(e,e=>eV(t(e),()=>e)),j(2,(e,t)=>({[Symbol.iterator](){let r,n=e[Symbol.iterator](),i=!1;return{next(){if(!i){let e=n.next();return e.done?(i=!0,(r=t[Symbol.iterator]()).next()):e}return r.next()}}}})));(e,t,r)=>({[Symbol.iterator](){let n=e[Symbol.iterator](),i=t[Symbol.iterator]();return{next(){let e=n.next(),t=i.next();return e.done||t.done?{done:!0,value:void 0}:{done:!1,value:r(e.value,t.value)}}}}});Symbol.iterator,()=>eG;let eG={next:()=>({done:!0,value:void 0})},eZ=j(2,(e,t)=>({[Symbol.iterator](){let r=e[Symbol.iterator](),n=0;return{next(){let e=r.next();return e.done?{done:!0,value:void 0}:{done:!1,value:t(e.value,n++)}}}}})),eQ=j(2,(e,t)=>eY(eZ(e,t))),eY=e=>({[Symbol.iterator](){let t,r=e[Symbol.iterator]();return{next:function e(){if(void 0===t){let e=r.next();if(e.done)return e;t=e.value[Symbol.iterator]()}let n=t.next();return n.done?(t=void 0,e()):n}}}});(e,t)=>({[Symbol.iterator](){let r=e[Symbol.iterator](),n=0;return{next(){let e=r.next();for(;!e.done;){let i=t(e.value,n++);if(eT(i))return{done:!1,value:i.value};e=r.next()}return{done:!0,value:void 0}}}}});(e,t,r)=>eQ(e,e=>eZ(t,t=>r(e,t)));Object.fromEntries,(e,t)=>{let r=[];for(let n of e0(e))r.push(t(n,e[n]));return r};let eX=j(2,(e,t)=>Object.prototype.hasOwnProperty.call(e,t));(e,t,r)=>eX(e,t)?eN({...e,[t]:r(e[t])}):eA,(e,t)=>{if(!eX(e,t))return{...e};let r={...e};return delete r[t],r};let e0=e=>Object.keys(e),e1=((e,t)=>{let r=Math.max(1,Math.floor(e)),n=Array(r);for(let e=0;e<r;e++)n[e]=t(e);return n},e=>Array.isArray(e)?e:Array.from(e)),e2=j(2,(e,t)=>[t,...e]),e3=j(2,(e,t)=>[...e,t]),e5=j(2,(e,t)=>e1(e).concat(e1(t))),e4=(e,t)=>e<0||e>=t.length,e6=j(2,(e,t)=>{let r=Math.floor(t);if(e4(r,e))throw Error(`Index ${r} out of bounds`);return e[r]})(0),e8=e=>e.slice(1),e7=((e,t)=>{let r=e1(e);return r.slice(0,Math.floor(Math.min(Math.max(0,t),r.length)))},j(2,(e,t)=>{let r=e1(e);if(eH(r)){let n=r.length,i=Math.round(t)%n;if(e4(Math.abs(i),r)||0===i)return tr(r);if(!(i<0))return e7(e,i-n);{let[e,t]=tt(r,-i);return e5(t,e)}}return[]})),e9=j(2,(e,t)=>{let r=e1(e);if(eH(r)){let[e,n]=t(r),i=[e],s=n;for(;eH(s);){let[e,r]=t(s);i.push(e),s=r}return i}return[]}),te=j(2,(e,t)=>{let r=Array.from(e),n=Math.floor(t);return eH(r)?n>=1?tt(r,n):[[],r]:[r,[]]}),tt=j(2,(e,t)=>{let r=Math.max(1,Math.floor(t));return r>=e.length?[tr(e),[]]:[e2(e.slice(1,r),e6(e)),e.slice(r)]}),tr=e=>e.slice();(e,t)=>{let r=e1(e);return eH(r)?e9(r,tt(t)):[]};(e,t,r)=>{let n=e1(e),i=e1(t);return eH(n)?eH(i)?ts(r)(e5(n,i)):n:i};let tn=j(2,(e,t)=>e.map(t)),ti=j(2,(e,t)=>{if(0===e.length)return[];let r=[];for(let n=0;n<e.length;n++){let i=t(e[n],n);for(let e=0;e<i.length;e++)r.push(i[e])}return r}),ts=j(2,(e,t)=>{let r=e1(e);if(eH(r)){let e=[e6(r)];for(let n of e8(r))e.every(e=>!t(n,e))&&e.push(n);return e}return[]});(e,t,r)=>ti(e,e=>tn(t,t=>r(e,t)));let ta=Symbol.for("effect/Context/Tag"),to=Symbol.for("effect/Context/Reference"),tl=Symbol.for("effect/STM"),tu={...e_,_op:"Tag",[tl]:eS,[ta]:{_Service:e=>e,_Identifier:e=>e},toString(){return eh(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[eu](){return this.toJSON()},of:e=>e,context(e){return tm(this,e)}},tc={...tu,[to]:to},th=Symbol.for("effect/Context"),tf={[th]:{_Services:e=>e},[es](e){if(td(e)&&this.unsafeMap.size===e.unsafeMap.size){for(let t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!ea(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[Z](){return ei(this,er(this.unsafeMap.size))},pipe(){return eg(this,arguments)},toString(){return eh(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(ec)}},[eu](){return this.toJSON()}},tp=e=>{let t=Object.create(tf);return t.unsafeMap=e,t},td=e=>B(e,th),tm=(e,t)=>tp(new Map([[e.key,t]])),tg=j(3,(e,t,r)=>{let n=new Map(e.unsafeMap);return n.set(t.key,r),tp(n)}),tb=L("effect/Context/defaultValueCache",()=>new Map),ty=e=>{if(tb.has(e.key))return tb.get(e.key);let t=e.defaultValue();return tb.set(e.key,t),t},tx=((e,t)=>{if(!e.unsafeMap.has(t.key)){if(to in t)return ty(t);throw(e=>{let t=Error(`Service not found${e.key?`: ${String(e.key)}`:""}`);if(e.stack){let r=e.stack.split("\n");if(r.length>2){let e=r[2].match(/at (.*)/);e&&(t.message=t.message+` (defined at ${e[1]})`)}}if(t.stack){let e=t.stack.split("\n");e.splice(1,3),t.stack=e.join("\n")}return t})(t)}return e.unsafeMap.get(t.key)},()=>(e,t)=>{let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let n=Error();function i(){}return Error.stackTraceLimit=r,Object.setPrototypeOf(i,tc),i.key=e,i.defaultValue=t.defaultValue,Object.defineProperty(i,"stack",{get:()=>n.stack}),i}),tv=Symbol.for("effect/Micro"),tS=Symbol.for("effect/Micro/MicroExit"),t_=e=>"object"==typeof e&&null!==e&&tv in e,tw=Symbol.for("effect/Micro/MicroCause"),tk={_E:P};class tO extends globalThis.Error{_tag;traces;[tw];constructor(e,t,r){let n,i,s,a=`MicroCause.${e}`;if(t instanceof globalThis.Error){n=`(${a}) ${t.name}`;let e=(i=t.message).split("\n").length;s=t.stack?`(${a}) ${t.stack.split("\n").slice(0,e+3).join("\n")}`:`${n}: ${i}`}else n=a,i=((e,t=2)=>{if("string"==typeof e)return e;try{return"object"==typeof e?((e,t)=>{let r=[],n=JSON.stringify(e,(e,t)=>"object"==typeof t&&null!==t?r.includes(t)?void 0:r.push(t)&&(void 0!==ed.fiberRefs&&ep(t)?t[ef](ed.fiberRefs):t):t,t);return r=void 0,n})(e,t):String(e)}catch{return String(e)}})(t,0),s=`${n}: ${i}`;r.length>0&&(s+=`
    ${r.join("\n    ")}`),super(i),this._tag=e,this.traces=r,this[tw]=tk,this.name=n,this.stack=s}pipe(){return eg(this,arguments)}toString(){return this.stack}[eu](){return this.stack}}class tE extends tO{error;constructor(e,t=[]){super("Fail",e,t),this.error=e}}let tC=(e,t=[])=>new tE(e,t);class tF extends tO{defect;constructor(e,t=[]){super("Die",e,t),this.defect=e}}let tR=(e,t=[])=>new tF(e,t);class tI extends tO{constructor(e=[]){super("Interrupt","interrupted",e)}}let tT=(e=[])=>new tI(e),tA=e=>"Fail"===e._tag,tN=e=>"Interrupt"===e._tag,tM=j(2,(e,t)=>{let r=[...e.traces,t];switch(e._tag){case"Die":return tR(e.defect,r);case"Interrupt":return tT(r);case"Fail":return tC(e.error,r)}}),tj=Symbol.for("effect/Micro/MicroFiber"),tP={_A:P,_E:P};class tD{context;interruptible;[tj];_stack=[];_observers=[];_exit;_children;currentOpCount=0;constructor(e,t=!0){this.context=e,this.interruptible=t,this[tj]=tP}getRef(e){let t;return t=this.context,t.unsafeMap.has(e.key)?t.unsafeMap.get(e.key):ty(e)}addObserver(e){return this._exit?(e(this._exit),$):(this._observers.push(e),()=>{let t=this._observers.indexOf(e);t>=0&&this._observers.splice(t,1)})}_interrupted=!1;unsafeInterrupt(){!this._exit&&(this._interrupted=!0,this.interruptible&&this.evaluate(rp))}unsafePoll(){return this._exit}evaluate(e){if(this._exit)return;if(void 0!==this._yielded){let e=this._yielded;this._yielded=void 0,e()}let t=this.runLoop(e);if(t===tV)return;let r=t$.interruptChildren&&t$.interruptChildren(this);if(void 0!==r)return this.evaluate(ro(r,()=>t));this._exit=t;for(let e=0;e<this._observers.length;e++)this._observers[e](t);this._observers.length=0}runLoop(e){let t=!1,r=e;this.currentOpCount=0;try{for(;;){if(this.currentOpCount++,!t&&this.getRef(rw).shouldYield(this)){t=!0;let e=r;r=ro(t3,()=>e)}if((r=r[tB](this))===tV){let e=this._yielded;if(tS in e)return this._yielded=void 0,e;return tV}}}catch(e){if(!B(r,tB))return rd(`MicroFiber.runLoop: Not a valid effect: ${String(r)}`);return rd(e)}}getCont(e){for(;;){let t=this._stack.pop();if(!t)return;let r=t[tH]&&t[tH](this);if(r)return{[e]:r};if(t[e])return t}}_yielded=void 0;yieldWith(e){return this._yielded=e,tV}children(){return this._children??=new Set}}let t$=L("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0})),tz=e=>t2(()=>{for(let t of e)t.unsafeInterrupt();let t=e[Symbol.iterator](),r=t2(()=>{let e=t.next();for(;!e.done;){if(e.value.unsafePoll()){e=t.next();continue}let n=e.value;return re(e=>{n.addObserver(t=>{e(r)})})}return rg});return r}),tL=Symbol.for("effect/Micro/identifier"),tU=Symbol.for("effect/Micro/args"),tB=Symbol.for("effect/Micro/evaluate"),tq=Symbol.for("effect/Micro/successCont"),tJ=Symbol.for("effect/Micro/failureCont"),tH=Symbol.for("effect/Micro/ensureCont"),tV=Symbol.for("effect/Micro/Yield"),tW={...e_,_op:"Micro",[tv]:{_A:P,_E:P,_R:P},pipe(){return eg(this,arguments)},[Symbol.iterator](){return new J(new V(this))},toJSON(){return{_id:"Micro",op:this[tL],...tU in this?{args:this[tU]}:void 0}},toString(){return eh(this)},[eu](){return eh(this)}};function tK(e){return rd("Micro.evaluate: Not implemented")}let tG=e=>({...tW,[tL]:e.op,[tB]:e.eval??tK,[tq]:e.contA,[tJ]:e.contE,[tH]:e.ensure}),tZ=e=>{let t=tG(e);return function(){let r=Object.create(t);return r[tU]=!1===e.single?arguments:arguments[0],r}},tQ=e=>{let t={...tG(e),[tS]:tS,_tag:e.op,get[e.prop](){return this[tU]},toJSON(){return{_id:"MicroExit",_tag:e.op,[e.prop]:this[tU]}},[es](t){return rc(t)&&t._tag===e.op&&ea(this[tU],t[tU])},[Z](){return ei(this,X(en(e.op))(Q(this[tU])))}};return function(e){let r=Object.create(t);return r[tU]=e,r[tq]=void 0,r[tJ]=void 0,r[tH]=void 0,r}},tY=tQ({op:"Success",prop:"value",eval(e){let t=e.getCont(tq);return t?t[tq](this[tU],e):e.yieldWith(this)}}),tX=tQ({op:"Failure",prop:"cause",eval(e){let t=e.getCont(tJ);for(;tN(this[tU])&&t&&e.interruptible;)t=e.getCont(tJ);return t?t[tJ](this[tU],e):e.yieldWith(this)}}),t0=e=>tX(tC(e)),t1=tZ({op:"Sync",eval(e){let t=this[tU](),r=e.getCont(tq);return r?r[tq](t,e):e.yieldWith(rh(t))}}),t2=tZ({op:"Suspend",eval(e){return this[tU]()}}),t3=tZ({op:"Yield",eval(e){let t=!1;return e.getRef(rw).scheduleTask(()=>{t||e.evaluate(rg)},this[tU]??0),e.yieldWith(()=>{t=!0})}})(0),t5=tY(void 0),t4=e=>t7(function(t,r){e(r).then(e=>t(tY(e)),e=>t(rd(e)))},0!==e.length),t6=e=>t7(function(t,r){try{e.try(r).then(e=>t(tY(e)),r=>t(t0(e.catch(r))))}catch(r){t(t0(e.catch(r)))}},0!==e.try.length),t8=tZ({op:"WithMicroFiber",eval(e){return this[tU](e)}}),t7=tZ({op:"Async",single:!1,eval(e){let t=this[tU][0],r=!1,n=!1,i=this[tU][1]?new AbortController:void 0,s=t(t=>{r||(r=!0,n?e.evaluate(t):n=t)},i?.signal);return!1!==n?n:(n=!0,e._yielded=()=>{r=!0},void 0===i&&void 0===s||e._stack.push(t9(()=>(r=!0,i?.abort(),s??rg))),tV)}}),t9=tZ({op:"AsyncFinalizer",ensure(e){e.interruptible&&(e.interruptible=!1,e._stack.push(rz(!0)))},contE(e,t){return tN(e)?ro(this[tU](),()=>tX(e)):tX(e)}}),re=e=>t7(e,e.length>=2),rt=(...e)=>t2(()=>rr(1===e.length?e[0]():e[1].call(e[0]))),rr=tZ({op:"Iterator",contA(e,t){let r=this[tU].next(e);if(r.done)return tY(r.value);t._stack.push(this);var n=r.value;if("object"==typeof n&&null!==n&&H in n)return n[H]();throw Error("BUG: yieldWrapGet - please report an issue at https://github.com/Effect-TS/effect/issues")},eval(e){return this[tq](void 0,e)}}),rn=j(2,(e,t)=>ru(e,e=>t)),ri=j(2,(e,t)=>ro(e,e=>{let r=t_(t)?t:"function"==typeof t?t(e):t;return t_(r)?r:tY(r)})),rs=((e,t)=>ro(e,e=>{let r=t_(t)?t:"function"==typeof t?t(e):t;return t_(r)?rn(r,e):tY(e)}),e=>rA(e,{onFailure:rf,onSuccess:rh})),ra=j(2,(e,t)=>{let r;return r=[e,t],t8(e=>re(t=>{let n=!1,i=new Set,s=e=>{n=!0,t(0===i.size?e:ro(tz(i),()=>e))};for(let t of r){if(n)break;let r=rH(e,rL(t),!0,!0);i.add(r),r.addObserver(e=>{i.delete(r),s(e)})}return tz(i)}))}),ro=j(2,(e,t)=>{let r=Object.create(rl);return r[tU]=e,r[tq]=t,r}),rl=tG({op:"OnSuccess",eval(e){return e._stack.push(this),this[tU]}}),ru=j(2,(e,t)=>ro(e,e=>tY(t(e)))),rc=e=>B(e,tS),rh=tY,rf=tX,rp=rf(tT()),rd=e=>rf(tR(e)),rm=e=>"Failure"===e._tag,rg=rh(void 0),rb=e=>{for(let t of e)if("Failure"===t._tag)return t;return rg},ry="setImmediate"in globalThis?globalThis.setImmediate:e=>setTimeout(e,0);class rx{tasks=[];running=!1;scheduleTask(e,t){this.tasks.push(e),this.running||(this.running=!0,ry(this.afterScheduled))}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){let e=this.tasks;this.tasks=[];for(let t=0,r=e.length;t<r;t++)e[t]()}shouldYield(e){return e.currentOpCount>=e.getRef(rS)}flush(){for(;this.tasks.length>0;)this.runTasks()}}let rv=j(2,(e,t)=>t8(r=>{let n=r.context;return r.context=t(n),rP(e,()=>(r.context=n,t5))}));(e,t,r)=>rv(e,tg(t,r));class rS extends tx()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){}class r_ extends tx()("effect/Micro/currentConcurrency",{defaultValue:()=>"unbounded"}){}class rw extends tx()("effect/Micro/currentScheduler",{defaultValue:()=>new rx}){}e=>t_(e[1]),(e,t)=>Array.from({length:t},()=>e);let rk=j(2,(e,t)=>{let r=Object.create(rO);return r[tU]=e,r[tJ]=t,r}),rO=tG({op:"OnFailure",eval(e){return e._stack.push(this),this[tU]}}),rE=j(3,(e,t,r)=>rk(e,e=>t(e)?r(e):tX(e))),rC=j(2,(e,t)=>rE(e,tA,e=>t(e.error))),rF=((e,t,r)=>rE(e,t,e=>ri(r(e),tX(e))),j(2,(e,t)=>rC(e,e=>t1(t)))),rR=function(){let e=globalThis.Error.stackTraceLimit;globalThis.Error.stackTraceLimit=2;let t=new globalThis.Error;globalThis.Error.stackTraceLimit=e;let r=e=>r=>r$(r,r=>tX(function(e,r){let n=t.stack;if(!n)return r;let i=n.split("\n")[2]?.trim().replace(/^at /,"");if(!i)return r;let s=i.match(/\((.*)\)$/);return tM(r,`at ${e} (${s?s[1]:i})`)}(e,r)));return 2==arguments.length?r(arguments[1])(arguments[0]):r(arguments[0])},rI=j(2,(e,t)=>{let r=Object.create(rT);return r[tU]=e,r[tq]=t.onSuccess,r[tJ]=t.onFailure,r}),rT=tG({op:"OnSuccessAndFailure",eval(e){return e._stack.push(this),this[tU]}}),rA=j(2,(e,t)=>rI(e,{onFailure:e=>t1(()=>t.onFailure(e)),onSuccess:e=>t1(()=>t.onSuccess(e))})),rN=((e,t)=>rI(e,{onFailure:e=>"Fail"===e._tag?t.onFailure(e.error):tX(e),onSuccess:t.onSuccess}),e=>re(t=>{let r=setTimeout(()=>{t(t5)},e);return t1(()=>{clearTimeout(r)})})),rM=((e,t)=>ra(e,ri(rL(rN(t.duration)),t.onTimeout)),Symbol.for("effect/Micro/MicroScope"));class rj{[rM];state={_tag:"Open",finalizers:new Set};constructor(){this[rM]=rM}unsafeAddFinalizer(e){"Open"===this.state._tag&&this.state.finalizers.add(e)}addFinalizer(e){return t2(()=>"Open"===this.state._tag?(this.state.finalizers.add(e),t5):e(this.state.exit))}unsafeRemoveFinalizer(e){"Open"===this.state._tag&&this.state.finalizers.delete(e)}close(e){return t2(()=>{if("Open"===this.state._tag){let t=Array.from(this.state.finalizers).reverse();return this.state={_tag:"Closed",exit:e},ro(rJ(t,t=>rs(t(e))),rb)}return t5})}get fork(){return t1(()=>{let e=new rj;if("Closed"===this.state._tag)return e.state=this.state,e;function t(t){return e.close(t)}return this.state.finalizers.add(t),e.unsafeAddFinalizer(e=>t1(()=>this.unsafeRemoveFinalizer(t))),e})}}let rP=j(2,(e,t)=>rU(r=>rI(r(e),{onFailure:e=>ro(t(rf(e)),()=>tX(e)),onSuccess:e=>ro(t(rh(e)),()=>tY(e))}))),rD=j(3,(e,t,r)=>rP(e,e=>t(e)?r(e):rg)),r$=j(2,(e,t)=>rD(e,rm,e=>t(e.cause))),rz=tZ({op:"SetInterruptible",ensure(e){if(e.interruptible=this[tU],e._interrupted&&e.interruptible)return()=>rp}}),rL=e=>t8(t=>t.interruptible?e:(t.interruptible=!0,t._stack.push(rz(!1)),t._interrupted)?rp:e),rU=e=>t8(t=>t.interruptible?(t.interruptible=!1,t._stack.push(rz(!0)),e(rL)):e(P)),rB=(e,t)=>Array.isArray(e)||B(e,Symbol.iterator)?rJ(e,P,t):t?.discard?rJ(Object.values(e),P,t):t2(()=>{let r={};return rn(rJ(Object.entries(e),([e,t])=>ru(t,t=>{r[e]=t}),{discard:!0,concurrency:t?.concurrency}),r)}),rq=tZ({op:"While",contA(e,t){return(this[tU].step(e),this[tU].while())?(t._stack.push(this),this[tU].body()):rg},eval(e){return this[tU].while()?(e._stack.push(this),this[tU].body()):rg}}),rJ=(e,t,r)=>t8(n=>{let i=r?.concurrency==="inherit"?n.getRef(r_):r?.concurrency??1,s="unbounded"===i?1/0:Math.max(1,i),a=e1(e),o=a.length;if(0===o)return r?.discard?t5:tY([]);let l=r?.discard?void 0:Array(o),u=0;return 1===s?rn(rq({while:()=>u<a.length,body:()=>t(a[u],u),step:l?e=>l[u++]=e:e=>u++}),l):re(e=>{let r,i=new Set,c=0,h=0,f=!1,p=!1;return!function d(){for(f=!0;c<s&&u<o;){let m=u,g=a[m];u++,c++;try{let a=rH(n,t(g,m),!0,!0);i.add(a),a.addObserver(t=>{i.delete(a),p||("Failure"===t._tag?void 0===r&&(r=t,o=u,i.forEach(e=>e.unsafeInterrupt())):void 0!==l&&(l[m]=t.value),h++,c--,h===o?e(r??tY(l)):!f&&c<s&&d())})}catch(e){r=rd(e),o=u,i.forEach(e=>e.unsafeInterrupt())}}f=!1}(),t2(()=>(p=!0,u=o,tz(i)))})}),rH=(e,t,r=!1,n=!1)=>{let i=new tD(e.context,e.interruptible);return n||(e.children().add(i),i.addObserver(()=>e.children().delete(i))),r?i.evaluate(t):e.getRef(rw).scheduleTask(()=>i.evaluate(t),0),i},rV=function(){class e extends globalThis.Error{}return Object.assign(e.prototype,tW,ew,{[tL]:"Failure",[tB](){return t0(this)},toString(){return this.message?`${this.name}: ${this.message}`:this.name},toJSON(){return{...this}},[eu](){let e=this.stack;return e?`${this.toString()}
${e.split("\n").slice(1).join("\n")}`:this.toString()}}),e}(),rW=class extends rV{constructor(e){super(),e&&Object.assign(this,e)}},rK=e=>{class t extends rW{_tag=e}return t.prototype.name=e,t},rG={"application/andrew-inset":{source:"iana",extensions:["ez"]},"application/applixware":{source:"apache",extensions:["aw"]},"application/atom+xml":{source:"iana",extensions:["atom"]},"application/atomcat+xml":{source:"iana",extensions:["atomcat"]},"application/atomdeleted+xml":{source:"iana",extensions:["atomdeleted"]},"application/atomsvc+xml":{source:"iana",extensions:["atomsvc"]},"application/atsc-dwd+xml":{source:"iana",extensions:["dwd"]},"application/atsc-held+xml":{source:"iana",extensions:["held"]},"application/atsc-rsat+xml":{source:"iana",extensions:["rsat"]},"application/calendar+xml":{source:"iana",extensions:["xcs"]},"application/ccxml+xml":{source:"iana",extensions:["ccxml"]},"application/cdfx+xml":{source:"iana",extensions:["cdfx"]},"application/cdmi-capability":{source:"iana",extensions:["cdmia"]},"application/cdmi-container":{source:"iana",extensions:["cdmic"]},"application/cdmi-domain":{source:"iana",extensions:["cdmid"]},"application/cdmi-object":{source:"iana",extensions:["cdmio"]},"application/cdmi-queue":{source:"iana",extensions:["cdmiq"]},"application/cpl+xml":{source:"iana",extensions:["cpl"]},"application/cu-seeme":{source:"apache",extensions:["cu"]},"application/dash+xml":{source:"iana",extensions:["mpd"]},"application/dash-patch+xml":{source:"iana",extensions:["mpp"]},"application/davmount+xml":{source:"iana",extensions:["davmount"]},"application/dicom":{source:"iana",extensions:["dcm"]},"application/docbook+xml":{source:"apache",extensions:["dbk"]},"application/dssc+der":{source:"iana",extensions:["dssc"]},"application/dssc+xml":{source:"iana",extensions:["xdssc"]},"application/ecmascript":{source:"iana",extensions:["es","ecma"]},"application/emma+xml":{source:"iana",extensions:["emma"]},"application/emotionml+xml":{source:"iana",extensions:["emotionml"]},"application/epub+zip":{source:"iana",extensions:["epub"]},"application/exi":{source:"iana",extensions:["exi"]},"application/express":{source:"iana",extensions:["exp"]},"application/fdt+xml":{source:"iana",extensions:["fdt"]},"application/font-tdpfr":{source:"iana",extensions:["pfr"]},"application/geo+json":{source:"iana",extensions:["geojson"]},"application/gml+xml":{source:"iana",extensions:["gml"]},"application/gpx+xml":{source:"apache",extensions:["gpx"]},"application/gxf":{source:"apache",extensions:["gxf"]},"application/gzip":{source:"iana",extensions:["gz"]},"application/hyperstudio":{source:"iana",extensions:["stk"]},"application/inkml+xml":{source:"iana",extensions:["ink","inkml"]},"application/ipfix":{source:"iana",extensions:["ipfix"]},"application/its+xml":{source:"iana",extensions:["its"]},"application/java-archive":{source:"apache",extensions:["jar","war","ear"]},"application/java-serialized-object":{source:"apache",extensions:["ser"]},"application/java-vm":{source:"apache",extensions:["class"]},"application/javascript":{source:"iana",charset:"UTF-8",extensions:["js","mjs"]},"application/json":{source:"iana",charset:"UTF-8",extensions:["json","map"]},"application/jsonml+json":{source:"apache",extensions:["jsonml"]},"application/ld+json":{source:"iana",extensions:["jsonld"]},"application/lgr+xml":{source:"iana",extensions:["lgr"]},"application/lost+xml":{source:"iana",extensions:["lostxml"]},"application/mac-binhex40":{source:"iana",extensions:["hqx"]},"application/mac-compactpro":{source:"apache",extensions:["cpt"]},"application/mads+xml":{source:"iana",extensions:["mads"]},"application/manifest+json":{source:"iana",charset:"UTF-8",extensions:["webmanifest"]},"application/marc":{source:"iana",extensions:["mrc"]},"application/marcxml+xml":{source:"iana",extensions:["mrcx"]},"application/mathematica":{source:"iana",extensions:["ma","nb","mb"]},"application/mathml+xml":{source:"iana",extensions:["mathml"]},"application/mbox":{source:"iana",extensions:["mbox"]},"application/media-policy-dataset+xml":{source:"iana",extensions:["mpf"]},"application/mediaservercontrol+xml":{source:"iana",extensions:["mscml"]},"application/metalink+xml":{source:"apache",extensions:["metalink"]},"application/metalink4+xml":{source:"iana",extensions:["meta4"]},"application/mets+xml":{source:"iana",extensions:["mets"]},"application/mmt-aei+xml":{source:"iana",extensions:["maei"]},"application/mmt-usd+xml":{source:"iana",extensions:["musd"]},"application/mods+xml":{source:"iana",extensions:["mods"]},"application/mp21":{source:"iana",extensions:["m21","mp21"]},"application/mp4":{source:"iana",extensions:["mp4s","m4p"]},"application/msword":{source:"iana",extensions:["doc","dot"]},"application/mxf":{source:"iana",extensions:["mxf"]},"application/n-quads":{source:"iana",extensions:["nq"]},"application/n-triples":{source:"iana",extensions:["nt"]},"application/node":{source:"iana",extensions:["cjs"]},"application/octet-stream":{source:"iana",extensions:["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"]},"application/oda":{source:"iana",extensions:["oda"]},"application/oebps-package+xml":{source:"iana",extensions:["opf"]},"application/ogg":{source:"iana",extensions:["ogx"]},"application/omdoc+xml":{source:"apache",extensions:["omdoc"]},"application/onenote":{source:"apache",extensions:["onetoc","onetoc2","onetmp","onepkg"]},"application/oxps":{source:"iana",extensions:["oxps"]},"application/p2p-overlay+xml":{source:"iana",extensions:["relo"]},"application/patch-ops-error+xml":{source:"iana",extensions:["xer"]},"application/pdf":{source:"iana",extensions:["pdf"]},"application/pgp-encrypted":{source:"iana",extensions:["pgp"]},"application/pgp-keys":{source:"iana",extensions:["asc"]},"application/pgp-signature":{source:"iana",extensions:["asc","sig"]},"application/pics-rules":{source:"apache",extensions:["prf"]},"application/pkcs10":{source:"iana",extensions:["p10"]},"application/pkcs7-mime":{source:"iana",extensions:["p7m","p7c"]},"application/pkcs7-signature":{source:"iana",extensions:["p7s"]},"application/pkcs8":{source:"iana",extensions:["p8"]},"application/pkix-attr-cert":{source:"iana",extensions:["ac"]},"application/pkix-cert":{source:"iana",extensions:["cer"]},"application/pkix-crl":{source:"iana",extensions:["crl"]},"application/pkix-pkipath":{source:"iana",extensions:["pkipath"]},"application/pkixcmp":{source:"iana",extensions:["pki"]},"application/pls+xml":{source:"iana",extensions:["pls"]},"application/postscript":{source:"iana",extensions:["ai","eps","ps"]},"application/provenance+xml":{source:"iana",extensions:["provx"]},"application/prs.cww":{source:"iana",extensions:["cww"]},"application/pskc+xml":{source:"iana",extensions:["pskcxml"]},"application/rdf+xml":{source:"iana",extensions:["rdf","owl"]},"application/reginfo+xml":{source:"iana",extensions:["rif"]},"application/relax-ng-compact-syntax":{source:"iana",extensions:["rnc"]},"application/resource-lists+xml":{source:"iana",extensions:["rl"]},"application/resource-lists-diff+xml":{source:"iana",extensions:["rld"]},"application/rls-services+xml":{source:"iana",extensions:["rs"]},"application/route-apd+xml":{source:"iana",extensions:["rapd"]},"application/route-s-tsid+xml":{source:"iana",extensions:["sls"]},"application/route-usd+xml":{source:"iana",extensions:["rusd"]},"application/rpki-ghostbusters":{source:"iana",extensions:["gbr"]},"application/rpki-manifest":{source:"iana",extensions:["mft"]},"application/rpki-roa":{source:"iana",extensions:["roa"]},"application/rsd+xml":{source:"apache",extensions:["rsd"]},"application/rss+xml":{source:"apache",extensions:["rss"]},"application/rtf":{source:"iana",extensions:["rtf"]},"application/sbml+xml":{source:"iana",extensions:["sbml"]},"application/scvp-cv-request":{source:"iana",extensions:["scq"]},"application/scvp-cv-response":{source:"iana",extensions:["scs"]},"application/scvp-vp-request":{source:"iana",extensions:["spq"]},"application/scvp-vp-response":{source:"iana",extensions:["spp"]},"application/sdp":{source:"iana",extensions:["sdp"]},"application/senml+xml":{source:"iana",extensions:["senmlx"]},"application/sensml+xml":{source:"iana",extensions:["sensmlx"]},"application/set-payment-initiation":{source:"iana",extensions:["setpay"]},"application/set-registration-initiation":{source:"iana",extensions:["setreg"]},"application/shf+xml":{source:"iana",extensions:["shf"]},"application/sieve":{source:"iana",extensions:["siv","sieve"]},"application/smil+xml":{source:"iana",extensions:["smi","smil"]},"application/sparql-query":{source:"iana",extensions:["rq"]},"application/sparql-results+xml":{source:"iana",extensions:["srx"]},"application/srgs":{source:"iana",extensions:["gram"]},"application/srgs+xml":{source:"iana",extensions:["grxml"]},"application/sru+xml":{source:"iana",extensions:["sru"]},"application/ssdl+xml":{source:"apache",extensions:["ssdl"]},"application/ssml+xml":{source:"iana",extensions:["ssml"]},"application/swid+xml":{source:"iana",extensions:["swidtag"]},"application/tei+xml":{source:"iana",extensions:["tei","teicorpus"]},"application/thraud+xml":{source:"iana",extensions:["tfi"]},"application/timestamped-data":{source:"iana",extensions:["tsd"]},"application/trig":{source:"iana",extensions:["trig"]},"application/ttml+xml":{source:"iana",extensions:["ttml"]},"application/urc-ressheet+xml":{source:"iana",extensions:["rsheet"]},"application/urc-targetdesc+xml":{source:"iana",extensions:["td"]},"application/vnd.1000minds.decision-model+xml":{source:"iana",extensions:["1km"]},"application/vnd.3gpp.pic-bw-large":{source:"iana",extensions:["plb"]},"application/vnd.3gpp.pic-bw-small":{source:"iana",extensions:["psb"]},"application/vnd.3gpp.pic-bw-var":{source:"iana",extensions:["pvb"]},"application/vnd.3gpp2.tcap":{source:"iana",extensions:["tcap"]},"application/vnd.3m.post-it-notes":{source:"iana",extensions:["pwn"]},"application/vnd.accpac.simply.aso":{source:"iana",extensions:["aso"]},"application/vnd.accpac.simply.imp":{source:"iana",extensions:["imp"]},"application/vnd.acucobol":{source:"iana",extensions:["acu"]},"application/vnd.acucorp":{source:"iana",extensions:["atc","acutc"]},"application/vnd.adobe.air-application-installer-package+zip":{source:"apache",extensions:["air"]},"application/vnd.adobe.formscentral.fcdt":{source:"iana",extensions:["fcdt"]},"application/vnd.adobe.fxp":{source:"iana",extensions:["fxp","fxpl"]},"application/vnd.adobe.xdp+xml":{source:"iana",extensions:["xdp"]},"application/vnd.adobe.xfdf":{source:"iana",extensions:["xfdf"]},"application/vnd.age":{source:"iana",extensions:["age"]},"application/vnd.ahead.space":{source:"iana",extensions:["ahead"]},"application/vnd.airzip.filesecure.azf":{source:"iana",extensions:["azf"]},"application/vnd.airzip.filesecure.azs":{source:"iana",extensions:["azs"]},"application/vnd.amazon.ebook":{source:"apache",extensions:["azw"]},"application/vnd.americandynamics.acc":{source:"iana",extensions:["acc"]},"application/vnd.amiga.ami":{source:"iana",extensions:["ami"]},"application/vnd.android.package-archive":{source:"apache",extensions:["apk"]},"application/vnd.anser-web-certificate-issue-initiation":{source:"iana",extensions:["cii"]},"application/vnd.anser-web-funds-transfer-initiation":{source:"apache",extensions:["fti"]},"application/vnd.antix.game-component":{source:"iana",extensions:["atx"]},"application/vnd.apple.installer+xml":{source:"iana",extensions:["mpkg"]},"application/vnd.apple.keynote":{source:"iana",extensions:["key"]},"application/vnd.apple.mpegurl":{source:"iana",extensions:["m3u8"]},"application/vnd.apple.numbers":{source:"iana",extensions:["numbers"]},"application/vnd.apple.pages":{source:"iana",extensions:["pages"]},"application/vnd.aristanetworks.swi":{source:"iana",extensions:["swi"]},"application/vnd.astraea-software.iota":{source:"iana",extensions:["iota"]},"application/vnd.audiograph":{source:"iana",extensions:["aep"]},"application/vnd.balsamiq.bmml+xml":{source:"iana",extensions:["bmml"]},"application/vnd.blueice.multipass":{source:"iana",extensions:["mpm"]},"application/vnd.bmi":{source:"iana",extensions:["bmi"]},"application/vnd.businessobjects":{source:"iana",extensions:["rep"]},"application/vnd.chemdraw+xml":{source:"iana",extensions:["cdxml"]},"application/vnd.chipnuts.karaoke-mmd":{source:"iana",extensions:["mmd"]},"application/vnd.cinderella":{source:"iana",extensions:["cdy"]},"application/vnd.citationstyles.style+xml":{source:"iana",extensions:["csl"]},"application/vnd.claymore":{source:"iana",extensions:["cla"]},"application/vnd.cloanto.rp9":{source:"iana",extensions:["rp9"]},"application/vnd.clonk.c4group":{source:"iana",extensions:["c4g","c4d","c4f","c4p","c4u"]},"application/vnd.cluetrust.cartomobile-config":{source:"iana",extensions:["c11amc"]},"application/vnd.cluetrust.cartomobile-config-pkg":{source:"iana",extensions:["c11amz"]},"application/vnd.commonspace":{source:"iana",extensions:["csp"]},"application/vnd.contact.cmsg":{source:"iana",extensions:["cdbcmsg"]},"application/vnd.cosmocaller":{source:"iana",extensions:["cmc"]},"application/vnd.crick.clicker":{source:"iana",extensions:["clkx"]},"application/vnd.crick.clicker.keyboard":{source:"iana",extensions:["clkk"]},"application/vnd.crick.clicker.palette":{source:"iana",extensions:["clkp"]},"application/vnd.crick.clicker.template":{source:"iana",extensions:["clkt"]},"application/vnd.crick.clicker.wordbank":{source:"iana",extensions:["clkw"]},"application/vnd.criticaltools.wbs+xml":{source:"iana",extensions:["wbs"]},"application/vnd.ctc-posml":{source:"iana",extensions:["pml"]},"application/vnd.cups-ppd":{source:"iana",extensions:["ppd"]},"application/vnd.curl.car":{source:"apache",extensions:["car"]},"application/vnd.curl.pcurl":{source:"apache",extensions:["pcurl"]},"application/vnd.dart":{source:"iana",extensions:["dart"]},"application/vnd.data-vision.rdz":{source:"iana",extensions:["rdz"]},"application/vnd.dbf":{source:"iana",extensions:["dbf"]},"application/vnd.dece.data":{source:"iana",extensions:["uvf","uvvf","uvd","uvvd"]},"application/vnd.dece.ttml+xml":{source:"iana",extensions:["uvt","uvvt"]},"application/vnd.dece.unspecified":{source:"iana",extensions:["uvx","uvvx"]},"application/vnd.dece.zip":{source:"iana",extensions:["uvz","uvvz"]},"application/vnd.denovo.fcselayout-link":{source:"iana",extensions:["fe_launch"]},"application/vnd.dna":{source:"iana",extensions:["dna"]},"application/vnd.dolby.mlp":{source:"apache",extensions:["mlp"]},"application/vnd.dpgraph":{source:"iana",extensions:["dpg"]},"application/vnd.dreamfactory":{source:"iana",extensions:["dfac"]},"application/vnd.ds-keypoint":{source:"apache",extensions:["kpxx"]},"application/vnd.dvb.ait":{source:"iana",extensions:["ait"]},"application/vnd.dvb.service":{source:"iana",extensions:["svc"]},"application/vnd.dynageo":{source:"iana",extensions:["geo"]},"application/vnd.ecowin.chart":{source:"iana",extensions:["mag"]},"application/vnd.enliven":{source:"iana",extensions:["nml"]},"application/vnd.epson.esf":{source:"iana",extensions:["esf"]},"application/vnd.epson.msf":{source:"iana",extensions:["msf"]},"application/vnd.epson.quickanime":{source:"iana",extensions:["qam"]},"application/vnd.epson.salt":{source:"iana",extensions:["slt"]},"application/vnd.epson.ssf":{source:"iana",extensions:["ssf"]},"application/vnd.eszigno3+xml":{source:"iana",extensions:["es3","et3"]},"application/vnd.ezpix-album":{source:"iana",extensions:["ez2"]},"application/vnd.ezpix-package":{source:"iana",extensions:["ez3"]},"application/vnd.fdf":{source:"iana",extensions:["fdf"]},"application/vnd.fdsn.mseed":{source:"iana",extensions:["mseed"]},"application/vnd.fdsn.seed":{source:"iana",extensions:["seed","dataless"]},"application/vnd.flographit":{source:"iana",extensions:["gph"]},"application/vnd.fluxtime.clip":{source:"iana",extensions:["ftc"]},"application/vnd.framemaker":{source:"iana",extensions:["fm","frame","maker","book"]},"application/vnd.frogans.fnc":{source:"iana",extensions:["fnc"]},"application/vnd.frogans.ltf":{source:"iana",extensions:["ltf"]},"application/vnd.fsc.weblaunch":{source:"iana",extensions:["fsc"]},"application/vnd.fujitsu.oasys":{source:"iana",extensions:["oas"]},"application/vnd.fujitsu.oasys2":{source:"iana",extensions:["oa2"]},"application/vnd.fujitsu.oasys3":{source:"iana",extensions:["oa3"]},"application/vnd.fujitsu.oasysgp":{source:"iana",extensions:["fg5"]},"application/vnd.fujitsu.oasysprs":{source:"iana",extensions:["bh2"]},"application/vnd.fujixerox.ddd":{source:"iana",extensions:["ddd"]},"application/vnd.fujixerox.docuworks":{source:"iana",extensions:["xdw"]},"application/vnd.fujixerox.docuworks.binder":{source:"iana",extensions:["xbd"]},"application/vnd.fuzzysheet":{source:"iana",extensions:["fzs"]},"application/vnd.genomatix.tuxedo":{source:"iana",extensions:["txd"]},"application/vnd.geogebra.file":{source:"iana",extensions:["ggb"]},"application/vnd.geogebra.tool":{source:"iana",extensions:["ggt"]},"application/vnd.geometry-explorer":{source:"iana",extensions:["gex","gre"]},"application/vnd.geonext":{source:"iana",extensions:["gxt"]},"application/vnd.geoplan":{source:"iana",extensions:["g2w"]},"application/vnd.geospace":{source:"iana",extensions:["g3w"]},"application/vnd.gmx":{source:"iana",extensions:["gmx"]},"application/vnd.google-earth.kml+xml":{source:"iana",extensions:["kml"]},"application/vnd.google-earth.kmz":{source:"iana",extensions:["kmz"]},"application/vnd.grafeq":{source:"iana",extensions:["gqf","gqs"]},"application/vnd.groove-account":{source:"iana",extensions:["gac"]},"application/vnd.groove-help":{source:"iana",extensions:["ghf"]},"application/vnd.groove-identity-message":{source:"iana",extensions:["gim"]},"application/vnd.groove-injector":{source:"iana",extensions:["grv"]},"application/vnd.groove-tool-message":{source:"iana",extensions:["gtm"]},"application/vnd.groove-tool-template":{source:"iana",extensions:["tpl"]},"application/vnd.groove-vcard":{source:"iana",extensions:["vcg"]},"application/vnd.hal+xml":{source:"iana",extensions:["hal"]},"application/vnd.handheld-entertainment+xml":{source:"iana",extensions:["zmm"]},"application/vnd.hbci":{source:"iana",extensions:["hbci"]},"application/vnd.hhe.lesson-player":{source:"iana",extensions:["les"]},"application/vnd.hp-hpgl":{source:"iana",extensions:["hpgl"]},"application/vnd.hp-hpid":{source:"iana",extensions:["hpid"]},"application/vnd.hp-hps":{source:"iana",extensions:["hps"]},"application/vnd.hp-jlyt":{source:"iana",extensions:["jlt"]},"application/vnd.hp-pcl":{source:"iana",extensions:["pcl"]},"application/vnd.hp-pclxl":{source:"iana",extensions:["pclxl"]},"application/vnd.hydrostatix.sof-data":{source:"iana",extensions:["sfd-hdstx"]},"application/vnd.ibm.minipay":{source:"iana",extensions:["mpy"]},"application/vnd.ibm.modcap":{source:"iana",extensions:["afp","listafp","list3820"]},"application/vnd.ibm.rights-management":{source:"iana",extensions:["irm"]},"application/vnd.ibm.secure-container":{source:"iana",extensions:["sc"]},"application/vnd.iccprofile":{source:"iana",extensions:["icc","icm"]},"application/vnd.igloader":{source:"iana",extensions:["igl"]},"application/vnd.immervision-ivp":{source:"iana",extensions:["ivp"]},"application/vnd.immervision-ivu":{source:"iana",extensions:["ivu"]},"application/vnd.insors.igm":{source:"iana",extensions:["igm"]},"application/vnd.intercon.formnet":{source:"iana",extensions:["xpw","xpx"]},"application/vnd.intergeo":{source:"iana",extensions:["i2g"]},"application/vnd.intu.qbo":{source:"iana",extensions:["qbo"]},"application/vnd.intu.qfx":{source:"iana",extensions:["qfx"]},"application/vnd.ipunplugged.rcprofile":{source:"iana",extensions:["rcprofile"]},"application/vnd.irepository.package+xml":{source:"iana",extensions:["irp"]},"application/vnd.is-xpr":{source:"iana",extensions:["xpr"]},"application/vnd.isac.fcs":{source:"iana",extensions:["fcs"]},"application/vnd.jam":{source:"iana",extensions:["jam"]},"application/vnd.jcp.javame.midlet-rms":{source:"iana",extensions:["rms"]},"application/vnd.jisp":{source:"iana",extensions:["jisp"]},"application/vnd.joost.joda-archive":{source:"iana",extensions:["joda"]},"application/vnd.kahootz":{source:"iana",extensions:["ktz","ktr"]},"application/vnd.kde.karbon":{source:"iana",extensions:["karbon"]},"application/vnd.kde.kchart":{source:"iana",extensions:["chrt"]},"application/vnd.kde.kformula":{source:"iana",extensions:["kfo"]},"application/vnd.kde.kivio":{source:"iana",extensions:["flw"]},"application/vnd.kde.kontour":{source:"iana",extensions:["kon"]},"application/vnd.kde.kpresenter":{source:"iana",extensions:["kpr","kpt"]},"application/vnd.kde.kspread":{source:"iana",extensions:["ksp"]},"application/vnd.kde.kword":{source:"iana",extensions:["kwd","kwt"]},"application/vnd.kenameaapp":{source:"iana",extensions:["htke"]},"application/vnd.kidspiration":{source:"iana",extensions:["kia"]},"application/vnd.kinar":{source:"iana",extensions:["kne","knp"]},"application/vnd.koan":{source:"iana",extensions:["skp","skd","skt","skm"]},"application/vnd.kodak-descriptor":{source:"iana",extensions:["sse"]},"application/vnd.las.las+xml":{source:"iana",extensions:["lasxml"]},"application/vnd.llamagraphics.life-balance.desktop":{source:"iana",extensions:["lbd"]},"application/vnd.llamagraphics.life-balance.exchange+xml":{source:"iana",extensions:["lbe"]},"application/vnd.lotus-1-2-3":{source:"iana",extensions:["123"]},"application/vnd.lotus-approach":{source:"iana",extensions:["apr"]},"application/vnd.lotus-freelance":{source:"iana",extensions:["pre"]},"application/vnd.lotus-notes":{source:"iana",extensions:["nsf"]},"application/vnd.lotus-organizer":{source:"iana",extensions:["org"]},"application/vnd.lotus-screencam":{source:"iana",extensions:["scm"]},"application/vnd.lotus-wordpro":{source:"iana",extensions:["lwp"]},"application/vnd.macports.portpkg":{source:"iana",extensions:["portpkg"]},"application/vnd.mapbox-vector-tile":{source:"iana",extensions:["mvt"]},"application/vnd.mcd":{source:"iana",extensions:["mcd"]},"application/vnd.medcalcdata":{source:"iana",extensions:["mc1"]},"application/vnd.mediastation.cdkey":{source:"iana",extensions:["cdkey"]},"application/vnd.mfer":{source:"iana",extensions:["mwf"]},"application/vnd.mfmp":{source:"iana",extensions:["mfm"]},"application/vnd.micrografx.flo":{source:"iana",extensions:["flo"]},"application/vnd.micrografx.igx":{source:"iana",extensions:["igx"]},"application/vnd.mif":{source:"iana",extensions:["mif"]},"application/vnd.mobius.daf":{source:"iana",extensions:["daf"]},"application/vnd.mobius.dis":{source:"iana",extensions:["dis"]},"application/vnd.mobius.mbk":{source:"iana",extensions:["mbk"]},"application/vnd.mobius.mqy":{source:"iana",extensions:["mqy"]},"application/vnd.mobius.msl":{source:"iana",extensions:["msl"]},"application/vnd.mobius.plc":{source:"iana",extensions:["plc"]},"application/vnd.mobius.txf":{source:"iana",extensions:["txf"]},"application/vnd.mophun.application":{source:"iana",extensions:["mpn"]},"application/vnd.mophun.certificate":{source:"iana",extensions:["mpc"]},"application/vnd.mozilla.xul+xml":{source:"iana",extensions:["xul"]},"application/vnd.ms-artgalry":{source:"iana",extensions:["cil"]},"application/vnd.ms-cab-compressed":{source:"iana",extensions:["cab"]},"application/vnd.ms-excel":{source:"iana",extensions:["xls","xlm","xla","xlc","xlt","xlw"]},"application/vnd.ms-excel.addin.macroenabled.12":{source:"iana",extensions:["xlam"]},"application/vnd.ms-excel.sheet.binary.macroenabled.12":{source:"iana",extensions:["xlsb"]},"application/vnd.ms-excel.sheet.macroenabled.12":{source:"iana",extensions:["xlsm"]},"application/vnd.ms-excel.template.macroenabled.12":{source:"iana",extensions:["xltm"]},"application/vnd.ms-fontobject":{source:"iana",extensions:["eot"]},"application/vnd.ms-htmlhelp":{source:"iana",extensions:["chm"]},"application/vnd.ms-ims":{source:"iana",extensions:["ims"]},"application/vnd.ms-lrm":{source:"iana",extensions:["lrm"]},"application/vnd.ms-officetheme":{source:"iana",extensions:["thmx"]},"application/vnd.ms-pki.seccat":{source:"apache",extensions:["cat"]},"application/vnd.ms-pki.stl":{source:"apache",extensions:["stl"]},"application/vnd.ms-powerpoint":{source:"iana",extensions:["ppt","pps","pot"]},"application/vnd.ms-powerpoint.addin.macroenabled.12":{source:"iana",extensions:["ppam"]},"application/vnd.ms-powerpoint.presentation.macroenabled.12":{source:"iana",extensions:["pptm"]},"application/vnd.ms-powerpoint.slide.macroenabled.12":{source:"iana",extensions:["sldm"]},"application/vnd.ms-powerpoint.slideshow.macroenabled.12":{source:"iana",extensions:["ppsm"]},"application/vnd.ms-powerpoint.template.macroenabled.12":{source:"iana",extensions:["potm"]},"application/vnd.ms-project":{source:"iana",extensions:["mpp","mpt"]},"application/vnd.ms-word.document.macroenabled.12":{source:"iana",extensions:["docm"]},"application/vnd.ms-word.template.macroenabled.12":{source:"iana",extensions:["dotm"]},"application/vnd.ms-works":{source:"iana",extensions:["wps","wks","wcm","wdb"]},"application/vnd.ms-wpl":{source:"iana",extensions:["wpl"]},"application/vnd.ms-xpsdocument":{source:"iana",extensions:["xps"]},"application/vnd.mseq":{source:"iana",extensions:["mseq"]},"application/vnd.musician":{source:"iana",extensions:["mus"]},"application/vnd.muvee.style":{source:"iana",extensions:["msty"]},"application/vnd.mynfc":{source:"iana",extensions:["taglet"]},"application/vnd.neurolanguage.nlu":{source:"iana",extensions:["nlu"]},"application/vnd.nitf":{source:"iana",extensions:["ntf","nitf"]},"application/vnd.noblenet-directory":{source:"iana",extensions:["nnd"]},"application/vnd.noblenet-sealer":{source:"iana",extensions:["nns"]},"application/vnd.noblenet-web":{source:"iana",extensions:["nnw"]},"application/vnd.nokia.n-gage.ac+xml":{source:"iana",extensions:["ac"]},"application/vnd.nokia.n-gage.data":{source:"iana",extensions:["ngdat"]},"application/vnd.nokia.n-gage.symbian.install":{source:"iana",extensions:["n-gage"]},"application/vnd.nokia.radio-preset":{source:"iana",extensions:["rpst"]},"application/vnd.nokia.radio-presets":{source:"iana",extensions:["rpss"]},"application/vnd.novadigm.edm":{source:"iana",extensions:["edm"]},"application/vnd.novadigm.edx":{source:"iana",extensions:["edx"]},"application/vnd.novadigm.ext":{source:"iana",extensions:["ext"]},"application/vnd.oasis.opendocument.chart":{source:"iana",extensions:["odc"]},"application/vnd.oasis.opendocument.chart-template":{source:"iana",extensions:["otc"]},"application/vnd.oasis.opendocument.database":{source:"iana",extensions:["odb"]},"application/vnd.oasis.opendocument.formula":{source:"iana",extensions:["odf"]},"application/vnd.oasis.opendocument.formula-template":{source:"iana",extensions:["odft"]},"application/vnd.oasis.opendocument.graphics":{source:"iana",extensions:["odg"]},"application/vnd.oasis.opendocument.graphics-template":{source:"iana",extensions:["otg"]},"application/vnd.oasis.opendocument.image":{source:"iana",extensions:["odi"]},"application/vnd.oasis.opendocument.image-template":{source:"iana",extensions:["oti"]},"application/vnd.oasis.opendocument.presentation":{source:"iana",extensions:["odp"]},"application/vnd.oasis.opendocument.presentation-template":{source:"iana",extensions:["otp"]},"application/vnd.oasis.opendocument.spreadsheet":{source:"iana",extensions:["ods"]},"application/vnd.oasis.opendocument.spreadsheet-template":{source:"iana",extensions:["ots"]},"application/vnd.oasis.opendocument.text":{source:"iana",extensions:["odt"]},"application/vnd.oasis.opendocument.text-master":{source:"iana",extensions:["odm"]},"application/vnd.oasis.opendocument.text-template":{source:"iana",extensions:["ott"]},"application/vnd.oasis.opendocument.text-web":{source:"iana",extensions:["oth"]},"application/vnd.olpc-sugar":{source:"iana",extensions:["xo"]},"application/vnd.oma.dd2+xml":{source:"iana",extensions:["dd2"]},"application/vnd.openblox.game+xml":{source:"iana",extensions:["obgx"]},"application/vnd.openofficeorg.extension":{source:"apache",extensions:["oxt"]},"application/vnd.openstreetmap.data+xml":{source:"iana",extensions:["osm"]},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{source:"iana",extensions:["pptx"]},"application/vnd.openxmlformats-officedocument.presentationml.slide":{source:"iana",extensions:["sldx"]},"application/vnd.openxmlformats-officedocument.presentationml.slideshow":{source:"iana",extensions:["ppsx"]},"application/vnd.openxmlformats-officedocument.presentationml.template":{source:"iana",extensions:["potx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{source:"iana",extensions:["xlsx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.template":{source:"iana",extensions:["xltx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{source:"iana",extensions:["docx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.template":{source:"iana",extensions:["dotx"]},"application/vnd.osgeo.mapguide.package":{source:"iana",extensions:["mgp"]},"application/vnd.osgi.dp":{source:"iana",extensions:["dp"]},"application/vnd.osgi.subsystem":{source:"iana",extensions:["esa"]},"application/vnd.palm":{source:"iana",extensions:["pdb","pqa","oprc"]},"application/vnd.pawaafile":{source:"iana",extensions:["paw"]},"application/vnd.pg.format":{source:"iana",extensions:["str"]},"application/vnd.pg.osasli":{source:"iana",extensions:["ei6"]},"application/vnd.picsel":{source:"iana",extensions:["efif"]},"application/vnd.pmi.widget":{source:"iana",extensions:["wg"]},"application/vnd.pocketlearn":{source:"iana",extensions:["plf"]},"application/vnd.powerbuilder6":{source:"iana",extensions:["pbd"]},"application/vnd.previewsystems.box":{source:"iana",extensions:["box"]},"application/vnd.proteus.magazine":{source:"iana",extensions:["mgz"]},"application/vnd.publishare-delta-tree":{source:"iana",extensions:["qps"]},"application/vnd.pvi.ptid1":{source:"iana",extensions:["ptid"]},"application/vnd.quark.quarkxpress":{source:"iana",extensions:["qxd","qxt","qwd","qwt","qxl","qxb"]},"application/vnd.rar":{source:"iana",extensions:["rar"]},"application/vnd.realvnc.bed":{source:"iana",extensions:["bed"]},"application/vnd.recordare.musicxml":{source:"iana",extensions:["mxl"]},"application/vnd.recordare.musicxml+xml":{source:"iana",extensions:["musicxml"]},"application/vnd.rig.cryptonote":{source:"iana",extensions:["cryptonote"]},"application/vnd.rim.cod":{source:"apache",extensions:["cod"]},"application/vnd.rn-realmedia":{source:"apache",extensions:["rm"]},"application/vnd.rn-realmedia-vbr":{source:"apache",extensions:["rmvb"]},"application/vnd.route66.link66+xml":{source:"iana",extensions:["link66"]},"application/vnd.sailingtracker.track":{source:"iana",extensions:["st"]},"application/vnd.seemail":{source:"iana",extensions:["see"]},"application/vnd.sema":{source:"iana",extensions:["sema"]},"application/vnd.semd":{source:"iana",extensions:["semd"]},"application/vnd.semf":{source:"iana",extensions:["semf"]},"application/vnd.shana.informed.formdata":{source:"iana",extensions:["ifm"]},"application/vnd.shana.informed.formtemplate":{source:"iana",extensions:["itp"]},"application/vnd.shana.informed.interchange":{source:"iana",extensions:["iif"]},"application/vnd.shana.informed.package":{source:"iana",extensions:["ipk"]},"application/vnd.simtech-mindmapper":{source:"iana",extensions:["twd","twds"]},"application/vnd.smaf":{source:"iana",extensions:["mmf"]},"application/vnd.smart.teacher":{source:"iana",extensions:["teacher"]},"application/vnd.software602.filler.form+xml":{source:"iana",extensions:["fo"]},"application/vnd.solent.sdkm+xml":{source:"iana",extensions:["sdkm","sdkd"]},"application/vnd.spotfire.dxp":{source:"iana",extensions:["dxp"]},"application/vnd.spotfire.sfs":{source:"iana",extensions:["sfs"]},"application/vnd.stardivision.calc":{source:"apache",extensions:["sdc"]},"application/vnd.stardivision.draw":{source:"apache",extensions:["sda"]},"application/vnd.stardivision.impress":{source:"apache",extensions:["sdd"]},"application/vnd.stardivision.math":{source:"apache",extensions:["smf"]},"application/vnd.stardivision.writer":{source:"apache",extensions:["sdw","vor"]},"application/vnd.stardivision.writer-global":{source:"apache",extensions:["sgl"]},"application/vnd.stepmania.package":{source:"iana",extensions:["smzip"]},"application/vnd.stepmania.stepchart":{source:"iana",extensions:["sm"]},"application/vnd.sun.wadl+xml":{source:"iana",extensions:["wadl"]},"application/vnd.sun.xml.calc":{source:"apache",extensions:["sxc"]},"application/vnd.sun.xml.calc.template":{source:"apache",extensions:["stc"]},"application/vnd.sun.xml.draw":{source:"apache",extensions:["sxd"]},"application/vnd.sun.xml.draw.template":{source:"apache",extensions:["std"]},"application/vnd.sun.xml.impress":{source:"apache",extensions:["sxi"]},"application/vnd.sun.xml.impress.template":{source:"apache",extensions:["sti"]},"application/vnd.sun.xml.math":{source:"apache",extensions:["sxm"]},"application/vnd.sun.xml.writer":{source:"apache",extensions:["sxw"]},"application/vnd.sun.xml.writer.global":{source:"apache",extensions:["sxg"]},"application/vnd.sun.xml.writer.template":{source:"apache",extensions:["stw"]},"application/vnd.sus-calendar":{source:"iana",extensions:["sus","susp"]},"application/vnd.svd":{source:"iana",extensions:["svd"]},"application/vnd.symbian.install":{source:"apache",extensions:["sis","sisx"]},"application/vnd.syncml+xml":{source:"iana",charset:"UTF-8",extensions:["xsm"]},"application/vnd.syncml.dm+wbxml":{source:"iana",charset:"UTF-8",extensions:["bdm"]},"application/vnd.syncml.dm+xml":{source:"iana",charset:"UTF-8",extensions:["xdm"]},"application/vnd.syncml.dmddf+xml":{source:"iana",charset:"UTF-8",extensions:["ddf"]},"application/vnd.tao.intent-module-archive":{source:"iana",extensions:["tao"]},"application/vnd.tcpdump.pcap":{source:"iana",extensions:["pcap","cap","dmp"]},"application/vnd.tmobile-livetv":{source:"iana",extensions:["tmo"]},"application/vnd.trid.tpt":{source:"iana",extensions:["tpt"]},"application/vnd.triscape.mxs":{source:"iana",extensions:["mxs"]},"application/vnd.trueapp":{source:"iana",extensions:["tra"]},"application/vnd.ufdl":{source:"iana",extensions:["ufd","ufdl"]},"application/vnd.uiq.theme":{source:"iana",extensions:["utz"]},"application/vnd.umajin":{source:"iana",extensions:["umj"]},"application/vnd.unity":{source:"iana",extensions:["unityweb"]},"application/vnd.uoml+xml":{source:"iana",extensions:["uoml"]},"application/vnd.vcx":{source:"iana",extensions:["vcx"]},"application/vnd.visio":{source:"iana",extensions:["vsd","vst","vss","vsw"]},"application/vnd.visionary":{source:"iana",extensions:["vis"]},"application/vnd.vsf":{source:"iana",extensions:["vsf"]},"application/vnd.wap.wbxml":{source:"iana",charset:"UTF-8",extensions:["wbxml"]},"application/vnd.wap.wmlc":{source:"iana",extensions:["wmlc"]},"application/vnd.wap.wmlscriptc":{source:"iana",extensions:["wmlsc"]},"application/vnd.webturbo":{source:"iana",extensions:["wtb"]},"application/vnd.wolfram.player":{source:"iana",extensions:["nbp"]},"application/vnd.wordperfect":{source:"iana",extensions:["wpd"]},"application/vnd.wqd":{source:"iana",extensions:["wqd"]},"application/vnd.wt.stf":{source:"iana",extensions:["stf"]},"application/vnd.xara":{source:"iana",extensions:["xar"]},"application/vnd.xfdl":{source:"iana",extensions:["xfdl"]},"application/vnd.yamaha.hv-dic":{source:"iana",extensions:["hvd"]},"application/vnd.yamaha.hv-script":{source:"iana",extensions:["hvs"]},"application/vnd.yamaha.hv-voice":{source:"iana",extensions:["hvp"]},"application/vnd.yamaha.openscoreformat":{source:"iana",extensions:["osf"]},"application/vnd.yamaha.openscoreformat.osfpvg+xml":{source:"iana",extensions:["osfpvg"]},"application/vnd.yamaha.smaf-audio":{source:"iana",extensions:["saf"]},"application/vnd.yamaha.smaf-phrase":{source:"iana",extensions:["spf"]},"application/vnd.yellowriver-custom-menu":{source:"iana",extensions:["cmp"]},"application/vnd.zul":{source:"iana",extensions:["zir","zirz"]},"application/vnd.zzazz.deck+xml":{source:"iana",extensions:["zaz"]},"application/voicexml+xml":{source:"iana",extensions:["vxml"]},"application/wasm":{source:"iana",extensions:["wasm"]},"application/watcherinfo+xml":{source:"iana",extensions:["wif"]},"application/widget":{source:"iana",extensions:["wgt"]},"application/winhlp":{source:"apache",extensions:["hlp"]},"application/wsdl+xml":{source:"iana",extensions:["wsdl"]},"application/wspolicy+xml":{source:"iana",extensions:["wspolicy"]},"application/x-7z-compressed":{source:"apache",extensions:["7z"]},"application/x-abiword":{source:"apache",extensions:["abw"]},"application/x-ace-compressed":{source:"apache",extensions:["ace"]},"application/x-apple-diskimage":{source:"apache",extensions:["dmg"]},"application/x-authorware-bin":{source:"apache",extensions:["aab","x32","u32","vox"]},"application/x-authorware-map":{source:"apache",extensions:["aam"]},"application/x-authorware-seg":{source:"apache",extensions:["aas"]},"application/x-bcpio":{source:"apache",extensions:["bcpio"]},"application/x-bittorrent":{source:"apache",extensions:["torrent"]},"application/x-blorb":{source:"apache",extensions:["blb","blorb"]},"application/x-bzip":{source:"apache",extensions:["bz"]},"application/x-bzip2":{source:"apache",extensions:["bz2","boz"]},"application/x-cbr":{source:"apache",extensions:["cbr","cba","cbt","cbz","cb7"]},"application/x-cdlink":{source:"apache",extensions:["vcd"]},"application/x-cfs-compressed":{source:"apache",extensions:["cfs"]},"application/x-chat":{source:"apache",extensions:["chat"]},"application/x-chess-pgn":{source:"apache",extensions:["pgn"]},"application/x-cocoa":{source:"nginx",extensions:["cco"]},"application/x-conference":{source:"apache",extensions:["nsc"]},"application/x-cpio":{source:"apache",extensions:["cpio"]},"application/x-csh":{source:"apache",extensions:["csh"]},"application/x-debian-package":{source:"apache",extensions:["deb","udeb"]},"application/x-dgc-compressed":{source:"apache",extensions:["dgc"]},"application/x-director":{source:"apache",extensions:["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"]},"application/x-doom":{source:"apache",extensions:["wad"]},"application/x-dtbncx+xml":{source:"apache",extensions:["ncx"]},"application/x-dtbook+xml":{source:"apache",extensions:["dtb"]},"application/x-dtbresource+xml":{source:"apache",extensions:["res"]},"application/x-dvi":{source:"apache",extensions:["dvi"]},"application/x-envoy":{source:"apache",extensions:["evy"]},"application/x-eva":{source:"apache",extensions:["eva"]},"application/x-font-bdf":{source:"apache",extensions:["bdf"]},"application/x-font-ghostscript":{source:"apache",extensions:["gsf"]},"application/x-font-linux-psf":{source:"apache",extensions:["psf"]},"application/x-font-pcf":{source:"apache",extensions:["pcf"]},"application/x-font-snf":{source:"apache",extensions:["snf"]},"application/x-font-type1":{source:"apache",extensions:["pfa","pfb","pfm","afm"]},"application/x-freearc":{source:"apache",extensions:["arc"]},"application/x-futuresplash":{source:"apache",extensions:["spl"]},"application/x-gca-compressed":{source:"apache",extensions:["gca"]},"application/x-glulx":{source:"apache",extensions:["ulx"]},"application/x-gnumeric":{source:"apache",extensions:["gnumeric"]},"application/x-gramps-xml":{source:"apache",extensions:["gramps"]},"application/x-gtar":{source:"apache",extensions:["gtar"]},"application/x-hdf":{source:"apache",extensions:["hdf"]},"application/x-install-instructions":{source:"apache",extensions:["install"]},"application/x-iso9660-image":{source:"apache",extensions:["iso"]},"application/x-java-archive-diff":{source:"nginx",extensions:["jardiff"]},"application/x-java-jnlp-file":{source:"apache",extensions:["jnlp"]},"application/x-latex":{source:"apache",extensions:["latex"]},"application/x-lzh-compressed":{source:"apache",extensions:["lzh","lha"]},"application/x-makeself":{source:"nginx",extensions:["run"]},"application/x-mie":{source:"apache",extensions:["mie"]},"application/x-mobipocket-ebook":{source:"apache",extensions:["prc","mobi"]},"application/x-ms-application":{source:"apache",extensions:["application"]},"application/x-ms-shortcut":{source:"apache",extensions:["lnk"]},"application/x-ms-wmd":{source:"apache",extensions:["wmd"]},"application/x-ms-wmz":{source:"apache",extensions:["wmz"]},"application/x-ms-xbap":{source:"apache",extensions:["xbap"]},"application/x-msaccess":{source:"apache",extensions:["mdb"]},"application/x-msbinder":{source:"apache",extensions:["obd"]},"application/x-mscardfile":{source:"apache",extensions:["crd"]},"application/x-msclip":{source:"apache",extensions:["clp"]},"application/x-msdownload":{source:"apache",extensions:["exe","dll","com","bat","msi"]},"application/x-msmediaview":{source:"apache",extensions:["mvb","m13","m14"]},"application/x-msmetafile":{source:"apache",extensions:["wmf","wmz","emf","emz"]},"application/x-msmoney":{source:"apache",extensions:["mny"]},"application/x-mspublisher":{source:"apache",extensions:["pub"]},"application/x-msschedule":{source:"apache",extensions:["scd"]},"application/x-msterminal":{source:"apache",extensions:["trm"]},"application/x-mswrite":{source:"apache",extensions:["wri"]},"application/x-netcdf":{source:"apache",extensions:["nc","cdf"]},"application/x-nzb":{source:"apache",extensions:["nzb"]},"application/x-perl":{source:"nginx",extensions:["pl","pm"]},"application/x-pilot":{source:"nginx",extensions:["prc","pdb"]},"application/x-pkcs12":{source:"apache",extensions:["p12","pfx"]},"application/x-pkcs7-certificates":{source:"apache",extensions:["p7b","spc"]},"application/x-pkcs7-certreqresp":{source:"apache",extensions:["p7r"]},"application/x-rar-compressed":{source:"apache",extensions:["rar"]},"application/x-redhat-package-manager":{source:"nginx",extensions:["rpm"]},"application/x-research-info-systems":{source:"apache",extensions:["ris"]},"application/x-sea":{source:"nginx",extensions:["sea"]},"application/x-sh":{source:"apache",extensions:["sh"]},"application/x-shar":{source:"apache",extensions:["shar"]},"application/x-shockwave-flash":{source:"apache",extensions:["swf"]},"application/x-silverlight-app":{source:"apache",extensions:["xap"]},"application/x-sql":{source:"apache",extensions:["sql"]},"application/x-stuffit":{source:"apache",extensions:["sit"]},"application/x-stuffitx":{source:"apache",extensions:["sitx"]},"application/x-subrip":{source:"apache",extensions:["srt"]},"application/x-sv4cpio":{source:"apache",extensions:["sv4cpio"]},"application/x-sv4crc":{source:"apache",extensions:["sv4crc"]},"application/x-t3vm-image":{source:"apache",extensions:["t3"]},"application/x-tads":{source:"apache",extensions:["gam"]},"application/x-tar":{source:"apache",extensions:["tar"]},"application/x-tcl":{source:"apache",extensions:["tcl","tk"]},"application/x-tex":{source:"apache",extensions:["tex"]},"application/x-tex-tfm":{source:"apache",extensions:["tfm"]},"application/x-texinfo":{source:"apache",extensions:["texinfo","texi"]},"application/x-tgif":{source:"apache",extensions:["obj"]},"application/x-ustar":{source:"apache",extensions:["ustar"]},"application/x-wais-source":{source:"apache",extensions:["src"]},"application/x-x509-ca-cert":{source:"iana",extensions:["der","crt","pem"]},"application/x-xfig":{source:"apache",extensions:["fig"]},"application/x-xliff+xml":{source:"apache",extensions:["xlf"]},"application/x-xpinstall":{source:"apache",extensions:["xpi"]},"application/x-xz":{source:"apache",extensions:["xz"]},"application/x-zmachine":{source:"apache",extensions:["z1","z2","z3","z4","z5","z6","z7","z8"]},"application/xaml+xml":{source:"apache",extensions:["xaml"]},"application/xcap-att+xml":{source:"iana",extensions:["xav"]},"application/xcap-caps+xml":{source:"iana",extensions:["xca"]},"application/xcap-diff+xml":{source:"iana",extensions:["xdf"]},"application/xcap-el+xml":{source:"iana",extensions:["xel"]},"application/xcap-ns+xml":{source:"iana",extensions:["xns"]},"application/xenc+xml":{source:"iana",extensions:["xenc"]},"application/xhtml+xml":{source:"iana",extensions:["xhtml","xht"]},"application/xliff+xml":{source:"iana",extensions:["xlf"]},"application/xml":{source:"iana",extensions:["xml","xsl","xsd","rng"]},"application/xml-dtd":{source:"iana",extensions:["dtd"]},"application/xop+xml":{source:"iana",extensions:["xop"]},"application/xproc+xml":{source:"apache",extensions:["xpl"]},"application/xslt+xml":{source:"iana",extensions:["xsl","xslt"]},"application/xspf+xml":{source:"apache",extensions:["xspf"]},"application/xv+xml":{source:"iana",extensions:["mxml","xhvml","xvml","xvm"]},"application/yaml":{source:"iana",extensions:["yaml","yml"]},"application/yang":{source:"iana",extensions:["yang"]},"application/yin+xml":{source:"iana",extensions:["yin"]},"application/zip":{source:"iana",extensions:["zip"]},"audio/3gpp":{source:"iana",extensions:["3gpp"]},"audio/adpcm":{source:"apache",extensions:["adp"]},"audio/amr":{source:"iana",extensions:["amr"]},"audio/basic":{source:"iana",extensions:["au","snd"]},"audio/midi":{source:"apache",extensions:["mid","midi","kar","rmi"]},"audio/mobile-xmf":{source:"iana",extensions:["mxmf"]},"audio/mp4":{source:"iana",extensions:["m4a","mp4a"]},"audio/mpeg":{source:"iana",extensions:["mpga","mp2","mp2a","mp3","m2a","m3a"]},"audio/ogg":{source:"iana",extensions:["oga","ogg","spx","opus"]},"audio/s3m":{source:"apache",extensions:["s3m"]},"audio/silk":{source:"apache",extensions:["sil"]},"audio/vnd.dece.audio":{source:"iana",extensions:["uva","uvva"]},"audio/vnd.digital-winds":{source:"iana",extensions:["eol"]},"audio/vnd.dra":{source:"iana",extensions:["dra"]},"audio/vnd.dts":{source:"iana",extensions:["dts"]},"audio/vnd.dts.hd":{source:"iana",extensions:["dtshd"]},"audio/vnd.lucent.voice":{source:"iana",extensions:["lvp"]},"audio/vnd.ms-playready.media.pya":{source:"iana",extensions:["pya"]},"audio/vnd.nuera.ecelp4800":{source:"iana",extensions:["ecelp4800"]},"audio/vnd.nuera.ecelp7470":{source:"iana",extensions:["ecelp7470"]},"audio/vnd.nuera.ecelp9600":{source:"iana",extensions:["ecelp9600"]},"audio/vnd.rip":{source:"iana",extensions:["rip"]},"audio/webm":{source:"apache",extensions:["weba"]},"audio/x-aac":{source:"apache",extensions:["aac"]},"audio/x-aiff":{source:"apache",extensions:["aif","aiff","aifc"]},"audio/x-caf":{source:"apache",extensions:["caf"]},"audio/x-flac":{source:"apache",extensions:["flac"]},"audio/x-m4a":{source:"nginx",extensions:["m4a"]},"audio/x-matroska":{source:"apache",extensions:["mka"]},"audio/x-mpegurl":{source:"apache",extensions:["m3u"]},"audio/x-ms-wax":{source:"apache",extensions:["wax"]},"audio/x-ms-wma":{source:"apache",extensions:["wma"]},"audio/x-pn-realaudio":{source:"apache",extensions:["ram","ra"]},"audio/x-pn-realaudio-plugin":{source:"apache",extensions:["rmp"]},"audio/x-realaudio":{source:"nginx",extensions:["ra"]},"audio/x-wav":{source:"apache",extensions:["wav"]},"audio/x-gsm":{source:"apache",extensions:["gsm"]},"audio/xm":{source:"apache",extensions:["xm"]},"image/aces":{source:"iana",extensions:["exr"]},"image/avci":{source:"iana",extensions:["avci"]},"image/avcs":{source:"iana",extensions:["avcs"]},"image/avif":{source:"iana",extensions:["avif"]},"image/bmp":{source:"iana",extensions:["bmp"]},"image/cgm":{source:"iana",extensions:["cgm"]},"image/dicom-rle":{source:"iana",extensions:["drle"]},"image/emf":{source:"iana",extensions:["emf"]},"image/fits":{source:"iana",extensions:["fits"]},"image/g3fax":{source:"iana",extensions:["g3"]},"image/gif":{source:"iana",extensions:["gif"]},"image/heic":{source:"iana",extensions:["heic"]},"image/heic-sequence":{source:"iana",extensions:["heics"]},"image/heif":{source:"iana",extensions:["heif"]},"image/heif-sequence":{source:"iana",extensions:["heifs"]},"image/hej2k":{source:"iana",extensions:["hej2"]},"image/hsj2":{source:"iana",extensions:["hsj2"]},"image/ief":{source:"iana",extensions:["ief"]},"image/jls":{source:"iana",extensions:["jls"]},"image/jp2":{source:"iana",extensions:["jp2","jpg2"]},"image/jpeg":{source:"iana",extensions:["jpeg","jpg","jpe","jfif","pjpeg","pjp"]},"image/jph":{source:"iana",extensions:["jph"]},"image/jphc":{source:"iana",extensions:["jhc"]},"image/jpm":{source:"iana",extensions:["jpm"]},"image/jpx":{source:"iana",extensions:["jpx","jpf"]},"image/jxr":{source:"iana",extensions:["jxr"]},"image/jxra":{source:"iana",extensions:["jxra"]},"image/jxrs":{source:"iana",extensions:["jxrs"]},"image/jxs":{source:"iana",extensions:["jxs"]},"image/jxsc":{source:"iana",extensions:["jxsc"]},"image/jxsi":{source:"iana",extensions:["jxsi"]},"image/jxss":{source:"iana",extensions:["jxss"]},"image/ktx":{source:"iana",extensions:["ktx"]},"image/ktx2":{source:"iana",extensions:["ktx2"]},"image/png":{source:"iana",extensions:["png"]},"image/prs.btif":{source:"iana",extensions:["btif"]},"image/prs.pti":{source:"iana",extensions:["pti"]},"image/sgi":{source:"apache",extensions:["sgi"]},"image/svg+xml":{source:"iana",extensions:["svg","svgz"]},"image/t38":{source:"iana",extensions:["t38"]},"image/tiff":{source:"iana",extensions:["tif","tiff"]},"image/tiff-fx":{source:"iana",extensions:["tfx"]},"image/vnd.adobe.photoshop":{source:"iana",extensions:["psd"]},"image/vnd.airzip.accelerator.azv":{source:"iana",extensions:["azv"]},"image/vnd.dece.graphic":{source:"iana",extensions:["uvi","uvvi","uvg","uvvg"]},"image/vnd.djvu":{source:"iana",extensions:["djvu","djv"]},"image/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"image/vnd.dwg":{source:"iana",extensions:["dwg"]},"image/vnd.dxf":{source:"iana",extensions:["dxf"]},"image/vnd.fastbidsheet":{source:"iana",extensions:["fbs"]},"image/vnd.fpx":{source:"iana",extensions:["fpx"]},"image/vnd.fst":{source:"iana",extensions:["fst"]},"image/vnd.fujixerox.edmics-mmr":{source:"iana",extensions:["mmr"]},"image/vnd.fujixerox.edmics-rlc":{source:"iana",extensions:["rlc"]},"image/vnd.microsoft.icon":{source:"iana",extensions:["ico"]},"image/vnd.ms-modi":{source:"iana",extensions:["mdi"]},"image/vnd.ms-photo":{source:"apache",extensions:["wdp"]},"image/vnd.net-fpx":{source:"iana",extensions:["npx"]},"image/vnd.pco.b16":{source:"iana",extensions:["b16"]},"image/vnd.tencent.tap":{source:"iana",extensions:["tap"]},"image/vnd.valve.source.texture":{source:"iana",extensions:["vtf"]},"image/vnd.wap.wbmp":{source:"iana",extensions:["wbmp"]},"image/vnd.xiff":{source:"iana",extensions:["xif"]},"image/vnd.zbrush.pcx":{source:"iana",extensions:["pcx"]},"image/webp":{source:"apache",extensions:["webp"]},"image/wmf":{source:"iana",extensions:["wmf"]},"image/x-3ds":{source:"apache",extensions:["3ds"]},"image/x-cmu-raster":{source:"apache",extensions:["ras"]},"image/x-cmx":{source:"apache",extensions:["cmx"]},"image/x-freehand":{source:"apache",extensions:["fh","fhc","fh4","fh5","fh7"]},"image/x-icon":{source:"apache",extensions:["ico"]},"image/x-jng":{source:"nginx",extensions:["jng"]},"image/x-mrsid-image":{source:"apache",extensions:["sid"]},"image/x-ms-bmp":{source:"nginx",extensions:["bmp"]},"image/x-pcx":{source:"apache",extensions:["pcx"]},"image/x-pict":{source:"apache",extensions:["pic","pct"]},"image/x-portable-anymap":{source:"apache",extensions:["pnm"]},"image/x-portable-bitmap":{source:"apache",extensions:["pbm"]},"image/x-portable-graymap":{source:"apache",extensions:["pgm"]},"image/x-portable-pixmap":{source:"apache",extensions:["ppm"]},"image/x-rgb":{source:"apache",extensions:["rgb"]},"image/x-tga":{source:"apache",extensions:["tga"]},"image/x-xbitmap":{source:"apache",extensions:["xbm"]},"image/x-xpixmap":{source:"apache",extensions:["xpm"]},"image/x-xwindowdump":{source:"apache",extensions:["xwd"]},"text/cache-manifest":{source:"iana",extensions:["appcache","manifest"]},"text/calendar":{source:"iana",extensions:["ics","ifb"]},"text/css":{source:"iana",charset:"UTF-8",extensions:["css"]},"text/csv":{source:"iana",extensions:["csv"]},"text/html":{source:"iana",extensions:["html","htm","shtml"]},"text/markdown":{source:"iana",extensions:["markdown","md"]},"text/mathml":{source:"nginx",extensions:["mml"]},"text/n3":{source:"iana",charset:"UTF-8",extensions:["n3"]},"text/plain":{source:"iana",extensions:["txt","text","conf","def","list","log","in","ini"]},"text/prs.lines.tag":{source:"iana",extensions:["dsc"]},"text/richtext":{source:"iana",extensions:["rtx"]},"text/rtf":{source:"iana",extensions:["rtf"]},"text/sgml":{source:"iana",extensions:["sgml","sgm"]},"text/shex":{source:"iana",extensions:["shex"]},"text/spdx":{source:"iana",extensions:["spdx"]},"text/tab-separated-values":{source:"iana",extensions:["tsv"]},"text/troff":{source:"iana",extensions:["t","tr","roff","man","me","ms"]},"text/turtle":{source:"iana",charset:"UTF-8",extensions:["ttl"]},"text/uri-list":{source:"iana",extensions:["uri","uris","urls"]},"text/vcard":{source:"iana",extensions:["vcard"]},"text/vnd.curl":{source:"iana",extensions:["curl"]},"text/vnd.curl.dcurl":{source:"apache",extensions:["dcurl"]},"text/vnd.curl.mcurl":{source:"apache",extensions:["mcurl"]},"text/vnd.curl.scurl":{source:"apache",extensions:["scurl"]},"text/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"text/vnd.familysearch.gedcom":{source:"iana",extensions:["ged"]},"text/vnd.fly":{source:"iana",extensions:["fly"]},"text/vnd.fmi.flexstor":{source:"iana",extensions:["flx"]},"text/vnd.graphviz":{source:"iana",extensions:["gv"]},"text/vnd.in3d.3dml":{source:"iana",extensions:["3dml"]},"text/vnd.in3d.spot":{source:"iana",extensions:["spot"]},"text/vnd.sun.j2me.app-descriptor":{source:"iana",charset:"UTF-8",extensions:["jad"]},"text/vnd.wap.wml":{source:"iana",extensions:["wml"]},"text/vnd.wap.wmlscript":{source:"iana",extensions:["wmls"]},"text/vtt":{source:"iana",charset:"UTF-8",extensions:["vtt"]},"text/x-asm":{source:"apache",extensions:["s","asm"]},"text/x-c":{source:"apache",extensions:["c","cc","cxx","cpp","h","hh","dic"]},"text/x-component":{source:"nginx",extensions:["htc"]},"text/x-fortran":{source:"apache",extensions:["f","for","f77","f90"]},"text/x-java-source":{source:"apache",extensions:["java"]},"text/x-nfo":{source:"apache",extensions:["nfo"]},"text/x-opml":{source:"apache",extensions:["opml"]},"text/x-pascal":{source:"apache",extensions:["p","pas"]},"text/x-setext":{source:"apache",extensions:["etx"]},"text/x-sfv":{source:"apache",extensions:["sfv"]},"text/x-uuencode":{source:"apache",extensions:["uu"]},"text/x-vcalendar":{source:"apache",extensions:["vcs"]},"text/x-vcard":{source:"apache",extensions:["vcf"]},"text/xml":{source:"iana",extensions:["xml"]},"video/3gpp":{source:"iana",extensions:["3gp","3gpp"]},"video/3gpp2":{source:"iana",extensions:["3g2"]},"video/h261":{source:"iana",extensions:["h261"]},"video/h263":{source:"iana",extensions:["h263"]},"video/h264":{source:"iana",extensions:["h264"]},"video/iso.segment":{source:"iana",extensions:["m4s"]},"video/jpeg":{source:"iana",extensions:["jpgv"]},"video/jpm":{source:"apache",extensions:["jpm","jpgm"]},"video/mj2":{source:"iana",extensions:["mj2","mjp2"]},"video/mp2t":{source:"iana",extensions:["ts"]},"video/mp4":{source:"iana",extensions:["mp4","mp4v","mpg4"]},"video/mpeg":{source:"iana",extensions:["mpeg","mpg","mpe","m1v","m2v"]},"video/ogg":{source:"iana",extensions:["ogv"]},"video/quicktime":{source:"iana",extensions:["qt","mov"]},"video/vnd.dece.hd":{source:"iana",extensions:["uvh","uvvh"]},"video/vnd.dece.mobile":{source:"iana",extensions:["uvm","uvvm"]},"video/vnd.dece.pd":{source:"iana",extensions:["uvp","uvvp"]},"video/vnd.dece.sd":{source:"iana",extensions:["uvs","uvvs"]},"video/vnd.dece.video":{source:"iana",extensions:["uvv","uvvv"]},"video/vnd.dvb.file":{source:"iana",extensions:["dvb"]},"video/vnd.fvt":{source:"iana",extensions:["fvt"]},"video/vnd.mpegurl":{source:"iana",extensions:["mxu","m4u"]},"video/vnd.ms-playready.media.pyv":{source:"iana",extensions:["pyv"]},"video/vnd.uvvu.mp4":{source:"iana",extensions:["uvu","uvvu"]},"video/vnd.vivo":{source:"iana",extensions:["viv"]},"video/webm":{source:"apache",extensions:["webm"]},"video/x-f4v":{source:"apache",extensions:["f4v"]},"video/x-fli":{source:"apache",extensions:["fli"]},"video/x-flv":{source:"apache",extensions:["flv"]},"video/x-m4v":{source:"apache",extensions:["m4v"]},"video/x-matroska":{source:"apache",extensions:["mkv","mk3d","mks"]},"video/x-mng":{source:"apache",extensions:["mng"]},"video/x-ms-asf":{source:"apache",extensions:["asf","asx"]},"video/x-ms-vob":{source:"apache",extensions:["vob"]},"video/x-ms-wm":{source:"apache",extensions:["wm"]},"video/x-ms-wmv":{source:"apache",extensions:["wmv"]},"video/x-ms-wmx":{source:"apache",extensions:["wmx"]},"video/x-ms-wvx":{source:"apache",extensions:["wvx"]},"video/x-msvideo":{source:"apache",extensions:["avi"]},"video/x-sgi-movie":{source:"apache",extensions:["movie"]},"video/x-smv":{source:"apache",extensions:["smv"]},"chemical/x-cdx":{source:"apache",extensions:["cdx"]},"chemical/x-cif":{source:"apache",extensions:["cif"]},"chemical/x-cmdf":{source:"apache",extensions:["cmdf"]},"chemical/x-cml":{source:"apache",extensions:["cml"]},"chemical/x-csml":{source:"apache",extensions:["csml"]},"chemical/x-xyz":{source:"apache",extensions:["xyz"]},"font/collection":{source:"iana",extensions:["ttc"]},"font/otf":{source:"iana",extensions:["otf"]},"font/ttf":{source:"iana",extensions:["ttf"]},"font/woff":{source:"iana",extensions:["woff"]},"font/woff2":{source:"iana",extensions:["woff2"]},"message/disposition-notification":{source:"iana",extensions:["disposition-notification"]},"message/global":{source:"iana",extensions:["u8msg"]},"message/global-delivery-status":{source:"iana",extensions:["u8dsn"]},"message/global-disposition-notification":{source:"iana",extensions:["u8mdn"]},"message/global-headers":{source:"iana",extensions:["u8hdr"]},"message/rfc822":{source:"iana",extensions:["eml","mime"]},"message/vnd.wfa.wsc":{source:"iana",extensions:["wsc"]},"model/3mf":{source:"iana",extensions:["3mf"]},"model/gltf+json":{source:"iana",extensions:["gltf"]},"model/gltf-binary":{source:"iana",extensions:["glb"]},"model/iges":{source:"iana",extensions:["igs","iges"]},"model/mesh":{source:"iana",extensions:["msh","mesh","silo"]},"model/mtl":{source:"iana",extensions:["mtl"]},"model/obj":{source:"iana",extensions:["obj"]},"model/step":{source:"iana",extensions:[".p21",".stp",".step",".stpnc",".210"]},"model/step+xml":{source:"iana",extensions:["stpx"]},"model/step+zip":{source:"iana",extensions:["stpz"]},"model/step-xml+zip":{source:"iana",extensions:["stpxz"]},"model/stl":{source:"iana",extensions:["stl"]},"model/vnd.collada+xml":{source:"iana",extensions:["dae"]},"model/vnd.dwf":{source:"iana",extensions:["dwf"]},"model/vnd.gdl":{source:"iana",extensions:["gdl"]},"model/vnd.gtw":{source:"iana",extensions:["gtw"]},"model/vnd.mts":{source:"iana",extensions:["mts"]},"model/vnd.opengex":{source:"iana",extensions:["ogex"]},"model/vnd.parasolid.transmit.binary":{source:"iana",extensions:["x_b"]},"model/vnd.parasolid.transmit.text":{source:"iana",extensions:["x_t"]},"model/vnd.sap.vds":{source:"iana",extensions:["vds"]},"model/vnd.usdz+zip":{source:"iana",extensions:["usdz"]},"model/vnd.valve.source.compiled-map":{source:"iana",extensions:["bsp"]},"model/vnd.vtu":{source:"iana",extensions:["vtu"]},"model/vrml":{source:"iana",extensions:["wrl","vrml"]},"model/x3d+binary":{source:"apache",extensions:["x3db","x3dbz"]},"model/x3d+fastinfoset":{source:"iana",extensions:["x3db"]},"model/x3d+vrml":{source:"apache",extensions:["x3dv","x3dvz"]},"model/x3d+xml":{source:"iana",extensions:["x3d","x3dz"]},"model/x3d-vrml":{source:"iana",extensions:["x3dv"]},"x-conference/x-cooltalk":{source:"apache",extensions:["ice"]}},rZ={},rQ={},rY=!1,rX=Symbol.for("effect/Encoding/errors/Decode"),r0=(e,t)=>{let r={_tag:"DecodeException",[rX]:rX,input:e};return"string"==typeof t&&(r.message=t),r},r1=new TextEncoder,r2=e=>{let t="";for(let r=0;r<e.length;++r)t+=r3[e[r]];return t},r3=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],r5=e=>{if(48<=e&&e<=57)return e-48;if(97<=e&&e<=102)return e-97+10;if(65<=e&&e<=70)return e-65+10;throw TypeError("Invalid input")},r4=L("effect/Redacted/redactedRegistry",()=>new WeakMap),r6=e=>{if(r4.has(e))return r4.get(e);throw Error("Unable to get redacted value")},r8={alphabet:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",minLength:0,blocklist:new Set(["0rgasm","1d10t","1d1ot","1di0t","1diot","1eccacu10","1eccacu1o","1eccacul0","1eccaculo","1mbec11e","1mbec1le","1mbeci1e","1mbecile","a11upat0","a11upato","a1lupat0","a1lupato","aand","ah01e","ah0le","aho1e","ahole","al1upat0","al1upato","allupat0","allupato","ana1","ana1e","anal","anale","anus","arrapat0","arrapato","arsch","arse","ass","b00b","b00be","b01ata","b0ceta","b0iata","b0ob","b0obe","b0sta","b1tch","b1te","b1tte","ba1atkar","balatkar","bastard0","bastardo","batt0na","battona","bitch","bite","bitte","bo0b","bo0be","bo1ata","boceta","boiata","boob","boobe","bosta","bran1age","bran1er","bran1ette","bran1eur","bran1euse","branlage","branler","branlette","branleur","branleuse","c0ck","c0g110ne","c0g11one","c0g1i0ne","c0g1ione","c0gl10ne","c0gl1one","c0gli0ne","c0glione","c0na","c0nnard","c0nnasse","c0nne","c0u111es","c0u11les","c0u1l1es","c0u1lles","c0ui11es","c0ui1les","c0uil1es","c0uilles","c11t","c11t0","c11to","c1it","c1it0","c1ito","cabr0n","cabra0","cabrao","cabron","caca","cacca","cacete","cagante","cagar","cagare","cagna","cara1h0","cara1ho","caracu10","caracu1o","caracul0","caraculo","caralh0","caralho","cazz0","cazz1mma","cazzata","cazzimma","cazzo","ch00t1a","ch00t1ya","ch00tia","ch00tiya","ch0d","ch0ot1a","ch0ot1ya","ch0otia","ch0otiya","ch1asse","ch1avata","ch1er","ch1ng0","ch1ngadaz0s","ch1ngadazos","ch1ngader1ta","ch1ngaderita","ch1ngar","ch1ngo","ch1ngues","ch1nk","chatte","chiasse","chiavata","chier","ching0","chingadaz0s","chingadazos","chingader1ta","chingaderita","chingar","chingo","chingues","chink","cho0t1a","cho0t1ya","cho0tia","cho0tiya","chod","choot1a","choot1ya","chootia","chootiya","cl1t","cl1t0","cl1to","clit","clit0","clito","cock","cog110ne","cog11one","cog1i0ne","cog1ione","cogl10ne","cogl1one","cogli0ne","coglione","cona","connard","connasse","conne","cou111es","cou11les","cou1l1es","cou1lles","coui11es","coui1les","couil1es","couilles","cracker","crap","cu10","cu1att0ne","cu1attone","cu1er0","cu1ero","cu1o","cul0","culatt0ne","culattone","culer0","culero","culo","cum","cunt","d11d0","d11do","d1ck","d1ld0","d1ldo","damn","de1ch","deich","depp","di1d0","di1do","dick","dild0","dildo","dyke","encu1e","encule","enema","enf01re","enf0ire","enfo1re","enfoire","estup1d0","estup1do","estupid0","estupido","etr0n","etron","f0da","f0der","f0ttere","f0tters1","f0ttersi","f0tze","f0utre","f1ca","f1cker","f1ga","fag","fica","ficker","figa","foda","foder","fottere","fotters1","fottersi","fotze","foutre","fr0c10","fr0c1o","fr0ci0","fr0cio","fr0sc10","fr0sc1o","fr0sci0","fr0scio","froc10","froc1o","froci0","frocio","frosc10","frosc1o","frosci0","froscio","fuck","g00","g0o","g0u1ne","g0uine","gandu","go0","goo","gou1ne","gouine","gr0gnasse","grognasse","haram1","harami","haramzade","hund1n","hundin","id10t","id1ot","idi0t","idiot","imbec11e","imbec1le","imbeci1e","imbecile","j1zz","jerk","jizz","k1ke","kam1ne","kamine","kike","leccacu10","leccacu1o","leccacul0","leccaculo","m1erda","m1gn0tta","m1gnotta","m1nch1a","m1nchia","m1st","mam0n","mamahuev0","mamahuevo","mamon","masturbat10n","masturbat1on","masturbate","masturbati0n","masturbation","merd0s0","merd0so","merda","merde","merdos0","merdoso","mierda","mign0tta","mignotta","minch1a","minchia","mist","musch1","muschi","n1gger","neger","negr0","negre","negro","nerch1a","nerchia","nigger","orgasm","p00p","p011a","p01la","p0l1a","p0lla","p0mp1n0","p0mp1no","p0mpin0","p0mpino","p0op","p0rca","p0rn","p0rra","p0uff1asse","p0uffiasse","p1p1","p1pi","p1r1a","p1rla","p1sc10","p1sc1o","p1sci0","p1scio","p1sser","pa11e","pa1le","pal1e","palle","pane1e1r0","pane1e1ro","pane1eir0","pane1eiro","panele1r0","panele1ro","paneleir0","paneleiro","patakha","pec0r1na","pec0rina","pecor1na","pecorina","pen1s","pendej0","pendejo","penis","pip1","pipi","pir1a","pirla","pisc10","pisc1o","pisci0","piscio","pisser","po0p","po11a","po1la","pol1a","polla","pomp1n0","pomp1no","pompin0","pompino","poop","porca","porn","porra","pouff1asse","pouffiasse","pr1ck","prick","pussy","put1za","puta","puta1n","putain","pute","putiza","puttana","queca","r0mp1ba11e","r0mp1ba1le","r0mp1bal1e","r0mp1balle","r0mpiba11e","r0mpiba1le","r0mpibal1e","r0mpiballe","rand1","randi","rape","recch10ne","recch1one","recchi0ne","recchione","retard","romp1ba11e","romp1ba1le","romp1bal1e","romp1balle","rompiba11e","rompiba1le","rompibal1e","rompiballe","ruff1an0","ruff1ano","ruffian0","ruffiano","s1ut","sa10pe","sa1aud","sa1ope","sacanagem","sal0pe","salaud","salope","saugnapf","sb0rr0ne","sb0rra","sb0rrone","sbattere","sbatters1","sbattersi","sborr0ne","sborra","sborrone","sc0pare","sc0pata","sch1ampe","sche1se","sche1sse","scheise","scheisse","schlampe","schwachs1nn1g","schwachs1nnig","schwachsinn1g","schwachsinnig","schwanz","scopare","scopata","sexy","sh1t","shit","slut","sp0mp1nare","sp0mpinare","spomp1nare","spompinare","str0nz0","str0nza","str0nzo","stronz0","stronza","stronzo","stup1d","stupid","succh1am1","succh1ami","succhiam1","succhiami","sucker","t0pa","tapette","test1c1e","test1cle","testic1e","testicle","tette","topa","tr01a","tr0ia","tr0mbare","tr1ng1er","tr1ngler","tring1er","tringler","tro1a","troia","trombare","turd","twat","vaffancu10","vaffancu1o","vaffancul0","vaffanculo","vag1na","vagina","verdammt","verga","w1chsen","wank","wichsen","x0ch0ta","x0chota","xana","xoch0ta","xochota","z0cc01a","z0cc0la","z0cco1a","z0ccola","z1z1","z1zi","ziz1","zizi","zocc01a","zocc0la","zocco1a","zoccola"])};class r7{constructor(e){var t,r,n;let i=null!=(t=null==e?void 0:e.alphabet)?t:r8.alphabet,s=null!=(r=null==e?void 0:e.minLength)?r:r8.minLength,a=null!=(n=null==e?void 0:e.blocklist)?n:r8.blocklist;if(new Blob([i]).size!==i.length)throw Error("Alphabet cannot contain multibyte characters");if(i.length<3)throw Error("Alphabet length must be at least 3");if(new Set(i).size!==i.length)throw Error("Alphabet must contain unique characters");if("number"!=typeof s||s<0||s>255)throw Error("Minimum length has to be between 0 and 255");let o=new Set,l=i.toLowerCase().split("");for(let e of a)if(e.length>=3){let t=e.toLowerCase(),r=t.split("");r.filter(e=>l.includes(e)).length===r.length&&o.add(t)}this.alphabet=this.shuffle(i),this.minLength=s,this.blocklist=o}encode(e){if(0===e.length)return"";if(e.filter(e=>e>=0&&e<=this.maxValue()).length!==e.length)throw Error(`Encoding supports numbers between 0 and ${this.maxValue()}`);return this.encodeNumbers(e)}decode(e){let t=[];if(""===e)return t;let r=this.alphabet.split("");for(let n of e.split(""))if(!r.includes(n))return t;let n=e.charAt(0),i=this.alphabet.indexOf(n),s=this.alphabet.slice(i)+this.alphabet.slice(0,i);s=s.split("").reverse().join("");let a=e.slice(1);for(;a.length>0;){let e=s.slice(0,1),r=a.split(e);if(r.length>0){if(""===r[0])return t;t.push(this.toNumber(r[0],s.slice(1))),r.length>1&&(s=this.shuffle(s))}a=r.slice(1).join(e)}return t}encodeNumbers(e,t=0){if(t>this.alphabet.length)throw Error("Reached max attempts to re-generate the ID");let r=e.reduce((e,t,r)=>this.alphabet[t%this.alphabet.length].codePointAt(0)+r+e,e.length)%this.alphabet.length;r=(r+t)%this.alphabet.length;let n=this.alphabet.slice(r)+this.alphabet.slice(0,r),i=n.charAt(0);n=n.split("").reverse().join("");let s=[i];for(let t=0;t!==e.length;t++){let r=e[t];s.push(this.toId(r,n.slice(1))),t<e.length-1&&(s.push(n.slice(0,1)),n=this.shuffle(n))}let a=s.join("");if(this.minLength>a.length)for(a+=n.slice(0,1);this.minLength-a.length>0;)n=this.shuffle(n),a+=n.slice(0,Math.min(this.minLength-a.length,n.length));return this.isBlockedId(a)&&(a=this.encodeNumbers(e,t+1)),a}shuffle(e){let t=e.split("");for(let e=0,r=t.length-1;r>0;e++,r--){let n=(e*r+t[e].codePointAt(0)+t[r].codePointAt(0))%t.length;[t[e],t[n]]=[t[n],t[e]]}return t.join("")}toId(e,t){let r=[],n=t.split(""),i=e;do r.unshift(n[i%n.length]),i=Math.floor(i/n.length);while(i>0)return r.join("")}toNumber(e,t){let r=t.split("");return e.split("").reduce((e,t)=>e*r.length+r.indexOf(t),0)}isBlockedId(e){let t=e.toLowerCase();for(let e of this.blocklist)if(e.length<=t.length){if(t.length<=3||e.length<=3){if(t===e)return!0}else if(/\d/.test(e)){if(t.startsWith(e)||t.endsWith(e))return!0}else if(t.includes(e))return!0}return!1}maxValue(){return Number.MAX_SAFE_INTEGER}}var r9=class extends rK("InvalidRouteConfig"){constructor(e,t){super({reason:t?`Expected route config to have a ${t} for key ${e} but none was found.`:`Encountered an invalid route config during backfilling. ${e} was not found.`})}},ne=class extends rK("UnknownFileType"){constructor(e){super({reason:`Could not determine type for ${e}`})}},nt=class extends rK("InvalidFileType"){constructor(e,t){super({reason:`File type ${e} not allowed for ${t}`})}},nr=class extends rK("InvalidFileSize"){constructor(e){super({reason:`Invalid file size: ${e}`})}};function nn(e){return{maxFileSize:"image"===e?"4MB":"video"===e?"16MB":"audio"===e||"blob"===e?"8MB":"pdf"===e?"4MB":"text"===e?"64KB":"4MB",maxFileCount:1,minFileCount:1,contentDisposition:"inline"}}rK("InvalidURL"),rK("RetryError"),rK("FetchError"),rK("InvalidJson"),rK("BadRequestError"),rK("UploadAborted"),rK("UploadAborted");let ni=e=>{if(Array.isArray(e))return tY(e.reduce((e,t)=>(e[t]=nn(t),e),{}));let t={};for(let r of nl(e)){let n=e[r];if(!n)return t0(new r9(r));t[r]={...nn(r),...n}}return tY(JSON.parse(JSON.stringify(t,nu)))},ns=(e,t)=>{let r=e.type||function(e){if(!e||"string"!=typeof e)return!1;let t=(function(e){let t=e.lastIndexOf(".");return t<0?"":e.substring(t)})("x."+e).toLowerCase().substring(1);return!!t&&((function(e,t){if(rY)return;rY=!0;let r=["nginx","apache",void 0,"iana"];Object.keys(rG).forEach(n=>{let i=rG[n],s=i.extensions;if(s.length)for(let a of(e[n]=s,s)){if(a in t){let e=r.indexOf(rG[t[a]].source),n=r.indexOf(i.source);if("application/octet-stream"!==t[a]&&(e>n||e===n&&t[a].startsWith("application/")))continue}t[a]=n}})}(rZ,rQ),rQ)[t]||!1)}(e.name);if(!r)return t.includes("blob")?tY("blob"):t0(new ne(e.name));if(t.some(e=>e.includes("/"))&&t.includes(r))return tY(r);let n="application/pdf"===r.toLowerCase()?"pdf":r.split("/")[0];if(!t.includes(n))if(t.includes("blob"))return tY("blob");else return t0(new nt(n,e.name));return tY(n)},na=["B","KB","MB","GB","TB"],no=e=>{let t=RegExp(`^(\\d+)(\\.\\d+)?\\s*(${na.join("|")})$`,"i"),r=e.match(t);if(!r?.[1]||!r[3])return t0(new nr(e));let n=parseFloat(r[1]),i=r[3].toUpperCase();return tY(Math.floor(n*Math.pow(1024,na.indexOf(i))))};function nl(e){return Object.keys(e)}let nu=(e,t)=>"number"!=typeof t||Number.isSafeInteger(t)||t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER?t:t===1/0?Number.MAX_SAFE_INTEGER:t===-1/0?Number.MIN_SAFE_INTEGER:Number.isNaN(t)?0:void 0,nc={BAD_REQUEST:400,NOT_FOUND:404,FORBIDDEN:403,INTERNAL_SERVER_ERROR:500,INTERNAL_CLIENT_ERROR:500,TOO_LARGE:413,TOO_SMALL:400,TOO_MANY_FILES:400,KEY_TOO_LONG:400,URL_GENERATION_FAILED:500,UPLOAD_FAILED:500,MISSING_ENV:500,INVALID_SERVER_CONFIG:500,FILE_LIMIT_EXCEEDED:500};var nh=class e extends rW{_tag="UploadThingError";name="UploadThingError";cause;code;data;constructor(e){let t="string"==typeof e?{code:"INTERNAL_SERVER_ERROR",message:e}:e;(super({message:t.message??function(e,t){return"string"==typeof e?e:e instanceof Error||e&&"object"==typeof e&&"message"in e&&"string"==typeof e.message?e.message:t??"An unknown error occurred"}(t.cause,t.code)}),this.code=t.code,this.data=t.data,t.cause instanceof Error)?this.cause=t.cause:(e=>U(e)&&!Array.isArray(e))(t.cause)&&"number"==typeof t.cause.status&&"string"==typeof t.cause.statusText?this.cause=Error(`Response ${t.cause.status} ${t.cause.statusText}`):"string"==typeof t.cause?this.cause=Error(t.cause):this.cause=t.cause}static toObject(e){return{code:e.code,message:e.message,data:e.data}}static serialize(t){return JSON.stringify(e.toObject(t))}};(c="uploadthing/Fetch",()=>{let e=Error.stackTraceLimit;Error.stackTraceLimit=2;let t=Error();function r(){}return Error.stackTraceLimit=e,Object.setPrototypeOf(r,tu),r.key=c,Object.defineProperty(r,"stack",{get:()=>t.stack}),r})();let nf={name:"HMAC",hash:"SHA-256"},np=new TextEncoder,nd=(e,t,r)=>rt(function*(){let n,i=t?.slice(12);if(!i)return!1;let s=np.encode(r6(r)),a=yield*t4(()=>crypto.subtle.importKey("raw",s,nf,!1,["verify"])),o=yield*"Right"===(n=(e=>{let t=new TextEncoder().encode(e);if(t.length%2!=0)return eU(r0(e,`Length must be a multiple of 2, but is ${t.length}`));try{let e=t.length/2,r=new Uint8Array(e);for(let n=0;n<e;n++){let e=r5(t[2*n]),i=r5(t[2*n+1]);r[n]=e<<4|i}return eB(r)}catch(t){return eU(r0(e,t instanceof Error?t.message:"Invalid input"))}})(i))._tag?tY(n.right):t0(n.left),l=np.encode(e);return yield*t4(()=>crypto.subtle.verify(nf,a,o,l))}).pipe(rR("verifySignature"),rF(()=>!1)),nm=function(e,t){if("function"==typeof e)return function(){return e(arguments)?t.apply(this,arguments):e=>t(e,...arguments)};switch(e){case 0:case 1:throw RangeError(`Invalid arity ${e}`);case 2:return function(e,r){return arguments.length>=2?t(e,r):function(r){return t(r,e)}};case 3:return function(e,r,n){return arguments.length>=3?t(e,r,n):function(n){return t(n,e,r)}};case 4:return function(e,r,n,i){return arguments.length>=4?t(e,r,n,i):function(i){return t(i,e,r,n)}};case 5:return function(e,r,n,i,s){return arguments.length>=5?t(e,r,n,i,s):function(s){return t(s,e,r,n,i)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(e){return t(e,...r)}}}},ng=e=>e,nb=e=>()=>e,ny=nb(!0),nx=nb(!1),nv=nb(void 0);function nS(e,t,r,n,i,s,a,o,l){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return n(r(t(e)));case 5:return i(n(r(t(e))));case 6:return s(i(n(r(t(e)))));case 7:return a(s(i(n(r(t(e))))));case 8:return o(a(s(i(n(r(t(e)))))));case 9:return l(o(a(s(i(n(r(t(e))))))));default:{let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return e}}}let n_=e=>(t,r)=>t===r||e(t,r),nw=(e,t)=>e===t,nk=nm(2,(e,t)=>n_((r,n)=>e(t(r),t(n)))),nO=nk(nw,e=>e.getTime()),nE=e=>n_((t,r)=>{if(t.length!==r.length)return!1;for(let n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1;return!0}),nC="effect/GlobalValue",nF=(e,t)=>(r||(globalThis[nC]??=new Map,r=globalThis[nC]),r.has(e)||r.set(e,t()),r.get(e)),nR=e=>"string"==typeof e,nI=e=>"number"==typeof e,nT=e=>"boolean"==typeof e,nA=e=>"bigint"==typeof e,nN=e=>"symbol"==typeof e,nM=e=>void 0===e,nj=e=>void 0!==e,nP=e=>null!==e,nD=e=>!1,n$=e=>"object"==typeof e&&null!==e,nz=e=>n$(e)||"function"==typeof e,nL=nm(2,(e,t)=>nz(e)&&t in e),nU=nm(2,(e,t)=>nL(e,"_tag")&&e._tag===t),nB=e=>null!=e,nq=e=>e instanceof Uint8Array,nJ=e=>e instanceof Date,nH=e=>nL(e,Symbol.iterator),nV=e=>nL(e,"then")&&"function"==typeof e.then,nW=((e,t)=>r=>e(r)||t(r),e=>`BUG: ${e} - please report an issue at https://github.com/Effect-TS/effect/issues`),nK=Symbol.for("effect/Gen/GenKind");Symbol.iterator;class nG{self;called=!1;constructor(e){this.self=e}next(e){return this.called?{value:e,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(e){return{value:e,done:!0}}throw(e){throw e}[Symbol.iterator](){return new nG(this.self)}}class nZ{_state;constructor(e,t,r,n){return null==t&&null==e?(t=0xffffffff*Math.random()>>>0,e=0):null==t&&(t=e,e=0),null==n&&null==r?(n=this._state?this._state[3]:0xf767814f,r=this._state?this._state[2]:0x14057b7e):null==n&&(n=r,r=0),this._state=new Int32Array([0,0,r>>>0,(1|(n||0))>>>0]),this._next(),nQ(this._state,this._state[0],this._state[1],e>>>0,t>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(e){this._state[0]=e[0],this._state[1]=e[1],this._state[2]=e[2],this._state[3]=1|e[3]}integer(e){return Math.round(this.number()*Number.MAX_SAFE_INTEGER)%e}number(){return(0x8000000*((0x3ffffff&this._next())*1)+(0x7ffffff&this._next())*1)/0x20000000000000}_next(){var e,t,r,n;let i,s,a,o,l=this._state[0]>>>0,u=this._state[1]>>>0;e=this._state,t=l,n=0x4c957f2d,i=((r=u)>>>16)*32557>>>0,s=(65535&r)*(n>>>16)>>>0,a=(65535&r)*(65535&n)>>>0,o=(r>>>16)*(n>>>16)+((s>>>16)+(i>>>16))>>>0,(a=a+(s=s<<16>>>0)>>>0)>>>0<s>>>0&&(o=o+1>>>0),(a=a+(i=i<<16>>>0)>>>0)>>>0<i>>>0&&(o=o+1>>>0),o=(o=o+Math.imul(r,0x5851f42d)>>>0)+Math.imul(t,n)>>>0,e[0]=o,e[1]=a,nQ(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let c=l>>>18,h=(u>>>18|l<<14)>>>0;c=(c^l)>>>0;let f=((h=(h^u)>>>0)>>>27|c<<5)>>>0,p=l>>>27;return(f>>>p|f<<((-p>>>0&31)>>>0))>>>0}}function nQ(e,t,r,n,i){let s=t+n>>>0,a=r+i>>>0;a>>>0<r>>>0&&(s=s+1|0),e[0]=s,e[1]=a}let nY=Symbol.for("effect/Utils/YieldWrap");class nX{#e;constructor(e){this.#e=e}[nY](){return this.#e}}let n0=nF("effect/Utils/isStructuralRegion",()=>({enabled:!1,tester:void 0})),n1={effect_internal_function:e=>e()},n2=n1.effect_internal_function(()=>Error().stack)?.includes("effect_internal_function")===!0?n1.effect_internal_function:e=>e(),n3=(function*(){}).constructor,n5=nF(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),n4=Symbol.for("effect/Hash"),n6=e=>{if(!0===n0.enabled)return 0;switch(typeof e){case"number":return it(e);case"bigint":return ir(e.toString(10));case"boolean":case"symbol":return ir(String(e));case"string":return ir(e);case"undefined":return ir("undefined");case"function":case"object":if(null===e)return ir("null");if(e instanceof Date)return n6(e.toISOString());if(e instanceof URL)return n6(e.href);else if(ie(e))return e[n4]();else return n8(e);default:throw Error(`BUG: unhandled typeof ${typeof e} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},n8=e=>(n5.has(e)||n5.set(e,it(Math.floor(Math.random()*Number.MAX_SAFE_INTEGER))),n5.get(e)),n7=e=>t=>53*t^e,n9=e=>0xbfffffff&e|e>>>1&0x40000000,ie=e=>nL(e,n4),it=e=>{if(e!=e||e===1/0)return 0;let t=0|e;for(t!==e&&(t^=0xffffffff*e);e>0xffffffff;)t^=e/=0xffffffff;return n9(t)},ir=e=>{let t=5381,r=e.length;for(;r;)t=33*t^e.charCodeAt(--r);return n9(t)},ii=e=>((e,t)=>{let r=12289;for(let n=0;n<t.length;n++)r^=nS(ir(t[n]),n7(n6(e[t[n]])));return n9(r)})(e,Object.keys(e)),is=e=>{let t=6151;for(let r=0;r<e.length;r++)t=nS(t,n7(n6(e[r])));return n9(t)},ia=function(){if(1==arguments.length){let e=arguments[0];return function(t){return Object.defineProperty(e,n4,{value:()=>t,enumerable:!1}),t}}let e=arguments[0],t=arguments[1];return Object.defineProperty(e,n4,{value:()=>t,enumerable:!1}),t},io=Symbol.for("effect/Equal");function il(){return 1==arguments.length?e=>iu(e,arguments[0]):iu(arguments[0],arguments[1])}function iu(e,t){if(e===t)return!0;let r=typeof e;if(r!==typeof t)return!1;if("object"===r||"function"===r){if(null!==e&&null!==t){if(ic(e)&&ic(t))if(n6(e)===n6(t)&&e[io](t))return!0;else return!!n0.enabled&&!!n0.tester&&n0.tester(e,t);else if(e instanceof Date&&t instanceof Date)return e.toISOString()===t.toISOString();else if(e instanceof URL&&t instanceof URL)return e.href===t.href}if(n0.enabled){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((e,r)=>iu(e,t[r]));if(Object.getPrototypeOf(e)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){let r=Object.keys(e),n=Object.keys(t);if(r.length===n.length){for(let n of r)if(!(n in t&&iu(e[n],t[n])))return!!n0.tester&&n0.tester(e,t);return!0}}return!!n0.tester&&n0.tester(e,t)}}return!!n0.enabled&&!!n0.tester&&n0.tester(e,t)}let ic=e=>nL(e,io),ih=Symbol.for("nodejs.util.inspect.custom"),ip=e=>{try{let t;if(nL(e,"toJSON")&&(t=e.toJSON,"function"==typeof t)&&0===e.toJSON.length)return e.toJSON();if(Array.isArray(e))return e.map(ip)}catch{return{}}return i_(e)},id=e=>JSON.stringify(e,null,2),im={toJSON(){return ip(this)},[ih](){return this.toJSON()},toString(){return id(this.toJSON())}};class ig{[ih](){return this.toJSON()}toString(){return id(this.toJSON())}}let ib=(e,t=2)=>{if("string"==typeof e)return e;try{return"object"==typeof e?iy(e,t):String(e)}catch{return String(e)}},iy=(e,t)=>{let r=[],n=JSON.stringify(e,(e,t)=>"object"==typeof t&&null!==t?r.includes(t)?void 0:r.push(t)&&(void 0!==iS.fiberRefs&&iv(t)?t[ix](iS.fiberRefs):t):t,t);return r=void 0,n},ix=Symbol.for("effect/Inspectable/Redactable"),iv=e=>"object"==typeof e&&null!==e&&ix in e,iS=nF("effect/Inspectable/redactableState",()=>({fiberRefs:void 0})),i_=e=>iv(e)&&void 0!==iS.fiberRefs?e[ix](iS.fiberRefs):e,iw=(e,t)=>{switch(t.length){case 0:return e;case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let e=0,n=t.length;e<n;e++)r=t[e](r);return r}}},ik="Async",iO="Commit",iE="Failure",iC="OnFailure",iF="OnSuccess",iR="OnSuccessAndFailure",iI="Success",iT="Sync",iA="UpdateRuntimeFlags",iN="While",iM="Iterator",ij="WithRuntime",iP="Yield",iD="RevertFlags",i$=()=>"3.17.7",iz=Symbol.for("effect/Effect"),iL=Symbol.for("effect/Stream"),iU=Symbol.for("effect/Sink"),iB=Symbol.for("effect/Channel"),iq={_R:e=>e,_E:e=>e,_A:e=>e,_V:i$()},iJ={[iz]:iq,[iL]:iq,[iU]:{_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e},[iB]:{_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},[io](e){return this===e},[n4](){return ia(this,n8(this))},[Symbol.iterator](){return new nG(new nX(this))},pipe(){return iw(this,arguments)}},iH={[n4](){return ia(this,ii(this))},[io](e){let t=Object.keys(this),r=Object.keys(e);if(t.length!==r.length)return!1;for(let r of t)if(!(r in e&&il(this[r],e[r])))return!1;return!0}},iV={...iJ,_op:iO},iW={...iV,...iH},iK=function(){function e(){}return e.prototype=iV,e}(),iG=function(){function e(){}return e.prototype=iW,e}(),iZ=Symbol.for("effect/Option"),iQ={...iJ,[iZ]:{_A:e=>e},[ih](){return this.toJSON()},toString(){return id(this.toJSON())}},iY=Object.assign(Object.create(iQ),{_tag:"Some",_op:"Some",[io](e){return i1(e)&&i3(e)&&il(this.value,e.value)},[n4](){return ia(this,n7(n6(this._tag))(n6(this.value)))},toJSON(){return{_id:"Option",_tag:this._tag,value:ip(this.value)}}}),iX=n6("None"),i0=Object.assign(Object.create(iQ),{_tag:"None",_op:"None",[io]:e=>i1(e)&&i2(e),[n4]:()=>iX,toJSON(){return{_id:"Option",_tag:this._tag}}}),i1=e=>nL(e,iZ),i2=e=>"None"===e._tag,i3=e=>"Some"===e._tag,i5=Object.create(i0),i4=e=>{let t=Object.create(iY);return t.value=e,t},i6=Symbol.for("effect/Either"),i8={...iJ,[i6]:{_R:e=>e},[ih](){return this.toJSON()},toString(){return id(this.toJSON())}},i7=Object.assign(Object.create(i8),{_tag:"Right",_op:"Right",[io](e){return se(e)&&sr(e)&&il(this.right,e.right)},[n4](){return n7(n6(this._tag))(n6(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:ip(this.right)}}}),i9=Object.assign(Object.create(i8),{_tag:"Left",_op:"Left",[io](e){return se(e)&&st(e)&&il(this.left,e.left)},[n4](){return n7(n6(this._tag))(n6(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:ip(this.left)}}}),se=e=>nL(e,i6),st=e=>"Left"===e._tag,sr=e=>"Right"===e._tag,sn=e=>{let t=Object.create(i9);return t.left=e,t},si=e=>{let t=Object.create(i7);return t.right=e,t},ss=nm(2,(e,t)=>i2(e)?sn(t()):si(e.value)),sa=nm(2,(e,{onLeft:t,onRight:r})=>st(e)?sn(t(e.left)):si(r(e.right))),so=nm(2,(e,t)=>st(e)?sn(t(e.left)):si(e.right)),sl=nm(2,(e,t)=>sr(e)?si(t(e.right)):sn(e.left)),su=nm(2,(e,{onLeft:t,onRight:r})=>st(e)?t(e.left):r(e.right)),sc=su({onLeft:ng,onRight:ng}),sh=nm(2,(e,t)=>{if(sr(e))return e.right;throw t(e.left)}),sf=sh(()=>Error("getOrThrow called on a Left")),sp=nm(2,(e,t)=>st(e)?sn(e.left):t(e.right)),sd=((e,t,r)=>sp(e,e=>sl(t,t=>r(e,t))),e=>e.length>0),sm=e=>(t,r)=>t===r?0:e(t,r),sg=sm((e,t)=>e<t?-1:1),sb=sm((e,t)=>e<t?-1:1),sy=nm(2,(e,t)=>sm((r,n)=>e(t(r),t(n)))),sx=e=>nm(2,(t,r)=>1===e(t,r)),sv=e=>nm(2,(t,r)=>t===r||1>e(t,r)?t:r),sS=e=>nm(2,(t,r)=>t===r||e(t,r)>-1?t:r),s_=()=>i5,sw=nm(2,(e,{onNone:t,onSome:r})=>i2(e)?t():r(e.value)),sk=nm(2,(e,t)=>i2(e)?t():e.value),sO=nm(2,(e,t)=>i2(e)?t():e),sE=nm(2,(e,t)=>i2(e)?i4(t()):e),sC=e=>null==e?s_():i4(e),sF=sk(nv),sR=e=>(...t)=>{try{return i4(e(...t))}catch{return s_()}},sI=nm(2,(e,t)=>{if(i3(e))return e.value;throw t()}),sT=sI(()=>Error("getOrThrow called on a None")),sA=nm(2,(e,t)=>i2(e)?s_():i4(t(e.value))),sN=nm(2,(e,t)=>i2(e)?s_():t(e.value)),sM=nm(2,(e,t)=>i2(e)?s_():sC(t(e.value))),sj=((e,t)=>sN(e,e=>sA(t(e),()=>e)),nm(2,(e,t)=>sN(e,e=>t(e)?i4(e):i5))),sP=e=>n_((t,r)=>i2(t)?i2(r):!i2(r)&&e(t.value,r.value)),sD=nm(2,(e,t)=>!i2(e)&&il(e.value,t)),s$=nm(2,(e,t)=>!i2(e)&&t(e.value)),sz=e=>(t,r)=>i2(t)?r:i2(r)?t:i4(e(t.value,r.value)),sL=(...e)=>e,sU=((e,t)=>sU(t,e),nm(2,(e,t)=>({[Symbol.iterator](){let r,n=e[Symbol.iterator](),i=!1;return{next(){if(!i){let e=n.next();return e.done?(i=!0,(r=t[Symbol.iterator]()).next()):e}return r.next()}}}}))),sB=nm(2,(e,t)=>{let r=0;for(let n of e){let e=t(n,r);if(nT(e)){if(e)return i4(n)}else if(i3(e))return e;r++}return s_()});(e,t,r)=>({[Symbol.iterator](){let n=e[Symbol.iterator](),i=t[Symbol.iterator]();return{next(){let e=n.next(),t=i.next();return e.done||t.done?{done:!0,value:void 0}:{done:!1,value:r(e.value,t.value)}}}}});Symbol.iterator,()=>sq;let sq={next:()=>({done:!0,value:void 0})},sJ=nm(2,(e,t)=>({[Symbol.iterator](){let r=e[Symbol.iterator](),n=0;return{next(){let e=r.next();return e.done?{done:!0,value:void 0}:{done:!1,value:t(e.value,n++)}}}}})),sH=nm(2,(e,t)=>sV(sJ(e,t))),sV=e=>({[Symbol.iterator](){let t,r=e[Symbol.iterator]();return{next:function e(){if(void 0===t){let e=r.next();if(e.done)return e;t=e.value[Symbol.iterator]()}let n=t.next();return n.done?(t=void 0,e()):n}}}});(e,t)=>({[Symbol.iterator](){let r=e[Symbol.iterator](),n=0;return{next(){let e=r.next();for(;!e.done;){let i=t(e.value,n++);if(i3(i))return{done:!1,value:i.value};e=r.next()}return{done:!0,value:void 0}}}}});(e,t,r)=>sH(e,e=>sJ(t,t=>r(e,t)));Object.fromEntries,(e,t)=>{let r=[];for(let n of sZ(e))r.push(t(n,e[n]));return r};let sW=nm(2,(e,t)=>Object.prototype.hasOwnProperty.call(e,t)),sK=((e,t)=>sW(e,t)?i4(e[t]):s_(),nm(2,(e,t)=>{if(!sW(e,t))return{...e};let r={...e};return delete r[t],r})),sG=nm(2,(e,t)=>{let r={...e};for(let n of sZ(e))r[n]=t(e[n],n);return r}),sZ=e=>Object.keys(e),sQ=nm(3,(e,t,r)=>({...e,[t]:r})),sY=(...e)=>e,sX=e=>Array(e),s0=nm(2,(e,t)=>{let r=Math.max(1,Math.floor(e)),n=Array(r);for(let e=0;e<r;e++)n[e]=t(e);return n}),s1=e=>Array.isArray(e)?e:Array.from(e),s2=e=>Array.isArray(e)?e:[e],s3=nm(2,(e,{onEmpty:t,onNonEmpty:r})=>s9(e)?r(e):t()),s5=nm(2,(e,{onEmpty:t,onNonEmpty:r})=>s9(e)?r(as(e),al(e)):t()),s4=nm(2,(e,t)=>[t,...e]),s6=nm(2,(e,t)=>[...e,t]),s8=nm(2,(e,t)=>s1(e).concat(s1(t))),s7=Array.isArray,s9=sd,ae=(e,t)=>e<0||e>=t.length,at=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),ar=nm(2,(e,t)=>{let r=Math.floor(t);return ae(r,e)?s_():i4(e[r])}),an=nm(2,(e,t)=>{let r=Math.floor(t);if(ae(r,e))throw Error(`Index ${r} out of bounds`);return e[r]}),ai=ar(0),as=an(0),aa=e=>s9(e)?i4(ao(e)):s_(),ao=e=>e[e.length-1],al=e=>e.slice(1),au=((e,t)=>{let r=s1(e);return r.slice(0,at(t,r))},nm(2,(e,t)=>ax(e,((e,t)=>{let r=0;for(let n of e){if(!t(n,r))break;r++}return r})(e,t)))),ac=nm(2,(e,t)=>{let r=s1(e);return r.slice(at(t,r),r.length)}),ah=((e,t)=>{let r=s1(e);for(let e=r.length-1;e>=0;e--){let n=r[e],i=t(n,e);if(nT(i)){if(i)return i4(n)}else if(i3(i))return i}return s_()},nm(3,(e,t,r)=>{let n=Array.from(e);if(ae(t,n))return n;let i=r(n[t]);return n[t]=i,n})),af=((e,t,r)=>{let n=s1(e);if(ae(t,n))return s_();let i=Array.isArray(e)?e.slice():n,s=r(n[t]);return i[t]=s,i4(i)},e=>Array.from(e).reverse()),ap=nm(2,(e,t)=>{let r=Array.from(e);return r.sort(t),r}),ad=nm(2,(e,t)=>am(e,t,sL)),am=nm(3,(e,t,r)=>{let n=s1(e),i=s1(t);if(s9(n)&&s9(i)){let e=[r(as(n),as(i))],t=Math.min(n.length,i.length);for(let s=1;s<t;s++)e[s]=r(n[s],i[s]);return e}return[]}),ag=((e,t)=>[t(as(e)),...al(e)],nm(2,(e,t)=>{let r=s1(e);if(s9(r)){let n=r.length,i=Math.round(t)%n;if(ae(Math.abs(i),r)||0===i)return aS(r);if(!(i<0))return ag(e,i-n);{let[e,t]=av(r,-i);return s8(t,e)}}return[]})),ab=e=>nm(2,(t,r)=>{for(let n of t)if(e(r,n))return!0;return!1}),ay=nm(2,(e,t)=>{let r=s1(e);if(s9(r)){let[e,n]=t(r),i=[e],s=n;for(;sd(s);){let[e,r]=t(s);i.push(e),s=r}return i}return[]}),ax=nm(2,(e,t)=>{let r=Array.from(e),n=Math.floor(t);return s9(r)?n>=1?av(r,n):[[],r]:[r,[]]}),av=nm(2,(e,t)=>{let r=Math.max(1,Math.floor(t));return r>=e.length?[aS(e),[]]:[s4(e.slice(1,r),as(e)),e.slice(r)]}),aS=e=>e.slice();(e,t)=>{let r=s1(e);return s9(r)?ay(r,av(t)):[]};let a_=nm(3,(e,t,r)=>{let n=s1(e),i=s1(t);return s9(n)?s9(i)?aL(r)(s8(n,i)):n:i}),aw=nm(2,(e,t)=>a_(e,t,il)),ak=e=>{let t=ab(e);return nm(2,(e,r)=>s1(e).filter(e=>t(r,e)))},aO=ak(il),aE=()=>[],aC=e=>[e],aF=nm(2,(e,t)=>e.map(t)),aR=nm(2,(e,t)=>{if(0===e.length)return[];let r=[];for(let n=0;n<e.length;n++){let i=t(e[n],n);for(let e=0;e<i.length;e++)r.push(i[e])}return r}),aI=aR(ng),aT=nm(2,(e,t)=>{let r=s1(e),n=[];for(let e=0;e<r.length;e++){let i=t(r[e],e);i3(i)&&n.push(i.value)}return n}),aA=nm(2,(e,t)=>{let r=0,n=[];for(let i of e){let e=t(i,r);if(i3(e))n.push(e.value);else break;r++}return n}),aN=nm(2,(e,t)=>{let r=[],n=[],i=s1(e);for(let e=0;e<i.length;e++){let s=t(i[e],e);st(s)?r.push(s.left):n.push(s.right)}return[r,n]}),aM=aT(ng),aj=nm(2,(e,t)=>{let r=s1(e),n=[];for(let e=0;e<r.length;e++)t(r[e],e)&&n.push(r[e]);return n}),aP=((e,t)=>{let r=[],n=[],i=s1(e);for(let e=0;e<i.length;e++)t(i[e],e)?n.push(i[e]):r.push(i[e]);return[r,n]},nm(3,(e,t,r)=>s1(e).reduce((e,t,n)=>r(e,t,n),t))),aD=nm(3,(e,t,r)=>s1(e).reduceRight((e,t,n)=>r(e,t,n),t)),a$=((e,t)=>e.every(t),(e,t)=>{let r,n=[],i=e;for(;i3(r=t(i));){let[e,t]=r.value;n.push(e),i=t}return n}),az=nE,aL=nm(2,(e,t)=>{let r=s1(e);if(s9(r)){let e=[as(r)];for(let n of al(r))e.every(e=>!t(n,e))&&e.push(n);return e}return[]}),aU=e=>aL(e,il),aB=nm(2,(e,t)=>s1(e).join(t)),aq=nm(3,(e,t,r)=>{let n=0,i=t,s=[];for(let t of e){let e=r(i,t,n);i=e[0],s.push(e[1]),n++}return[i,s]}),aJ=((e,t,r)=>aR(e,e=>aF(t,t=>r(e,t))),/^[+-]?\d+$/),aH=Symbol.for("effect/BigDecimal"),aV={[aH]:aH,[n4](){let e=a0(this);return nS(n6(e.value),n7(it(e.scale)),ia(this))},[io](e){return aW(e)&&a7(this,e)},toString(){return`BigDecimal(${a9(this)})`},toJSON(){return{_id:"BigDecimal",value:String(this.value),scale:this.scale}},[ih](){return this.toJSON()},pipe(){return iw(this,arguments)}},aW=e=>nL(e,aH),aK=(e,t)=>{let r=Object.create(aV);return r.value=e,r.scale=t,r},aG=(e,t)=>{if(e!==aZ&&e%aY===aZ)throw RangeError("Value must be normalized");let r=aK(e,t);return r.normalized=r,r},aZ=BigInt(0),aQ=BigInt(1),aY=BigInt(10),aX=aG(aZ,0),a0=e=>{if(void 0===e.normalized)if(e.value===aZ)e.normalized=aX;else{let t=`${e.value}`,r=0;for(let e=t.length-1;e>=0;e--)if("0"===t[e])r++;else break;0===r&&(e.normalized=e);let n=BigInt(t.substring(0,t.length-r)),i=e.scale-r;e.normalized=aG(n,i)}return e.normalized},a1=nm(2,(e,t)=>t>e.scale?aK(e.value*aY**BigInt(t-e.scale),t):t<e.scale?aK(e.value/aY**BigInt(e.scale-t),t):e),a2=nm(2,(e,t)=>t.value===aZ?e:e.value===aZ?t:e.scale>t.scale?aK(a1(t,e.scale).value+e.value,e.scale):e.scale<t.scale?aK(a1(e,t.scale).value+t.value,t.scale):aK(e.value+t.value,e.scale)),a3=sm((e,t)=>{let r=sg(a6(e),a6(t));return 0!==r?r:e.scale>t.scale?sb(e.value,a1(t,e.scale).value):e.scale<t.scale?sb(a1(e,t.scale).value,t.value):sb(e.value,t.value)}),a5=(h=a3,nm(2,(e,t)=>-1===h(e,t))),a4=sx(a3),a6=e=>e.value===aZ?0:e.value<aZ?-1:1,a8=n_((e,t)=>e.scale>t.scale?a1(t,e.scale).value===e.value:e.scale<t.scale?a1(e,t.scale).value===t.value:e.value===t.value),a7=nm(2,(e,t)=>a8(e,t)),a9=e=>{let t,r,n=a0(e);if(Math.abs(n.scale)>=16)return oe(n);let i=n.value<aZ,s=i?`${n.value}`.substring(1):`${n.value}`;if(n.scale>=s.length)t="0",r="0".repeat(n.scale-s.length)+s;else{let e=s.length-n.scale;if(e>s.length){let n=e-s.length;t=`${s}${"0".repeat(n)}`,r=""}else r=s.slice(e),t=s.slice(0,e)}let a=""===r?t:`${t}.${r}`;return i?`-${a}`:a},oe=e=>{if(ot(e))return"0e+0";let t=a0(e),r=`${(e=>e.value<aZ?aK(-e.value,e.scale):e)(t).value}`,n=r.slice(0,1),i=r.slice(1),s=`${or(t)?"-":""}${n}`;""!==i&&(s+=`.${i}`);let a=i.length-t.scale;return`${s}e${a>=0?"+":""}${a}`},ot=e=>e.value===aZ,or=e=>e.value<aZ,on=e=>aW(e[0]),oi=((e,t=0)=>{let r=oi(e,t);return e.value>aZ&&a5(r,e)?a2(r,aK(1n,t)):r},nm(on,(e,t=0)=>e.scale<=t?e:aK(e.value/10n**BigInt(e.scale-t),t))),os=((e,t)=>e.scale<t?0n:e.value/10n**BigInt(e.scale-t)%10n,BigInt(0)),oa=((e,t)=>{for(;t!==os;){let r=t;t=e%t,e=r}return e},e=>{try{return""===e.trim()?s_():i4(BigInt(e))}catch{return s_()}}),oo=e=>!e,ol=((e,t)=>!e&&t||e&&!t,Symbol.for("effect/Chunk")),ou=[],oc=n_((e,t)=>e.length===t.length&&ov(e).every((e,r)=>il(e,oO(t,r)))),oh={[ol]:{_A:e=>e},toString(){return id(this.toJSON())},toJSON(){return{_id:"Chunk",values:ov(this).map(ip)}},[ih](){return this.toJSON()},[io](e){return op(e)&&oc(this,e)},[n4](){return ia(this,is(ov(this)))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return ou[Symbol.iterator]();default:return ov(this)[Symbol.iterator]()}},pipe(){return iw(this,arguments)}},of=e=>{let t=Object.create(oh);switch(t.backing=e,e._tag){case"IEmpty":t.length=0,t.depth=0,t.left=t,t.right=t;break;case"IConcat":t.length=e.left.length+e.right.length,t.depth=1+Math.max(e.left.depth,e.right.depth),t.left=e.left,t.right=e.right;break;case"IArray":t.length=e.array.length,t.depth=0,t.left=od,t.right=od;break;case"ISingleton":t.length=1,t.depth=0,t.left=od,t.right=od;break;case"ISlice":t.length=e.length,t.depth=e.chunk.depth+1,t.left=od,t.right=od}return t},op=e=>nL(e,ol),od=of({_tag:"IEmpty"}),om=()=>od,og=(...e)=>ok(e),ob=e=>of({_tag:"ISingleton",a:e}),oy=e=>op(e)?e:ow(s1(e)),ox=(e,t,r)=>{switch(e.backing._tag){case"IArray":!function(e,t,r,n,i){for(let s=0;s<Math.min(e.length,0+i);s++)r[n+s-t]=e[s]}(e.backing.array,0,t,r,e.length);break;case"IConcat":ox(e.left,t,r),ox(e.right,t,r+e.left.length);break;case"ISingleton":t[r]=e.backing.a;break;case"ISlice":{let n=0,i=r;for(;n<e.length;)t[i]=oO(e,n),n+=1,i+=1}}},ov=e=>{switch(e.backing._tag){case"IEmpty":return ou;case"IArray":return e.backing.array;default:{let t=Array(e.length);return ox(e,t,0),e.backing={_tag:"IArray",array:t},e.left=od,e.right=od,e.depth=0,t}}},oS=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return of({_tag:"IArray",array:af(e.backing.array)});case"IConcat":return of({_tag:"IConcat",left:oS(e.backing.right),right:oS(e.backing.left)});case"ISlice":return ow(af(ov(e)))}},o_=nm(2,(e,t)=>t<0||t>=e.length?s_():i4(oO(e,t))),ow=e=>0===e.length?om():1===e.length?ob(e[0]):of({_tag:"IArray",array:e}),ok=e=>ow(e),oO=nm(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw Error("Index out of bounds");case"ISingleton":if(0!==t)throw Error("Index out of bounds");return e.backing.a;case"IArray":if(t>=e.length||t<0)throw Error("Index out of bounds");return e.backing.array[t];case"IConcat":return t<e.left.length?oO(e.left,t):oO(e.right,t-e.left.length);case"ISlice":return oO(e.backing.chunk,t+e.backing.offset)}}),oE=nm(2,(e,t)=>oT(e,ob(t))),oC=nm(2,(e,t)=>oT(ob(t),e)),oF=nm(2,(e,t)=>{if(t<=0)return od;if(t>=e.length)return e;switch(e.backing._tag){case"ISlice":return of({_tag:"ISlice",chunk:e.backing.chunk,length:t,offset:e.backing.offset});case"IConcat":if(t>e.left.length)return of({_tag:"IConcat",left:e.left,right:oF(e.right,t-e.left.length)});return oF(e.left,t);default:return of({_tag:"ISlice",chunk:e,offset:0,length:t})}}),oR=nm(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return od;switch(e.backing._tag){case"ISlice":return of({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":if(t>e.left.length)return oR(e.right,t-e.left.length);return of({_tag:"IConcat",left:oR(e.left,t),right:e.right});default:return of({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}}),oI=nm(2,(e,t)=>{let r=ov(e),n=r.length,i=0;for(;i<n&&t(r[i]);)i++;return oR(e,i)}),oT=nm(2,(e,t)=>{if("IEmpty"===e.backing._tag)return t;if("IEmpty"===t.backing._tag)return e;let r=t.depth-e.depth;if(1>=Math.abs(r))return of({_tag:"IConcat",left:e,right:t});if(r<-1)if(e.left.depth>=e.right.depth){let r=oT(e.right,t);return of({_tag:"IConcat",left:e.left,right:r})}else{let r=oT(e.right.right,t);if(r.depth===e.depth-3){let t=of({_tag:"IConcat",left:e.right.left,right:r});return of({_tag:"IConcat",left:e.left,right:t})}{let t=of({_tag:"IConcat",left:e.left,right:e.right.left});return of({_tag:"IConcat",left:t,right:r})}}if(t.right.depth>=t.left.depth)return of({_tag:"IConcat",left:oT(e,t.left),right:t.right});{let r=oT(e,t.left.left);if(r.depth===t.depth-3){let e=of({_tag:"IConcat",left:r,right:t.left.right});return of({_tag:"IConcat",left:e,right:t.right})}{let e=of({_tag:"IConcat",left:t.left.right,right:t.right});return of({_tag:"IConcat",left:r,right:e})}}}),oA=nm(2,(e,t)=>ow(aT(e,t))),oN=nm(2,(e,t)=>ow(aj(e,t))),oM=((e,t)=>ow(aA(e,t)),nm(2,(e,t)=>{if("ISingleton"===e.backing._tag)return t(e.backing.a,0);let r=od,n=0;for(let i of e)r=oT(r,t(i,n++));return r})),oj=nm(2,(e,t)=>ov(e).forEach(t)),oP=oM(ng),oD=((e,t)=>{let r=[],n=[];return ov(e).forEach(e=>{n.push(e),n.length>=t&&(r.push(ow(n)),n=[])}),n.length>0&&r.push(ow(n)),ow(r)},e=>0===e.length),o$=e=>e.length>0,oz=o_(0),oL=e=>oO(e,0),oU=e=>oO(e,e.length-1),oB=nm(2,(e,t)=>"ISingleton"===e.backing._tag?ob(t(e.backing.a,0)):ow(nS(ov(e),aF((e,r)=>t(e,r))))),oq=nm(3,(e,t,r)=>{let[n,i]=aq(e,t,r);return[n,ow(i)]}),oJ=((e,t)=>ow(ap(ov(e),t)),nm(2,(e,t)=>[oF(e,t),oR(e,t)])),oH=nm(2,(e,t)=>{let r=0;for(let n of ov(e))if(t(n))break;else r++;return oJ(e,r)}),oV=e=>oR(e,1),oW=nm(2,(e,t)=>oR(e,e.length-t)),oK=nm(2,(e,t)=>{let r=[];for(let n of ov(e))if(t(n))r.push(n);else break;return ow(r)}),oG=nm(3,(e,t,r)=>ow(am(e,t,r))),oZ=nm(3,(e,t,r)=>t<0||t>=e.length?s_():i4(ow(ah(ov(e),t,r)))),oQ=((e,t,r)=>sk(oZ(e,t,r),()=>e),nm(2,(e,t)=>oy(s0(e,t)))),oY=nm(2,(e,t)=>s1(e).some(t));function oX(e,t){var r;return r=e&t-1,r-=r>>1&0x55555555,r=(r=(0x33333333&r)+(r>>2&0x33333333))+(r>>4)&0xf0f0f0f,r+=r>>8,127&(r+=r>>16)}let o0=(e,t)=>({value:e,previous:t});function o1(e,t,r,n){let i=n;if(!e){let e=n.length;i=Array(e);for(let t=0;t<e;++t)i[t]=n[t]}return i[t]=r,i}function o2(e,t,r){let n=r.length-1,i=0,s=0,a=r;if(e)i=s=t;else for(a=Array(n);i<t;)a[s++]=r[i++];for(++i;i<=n;)a[s++]=r[i++];return e&&(a.length=n),a}class o3{_tag="EmptyNode";modify(e,t,r,n,i,s){let a=r(s_());return i2(a)?new o3:(++s.value,new o6(e,n,i,a))}}function o5(e){return nU(e,"EmptyNode")}function o4(e,t){return!o5(e)&&t===e.edit}class o6{edit;hash;key;value;_tag="LeafNode";constructor(e,t,r,n){this.edit=e,this.hash=t,this.key=r,this.value=n}modify(e,t,r,n,i,s){if(il(i,this.key)){let t=r(this.value);return t===this.value?this:i2(t)?(--s.value,new o3):o4(this,e)?(this.value=t,this):new o6(e,n,i,t)}let a=r(s_());return i2(a)?this:(++s.value,le(e,t,this.hash,this,n,new o6(e,n,i,a)))}}class o8{edit;hash;children;_tag="CollisionNode";constructor(e,t,r){this.edit=e,this.hash=t,this.children=r}modify(e,t,r,n,i,s){if(n===this.hash){let t=o4(this,e),n=this.updateCollisionList(t,e,this.hash,this.children,r,i,s);return n===this.children?this:n.length>1?new o8(e,this.hash,n):n[0]}let a=r(s_());return i2(a)?this:(++s.value,le(e,t,this.hash,this,n,new o6(e,n,i,a)))}updateCollisionList(e,t,r,n,i,s,a){let o=n.length;for(let l=0;l<o;++l){let o=n[l];if("key"in o&&il(s,o.key)){let u=o.value,c=i(u);if(c===u)return n;if(i2(c))return--a.value,o2(e,l,n);return o1(e,l,new o6(t,r,s,c),n)}}let l=i(s_());return i2(l)?n:(++a.value,o1(e,o,new o6(t,r,s,l),n))}}class o7{edit;mask;children;_tag="IndexedNode";constructor(e,t,r){this.edit=e,this.mask=t,this.children=r}modify(e,t,r,n,i,s){let a,o=this.mask,l=this.children,u=n>>>t&31,c=1<<u,h=oX(o,c),f=o&c,p=o4(this,e);if(!f){let a=new o3().modify(e,t+5,r,n,i,s);return a?l.length>=16?function(e,t,r,n,i){let s=[],a=n,o=0;for(let e=0;a;++e)1&a&&(s[e]=i[o++]),a>>>=1;return s[t]=r,new o9(e,o+1,s)}(e,u,a,o,l):new o7(e,o|c,function(e,t,r,n){let i=n.length;if(e){let e=i;for(;e>=t;)n[e--]=n[e];return n[t]=r,n}let s=0,a=0,o=Array(i+1);for(;s<t;)o[a++]=n[s++];for(o[t]=r;s<i;)o[++a]=n[s++];return o}(p,h,a,l)):this}let d=l[h],m=d.modify(e,t+5,r,n,i,s);if(d===m)return this;let g=o;if(o5(m)){var b;if(!(g&=~c))return new o3;if(l.length<=2&&(o5(b=l[1^h])||"LeafNode"===b._tag||"CollisionNode"===b._tag))return l[1^h];a=o2(p,h,l)}else a=o1(p,h,m,l);return p?(this.mask=g,this.children=a,this):new o7(e,g,a)}}class o9{edit;size;children;_tag="ArrayNode";constructor(e,t,r){this.edit=e,this.size=t,this.children=r}modify(e,t,r,n,i,s){let a,o=this.size,l=this.children,u=n>>>t&31,c=l[u],h=(c||new o3).modify(e,t+5,r,n,i,s);if(c===h)return this;let f=o4(this,e);if(o5(c)&&!o5(h))++o,a=o1(f,u,h,l);else if(!o5(c)&&o5(h)){if(--o<=8)return function(e,t,r,n){let i=Array(t-1),s=0,a=0;for(let e=0,t=n.length;e<t;++e)if(e!==r){let t=n[e];t&&!o5(t)&&(i[s++]=t,a|=1<<e)}return new o7(e,a,i)}(e,o,u,l);a=o1(f,u,new o3,l)}else a=o1(f,u,h,l);return f?(this.size=o,this.children=a,this):new o9(e,o,a)}}function le(e,t,r,n,i,s){let a,o=t;for(;;){let t=function(e,t,r,n,i,s){if(r===i)return new o8(e,r,[s,n]);let a=r>>>t&31,o=i>>>t&31;return a===o?t=>new o7(e,1<<a|1<<o,[t]):new o7(e,1<<a|1<<o,a<o?[n,s]:[s,n])}(e,o,r,n,i,s);if("function"==typeof t)a=o0(t,a),o+=5;else{let e=t;for(;null!=a;)e=a.value(e),a=a.previous;return e}}}let lt="effect/HashMap",lr=Symbol.for(lt),ln={[lr]:lr,[Symbol.iterator](){return new ls(this,(e,t)=>[e,t])},[n4](){let e=n6(lt);for(let t of this)e^=nS(n6(t[0]),n7(n6(t[1])));return ia(this,e)},[io](e){if(lc(e)){if(e._size!==this._size)return!1;for(let t of this){let r=nS(e,lf(t[0],n6(t[0])));if(i2(r)||!il(t[1],r.value))return!1}return!0}return!1},toString(){return id(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(ip)}},[ih](){return this.toJSON()},pipe(){return iw(this,arguments)}},li=(e,t,r,n)=>{let i=Object.create(ln);return i._editable=e,i._edit=t,i._root=r,i._size=n,i};class ls{map;f;v;constructor(e,t){this.map=e,this.f=t,this.v=lo(this.map._root,this.f,void 0)}next(){if(i2(this.v))return{done:!0,value:void 0};let e=this.v.value;return this.v=la(e.cont),{done:!1,value:e.value}}[Symbol.iterator](){return new ls(this.map,this.f)}}let la=e=>e?ll(e[0],e[1],e[2],e[3],e[4]):s_(),lo=(e,t,r)=>{switch(e._tag){case"LeafNode":if(i3(e.value))return i4({value:t(e.key,e.value.value),cont:r});return la(r);case"CollisionNode":case"ArrayNode":case"IndexedNode":{let n=e.children;return ll(n.length,n,0,t,r)}default:return la(r)}},ll=(e,t,r,n,i)=>{for(;r<e;){let s=t[r++];if(s&&!o5(s))return lo(s,n,[e,t,r,n,i])}return la(i)},lu=li(!1,0,new o3,0),lc=e=>nL(e,lr),lh=nm(2,(e,t)=>lf(e,t,n6(t))),lf=nm(3,(e,t,r)=>{let n=e._root,i=0;for(;;)switch(n._tag){case"LeafNode":return il(t,n.key)?n.value:s_();case"CollisionNode":if(r===n.hash){let e=n.children;for(let r=0,n=e.length;r<n;++r){let n=e[r];if("key"in n&&il(t,n.key))return n.value}}return s_();case"IndexedNode":{let e=1<<(r>>>i&31);if(n.mask&e){n=n.children[oX(n.mask,e)],i+=5;break}return s_()}case"ArrayNode":if(n=n.children[r>>>i&31]){i+=5;break}return s_();default:return s_()}}),lp=nm(2,(e,t)=>i3(lf(e,t,n6(t)))),ld=nm(3,(e,t,r)=>lx(e,t,()=>i4(r))),lm=nm(3,(e,t,r)=>e._editable?(e._root=t,e._size=r,e):t===e._root?e:li(e._editable,e._edit,t,r)),lg=e=>new ls(e,e=>e),lb=e=>li(!0,e._edit+1,e._root,e._size),ly=e=>(e._editable=!1,e),lx=((e,t)=>{let r=lb(e);return t(r),ly(r)},nm(3,(e,t,r)=>lv(e,t,n6(t),r))),lv=nm(4,(e,t,r,n)=>{let i={value:e._size},s=e._root.modify(e._editable?e._edit:NaN,0,n,r,t,i);return nS(e,lm(s,i.value))}),lS=nm(2,(e,t)=>lx(e,t,s_)),l_=nm(2,(e,t)=>lk(e,lu,(e,r,n)=>ld(e,n,t(r,n)))),lw=nm(2,(e,t)=>lk(e,void 0,(e,r,n)=>t(r,n))),lk=nm(3,(e,t,r)=>{let n,i=e._root;if("LeafNode"===i._tag)return i3(i.value)?r(t,i.value.value,i.key):t;if("EmptyNode"===i._tag)return t;let s=[i.children];for(;n=s.pop();)for(let e=0,i=n.length;e<i;){let i=n[e++];i&&!o5(i)&&("LeafNode"===i._tag?i3(i.value)&&(t=r(t,i.value.value,i.key)):s.push(i.children))}return t}),lO=((e,t)=>{for(let r of e)if(t(r[1],r[0]))return i4(r);return s_()},"effect/HashSet"),lE=Symbol.for(lO),lC={[lE]:lE,[Symbol.iterator](){return lg(this._keyMap)},[n4](){return ia(this,n7(n6(this._keyMap))(n6(lO)))},[io](e){return!!lR(e)&&this._keyMap._size===e._keyMap._size&&il(this._keyMap,e._keyMap)},toString(){return id(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(ip)}},[ih](){return this.toJSON()},pipe(){return iw(this,arguments)}},lF=e=>{let t=Object.create(lC);return t._keyMap=e,t},lR=e=>nL(e,lE),lI=lF(lu),lT=()=>lI,lA=nm(2,(e,t)=>lp(e._keyMap,t)),lN=nm(2,(e,t)=>{let r=!1;for(let n of e)if(r=t(n))break;return r}),lM=nm(2,(e,t)=>!lN(e,e=>!t(e))),lj=e=>lF(lb(e._keyMap)),lP=e=>(e._keyMap._editable=!1,e),lD=nm(2,(e,t)=>{let r=lj(e);return t(r),lP(r)}),l$=nm(2,(e,t)=>e._keyMap._editable?(ld(t,!0)(e._keyMap),e):lF(ld(t,!0)(e._keyMap))),lz=nm(2,(e,t)=>e._keyMap._editable?(lS(t)(e._keyMap),e):lF(lS(t)(e._keyMap))),lL=nm(2,(e,t)=>lD(e,e=>{for(let r of t)lz(e,r)})),lU=nm(2,(e,t)=>lD(lT(),r=>{for(let n of(lB(e,e=>l$(r,e)),t))l$(r,n)})),lB=nm(2,(e,t)=>lw(e._keyMap,(e,r)=>t(r))),lq=nm(3,(e,t,r)=>lk(e._keyMap,t,(e,t,n)=>r(e,n))),lJ=e=>{let t=lj(lT());for(let r of e)l$(t,r);return lP(t)},lH=(...e)=>{let t=lj(lT());for(let r of e)l$(t,r);return lP(t)},lV=e=>e._keyMap._size,lW="Empty",lK="Fail",lG="Interrupt",lZ="Parallel",lQ="Sequential",lY="effect/Cause",lX=Symbol.for(lY),l0={[lX]:{_E:e=>e},[n4](){return nS(n6(lY),n7(n6(uh(this))),ia(this))},[io](e){return l8(e)&&uc(this,e)},pipe(){return iw(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:ip(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:ip(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:ip(this.left),right:ip(this.right)}}},toString(){return uS(this)},[ih](){return this.toJSON()}},l1=(()=>{let e=Object.create(l0);return e._tag=lW,e})(),l2=e=>{let t=Object.create(l0);return t._tag=lK,t.error=e,t},l3=e=>{let t=Object.create(l0);return t._tag="Die",t.defect=e,t},l5=e=>{let t=Object.create(l0);return t._tag=lG,t.fiberId=e,t},l4=(e,t)=>{let r=Object.create(l0);return r._tag=lZ,r.left=e,r.right=t,r},l6=(e,t)=>{let r=Object.create(l0);return r._tag=lQ,r.left=e,r.right=t,r},l8=e=>nL(e,lX),l7=e=>e._tag===lW||ux(e,!0,(e,t)=>{switch(t._tag){case lW:return i4(e);case"Die":case lK:case lG:return i4(!1);default:return s_()}}),l9=e=>i3(us(e)),ue=e=>uv(void 0,um)(e),ut=e=>oS(ux(e,om(),(e,t)=>"Die"===t._tag?i4(nS(e,oC(t.defect))):s_())),ur=e=>ux(e,lT(),(e,t)=>t._tag===lG?i4(nS(e,l$(t.fiberId))):s_()),un=e=>up(e,e=>e._tag===lK?i4(e.error):s_()),ui=e=>{let t=un(e);switch(t._tag){case"None":return si(e);case"Some":return sn(t.value)}},us=e=>up(e,e=>e._tag===lG?i4(e.fiberId):s_()),ua=e=>uy(e,{onEmpty:l1,onFail:()=>l1,onDie:l3,onInterrupt:l5,onSequential:l6,onParallel:l4}),uo=nm(2,(e,t)=>uy(e,{onEmpty:i4(l1),onFail:e=>i4(l2(e)),onDie:e=>i3(t(e))?s_():i4(l3(e)),onInterrupt:e=>i4(l5(e)),onSequential:sz(l6),onParallel:sz(l4)})),ul=nm(2,(e,t)=>uu(e,e=>l2(t(e)))),uu=nm(2,(e,t)=>uy(e,{onEmpty:l1,onFail:e=>t(e),onDie:e=>l3(e),onInterrupt:e=>l5(e),onSequential:(e,t)=>l6(e,t),onParallel:(e,t)=>l4(e,t)})),uc=(e,t)=>{let r=ob(e),n=ob(t);for(;o$(r)&&o$(n);){let[e,t]=nS(oL(r),ux([lT(),om()],([e,t],r)=>{let[n,i]=ud(r);return i4([nS(e,lU(n)),nS(t,oT(i))])})),[i,s]=nS(oL(n),ux([lT(),om()],([e,t],r)=>{let[n,i]=ud(r);return i4([nS(e,lU(n)),nS(t,oT(i))])}));if(!il(e,i))return!1;r=t,n=s}return!0},uh=e=>uf(ob(e),om()),uf=(e,t)=>{for(;;){let[r,n]=nS(e,aP([lT(),om()],([e,t],r)=>{let[n,i]=ud(r);return[nS(e,lU(n)),nS(t,oT(i))]})),i=lV(r)>0?nS(t,oC(r)):t;if(oD(n))return oS(i);e=n,t=i}throw Error(nW("Cause.flattenCauseLoop"))},up=nm(2,(e,t)=>{let r=[e];for(;r.length>0;){let e=r.pop(),n=t(e);switch(n._tag){case"None":switch(e._tag){case lQ:case lZ:r.push(e.right),r.push(e.left)}break;case"Some":return n}}return s_()}),ud=e=>{let t=e,r=[],n=lT(),i=om();for(;void 0!==t;)switch(t._tag){case lW:if(0===r.length)return[n,i];t=r.pop();break;case lK:if(n=l$(n,og(t._tag,t.error)),0===r.length)return[n,i];t=r.pop();break;case"Die":if(n=l$(n,og(t._tag,t.defect)),0===r.length)return[n,i];t=r.pop();break;case lG:if(n=l$(n,og(t._tag,t.fiberId)),0===r.length)return[n,i];t=r.pop();break;case lQ:switch(t.left._tag){case lW:t=t.right;break;case lQ:t=l6(t.left.left,l6(t.left.right,t.right));break;case lZ:t=l4(l6(t.left.left,t.right),l6(t.left.right,t.right));break;default:i=oC(i,t.right),t=t.left}break;case lZ:r.push(t.right),t=t.left}throw Error(nW("Cause.evaluateCauseLoop"))},um={emptyCase:ny,failCase:nx,dieCase:nx,interruptCase:ny,sequentialCase:(e,t,r)=>t&&r,parallelCase:(e,t,r)=>t&&r},ug="SequentialCase",ub="ParallelCase",uy=nm(2,(e,{onDie:t,onEmpty:r,onFail:n,onInterrupt:i,onParallel:s,onSequential:a})=>uv(e,void 0,{emptyCase:()=>r,failCase:(e,t)=>n(t),dieCase:(e,r)=>t(r),interruptCase:(e,t)=>i(t),sequentialCase:(e,t,r)=>a(t,r),parallelCase:(e,t,r)=>s(t,r)})),ux=nm(3,(e,t,r)=>{let n=t,i=e,s=[];for(;void 0!==i;){let e=r(n,i);switch(n=i3(e)?e.value:n,i._tag){case lQ:case lZ:s.push(i.right),i=i.left;break;default:i=void 0}void 0===i&&s.length>0&&(i=s.pop())}return n}),uv=nm(3,(e,t,r)=>{let n=[e],i=[];for(;n.length>0;){let e=n.pop();switch(e._tag){case lW:i.push(si(r.emptyCase(t)));break;case lK:i.push(si(r.failCase(t,e.error)));break;case"Die":i.push(si(r.dieCase(t,e.defect)));break;case lG:i.push(si(r.interruptCase(t,e.fiberId)));break;case lQ:n.push(e.right),n.push(e.left),i.push(sn({_tag:ug}));break;case lZ:n.push(e.right),n.push(e.left),i.push(sn({_tag:ub}))}}let s=[];for(;i.length>0;){let e=i.pop();switch(e._tag){case"Left":switch(e.left._tag){case ug:{let e=s.pop(),n=s.pop(),i=r.sequentialCase(t,e,n);s.push(i);break}case ub:{let e=s.pop(),n=s.pop(),i=r.parallelCase(t,e,n);s.push(i)}}break;case"Right":s.push(e.right)}}if(0===s.length)throw Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return s.pop()}),uS=(e,t)=>ue(e)?"All fibers interrupted without errors.":uR(e).map(function(e){return t?.renderErrorCause!==!0||void 0===e.cause?e.stack:`${e.stack} {
${u_(e.cause,"  ")}
}`}).join("\n"),u_=(e,t)=>{let r=e.stack.split("\n"),n=`${t}[cause]: ${r[0]}`;for(let e=1,i=r.length;e<i;e++)n+=`
${t}${r[e]}`;return e.cause&&(n+=` {
${u_(e.cause,`${t}  `)}
${t}}`),n};class uw extends globalThis.Error{span=void 0;constructor(e){let t="object"==typeof e&&null!==e,r=Error.stackTraceLimit;Error.stackTraceLimit=1,super(uk(e),t&&"cause"in e&&void 0!==e.cause?{cause:new uw(e.cause)}:void 0),""===this.message&&(this.message="An error has occurred"),Error.stackTraceLimit=r,this.name=e instanceof Error?e.name:"Error",t&&(uF in e&&(this.span=e[uF]),Object.keys(e).forEach(t=>{t in this||(this[t]=e[t])})),this.stack=uC(`${this.name}: ${this.message}`,e instanceof Error&&e.stack?e.stack:"",this.span)}}let uk=e=>{if("string"==typeof e)return e;if("object"==typeof e&&null!==e&&e instanceof Error)return e.message;try{let t;if(nL(e,"toString")&&(t=e.toString,"function"==typeof t)&&e.toString!==Object.prototype.toString&&e.toString!==globalThis.Array.prototype.toString)return e.toString()}catch{}return iy(e)},uO=/\((.*)\)/g,uE=nF("effect/Tracer/spanToTrace",()=>new WeakMap),uC=(e,t,r)=>{let n=[e],i=t.startsWith(e)?t.slice(e.length).split("\n"):t.split("\n");for(let e=1;e<i.length;e++){if(i[e].includes(" at new BaseEffectError")||i[e].includes(" at new YieldableError")){e++;continue}if(i[e].includes("Generator.next")||i[e].includes("effect_internal_function"))break;n.push(i[e].replace(/at .*effect_instruction_i.*\((.*)\)/,"at $1").replace(/EffectPrimitive\.\w+/,"<anonymous>"))}if(r){let e=r,t=0;for(;e&&"Span"===e._tag&&t<10;){let r=uE.get(e);if("function"==typeof r){let t=r();if("string"==typeof t){let r=t.matchAll(uO),i=!1;for(let[,t]of r)i=!0,n.push(`    at ${e.name} (${t})`);i||n.push(`    at ${e.name} (${t.replace(/^at /,"")})`)}else n.push(`    at ${e.name}`)}else n.push(`    at ${e.name}`);e=sF(e.parent),t++}}return n.join("\n")},uF=Symbol.for("effect/SpanAnnotation"),uR=e=>uv(e,void 0,{emptyCase:()=>[],dieCase:(e,t)=>[new uw(t)],failCase:(e,t)=>[new uw(t)],interruptCase:()=>[],parallelCase:(e,t,r)=>[...t,...r],sequentialCase:(e,t,r)=>[...t,...r]}),uI=Symbol.for("effect/Context/Tag"),uT=Symbol.for("effect/Context/Reference"),uA=Symbol.for("effect/STM"),uN={...iJ,_op:"Tag",[uA]:iq,[uI]:{_Service:e=>e,_Identifier:e=>e},toString(){return id(this.toJSON())},toJSON(){return{_id:"Tag",key:this.key,stack:this.stack}},[ih](){return this.toJSON()},of:e=>e,context(e){return uL(this,e)}},uM={...uN,[uT]:uT},uj=Symbol.for("effect/Context"),uP={[uj]:{_Services:e=>e},[io](e){if(u$(e)&&this.unsafeMap.size===e.unsafeMap.size){for(let t of this.unsafeMap.keys())if(!e.unsafeMap.has(t)||!il(this.unsafeMap.get(t),e.unsafeMap.get(t)))return!1;return!0}return!1},[n4](){return ia(this,it(this.unsafeMap.size))},pipe(){return iw(this,arguments)},toString(){return id(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(ip)}},[ih](){return this.toJSON()}},uD=e=>{let t=Object.create(uP);return t.unsafeMap=e,t},u$=e=>nL(e,uj),uz=uD(new Map),uL=(e,t)=>uD(new Map([[e.key,t]])),uU=nm(3,(e,t,r)=>{let n=new Map(e.unsafeMap);return n.set(t.key,r),uD(n)}),uB=nF("effect/Context/defaultValueCache",()=>new Map),uq=e=>{if(uB.has(e.key))return uB.get(e.key);let t=e.defaultValue();return uB.set(e.key,t),t},uJ=nm(2,(e,t)=>{if(!e.unsafeMap.has(t.key)){if(uT in t)return uq(t);throw(e=>{let t=Error(`Service not found${e.key?`: ${String(e.key)}`:""}`);if(e.stack){let r=e.stack.split("\n");if(r.length>2){let e=r[2].match(/at (.*)/);e&&(t.message=t.message+` (defined at ${e[1]})`)}}if(t.stack){let e=t.stack.split("\n");e.splice(1,3),t.stack=e.join("\n")}return t})(t)}return e.unsafeMap.get(t.key)}),uH=nm(2,(e,t)=>e.unsafeMap.has(t.key)?i4(e.unsafeMap.get(t.key)):nL(t,uT)?i4(uq(t)):i5),uV=nm(2,(e,t)=>{let r=new Map(e.unsafeMap);for(let[e,n]of t.unsafeMap)r.set(e,n);return uD(r)}),uW=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=Error();Error.stackTraceLimit=t;let n=Object.create(uN);return Object.defineProperty(n,"stack",{get:()=>r.stack}),n.key=e,n},uK=e=>nL(e,uI),uG=e=>()=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=Error();function n(){}return Error.stackTraceLimit=t,Object.setPrototypeOf(n,uN),n.key=e,Object.defineProperty(n,"stack",{get:()=>r.stack}),n},uZ=()=>(e,t)=>{let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let n=Error();function i(){}return Error.stackTraceLimit=r,Object.setPrototypeOf(i,uM),i.key=e,i.defaultValue=t.defaultValue,Object.defineProperty(i,"stack",{get:()=>n.stack}),i},uQ=Symbol.for("effect/Duration"),uY=BigInt(0),uX=BigInt(24),u0=BigInt(60),u1=BigInt(1e3),u2=BigInt(1e6),u3=BigInt(1e9),u5=/^(-?\d+(?:\.\d+)?)\s+(nanos?|micros?|millis?|seconds?|minutes?|hours?|days?|weeks?)$/,u4=e=>{if(ce(e))return e;if(nI(e))return cs(e);if(nA(e))return cn(e);if(Array.isArray(e)&&2===e.length&&e.every(nI))return e[0]===-1/0||e[1]===-1/0||Number.isNaN(e[0])||Number.isNaN(e[1])?ct:e[0]===1/0||e[1]===1/0?cr:cn(BigInt(Math.round(1e9*e[0]))+BigInt(Math.round(e[1])));if(nR(e)){let t=u5.exec(e);if(t){let[e,r,n]=t,i=Number(r);switch(n){case"nano":case"nanos":return cn(BigInt(r));case"micro":case"micros":return ci(BigInt(r));case"milli":case"millis":return cs(i);case"second":case"seconds":return ca(i);case"minute":case"minutes":return co(i);case"hour":case"hours":return cl(i);case"day":case"days":return cu(i);case"week":case"weeks":return cc(i)}}}throw Error("Invalid DurationInput")},u6={_tag:"Millis",millis:0},u8={_tag:"Infinity"},u7={[uQ]:uQ,[n4](){return ia(this,ii(this.value))},[io](e){return ce(e)&&cS(this,e)},toString(){return`Duration(${c_(this)})`},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:cf(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[ih](){return this.toJSON()},pipe(){return iw(this,arguments)}},u9=e=>{let t=Object.create(u7);return nI(e)?isNaN(e)||e<=0?t.value=u6:Number.isFinite(e)?Number.isInteger(e)?t.value={_tag:"Millis",millis:e}:t.value={_tag:"Nanos",nanos:BigInt(Math.round(1e6*e))}:t.value=u8:e<=uY?t.value=u6:t.value={_tag:"Nanos",nanos:e},t},ce=e=>nL(e,uQ),ct=u9(0),cr=u9(1/0),cn=e=>u9(e),ci=e=>u9(e*u1),cs=e=>u9(e),ca=e=>u9(1e3*e),co=e=>u9(6e4*e),cl=e=>u9(36e5*e),cu=e=>u9(864e5*e),cc=e=>u9(6048e5*e),ch=e=>cp(e,{onMillis:e=>e,onNanos:e=>Number(e)/1e6}),cf=e=>{let t=u4(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/u3),Number(t.value.nanos%u3)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}},cp=nm(2,(e,t)=>{let r=u4(e);switch(r.value._tag){case"Nanos":return t.onNanos(r.value.nanos);case"Infinity":return t.onMillis(1/0);case"Millis":return t.onMillis(r.value.millis)}}),cd=nm(3,(e,t,r)=>{let n=u4(e),i=u4(t);if("Infinity"===n.value._tag||"Infinity"===i.value._tag)return r.onMillis(ch(n),ch(i));if("Nanos"===n.value._tag||"Nanos"===i.value._tag){let e="Nanos"===n.value._tag?n.value.nanos:BigInt(Math.round(1e6*n.value.millis)),t="Nanos"===i.value._tag?i.value.nanos:BigInt(Math.round(1e6*i.value.millis));return r.onNanos(e,t)}return r.onMillis(n.value.millis,i.value.millis)}),cm=sm((e,t)=>cd(e,t,{onMillis:(e,t)=>e<t?-1:+(e>t),onNanos:(e,t)=>e<t?-1:+(e>t)})),cg=(e,t)=>cd(e,t,{onMillis:(e,t)=>e===t,onNanos:(e,t)=>e===t}),cb=nm(2,(e,t)=>cd(e,t,{onMillis:(e,t)=>u9(e+t),onNanos:(e,t)=>u9(e+t)})),cy=((e,t)=>cd(e,t,{onMillis:(e,t)=>e<t,onNanos:(e,t)=>e<t}),nm(2,(e,t)=>cd(e,t,{onMillis:(e,t)=>e<=t,onNanos:(e,t)=>e<=t}))),cx=nm(2,(e,t)=>cd(e,t,{onMillis:(e,t)=>e>t,onNanos:(e,t)=>e>t})),cv=nm(2,(e,t)=>cd(e,t,{onMillis:(e,t)=>e>=t,onNanos:(e,t)=>e>=t})),cS=nm(2,(e,t)=>cg(u4(e),u4(t))),c_=e=>{let t=u4(e);if("Infinity"===t.value._tag)return"Infinity";if((e=>{switch(e.value._tag){case"Millis":return 0===e.value.millis;case"Nanos":return e.value.nanos===uY;case"Infinity":return!1}})(t))return"0";let r=(e=>{let t=u4(e);if("Infinity"===t.value._tag)return{days:1/0,hours:1/0,minutes:1/0,seconds:1/0,millis:1/0,nanos:1/0};let r=(e=>{let t=u4(e);switch(t.value._tag){case"Infinity":throw Error("Cannot convert infinite duration to nanos");case"Nanos":return t.value.nanos;case"Millis":return BigInt(Math.round(1e6*t.value.millis))}})(t),n=r/u2,i=n/u1,s=i/u0,a=s/u0;return{days:Number(a/uX),hours:Number(a%uX),minutes:Number(s%u0),seconds:Number(i%u0),millis:Number(n%u1),nanos:Number(r%u2)}})(t),n=[];return 0!==r.days&&n.push(`${r.days}d`),0!==r.hours&&n.push(`${r.hours}h`),0!==r.minutes&&n.push(`${r.minutes}m`),0!==r.seconds&&n.push(`${r.seconds}s`),0!==r.millis&&n.push(`${r.millis}ms`),0!==r.nanos&&n.push(`${r.nanos}ns`),n.join(" ")},cw=Symbol.for("effect/MutableRef"),ck={[cw]:cw,toString(){return id(this.toJSON())},toJSON(){return{_id:"MutableRef",current:ip(this.current)}},[ih](){return this.toJSON()},pipe(){return iw(this,arguments)}},cO=e=>{let t=Object.create(ck);return t.current=e,t},cE=nm(3,(e,t,r)=>!!il(t,e.current)&&(e.current=r,!0)),cC=((e,t)=>{let r=e.current;return e.current=t,r},nm(2,(e,t)=>(e.current=t,e))),cF=((e,t)=>(e.current=t,e.current),"effect/FiberId"),cR=Symbol.for(cF),cI="None",cT="Runtime",cA="Composite",cN=ir(`${cF}-${cI}`);class cM{id;startTimeMillis;[cR]=cR;_tag=cT;constructor(e,t){this.id=e,this.startTimeMillis=t}[n4](){return ia(this,ir(`${cF}-${this._tag}-${this.id}-${this.startTimeMillis}`))}[io](e){return cD(e)&&e._tag===cT&&this.id===e.id&&this.startTimeMillis===e.startTimeMillis}toString(){return id(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[ih](){return this.toJSON()}}class cj{left;right;[cR]=cR;_tag=cA;constructor(e,t){this.left=e,this.right=t}_hash;[n4](){return nS(ir(`${cF}-${this._tag}`),n7(n6(this.left)),n7(n6(this.right)),ia(this))}[io](e){return cD(e)&&e._tag===cA&&il(this.left,e.left)&&il(this.right,e.right)}toString(){return id(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,left:ip(this.left),right:ip(this.right)}}[ih](){return this.toJSON()}}let cP=new class{[cR]=cR;_tag=cI;id=-1;startTimeMillis=-1;[n4](){return cN}[io](e){return cD(e)&&e._tag===cI}toString(){return id(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[ih](){return this.toJSON()}},cD=e=>nL(e,cR),c$=e=>e._tag===cI||nS(cJ(e),lM(e=>c$(e))),cz=nm(2,(e,t)=>e._tag===cI?t:t._tag===cI?e:new cj(e,t)),cL=nm(2,(e,t)=>c$(e)?t:e),cU=e=>{switch(e._tag){case cI:return lT();case cT:return lH(e.id);case cA:return nS(cU(e.left),lU(cU(e.right)))}},cB=nF(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>cO(0)),cq=e=>Array.from(cU(e)).map(e=>`#${e}`).join(","),cJ=e=>{switch(e._tag){case cI:return lT();case cT:return lH(e);case cA:return nS(cJ(e.left),lU(cJ(e.right)))}},cH=cP,cV=(e,t)=>new cM(e,t),cW=cD,cK=()=>{let e=cB.current;return nS(cB,cC(e+1)),new cM(e,Date.now())},cG=Symbol.for("effect/List"),cZ=e=>s1(e),cQ=nk(az(il),cZ),cY={[cG]:cG,_tag:"Cons",toString(){return id(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:cZ(this).map(ip)}},[ih](){return this.toJSON()},[io](e){return c2(e)&&this._tag===e._tag&&cQ(this,e)},[n4](){return ia(this,is(cZ(this)))},[Symbol.iterator](){let e=!1,t=this;return{next(){if(e)return this.return();if("Nil"===t._tag)return e=!0,this.return();let r=t.head;return t=t.tail,{done:e,value:r}},return:t=>(e||(e=!0),{done:!0,value:t})}},pipe(){return iw(this,arguments)}},cX=(e,t)=>{let r=Object.create(cY);return r.head=e,r.tail=t,r},c0=ir("Nil"),c1=Object.create({[cG]:cG,_tag:"Nil",toString(){return id(this.toJSON())},toJSON:()=>({_id:"List",_tag:"Nil"}),[ih](){return this.toJSON()},[n4]:()=>c0,[io](e){return c2(e)&&this._tag===e._tag},[Symbol.iterator]:()=>({next:()=>({done:!0,value:void 0})}),pipe(){return iw(this,arguments)}}),c2=e=>nL(e,cG),c3=e=>"Nil"===e._tag,c5=e=>"Cons"===e._tag,c4=e=>{let t=e,r=0;for(;!c3(t);)r+=1,t=t.tail;return r},c6=(e,t)=>cX(e,t),c8=()=>c1,c7=e=>cX(e,c1),c9=e=>{let t,r=e[Symbol.iterator]();if(!(t=r.next())||t.done)return c1;{let e=cX(t.value,c1),n=e;for(;(t=r.next())&&!t.done;){let e=cX(t.value,c1);n.tail=e,n=e}return e}},he=nm(2,(e,t)=>hr(t,e)),ht=nm(2,(e,t)=>c6(t,e)),hr=nm(2,(e,t)=>{if(c3(e))return t;{if(c3(t))return e;let r=cX(t.head,e),n=r,i=t.tail;for(;!c3(i);){let t=cX(i.head,e);n.tail=t,n=t,i=i.tail}return r}}),hn=((e,t)=>{if(t<=0)return e;if(t>=c4(e))return c1;let r=e,n=0;for(;!c3(r)&&n<t;)r=r.tail,n+=1;return r},(e,t,r,n)=>{for(;;)if(c3(t))return e;else{if(r(t.head)===n)return hi(e,t,r,n);t=t.tail}}),hi=(e,t,r,n)=>{let i=cX(hl(e),c1),s=hu(e),a=i;for(;s!==t;){let e=cX(hl(s),c1);a.tail=e,a=ng(e),s=ng(s.tail)}let o=t.tail,l=ng(o);for(;!c3(o);)if(r(hl(o))!==n)o=o.tail;else{for(;l!==o;){let e=cX(hl(l),c1);a.tail=e,a=e,l=ng(l.tail)}l=ng(o.tail),o=o.tail}return c3(l)||(a.tail=l),i},hs=nm(3,(e,t,r)=>{let n=t,i=e;for(;!c3(i);)n=r(n,i.head),i=i.tail;return n}),ha=e=>{let t=c8(),r=e;for(;!c3(r);)t=ht(t,r.head),r=r.tail;return t},ho=((e,t)=>{if(t<=0)return c1;if(t>=c4(e))return e;let r=((...e)=>c9(e))(hl(e)),n=hu(e);for(let e=1;e<t;e++)r=cX(hl(n),r),n=hu(n);return ha(r)},"Expected List to be non-empty"),hl=e=>{if(c3(e))throw Error(ho);return e.head},hu=e=>{if(c3(e))throw Error(ho);return e.tail};Array.prototype;let hc=function(){function e(e){e&&Object.assign(this,e)}return e.prototype=iH,e}(),hh=e=>Object.assign(Object.create(iH),e),hf=Symbol.for("effect/DifferChunkPatch");function hp(e){return e}let hd=({...hc.prototype,[hf]:{_Value:hp,_Patch:hp}},Symbol.for("effect/DifferContextPatch"));function hm(e){return e}let hg={...hc.prototype,[hd]:{_Value:hm,_Patch:hm}},hb=Object.create(Object.assign(Object.create(hg),{_tag:"Empty"})),hy=Object.assign(Object.create(hg),{_tag:"AndThen"}),hx=Object.assign(Object.create(hg),{_tag:"AddService"}),hv=(e,t)=>{let r=Object.create(hx);return r.key=e,r.service=t,r},hS=Object.assign(Object.create(hg),{_tag:"RemoveService"}),h_=e=>{let t=Object.create(hS);return t.key=e,t},hw=Object.assign(Object.create(hg),{_tag:"UpdateService"}),hk=(e,t)=>{let r=Object.create(hw);return r.key=e,r.update=t,r},hO=nm(2,(e,t)=>((e,t)=>{let r=Object.create(hy);return r.first=e,r.second=t,r})(e,t)),hE=nm(2,(e,t)=>{if("Empty"===e._tag)return t;let r=!1,n=ob(e),i=new Map(t.unsafeMap);for(;o$(n);){let e=oL(n),t=oV(n);switch(e._tag){case"Empty":n=t;break;case"AddService":i.set(e.key,e.service),n=t;break;case"AndThen":n=oC(oC(t,e.second),e.first);break;case"RemoveService":i.delete(e.key),n=t;break;case"UpdateService":i.set(e.key,e.update(i.get(e.key))),r=!0,n=t}}if(!r)return uD(i);let s=new Map;for(let[e]of t.unsafeMap)i.has(e)&&(s.set(e,i.get(e)),i.delete(e));for(let[e,t]of i)s.set(e,t);return uD(s)}),hC=Symbol.for("effect/DifferHashMapPatch");function hF(e){return e}let hR=({...hc.prototype,[hC]:{_Value:hF,_Key:hF,_Patch:hF}},Symbol.for("effect/DifferHashSetPatch"));function hI(e){return e}let hT={...hc.prototype,[hR]:{_Value:hI,_Key:hI,_Patch:hI}},hA=Object.create(Object.assign(Object.create(hT),{_tag:"Empty"})),hN=Object.assign(Object.create(hT),{_tag:"AndThen"}),hM=Object.assign(Object.create(hT),{_tag:"Add"}),hj=Object.assign(Object.create(hT),{_tag:"Remove"}),hP=nm(2,(e,t)=>((e,t)=>{let r=Object.create(hN);return r.first=e,r.second=t,r})(e,t)),hD=nm(2,(e,t)=>{if("Empty"===e._tag)return t;let r=t,n=ob(e);for(;o$(n);){let e=oL(n),t=oV(n);switch(e._tag){case"Empty":n=t;break;case"AndThen":n=oC(e.first)(oC(e.second)(t));break;case"Add":r=l$(e.value)(r),n=t;break;case"Remove":r=lz(e.value)(r),n=t}}return r}),h$=Symbol.for("effect/DifferOrPatch");function hz(e){return e}let hL={...hc.prototype,[h$]:{_Value:hz,_Key:hz,_Patch:hz}},hU=Object.assign(Object.create(hL),{_tag:"AndThen"}),hB=((e,t)=>((e,t)=>{let r=Object.create(hU);return r.first=e,r.second=t,r})(e,t),Symbol.for("effect/DifferReadonlyArrayPatch"));function hq(e){return e}let hJ={...hc.prototype,[hB]:{_Value:hq,_Patch:hq}},hH=Object.create(Object.assign(Object.create(hJ),{_tag:"Empty"})),hV=Object.assign(Object.create(hJ),{_tag:"AndThen"}),hW=Object.assign(Object.create(hJ),{_tag:"Append"}),hK=Object.assign(Object.create(hJ),{_tag:"Slice"}),hG=Object.assign(Object.create(hJ),{_tag:"Update"}),hZ=(e,t)=>{let r=Object.create(hG);return r.index=e,r.patch=t,r},hQ=nm(2,(e,t)=>((e,t)=>{let r=Object.create(hV);return r.first=e,r.second=t,r})(e,t)),hY=nm(3,(e,t,r)=>{if("Empty"===e._tag)return t;let n=t.slice(),i=aC(e);for(;sd(i);){let e=as(i),t=al(i);switch(e._tag){case"Empty":i=t;break;case"AndThen":t.unshift(e.first,e.second),i=t;break;case"Append":for(let t of e.values)n.push(t);i=t;break;case"Slice":n=n.slice(e.from,e.until),i=t;break;case"Update":n[e.index]=r.patch(e.patch,n[e.index]),i=t}}return n}),hX={[Symbol.for("effect/Differ")]:{_P:ng,_V:ng},pipe(){return iw(this,arguments)}},h0=e=>{let t=Object.create(hX);return t.empty=e.empty,t.diff=e.diff,t.combine=e.combine,t.patch=e.patch,t},h1=()=>h2((e,t)=>t),h2=e=>h0({empty:ng,combine:(e,t)=>e===ng?t:t===ng?e:r=>t(e(r)),diff:(e,t)=>il(e,t)?ng:nb(t),patch:(t,r)=>e(r,t(r))}),h3=(e,t)=>(255&e)+((t&e&255)<<8),h5=h3(0,0),h4=nm(2,(e,t)=>h3(255&e&~t,e>>8&255)),h6=nm(2,(e,t)=>e|t),h8=e=>fr(e,32),h7=nm(2,(e,t)=>e&~t),h9=nm(2,(e,t)=>e|t),fe=e=>ft(e)&&!fa(e),ft=e=>fr(e,1),fr=nm(2,(e,t)=>(e&t)!=0),fn=(...e)=>e.reduce((e,t)=>e|t,0),fi=fn(0),fs=e=>fr(e,4),fa=e=>fr(e,16),fo=nm(2,(e,t)=>h3(e^t,t)),fl=nm(2,(e,t)=>e&(~(255&t)>>>0&255|t>>8&255)|255&t&(t>>8&255)),fu=h0({empty:h5,diff:(e,t)=>fo(e,t),combine:(e,t)=>h6(t)(e),patch:(e,t)=>fl(t,e)}),fc=e=>h3(e,0),fh=(e,t)=>({_tag:"Par",left:e,right:t}),ff=(e,t)=>({_tag:"Seq",left:e,right:t}),fp=e=>{let t=e,r=fS(),n=c8(),i=c8();for(;;)switch(t._tag){case"Empty":if(c3(n))return[r,i];t=n.head,n=n.tail;break;case"Par":n=c6(t.right,n),t=t.left;break;case"Seq":{let e=t.left,r=t.right;switch(e._tag){case"Empty":t=r;break;case"Par":{let n=e.left,i=e.right;t=fh(ff(n,r),ff(i,r));break}case"Seq":t=ff(e.left,ff(e.right,r));break;case"Single":t=e,i=c6(r,i)}break}case"Single":if(r=f_(r,t),c3(n))return[r,i];t=n.head,n=n.tail}throw Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},fd=(e,t)=>{if(c3(e))return c7(fE(t));if(fk(t))return e;let r=fA(e.head),n=fO(t);return 1===r.length&&1===n.length&&il(r[0],n[0])?c6(fT(e.head,fE(t)),e.tail):c6(fE(t),e)},fm=Symbol.for("effect/RequestBlock/Entry");class fg{request;result;listeners;ownerId;state;[fm]=fb;constructor(e,t,r,n,i){this.request=e,this.result=t,this.listeners=r,this.ownerId=n,this.state=i}}let fb={_R:e=>e},fy=Symbol.for("effect/RequestBlock/RequestBlockParallel"),fx={_R:e=>e};class fv{map;[fy]=fx;constructor(e){this.map=e}}let fS=()=>new fv(lu),f_=(e,t)=>new fv(lx(e.map,t.dataSource,e=>sE(sA(e,oE(t.blockedRequest)),()=>ob(t.blockedRequest)))),fw=(e,t)=>new fv(lk(e.map,t.map,(e,t,r)=>ld(e,r,sw(lh(e,r),{onNone:()=>t,onSome:e=>oT(t,e)})))),fk=e=>(e=>e&&o5(e._root))(e.map),fO=e=>Array.from(lg(e.map)),fE=e=>fI(l_(e.map,e=>ob(e))),fC=Symbol.for("effect/RequestBlock/RequestBlockSequential"),fF={_R:e=>e};class fR{map;[fC]=fF;constructor(e){this.map=e}}let fI=e=>new fR(e),fT=(e,t)=>new fR(lk(t.map,e.map,(e,t,r)=>ld(e,r,sw(lh(e,r),{onNone:()=>om(),onSome:e=>oT(e,t)})))),fA=e=>Array.from(lg(e.map)),fN="Pending",fM="Done",fj=Symbol.for("effect/Deferred"),fP={_E:e=>e,_A:e=>e},fD=e=>({_tag:fM,effect:e});class f${self;called=!1;constructor(e){this.self=e}next(e){return this.called?{value:e,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(e){return{value:e,done:!0}}throw(e){throw e}[Symbol.iterator](){return new f$(this.self)}}let fz=(e,t)=>{let r=new fB("Blocked");return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r},fL=Symbol.for("effect/Effect");class fU{patch;op;_op=iD;constructor(e,t){this.patch=e,this.op=t}}class fB{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[fL]=iq;constructor(e){this._op=e}[io](e){return this===e}[n4](){return ia(this,n8(this))}pipe(){return iw(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,effect_instruction_i0:ip(this.effect_instruction_i0),effect_instruction_i1:ip(this.effect_instruction_i1),effect_instruction_i2:ip(this.effect_instruction_i2)}}toString(){return id(this.toJSON())}[ih](){return this.toJSON()}[Symbol.iterator](){return new f$(new nX(this))}}class fq{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[fL]=iq;constructor(e){this._op=e,this._tag=e}[io](e){return dY(e)&&"Failure"===e._op&&il(this.effect_instruction_i0,e.effect_instruction_i0)}[n4](){return nS(ir(this._tag),n7(n6(this.effect_instruction_i0)),ia(this))}get cause(){return this.effect_instruction_i0}pipe(){return iw(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return id(this.toJSON())}[ih](){return this.toJSON()}[Symbol.iterator](){return new f$(new nX(this))}}class fJ{_op;effect_instruction_i0=void 0;effect_instruction_i1=void 0;effect_instruction_i2=void 0;trace=void 0;[fL]=iq;constructor(e){this._op=e,this._tag=e}[io](e){return dY(e)&&"Success"===e._op&&il(this.effect_instruction_i0,e.effect_instruction_i0)}[n4](){return nS(ir(this._tag),n7(n6(this.effect_instruction_i0)),ia(this))}get value(){return this.effect_instruction_i0}pipe(){return iw(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:ip(this.value)}}toString(){return id(this.toJSON())}[ih](){return this.toJSON()}[Symbol.iterator](){return new f$(new nX(this))}}let fH=e=>nL(e,fL),fV=e=>{let t=new fB(ij);return t.effect_instruction_i0=e,t},fW=nm(3,(e,t,r)=>pM(n=>ps(e,e=>ps(f7(pR(()=>n(t(e)))),t=>pR(()=>r(e,t)).pipe(pc({onFailure:e=>{switch(t._tag){case iE:return pt(l6(t.effect_instruction_i0,e));case iI:return pt(e)}},onSuccess:()=>t})))))),fK=nm(2,(e,t)=>ps(e,()=>pF(t))),fG=e=>fK(e,void 0),fZ=function(){let e=new fB(iO);switch(arguments.length){case 2:e.effect_instruction_i0=arguments[0],e.commit=arguments[1];break;case 3:e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.commit=arguments[2];break;case 4:e.effect_instruction_i0=arguments[0],e.effect_instruction_i1=arguments[1],e.effect_instruction_i2=arguments[2],e.commit=arguments[3];break;default:throw Error(nW("you're not supposed to end up here"))}return e},fQ=(e,t=cH)=>{let r,n=new fB(ik);return n.effect_instruction_i0=t=>{r=e(t)},n.effect_instruction_i1=t,pw(n,e=>fH(r)?r:pj)},fY=(e,t=cH)=>pR(()=>fQ(e,t)),fX=(e,t=cH)=>fZ(e,function(){let e,r,n,i;function s(t){e?e(t):void 0===r&&(r=t)}let a=new fB(ik);return a.effect_instruction_i0=t=>{e=t,r&&t(r)},a.effect_instruction_i1=t,1!==this.effect_instruction_i0.length?(i=new AbortController,n=n2(()=>this.effect_instruction_i0(s,i.signal))):n=n2(()=>this.effect_instruction_i0(s)),n||i?pw(a,e=>(i&&i.abort(),n??pj)):a}),f0=nm(2,(e,t)=>{let r=new fB(iC);return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r}),f1=nm(2,(e,t)=>ph(e,{onFailure:t,onSuccess:pF})),f2=nm(3,(e,t,r)=>f0(e,e=>{let n=ui(e);switch(n._tag){case"Left":return t(n.left)?r(n.left):pt(e);case"Right":return pt(n.right)}})),f3=Symbol.for("effect/OriginalAnnotation"),f5=(e,t)=>i3(t)?new Proxy(e,{has:(e,t)=>t===uF||t===f3||t in e,get:(r,n)=>n===uF?t.value:n===f3?e:r[n]}):e,f4=e=>!nz(e)||uF in e?pt(l3(e)):fV(t=>pt(l3(f5(e,mk(t))))),f6=e=>pr(()=>l3(new dz(e))),f8=e=>ph(e,{onFailure:e=>pF(sn(e)),onSuccess:e=>pF(si(e))}),f7=e=>pu(e,{onFailure:d4,onSuccess:mr}),f9=e=>!nz(e)||uF in e?pt(l2(e)):fV(t=>pt(l2(f5(e,mk(t))))),pe=e=>ps(pI(e),f9),pt=e=>{let t=new fq(iE);return t.effect_instruction_i0=e,t},pr=e=>ps(pI(e),pt),pn=fV(e=>pF(e.id())),pi=e=>fV(t=>e(t.id())),ps=nm(2,(e,t)=>{let r=new fB(iF);return r.effect_instruction_i0=e,r.effect_instruction_i1=t,r}),pa=nm(2,(e,t)=>ps(e,e=>{let r="function"==typeof t?t(e):t;return fH(r)?r:nV(r)?fQ(e=>{r.then(t=>e(pF(t)),t=>e(f9(new dQ(t,"An unknown error occurred in Effect.andThen"))))}):pF(r)})),po=e=>{let t=new fB("OnStep");return t.effect_instruction_i0=e,t},pl=e=>ps(e,ng),pu=nm(2,(e,t)=>pc(e,{onFailure:e=>pF(t.onFailure(e)),onSuccess:e=>pF(t.onSuccess(e))})),pc=nm(2,(e,t)=>{let r=new fB(iR);return r.effect_instruction_i0=e,r.effect_instruction_i1=t.onFailure,r.effect_instruction_i2=t.onSuccess,r}),ph=nm(2,(e,t)=>pc(e,{onFailure:e=>{if(ut(e).length>0)return pt(uy(e,{onEmpty:l1,onFail:l3,onDie:l3,onInterrupt:l5,onSequential:l6,onParallel:l4}));let r=oS(ux(e,om(),(e,t)=>t._tag===lK?i4(nS(e,oC(t.error))):s_()));return r.length>0?t.onFailure(oL(r)):pt(e)},onSuccess:t.onSuccess})),pf=nm(2,(e,t)=>pR(()=>{let r=s1(e),n=sX(r.length),i=0;return fK(p$({while:()=>i<r.length,body:()=>t(r[i],i),step:e=>{n[i++]=e}}),n)})),pp=nm(2,(e,t)=>pR(()=>{let r=s1(e),n=0;return p$({while:()=>n<r.length,body:()=>t(r[n],n),step:()=>{n++}})})),pd=nm(e=>"boolean"==typeof e[0]||fH(e[0]),(e,t)=>fH(e)?ps(e,e=>e?t.onTrue():t.onFalse()):e?t.onTrue():t.onFalse()),pm=ps(pn,e=>pg(e)),pg=e=>pt(l5(e)),pb=e=>{let t=new fB(iA);return t.effect_instruction_i0=(e=>h3(e,e))(1),t.effect_instruction_i1=()=>e,t},py=nm(2,(e,t)=>pM(r=>ps(f7(r(e)),e=>mp(t,e)))),px=nm(2,(e,t)=>ps(e,e=>pI(()=>t(e)))),pv=nm(2,(e,t)=>ph(e,{onFailure:e=>pe(()=>t.onFailure(e)),onSuccess:e=>pI(()=>t.onSuccess(e))})),pS=nm(2,(e,t)=>pc(e,{onFailure:e=>{let r=ui(e);switch(r._tag){case"Left":return pe(()=>t(r.left));case"Right":return pt(r.right)}},onSuccess:pF})),p_=((e,t)=>p_(e,e=>dX(e)?pj:t(e.effect_instruction_i0)),nm(2,(e,t)=>pM(r=>pc(r(e),{onFailure:e=>{let r=d4(e);return pc(t(r),{onFailure:t=>d4(l6(e,t)),onSuccess:()=>r})},onSuccess:e=>{let r=mr(e);return pJ(t(r),r)}})))),pw=nm(2,(e,t)=>p_(e,me({onFailure:e=>ue(e)?fG(t(ur(e))):pj,onSuccess:()=>pj}))),pk=nm(2,(e,t)=>pA(e,t,pF)),pO=e=>pE(e,ng),pE=nm(2,(e,t)=>ph(e,{onFailure:e=>f4(t(e)),onSuccess:pF})),pC=fV((e,t)=>pF(t.runtimeFlags)),pF=e=>{let t=new fJ(iI);return t.effect_instruction_i0=e,t},pR=e=>{let t=new fB(iO);return t.commit=e,t},pI=e=>{let t=new fB(iT);return t.effect_instruction_i0=e,t},pT=nm(e=>3===e.length||2===e.length&&!(nz(e[1])&&"onlyEffect"in e[1]),(e,t)=>ps(e,e=>{let r="function"==typeof t?t(e):t;return fH(r)?fK(r,e):nV(r)?fQ(t=>{r.then(r=>t(pF(e)),e=>t(f9(new dQ(e,"An unknown error occurred in Effect.tap"))))}):pF(e)})),pA=nm(3,(e,t,r)=>pc(e,{onFailure:e=>ut(e).length>0?pt(sT(uy(e,{onEmpty:s_(),onFail:e=>i4(l3(e)),onDie:e=>i4(l3(e)),onInterrupt:()=>s_(),onSequential:sz(l6),onParallel:sz(l4)}))):t(),onSuccess:r})),pN=e=>{let t=new fB(iA);return t.effect_instruction_i0=fc(1),t.effect_instruction_i1=()=>e,t},pM=e=>fZ(e,function(){let e=new fB(iA);return e.effect_instruction_i0=fc(1),e.effect_instruction_i1=e=>ft(e)?n2(()=>this.effect_instruction_i0(pb)):n2(()=>this.effect_instruction_i0(pN)),e}),pj=pF(void 0),pP=e=>{let t=new fB(iA);return t.effect_instruction_i0=e,t.effect_instruction_i1=void 0,t},pD=nm(2,(e,t)=>ps(t,t=>t?nS(e,px(i4)):pF(s_()))),p$=e=>{let t=new fB(iN);return t.effect_instruction_i0=e.while,t.effect_instruction_i1=e.body,t.effect_instruction_i2=e.step,t},pz=e=>pR(()=>{let t=new fB(iM);return t.effect_instruction_i0=e(),t}),pL=nm(2,(e,t)=>{let r=new fB(iA);return r.effect_instruction_i0=t,r.effect_instruction_i1=()=>e,r}),pU=e=>{let t=new fB(iP);return void 0!==e?.priority?db(t,e.priority):t},pB=nm(2,(e,t)=>ps(e,e=>px(t,t=>[e,t]))),pq=nm(2,(e,t)=>ps(e,e=>fK(t,e))),pJ=nm(2,(e,t)=>ps(e,()=>t)),pH=nm(3,(e,t,r)=>ps(e,e=>px(t,t=>r(e,t)))),pV=fY(()=>{let e=setInterval(()=>{},0x80000000-1);return pI(()=>clearInterval(e))}),pW=e=>ps(pn,t=>nS(e,pK(t))),pK=nm(2,(e,t)=>ps(e.interruptAsFork(t),()=>e.await)),pG={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return iw(this,arguments)}},pZ={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return iw(this,arguments)}},pQ={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return iw(this,arguments)}},pY={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return iw(this,arguments)}},pX={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return iw(this,arguments)}},p0={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return iw(this,arguments)}},p1={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return iw(this,arguments)}},p2={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return iw(this,arguments)}},p3=[pG,p1,p0,pX,pY,pQ,pZ,p2],p5=Symbol.for("effect/FiberRef"),p4={_A:e=>e},p6=e=>fV(t=>mr(t.getFiberRef(e))),p8=nm(2,(e,t)=>ps(p6(e),t)),p7=nm(2,(e,t)=>p9(e,()=>[void 0,t])),p9=nm(2,(e,t)=>fV(r=>{let[n,i]=t(r.getFiberRef(e));return r.setFiberRef(e,i),pF(n)})),de=nm(2,(e,t)=>p9(e,e=>[void 0,t(e)])),dt=Symbol.for("effect/RequestResolver"),dr={_A:e=>e,_R:e=>e};class dn{runAll;target;[dt]=dr;constructor(e,t){this.runAll=e,this.target=t}[n4](){return ia(this,this.target?n6(this.target):n8(this))}[io](e){return this.target?di(e)&&il(this.target,e.target):this===e}identified(...e){return new dn(this.runAll,oy(e))}pipe(){return iw(this,arguments)}}let di=e=>nL(e,dt),ds=nm(3,(e,t,r)=>fW(pq(p6(t),p7(t,r)),()=>e,e=>p7(t,e))),da=nm(3,(e,t,r)=>p8(t,n=>ds(e,t,r(n)))),dl=(e,t)=>dc(e,{differ:h1(),fork:t?.fork??ng,join:t?.join}),du=e=>{let t=h0({empty:hb,combine:(e,t)=>hO(t)(e),diff:(e,t)=>((e,t)=>{let r=new Map(e.unsafeMap),n=hb;for(let[e,i]of t.unsafeMap.entries())if(r.has(e)){let t=r.get(e);r.delete(e),il(t,i)||(n=hO(hk(e,()=>i))(n))}else r.delete(e),n=hO(hv(e,i))(n);for(let[e]of r.entries())n=hO(h_(e))(n);return n})(e,t),patch:(e,t)=>hE(t)(e)});return dc(e,{differ:t,fork:t.empty})},dc=(e,t)=>({...iV,[p5]:p4,initial:e,commit(){return p6(this)},diff:(e,r)=>t.differ.diff(e,r),combine:(e,r)=>t.differ.combine(e,r),patch:e=>r=>t.differ.patch(e,r),fork:t.fork,join:t.join??((e,t)=>t)}),dh=nF(Symbol.for("effect/FiberRef/currentContext"),()=>du(uz)),df=nF(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>dl(0)),dp=nF(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>dl(2048)),dd=nF(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>dl(lu)),dm=nF(Symbol.for("effect/FiberRef/currentLogLevel"),()=>dl(pX)),dg=nF(Symbol.for("effect/FiberRef/currentLogSpan"),()=>dl(c8())),db=nm(2,(e,t)=>ds(e,df,t)),dy=nF(Symbol.for("effect/FiberRef/currentConcurrency"),()=>dl("unbounded")),dx=nF(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>dl(!0)),dv=nF(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>dl(i4(p0))),dS=nF(Symbol.for("effect/FiberRef/versionMismatchErrorLogLevel"),()=>dl(i4(pY))),d_=nF(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>(e=>{let t=(e=>h0({empty:hH,combine:(e,t)=>hQ(e,t),diff:(t,r)=>(e=>{let t=0,r=hH;for(;t<e.oldValue.length&&t<e.newValue.length;){let n=e.oldValue[t],i=e.newValue[t],s=e.differ.diff(n,i);il(s,e.differ.empty)||(r=hQ(r,hZ(t,s))),t+=1}return t<e.oldValue.length&&(r=hQ(r,((e,t)=>{let r=Object.create(hK);return r.from=e,r.until=t,r})(0,t))),t<e.newValue.length&&(r=hQ(r,(e=>{let t=Object.create(hW);return t.values=e,t})(ac(t)(e.newValue)))),r})({oldValue:t,newValue:r,differ:e}),patch:(t,r)=>hY(t,r,e)}))(h1());return dc(e,{differ:t,fork:t.empty})})(aE())),dw=nF(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>dl(s_(),{fork:()=>s_(),join:(e,t)=>e})),dk=nF(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>dl(l1,{fork:()=>l1,join:(e,t)=>e})),dO=nF(Symbol.for("effect/FiberRef/currentTracerEnabled"),()=>dl(!0)),dE=nF(Symbol.for("effect/FiberRef/currentTracerTiming"),()=>dl(!0)),dC=nF(Symbol.for("effect/FiberRef/currentTracerSpanAnnotations"),()=>dl(lu)),dF=nF(Symbol.for("effect/FiberRef/currentTracerSpanLinks"),()=>dl(om())),dR=Symbol.for("effect/Scope"),dI=Symbol.for("effect/CloseableScope"),dT=(e,t)=>e.addFinalizer(()=>fG(t)),dA=(e,t)=>e.addFinalizer(t),dN=(e,t)=>e.close(t),dM=(e,t)=>e.fork(t),dj=nm(2,(e,t)=>{let r=nS(e,un,sA(t));switch(r._tag){case"None":return nS(ut(e),oz,sw({onNone:()=>{let t=s1(ur(e)).flatMap(e=>s1(cU(e)).map(e=>`#${e}`));return new dU(t?`Interrupted by fibers: ${t.join(", ")}`:void 0)},onSome:ng}));case"Some":return r.value}}),dP=function(){class e extends globalThis.Error{commit(){return f9(this)}toJSON(){let e={...this};return this.message&&(e.message=this.message),this.cause&&(e.cause=this.cause),e}[ih](){return this.toString!==globalThis.Error.prototype.toString?this.stack?`${this.toString()}
${this.stack.split("\n").slice(1).join("\n")}`:this.toString():"Bun"in globalThis?uS(l2(this),{renderErrorCause:!0}):this}}return Object.assign(e.prototype,iW),e}(),dD=(e,t)=>{class r extends dP{_tag=t}return Object.assign(r.prototype,e),r.prototype.name=t,r},d$=Symbol.for("effect/Cause/errors/RuntimeException"),dz=dD({[d$]:d$},"RuntimeException"),dL=Symbol.for("effect/Cause/errors/InterruptedException"),dU=dD({[dL]:dL},"InterruptedException"),dB=e=>nL(e,dL),dq=Symbol.for("effect/Cause/errors/IllegalArgument"),dJ=dD({[dq]:dq},"IllegalArgumentException"),dH=Symbol.for("effect/Cause/errors/NoSuchElement"),dV=dD({[dH]:dH},"NoSuchElementException"),dW=Symbol.for("effect/Cause/errors/InvalidPubSubCapacityException"),dK=dD({[dW]:dW},"InvalidPubSubCapacityException"),dG=Symbol.for("effect/Cause/errors/Timeout"),dZ=Symbol.for("effect/Cause/errors/UnknownException"),dQ=function(){class e extends dP{_tag="UnknownException";error;constructor(e,t){super(t??"An unknown error occurred",{cause:e}),this.error=e}}return Object.assign(e.prototype,{[dZ]:dZ,name:"UnknownException"}),e}(),dY=e=>fH(e)&&"_tag"in e&&("Success"===e._tag||"Failure"===e._tag),dX=e=>"Success"===e._tag,d0=nm(2,(e,t)=>{switch(e._tag){case iE:return d4(e.effect_instruction_i0);case iI:return mr(t)}}),d1=e=>d0(e,void 0),d2=(e,t)=>mo(e,t?.parallel?l4:l6),d3=e=>d4(l3(e)),d5=e=>d4(l2(e)),d4=e=>{let t=new fq(iE);return t.effect_instruction_i0=e,t},d6=nm(2,(e,t)=>{switch(e._tag){case iE:return d4(e.effect_instruction_i0);case iI:return t(e.effect_instruction_i0)}}),d8=nm(2,(e,t)=>{switch(e._tag){case iE:return pF(d4(e.effect_instruction_i0));case iI:return f7(t(e.effect_instruction_i0))}}),d7=e=>d4(l5(e)),d9=nm(2,(e,t)=>{switch(e._tag){case iE:return d4(e.effect_instruction_i0);case iI:return mr(t(e.effect_instruction_i0))}}),me=nm(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case iE:return t(e.effect_instruction_i0);case iI:return r(e.effect_instruction_i0)}}),mt=nm(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case iE:return t(e.effect_instruction_i0);case iI:return r(e.effect_instruction_i0)}}),mr=e=>{let t=new fJ(iI);return t.effect_instruction_i0=e,t},mn=mr(void 0),mi=nm(2,(e,t)=>ma(e,t,{onSuccess:(e,t)=>[e,t],onFailure:l6})),ms=nm(2,(e,t)=>ma(e,t,{onSuccess:(e,t)=>t,onFailure:l6})),ma=nm(3,(e,t,{onFailure:r,onSuccess:n})=>{switch(e._tag){case iE:switch(t._tag){case iI:return d4(e.effect_instruction_i0);case iE:return d4(r(e.effect_instruction_i0,t.effect_instruction_i0))}case iI:switch(t._tag){case iI:return mr(n(e.effect_instruction_i0,t.effect_instruction_i0));case iE:return d4(t.effect_instruction_i0)}}}),mo=(e,t)=>{let r=oy(e);return o$(r)?nS(oV(r),aP(nS(oL(r),d9(ob)),(e,r)=>nS(e,ma(r,{onSuccess:(e,t)=>nS(e,oC(t)),onFailure:t}))),d9(oS),d9(e=>ov(e)),i4):s_()},ml=e=>({...iV,[fj]:fP,state:cO({_tag:fN,joiners:[]}),commit(){return mh(this)},blockingOn:e}),mu=()=>ps(pn,e=>mc(e)),mc=e=>pI(()=>ml(e)),mh=e=>fY(t=>{let r=e.state.current;switch(r._tag){case fM:return t(r.effect);case fN:return r.joiners.push(t),my(e,t)}},e.blockingOn),mf=nm(2,(e,t)=>pI(()=>{let r=e.state.current;switch(r._tag){case fM:return!1;case fN:cC(e.state,fD(t));for(let e=0,n=r.joiners.length;e<n;e++)r.joiners[e](t);return!0}})),mp=nm(2,(e,t)=>mf(e,t)),md=((e,t)=>mf(e,f9(t)),nm(2,(e,t)=>mf(e,pt(t)))),mm=nm(2,(e,t)=>mf(e,pg(t))),mg=nm(2,(e,t)=>mf(e,pF(t))),mb=(e,t)=>{let r=e.state.current;if(r._tag===fN){cC(e.state,fD(t));for(let e=0,n=r.joiners.length;e<n;e++)r.joiners[e](t)}},my=(e,t)=>pI(()=>{let r=e.state.current;if(r._tag===fN){let e=r.joiners.indexOf(t);e>=0&&r.joiners.splice(e,1)}}),mx=fV(e=>mr(e.currentContext)),mv=e=>ps(mx,e),mS=nm(2,(e,t)=>ds(dh,t)(e)),m_=nm(2,(e,t)=>da(dh,e=>uV(e,t))(e)),mw=nm(2,(e,t)=>mv(r=>mS(e,t(r)))),mk=((e,t)=>ps(e,e=>ps(t.predicate(e),r=>r?pF(e):t.orElse(e))),e=>{let t=e.currentSpan;return void 0!==t&&"Span"===t._tag?i4(t):s_()}),mO={_tag:"Span",spanId:"noop",traceId:"noop",sampled:!1,status:{_tag:"Ended",startTime:BigInt(0),endTime:BigInt(0),exit:mn},attributes:new Map,links:[],kind:"internal",attribute(){},event(){},end(){},addLinks(){}},mE=e=>uy(e,{onEmpty:i4(l1),onFail:sA(l2),onDie:e=>i4(l3(e)),onInterrupt:e=>i4(l5(e)),onSequential:sz(l6),onParallel:sz(l4)}),mC=e=>dj(ng)(e),mF="InvalidData",mR="MissingData",mI="SourceUnavailable",mT="Unsupported",mA=Symbol.for("effect/ConfigError"),mN={_tag:"ConfigError",[mA]:mA},mM=(e,t)=>{let r=Object.create(mN);return r._op="And",r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),Object.defineProperty(r,"message",{enumerable:!1,get(){return this.toString()}}),r},mj=(e,t)=>{let r=Object.create(mN);return r._op="Or",r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),Object.defineProperty(r,"message",{enumerable:!1,get(){return this.toString()}}),r},mP=(e,t,r={pathDelim:"."})=>{let n=Object.create(mN);return n._op=mF,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){let e=nS(this.path,aB(r.pathDelim));return`(Invalid data at ${e}: "${this.message}")`}}),n},mD=(e,t,r={pathDelim:"."})=>{let n=Object.create(mN);return n._op=mR,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){let e=nS(this.path,aB(r.pathDelim));return`(Missing data at ${e}: "${this.message}")`}}),n},m$=nm(2,(e,t)=>{switch(e._op){case"And":return mM(m$(e.left,t),m$(e.right,t));case"Or":return mj(m$(e.left,t),m$(e.right,t));case mF:return mP([...t,...e.path],e.message);case mR:return mD([...t,...e.path],e.message);case mI:return((e,t,r,n={pathDelim:"."})=>{let i=Object.create(mN);return i._op=mI,i.path=e,i.message=t,i.cause=r,Object.defineProperty(i,"toString",{enumerable:!1,value(){let e=nS(this.path,aB(n.pathDelim));return`(Source unavailable at ${e}: "${this.message}")`}}),i})([...t,...e.path],e.message,e.cause);case mT:return((e,t,r={pathDelim:"."})=>{let n=Object.create(mN);return n._op=mT,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){let e=nS(this.path,aB(r.pathDelim));return`(Unsupported operation at ${e}: "${this.message}")`}}),n})([...t,...e.path],e.message)}}),mz={andCase:(e,t,r)=>t&&r,orCase:(e,t,r)=>t&&r,invalidDataCase:nx,missingDataCase:ny,sourceUnavailableCase:nx,unsupportedCase:nx},mL=nm(3,(e,t,r)=>{let n=[e],i=[];for(;n.length>0;){let e=n.pop();switch(e._op){case"And":n.push(e.right),n.push(e.left),i.push(sn({_op:"AndCase"}));break;case"Or":n.push(e.right),n.push(e.left),i.push(sn({_op:"OrCase"}));break;case mF:i.push(si(r.invalidDataCase(t,e.path,e.message)));break;case mR:i.push(si(r.missingDataCase(t,e.path,e.message)));break;case mI:i.push(si(r.sourceUnavailableCase(t,e.path,e.message,e.cause)));break;case mT:i.push(si(r.unsupportedCase(t,e.path,e.message)))}}let s=[];for(;i.length>0;){let e=i.pop();switch(e._op){case"Left":switch(e.left._op){case"AndCase":{let e=s.pop(),n=s.pop(),i=r.andCase(t,e,n);s.push(i);break}case"OrCase":{let e=s.pop(),n=s.pop(),i=r.orCase(t,e,n);s.push(i)}}break;case"Right":s.push(e.right)}}if(0===s.length)throw Error("BUG: ConfigError.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return s.pop()}),mU=e=>mL(e,void 0,mz),mB=Symbol.for("effect/Clock"),mq=uW("effect/Clock"),mJ=0x80000000-1,mH={unsafeSchedule(e,t){let r=ch(t);if(r>mJ)return nx;let n=!1,i=setTimeout(()=>{n=!0,e()},r);return()=>(clearTimeout(i),!n)}},mV=function(){let e,t=BigInt(1e6);return"undefined"==typeof performance?()=>BigInt(Date.now())*t:()=>(void 0===e&&(e=BigInt(Date.now())*t-BigInt(Math.round(1e6*performance.now()))),e+BigInt(Math.round(1e6*performance.now())))}(),mW=function(){let e="object"==typeof process&&"hrtime"in process&&"function"==typeof process.hrtime.bigint?process.hrtime:void 0;if(!e)return mV;let t=mV()-e.bigint();return()=>t+e.bigint()}();class mK{[mB]=mB;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return mW()}currentTimeMillis=pI(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=pI(()=>this.unsafeCurrentTimeNanos());scheduler(){return pF(mH)}sleep(e){return fX(t=>fG(pI(mH.unsafeSchedule(()=>t(pj),e))))}}nm(2,(e,t)=>-1!==sg(e,t));let mG=e=>e.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&"),mZ={_tag:"Empty"},mQ=nm(2,(e,t)=>({_tag:"AndThen",first:e,second:t})),mY=nm(2,(e,t)=>mQ(e,{_tag:"MapName",f:t})),mX=nm(2,(e,t)=>mQ(e,{_tag:"Nested",name:t})),m0=nm(2,(e,t)=>mQ(e,{_tag:"Unnested",name:t})),m1=nm(2,(e,t)=>{let r=c7(t),n=e;for(;c5(r);){let e=r.head;switch(e._tag){case"Empty":r=r.tail;break;case"AndThen":r=c6(e.first,c6(e.second,r.tail));break;case"MapName":n=aF(n,e.f),r=r.tail;break;case"Nested":n=s4(n,e.name),r=r.tail;break;case"Unnested":if(!nS(ai(n),sD(e.name)))return sn(mD(n,`Expected ${e.name} to be in path in ConfigProvider#unnested`));n=al(n),r=r.tail}}return si(n)}),m2="Constant",m3="Fallback",m5="Lazy",m4="MapOrFail",m6="Nested",m8="Primitive",m7="ZipWith",m9=e=>e.toLowerCase(),ge=e=>e.toUpperCase(),gt=(e,t,r)=>t instanceof RegExp?e.replace(t,r):t.reduce((e,t)=>e.replace(t,r),e),gr=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],gn=/[^A-Z0-9]+/gi,gi=(e,t)=>((e,t={})=>{let{delimiter:r=" ",splitRegexp:n=gr,stripRegexp:i=gn,transform:s=m9}=t,a=gt(gt(e,n,"$1\0$2"),i,"\0"),o=0,l=a.length;for(;"\0"===a.charAt(o);)o++;for(;"\0"===a.charAt(l-1);)l--;return a.slice(o,l).split("\0").map(s).join(r)})(e,{delimiter:"_",transform:ge,...t}),gs=(e,t)=>[...e,...t],ga=Symbol.for("effect/ConfigProvider"),go=uW("effect/ConfigProvider"),gl=Symbol.for("effect/ConfigProviderFlat"),gu=e=>({[gl]:gl,patch:e.patch,load:(t,r,n=!0)=>e.load(t,r,n),enumerateChildren:e.enumerateChildren}),gc=e=>({[ga]:ga,pipe(){return iw(this,arguments)},...{load:t=>ps(gp(e,aE(),t,!1),e=>sw(ai(e),{onNone:()=>f9(mD(aE(),`Expected a single value having structure: ${t}`)),onSome:pF})),flattened:e}}),gh=e=>{let{pathDelim:t,seqDelim:r}=Object.assign({},{pathDelim:"_",seqDelim:","},e),n=()=>"undefined"!=typeof process&&"env"in process&&"object"==typeof process.env?process.env:{};return gc(gu({load:(e,i,s=!0)=>{let a=nS(e,aB(t)),o=n();return nS(a in o?i4(o[a]):s_(),pS(()=>mD(e,`Expected ${a} to exist in the process context`)),ps(t=>gv(t,e,i,r,s)))},enumerateChildren:e=>pI(()=>lJ(Object.keys(n()).map(e=>e.toUpperCase().split(t)).filter(t=>{for(let r=0;r<e.length;r++){let n=nS(e,an(r)),i=t[r];if(void 0===i||n!==i)return!1}return!0}).flatMap(t=>t.slice(e.length,e.length+1)))),patch:mZ}))},gf=(e,t)=>{let{pathDelim:r,seqDelim:n}=Object.assign({seqDelim:",",pathDelim:"."},t),i=e=>nS(e,aB(r)),s=e=>e.split(r),a=gE(e,e=>s(e),i);return gc(gu({load:(e,t,r=!0)=>{let s=i(e);return nS(a.has(s)?i4(a.get(s)):s_(),pS(()=>mD(e,`Expected ${s} to exist in the provided map`)),ps(i=>gv(i,e,t,n,r)))},enumerateChildren:e=>pI(()=>lJ(s1(a.keys()).map(s).filter(t=>{for(let r=0;r<e.length;r++){let n=nS(e,an(r)),i=t[r];if(void 0===i||n!==i)return!1}return!0}).flatMap(t=>t.slice(e.length,e.length+1)))),patch:mZ}))},gp=(e,t,r,n)=>{switch(r._tag){case m2:return pF(aC(r.value));case"Described":return pR(()=>gp(e,t,r.config,n));case"Fail":return f9(mD(t,r.message));case m3:return nS(pR(()=>gp(e,t,r.first,n)),f1(i=>r.condition(i)?nS(gp(e,t,r.second,n),f1(e=>f9(mj(i,e)))):f9(i)));case m5:return pR(()=>gp(e,t,r.config(),n));case m4:return pR(()=>nS(gp(e,t,r.original,n),ps(pf(e=>nS(r.mapOrFail(e),pS(m$(((e,t)=>{let r=t;if("Nested"===r._tag){let t=e.slice();for(;"Nested"===r._tag;)t.push(r.name),r=r.config;return t}return e})(t,r.original))))))));case m6:return pR(()=>gp(e,gs(t,aC(r.name)),r.config,n));case m8:return nS(m1(t,e.patch),ps(t=>nS(e.load(t,r,n),ps(e=>{if(0===e.length){let e=nS(aa(t),sk(()=>"<n/a>"));return f9(mD([],`Expected ${r.description} with name ${e}`))}return pF(e)}))));case"Sequence":return nS(m1(t,e.patch),ps(n=>nS(e.enumerateChildren(n),ps(g_),ps(n=>0===n.length?pR(()=>px(gp(e,t,r.config,!0),aC)):nS(pf(n,n=>gp(e,s6(t,`[${n}]`),r.config,!0)),px(e=>{let t=aI(e);return 0===t.length?aC(aE()):aC(t)}))))));case"HashMap":return pR(()=>nS(m1(t,e.patch),ps(t=>nS(e.enumerateChildren(t),ps(i=>nS(i,pf(i=>gp(e,gs(t,aC(i)),r.valueConfig,n)),px(e=>0===e.length?aC(lu):nS(gS(e),aF(e=>(e=>{let t=lb(lu);for(let r of e)ld(t,r[0],r[1]);return ly(t)})(ad(s1(i),e)))))))))));case m7:return pR(()=>nS(gp(e,t,r.left,n),f8,ps(i=>nS(gp(e,t,r.right,n),f8,ps(e=>{if(st(i)&&st(e))return f9(mM(i.left,e.left));if(st(i)&&sr(e))return f9(i.left);if(sr(i)&&st(e))return f9(e.left);if(sr(i)&&sr(e)){let n=nS(t,aB(".")),s=gd(t,n),[a,o]=((e,t,r,n)=>{let i=a$(r.length,t=>t>=n.length?s_():i4([e(t),t+1])),s=a$(n.length,e=>e>=r.length?s_():i4([t(e),e+1]));return[gs(r,i),gs(n,s)]})(s,s,nS(i.right,aF(si)),nS(e.right,aF(si)));return nS(a,ad(o),pf(([e,t])=>nS(pB(e,t),px(([e,t])=>r.zip(e,t)))))}throw Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},gd=(e,t)=>r=>sn(mD(e,`The element at index ${r} in a sequence at path "${t}" was missing`)),gm=nm(2,(e,t)=>gc(gg(e.flattened,t))),gg=(e,t)=>gu({load:(t,r,n=!0)=>e.load(t,r,n),enumerateChildren:t=>e.enumerateChildren(t),patch:mY(e.patch,t)}),gb=nm(2,(e,t)=>gc(gu({load:(t,r)=>e.flattened.load(t,r,!0),enumerateChildren:t=>e.flattened.enumerateChildren(t),patch:mX(e.flattened.patch,t)}))),gy=((e,t)=>gc(gu({load:(t,r)=>e.flattened.load(t,r,!0),enumerateChildren:t=>e.flattened.enumerateChildren(t),patch:m0(e.flattened.patch,t)})),nm(2,(e,t)=>gc(gx(e.flattened,()=>t().flattened)))),gx=(e,t)=>gu({load:(r,n,i)=>nS(m1(r,e.patch),ps(t=>e.load(t,n,i)),f1(e=>nS(pI(t),ps(t=>nS(m1(r,t.patch),ps(e=>t.load(e,n,i)),f1(t=>f9(mj(e,t)))))))),enumerateChildren:r=>nS(m1(r,e.patch),ps(t=>e.enumerateChildren(t)),f8,ps(e=>nS(pI(t),ps(t=>nS(m1(r,t.patch),ps(e=>t.enumerateChildren(e)),f8,ps(t=>{if(st(e)&&st(t))return f9(mM(e.left,t.left));if(st(e)&&sr(t))return pF(t.right);if(sr(e)&&st(t))return pF(e.right);if(sr(e)&&sr(t))return pF(nS(e.right,lU(t.right)));throw Error("BUG: ConfigProvider.orElseFlat - please report an issue at https://github.com/Effect-TS/effect/issues")})))))),patch:mZ}),gv=(e,t,r,n,i)=>i?nS(e.split(RegExp(`\\s*${mG(n)}\\s*`)),pf(e=>r.parse(e.trim())),pS(m$(t))):nS(r.parse(e),pv({onFailure:m$(t),onSuccess:aC})),gS=e=>Object.keys(e[0]).map(t=>e.map(e=>e[t])),g_=e=>nS(pf(e,gO),pv({onFailure:()=>aE(),onSuccess:ap(sg)}),f8,px(sc)),gw=/(^.+)(\[(\d+)\])$/,gk=/^(\[(\d+)\])$/,gO=e=>{let t=e.match(gk);if(null!==t){let e=t[2];return nS(void 0!==e&&e.length>0?i4(e):s_(),sN(gF))}return s_()},gE=(e,t,r)=>{let n=new Map;for(let[i,s]of e){let e=nS(t(i),aR(e=>sw(gC(e),{onNone:()=>aC(e),onSome:([e,t])=>sY(e,`[${t}]`)})));n.set(r(e),s)}return n},gC=e=>{let t=e.match(gw);if(null!==t){let e=t[1],r=t[3];return(e=>{if(Symbol.iterator in e){let t=[];for(let r of e){if(i2(r))return s_();t.push(r.value)}return i4(t)}let t={};for(let r of Object.keys(e)){let n=e[r];if(i2(n))return s_();t[r]=n.value}return i4(t)})([void 0!==e&&e.length>0?i4(e):s_(),nS(void 0!==r&&r.length>0?i4(r):s_(),sN(gF))])}return s_()},gF=e=>{let t=Number.parseInt(e);return Number.isNaN(t)?s_():i4(t)},gR=Symbol.for("effect/Console"),gI=uW("effect/Console"),gT={[gR]:gR,assert:(e,...t)=>pI(()=>{console.assert(e,...t)}),clear:pI(()=>{console.clear()}),count:e=>pI(()=>{console.count(e)}),countReset:e=>pI(()=>{console.countReset(e)}),debug:(...e)=>pI(()=>{console.debug(...e)}),dir:(e,t)=>pI(()=>{console.dir(e,t)}),dirxml:(...e)=>pI(()=>{console.dirxml(...e)}),error:(...e)=>pI(()=>{console.error(...e)}),group:e=>e?.collapsed?pI(()=>console.groupCollapsed(e?.label)):pI(()=>console.group(e?.label)),groupEnd:pI(()=>{console.groupEnd()}),info:(...e)=>pI(()=>{console.info(...e)}),log:(...e)=>pI(()=>{console.log(...e)}),table:(e,t)=>pI(()=>{console.table(e,t)}),time:e=>pI(()=>console.time(e)),timeEnd:e=>pI(()=>console.timeEnd(e)),timeLog:(e,...t)=>pI(()=>{console.timeLog(e,...t)}),trace:(...e)=>pI(()=>{console.trace(...e)}),warn:(...e)=>pI(()=>{console.warn(...e)}),unsafe:console},gA=Symbol.for("effect/Random"),gN=uW("effect/Random"),gM=(e,t)=>pR(()=>nS(pI(()=>Array.from(e)),ps(e=>{let r=[];for(let t=e.length;t>=2;t-=1)r.push(t);return nS(r,pp(r=>nS(t(r),px(t=>gj(e,r-1,t)))),fK(oy(e)))}))),gj=(e,t,r)=>{let n=e[t];return e[t]=e[r],e[r]=n,e},gP=Symbol.for("effect/Tracer"),gD=uW("effect/Tracer"),g$=uW("effect/ParentSpan"),gz=function(){let e="abcdef0123456789",t=e.length;return function(r){let n="";for(let i=0;i<r;i++)n+=e.charAt(Math.floor(Math.random()*t));return n}}();class gL{name;parent;context;startTime;kind;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];links;constructor(e,t,r,n,i,s){this.name=e,this.parent=t,this.context=r,this.startTime=i,this.kind=s,this.status={_tag:"Started",startTime:i},this.attributes=new Map,this.traceId="Some"===t._tag?t.value.traceId:gz(32),this.spanId=gz(16),this.links=Array.from(n)}end(e,t){this.status={_tag:"Ended",endTime:e,exit:t,startTime:this.status.startTime}}attribute(e,t){this.attributes.set(e,t)}event(e,t,r){this.events.push([e,t,r??{}])}addLinks(e){this.links.push(...e)}}let gU={[gP]:gP,...{span:(e,t,r,n,i,s)=>new gL(e,t,r,n,i,s),context:e=>e()}},gB=e=>{if(e?.captureStackTrace===!1||e?.captureStackTrace!==void 0&&"boolean"!=typeof e.captureStackTrace)return e;let t=Error.stackTraceLimit;Error.stackTraceLimit=3;let r=Error();Error.stackTraceLimit=t;let n=!1;return{...e,captureStackTrace:()=>{if(!1!==n)return n;if(void 0!==r.stack){let e=r.stack.split("\n");if(void 0!==e[3])return n=e[3].trim()}}}},gq=uZ()("effect/Tracer/DisablePropagation",{defaultValue:nx}),gJ=nS(uz,uU(mq,new mK),uU(gI,gT),uU(gN,new class e{seed;[gA]=gA;PRNG;constructor(e){this.seed=e,this.PRNG=new nZ(e)}get next(){return pI(()=>this.PRNG.number())}get nextBoolean(){return px(this.next,e=>e>.5)}get nextInt(){return pI(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(e,t){return px(this.next,r=>(t-e)*r+e)}nextIntBetween(e,t){return pI(()=>this.PRNG.integer(t-e)+e)}shuffle(e){return gM(e,e=>this.nextIntBetween(0,e))}}(n6(Math.random()))),uU(go,gh()),uU(gD,gU)),gH=nF(Symbol.for("effect/DefaultServices/currentServices"),()=>du(gJ)),gV=e=>fV(t=>e(t.currentDefaultServices)),gW=e=>gV(t=>e(t.unsafeMap.get(mq.key))),gK=gW(e=>e.currentTimeMillis),gG=(gV(e=>e.unsafeMap.get(gN.key).next),"effect/Redacted"),gZ=nF("effect/Redacted/redactedRegistry",()=>new WeakMap),gQ=Symbol.for(gG),gY={[gQ]:{_A:e=>e},pipe(){return iw(this,arguments)},toString:()=>"<redacted>",toJSON:()=>"<redacted>",[ih]:()=>"<redacted>",[n4](){return nS(n6(gG),n7(n6(gZ.get(this))),ia(this))},[io](e){return gX(e)&&il(gZ.get(this),gZ.get(e))}},gX=e=>nL(e,gQ),g0=Symbol.for("effect/Secret");({...gY,[g0]:g0});let g1=Symbol.for("effect/Config"),g2={...iV,[g1]:{_A:e=>e},commit(){var e;let t;return e=this,t=t=>t.load(e),gV(e=>t(e.unsafeMap.get(go.key)))}},g3=nm(2,(e,t)=>g4(e,e=>si(t(e)))),g5=nm(2,(e,t)=>g4(e,e=>{try{return si(t(e))}catch(e){return sn(mP([],e instanceof Error?e.message:`${e}`))}})),g4=nm(2,(e,t)=>{let r=Object.create(g2);return r._tag=m4,r.original=e,r.mapOrFail=t,r}),g6=nm(2,(e,t)=>{let r=Object.create(g2);return r._tag=m6,r.name=t,r.config=e,r}),g8=nm(2,(e,t)=>{let r=Object.create(g2);return r._tag=m3,r.first=e,r.second=br(t),r.condition=ny,r}),g7=nm(2,(e,t)=>{let r=Object.create(g2);return r._tag=m3,r.first=e,r.second=br(t.orElse),r.condition=t.if,r}),g9=(e,t)=>{let r=Object.create(g2);return r._tag=m8,r.description=e,r.parse=t,r},be=e=>{let t=g9("a text property",si);return void 0===e?t:g6(t,e)},bt=e=>{let t=Object.create(g2);return t._tag=m2,t.value=e,t.parse=()=>si(e),t},br=e=>{let t=Object.create(g2);return t._tag=m5,t.config=e,t},bn=nm(2,(e,t)=>g7(e,{orElse:()=>bt(t),if:mU})),bi=((e,t,r)=>{let n=Object.create(g2);return n._tag=m7,n.left=e,n.right=t,n.zip=r,n},(...e)=>t=>{let r=e.map(String).join(", "),n=g9(`one of (${r})`,t=>{let n=e.find(e=>String(e)===t);return void 0===n?sn(mP([],`Expected one of (${r}) but received ${t}`)):si(n)});return void 0===t?n:g6(n,t)}),bs=function(){let e=Symbol.for("effect/Data/Error/plainArgs");return({BaseEffectError:class extends dP{constructor(t){super(t?.message,t?.cause?{cause:t.cause}:void 0),t&&(Object.assign(this,t),Object.defineProperty(this,e,{value:t,enumerable:!1}))}toJSON(){return{...this[e],...this}}}}).BaseEffectError}(),ba=e=>{let t={BaseEffectError:class extends bs{_tag=e}};return t.BaseEffectError.prototype.name=e,t.BaseEffectError},bo=e=>pI(()=>e.state.current._tag===fM),bl=iK,bu=iG;class bc extends bl{}class bh extends bu{}let bf="Sequential",bp="Parallel",bd={_tag:bf},bm={_tag:bp},bg=e=>({_tag:"ParallelN",parallelism:e});function bb(){return new bx(new Map)}let by=Symbol.for("effect/FiberRefs");class bx{locals;[by]=by;constructor(e){this.locals=e}pipe(){return iw(this,arguments)}}let bv=nm(3,(e,t,r)=>{let n=new Map(e.locals);return r.locals.forEach((e,r)=>{let i=e[0][1];if(!e[0][0][io](t)){if(!n.has(r)){if(il(i,r.initial))return;n.set(r,[[t,r.join(r.initial,i)]]);return}let s=n.get(r),[a,o]=((e,t,r,n=!1)=>{let i,s=t,a=r,o=n;for(;void 0===i;)if(s9(s)&&s9(a)){let e=as(s)[0],t=al(s),r=as(a)[0],n=as(a)[1],l=al(a);e.startTimeMillis<r.startTimeMillis?(a=l,o=!0):e.startTimeMillis>r.startTimeMillis?s=t:e.id<r.id?(a=l,o=!0):e.id>r.id?s=t:i=[n,o]}else i=[e.initial,!0];return i})(r,s,e);if(o){let e=r.diff(a,i),o=s[0][1],l=r.join(o,r.patch(e)(o));if(!il(o,l)){let e,i=s[0][0];e=i[io](t)?[[i,l],...s.slice(1)]:[[t,l],...s],n.set(r,e)}}}}),new bx(n)}),bS=nm(2,(e,t)=>{let r=new Map;return b_(e,r,t),new bx(r)}),b_=(e,t,r)=>{e.locals.forEach((e,n)=>{let i=e[0][1],s=n.patch(n.fork)(i);il(i,s)?t.set(n,e):t.set(n,[[r,s],...e])})},bw=nm(2,(e,t)=>{let r=new Map(e.locals);return r.delete(t),new bx(r)}),bk=nm(2,(e,t)=>e.locals.has(t)?i4(as(e.locals.get(t))[1]):s_()),bO=nm(2,(e,t)=>nS(bk(e,t),sk(()=>t.initial))),bE=nm(2,(e,{fiberId:t,fiberRef:r,value:n})=>{if(0===e.locals.size)return new bx(new Map([[r,[[t,n]]]]));let i=new Map(e.locals);return bC(i,t,r,n),new bx(i)}),bC=(e,t,r,n)=>{let i,s=e.get(r)??[];if(s9(s)){let[e,r]=as(s);if(e[io](t))if(il(r,n))return;else i=[[t,n],...s.slice(1)];else i=[[t,n],...s]}else i=[[t,n]];e.set(r,i)},bF=nm(2,(e,{entries:t,forkAs:r})=>{if(0===e.locals.size)return new bx(new Map(t));let n=new Map(e.locals);return void 0!==r&&b_(e,n,r),t.forEach(([e,t])=>{1===t.length?bC(n,t[0][0],e,t[0][1]):t.forEach(([t,r])=>{bC(n,t,e,r)})}),new bx(n)}),bR="Empty",bI="Remove",bT="Update",bA="AndThen",bN={_tag:bR},bM=(e,t)=>{let r=new Map(e.locals),n=bN;for(let[e,i]of t.locals.entries()){let t=as(i)[1],s=r.get(e);if(void 0!==s){let r=as(s)[1];il(r,t)||(n=bj({_tag:bT,fiberRef:e,patch:e.diff(r,t)})(n))}else n=bj({_tag:"Add",fiberRef:e,value:t})(n);r.delete(e)}for(let[e]of r.entries())n=bj({_tag:bI,fiberRef:e})(n);return n},bj=nm(2,(e,t)=>({_tag:bA,first:e,second:t})),bP=nm(3,(e,t,r)=>{let n=r,i=aC(e);for(;s9(i);){let e=as(i),r=al(i);switch(e._tag){case bR:i=r;break;case"Add":n=bE(n,{fiberId:t,fiberRef:e.fiberRef,value:e.value}),i=r;break;case bI:n=bw(n,e.fiberRef),i=r;break;case bT:{let s=bO(n,e.fiberRef);n=bE(n,{fiberId:t,fiberRef:e.fiberRef,value:e.fiberRef.patch(e.patch)(s)}),i=r;break}case bA:i=s4(e.first)(s4(e.second)(r))}}return n}),bD="effect/FiberStatus",b$=Symbol.for(bD),bz="Done",bL="Running",bU="Suspended",bB=ir(`${bD}-${bz}`);class bq{runtimeFlags;[b$]=b$;_tag=bL;constructor(e){this.runtimeFlags=e}[n4](){return nS(n6(bD),n7(n6(this._tag)),n7(n6(this.runtimeFlags)),ia(this))}[io](e){return bV(e)&&e._tag===bL&&this.runtimeFlags===e.runtimeFlags}}class bJ{runtimeFlags;blockingOn;[b$]=b$;_tag=bU;constructor(e,t){this.runtimeFlags=e,this.blockingOn=t}[n4](){return nS(n6(bD),n7(n6(this._tag)),n7(n6(this.runtimeFlags)),n7(n6(this.blockingOn)),ia(this))}[io](e){return bV(e)&&e._tag===bU&&this.runtimeFlags===e.runtimeFlags&&il(this.blockingOn,e.blockingOn)}}let bH=new class{[b$]=b$;_tag=bz;[n4](){return bB}[io](e){return bV(e)&&e._tag===bz}},bV=e=>nL(e,b$),bW=e=>new bq(e),bK=sx(nS(sg,sy(e=>e.ordinal))),bG=e=>{switch(e){case"All":return pG;case"Debug":return p0;case"Error":return pQ;case"Fatal":return pZ;case"Info":return pX;case"Trace":return p1;case"None":return p2;case"Warning":return pY}},bZ=Symbol.for("effect/Micro"),bQ=Symbol.for("effect/Micro/MicroExit"),bY=e=>"object"==typeof e&&null!==e&&bZ in e,bX=Symbol.for("effect/Micro/MicroCause"),b0={_E:ng};class b1 extends globalThis.Error{_tag;traces;[bX];constructor(e,t,r){let n,i,s,a=`MicroCause.${e}`;if(t instanceof globalThis.Error){n=`(${a}) ${t.name}`;let e=(i=t.message).split("\n").length;s=t.stack?`(${a}) ${t.stack.split("\n").slice(0,e+3).join("\n")}`:`${n}: ${i}`}else n=a,i=ib(t,0),s=`${n}: ${i}`;r.length>0&&(s+=`
    ${r.join("\n    ")}`),super(i),this._tag=e,this.traces=r,this[bX]=b0,this.name=n,this.stack=s}pipe(){return iw(this,arguments)}toString(){return this.stack}[ih](){return this.stack}}class b2 extends b1{error;constructor(e,t=[]){super("Fail",e,t),this.error=e}}class b3 extends b1{defect;constructor(e,t=[]){super("Die",e,t),this.defect=e}}class b5 extends b1{constructor(e=[]){super("Interrupt","interrupted",e)}}let b4=e=>"Fail"===e._tag,b6=e=>"Interrupt"===e._tag,b8=Symbol.for("effect/Micro/MicroFiber"),b7={_A:ng,_E:ng};class b9{context;interruptible;[b8];_stack=[];_observers=[];_exit;_children;currentOpCount=0;constructor(e,t=!0){this.context=e,this.interruptible=t,this[b8]=b7}getRef(e){let t;return t=this.context,t.unsafeMap.has(e.key)?t.unsafeMap.get(e.key):uq(e)}addObserver(e){return this._exit?(e(this._exit),nv):(this._observers.push(e),()=>{let t=this._observers.indexOf(e);t>=0&&this._observers.splice(t,1)})}_interrupted=!1;unsafeInterrupt(){!this._exit&&(this._interrupted=!0,this.interruptible&&this.evaluate(yM))}unsafePoll(){return this._exit}evaluate(e){if(this._exit)return;if(void 0!==this._yielded){let e=this._yielded;this._yielded=void 0,e()}let t=this.runLoop(e);if(t===yl)return;let r=ye.interruptChildren&&ye.interruptChildren(this);if(void 0!==r)return this.evaluate(yF(r,()=>t));this._exit=t;for(let e=0;e<this._observers.length;e++)this._observers[e](t);this._observers.length=0}runLoop(e){let t=!1,r=e;this.currentOpCount=0;try{for(;;){if(this.currentOpCount++,!t&&this.getRef(yJ).shouldYield(this)){t=!0;let e=r;r=yF(yy,()=>e)}if((r=r[yi](this))===yl){let e=this._yielded;if(bQ in e)return this._yielded=void 0,e;return yl}}}catch(e){if(!nL(r,yi))return yj(`MicroFiber.runLoop: Not a valid effect: ${String(r)}`);return yj(e)}}getCont(e){for(;;){let t=this._stack.pop();if(!t)return;let r=t[yo]&&t[yo](this);if(r)return{[e]:r};if(t[e])return t}}_yielded=void 0;yieldWith(e){return this._yielded=e,yl}children(){return this._children??=new Set}}let ye=nF("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0})),yt=e=>yb(()=>{for(let t of e)t.unsafeInterrupt();let t=e[Symbol.iterator](),r=yb(()=>{let e=t.next();for(;!e.done;){if(e.value.unsafePoll()){e=t.next();continue}let n=e.value;return yw(e=>{n.addObserver(t=>{e(r)})})}return yP});return r}),yr=Symbol.for("effect/Micro/identifier"),yn=Symbol.for("effect/Micro/args"),yi=Symbol.for("effect/Micro/evaluate"),ys=Symbol.for("effect/Micro/successCont"),ya=Symbol.for("effect/Micro/failureCont"),yo=Symbol.for("effect/Micro/ensureCont"),yl=Symbol.for("effect/Micro/Yield"),yu={...iJ,_op:"Micro",[bZ]:{_A:ng,_E:ng,_R:ng},pipe(){return iw(this,arguments)},[Symbol.iterator](){return new nG(new nX(this))},toJSON(){return{_id:"Micro",op:this[yr],...yn in this?{args:this[yn]}:void 0}},toString(){return id(this)},[ih](){return id(this)}};function yc(e){return yj("Micro.evaluate: Not implemented")}let yh=e=>({...yu,[yr]:e.op,[yi]:e.eval??yc,[ys]:e.contA,[ya]:e.contE,[yo]:e.ensure}),yf=e=>{let t=yh(e);return function(){let r=Object.create(t);return r[yn]=!1===e.single?arguments:arguments[0],r}},yp=e=>{let t={...yh(e),[bQ]:bQ,_tag:e.op,get[e.prop](){return this[yn]},toJSON(){return{_id:"MicroExit",_tag:e.op,[e.prop]:this[yn]}},[io](t){return yT(t)&&t._tag===e.op&&il(this[yn],t[yn])},[n4](){return ia(this,n7(ir(e.op))(n6(this[yn])))}};return function(e){let r=Object.create(t);return r[yn]=e,r[ys]=void 0,r[ya]=void 0,r[yo]=void 0,r}},yd=yp({op:"Success",prop:"value",eval(e){let t=e.getCont(ys);return t?t[ys](this[yn],e):e.yieldWith(this)}}),ym=yp({op:"Failure",prop:"cause",eval(e){let t=e.getCont(ya);for(;b6(this[yn])&&t&&e.interruptible;)t=e.getCont(ya);return t?t[ya](this[yn],e):e.yieldWith(this)}}),yg=yf({op:"Sync",eval(e){let t=this[yn](),r=e.getCont(ys);return r?r[ys](t,e):e.yieldWith(yA(t))}}),yb=yf({op:"Suspend",eval(e){return this[yn]()}}),yy=yf({op:"Yield",eval(e){let t=!1;return e.getRef(yJ).scheduleTask(()=>{t||e.evaluate(yP)},this[yn]??0),e.yieldWith(()=>{t=!0})}})(0),yx=yd(void 0),yv=yf({op:"WithMicroFiber",eval(e){return this[yn](e)}}),yS=yf({op:"Async",single:!1,eval(e){let t=this[yn][0],r=!1,n=!1,i=this[yn][1]?new AbortController:void 0,s=t(t=>{r||(r=!0,n?e.evaluate(t):n=t)},i?.signal);return!1!==n?n:(n=!0,e._yielded=()=>{r=!0},void 0===i&&void 0===s||e._stack.push(y_(()=>(r=!0,i?.abort(),s??yP))),yl)}}),y_=yf({op:"AsyncFinalizer",ensure(e){e.interruptible&&(e.interruptible=!1,e._stack.push(y1(!0)))},contE(e,t){return b6(e)?yF(this[yn](),()=>ym(e)):ym(e)}}),yw=e=>yS(e,e.length>=2),yk=nm(2,(e,t)=>yI(e,e=>t)),yO=nm(2,(e,t)=>yF(e,e=>{let r=bY(t)?t:"function"==typeof t?t(e):t;return bY(r)?r:yd(r)})),yE=((e,t)=>yF(e,e=>{let r=bY(t)?t:"function"==typeof t?t(e):t;return bY(r)?yk(r,e):yd(e)}),e=>yZ(e,{onFailure:yN,onSuccess:yA})),yC=nm(2,(e,t)=>{let r;return r=[e,t],yv(e=>yw(t=>{let n=!1,i=new Set,s=e=>{n=!0,t(0===i.size?e:yF(yt(i),()=>e))};for(let t of r){if(n)break;let r=y8(e,y2(t),!0,!0);i.add(r),r.addObserver(e=>{i.delete(r),s(e)})}return yt(i)}))}),yF=nm(2,(e,t)=>{let r=Object.create(yR);return r[yn]=e,r[ys]=t,r}),yR=yh({op:"OnSuccess",eval(e){return e._stack.push(this),this[yn]}}),yI=nm(2,(e,t)=>yF(e,e=>yd(t(e)))),yT=e=>nL(e,bQ),yA=yd,yN=ym,yM=yN(((e=[])=>new b5(e))()),yj=e=>yN(((e,t=[])=>new b3(e,t))(e)),yP=yA(void 0),yD=e=>{for(let t of e)if("Failure"===t._tag)return t;return yP},y$="setImmediate"in globalThis?globalThis.setImmediate:e=>setTimeout(e,0);class yz{tasks=[];running=!1;scheduleTask(e,t){this.tasks.push(e),this.running||(this.running=!0,y$(this.afterScheduled))}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){let e=this.tasks;this.tasks=[];for(let t=0,r=e.length;t<r;t++)e[t]()}shouldYield(e){return e.currentOpCount>=e.getRef(yB)}flush(){for(;this.tasks.length>0;)this.runTasks()}}let yL=nm(2,(e,t)=>yv(r=>{let n=r.context;return r.context=t(n),y0(e,()=>(r.context=n,yx))})),yU=nm(2,(e,t)=>yL(e,uV(t)));(e,t,r)=>yL(e,uU(t,r));class yB extends uZ()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){}class yq extends uZ()("effect/Micro/currentConcurrency",{defaultValue:()=>"unbounded"}){}class yJ extends uZ()("effect/Micro/currentScheduler",{defaultValue:()=>new yz}){}e=>bY(e[1]),(e,t)=>Array.from({length:t},()=>e);let yH=nm(2,(e,t)=>{let r=Object.create(yV);return r[yn]=e,r[ya]=t,r}),yV=yh({op:"OnFailure",eval(e){return e._stack.push(this),this[yn]}}),yW=nm(3,(e,t,r)=>yH(e,e=>t(e)?r(e):ym(e))),yK=((e,t)=>yW(e,b4,e=>t(e.error)),nm(2,(e,t)=>{let r=Object.create(yG);return r[yn]=e,r[ys]=t.onSuccess,r[ya]=t.onFailure,r})),yG=yh({op:"OnSuccessAndFailure",eval(e){return e._stack.push(this),this[yn]}}),yZ=nm(2,(e,t)=>yK(e,{onFailure:e=>yg(()=>t.onFailure(e)),onSuccess:e=>yg(()=>t.onSuccess(e))})),yQ=((e,t)=>yK(e,{onFailure:e=>"Fail"===e._tag?t.onFailure(e.error):ym(e),onSuccess:t.onSuccess}),e=>yw(t=>{let r=setTimeout(()=>{t(yx)},e);return yg(()=>{clearTimeout(r)})})),yY=((e,t)=>yC(e,yO(y2(yQ(t.duration)),t.onTimeout)),Symbol.for("effect/Micro/MicroScope"));class yX{[yY];state={_tag:"Open",finalizers:new Set};constructor(){this[yY]=yY}unsafeAddFinalizer(e){"Open"===this.state._tag&&this.state.finalizers.add(e)}addFinalizer(e){return yb(()=>"Open"===this.state._tag?(this.state.finalizers.add(e),yx):e(this.state.exit))}unsafeRemoveFinalizer(e){"Open"===this.state._tag&&this.state.finalizers.delete(e)}close(e){return yb(()=>{if("Open"===this.state._tag){let t=Array.from(this.state.finalizers).reverse();return this.state={_tag:"Closed",exit:e},yF(y6(t,t=>yE(t(e))),yD)}return yx})}get fork(){return yg(()=>{let e=new yX;if("Closed"===this.state._tag)return e.state=this.state,e;function t(t){return e.close(t)}return this.state.finalizers.add(t),e.unsafeAddFinalizer(e=>yg(()=>this.unsafeRemoveFinalizer(t))),e})}}let y0=nm(2,(e,t)=>y3(r=>yK(r(e),{onFailure:e=>yF(t(yN(e)),()=>ym(e)),onSuccess:e=>yF(t(yA(e)),()=>yd(e))}))),y1=((e,t,r)=>y0(e,e=>t(e)?r(e):yP),yf({op:"SetInterruptible",ensure(e){if(e.interruptible=this[yn],e._interrupted&&e.interruptible)return()=>yM}})),y2=e=>yv(t=>t.interruptible?e:(t.interruptible=!0,t._stack.push(y1(!1)),t._interrupted)?yM:e),y3=e=>yv(t=>t.interruptible?(t.interruptible=!1,t._stack.push(y1(!0)),e(y2)):e(ng)),y5=(e,t)=>Array.isArray(e)||nH(e)?y6(e,ng,t):t?.discard?y6(Object.values(e),ng,t):yb(()=>{let r={};return yk(y6(Object.entries(e),([e,t])=>yI(t,t=>{r[e]=t}),{discard:!0,concurrency:t?.concurrency}),r)}),y4=yf({op:"While",contA(e,t){return(this[yn].step(e),this[yn].while())?(t._stack.push(this),this[yn].body()):yP},eval(e){return this[yn].while()?(e._stack.push(this),this[yn].body()):yP}}),y6=(e,t,r)=>yv(n=>{let i=r?.concurrency==="inherit"?n.getRef(yq):r?.concurrency??1,s="unbounded"===i?1/0:Math.max(1,i),a=s1(e),o=a.length;if(0===o)return r?.discard?yx:yd([]);let l=r?.discard?void 0:Array(o),u=0;return 1===s?yk(y4({while:()=>u<a.length,body:()=>t(a[u],u),step:l?e=>l[u++]=e:e=>u++}),l):yw(e=>{let r,i=new Set,c=0,h=0,f=!1,p=!1;return!function d(){for(f=!0;c<s&&u<o;){let m=u,g=a[m];u++,c++;try{let a=y8(n,t(g,m),!0,!0);i.add(a),a.addObserver(t=>{i.delete(a),p||("Failure"===t._tag?void 0===r&&(r=t,o=u,i.forEach(e=>e.unsafeInterrupt())):void 0!==l&&(l[m]=t.value),h++,c--,h===o?e(r??yd(l)):!f&&c<s&&d())})}catch(e){r=yj(e),o=u,i.forEach(e=>e.unsafeInterrupt())}}f=!1}(),yb(()=>(p=!0,u=o,yt(i)))})}),y8=(e,t,r=!1,n=!1)=>{let i=new b9(e.context,e.interruptible);return n||(e.children().add(i),i.addObserver(()=>e.children().delete(i))),r?i.evaluate(t):e.getRef(yJ).scheduleTask(()=>i.evaluate(t),0),i},y7=function(){class e extends globalThis.Error{}return Object.assign(e.prototype,yu,iH,{[yr]:"Failure",[yi](){let e;return e=this,ym(((e,t=[])=>new b2(e,t))(e))},toString(){return this.message?`${this.name}: ${this.message}`:this.name},toJSON(){return{...this}},[ih](){let e=this.stack;return e?`${this.toString()}
${e.split("\n").slice(1).join("\n")}`:this.toString()}}),e}(),y9=class extends y7{constructor(e){super(),e&&Object.assign(this,e)}},xe=e=>{class t extends y9{_tag=e}return t.prototype.name=e,t},xt=Symbol.for("effect/Readable"),xr=Symbol.for("effect/Ref"),xn={_A:e=>e};class xi extends bc{ref;commit(){return this.get}[xr]=xn;[xt]=xt;constructor(e){super(),this.ref=e,this.get=pI(()=>this.ref.current)}get;modify(e){return pI(()=>{let t=this.ref.current,[r,n]=e(t);return t!==n&&cC(n)(this.ref),r})}}let xs=e=>new xi(cO(e)),xa=e=>pI(()=>xs(e)),xo=nm(2,(e,t)=>e.modify(()=>[void 0,t])),xl=nm(2,(e,t)=>e.modify(e=>[e,t])),xu=nm(2,(e,t)=>e.modify(t)),xc=nm(2,(e,t)=>e.modify(e=>[void 0,t(e)]));class xh{buckets=[];scheduleTask(e,t){let r,n=this.buckets.length,i=0;for(;i<n;i++)if(this.buckets[i][0]<=t)r=this.buckets[i];else break;r&&r[0]===t?r[1].push(e):i===n?this.buckets.push([t,[e]]):this.buckets.splice(i,0,[t,[e]])}}class xf{maxNextTickBeforeTimer;running=!1;tasks=new xh;constructor(e){this.maxNextTickBeforeTimer=e}starveInternal(e){let t=this.tasks.buckets;for(let[e,r]of(this.tasks.buckets=[],t))for(let e=0;e<r.length;e++)r[e]();0===this.tasks.buckets.length?this.running=!1:this.starve(e)}starve(e=0){e>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(e+1))}shouldYield(e){return e.currentOpCount>e.getFiberRef(dp)&&e.getFiberRef(df)}scheduleTask(e,t){this.tasks.scheduleTask(e,t),this.running||(this.running=!0,this.starve())}}let xp=nF(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new xf(2048));class xd{tasks=new xh;deferred=!1;scheduleTask(e,t){this.deferred?xp.scheduleTask(e,t):this.tasks.scheduleTask(e,t)}shouldYield(e){return e.currentOpCount>e.getFiberRef(dp)&&e.getFiberRef(df)}flush(){for(;this.tasks.buckets.length>0;){let e=this.tasks.buckets;for(let[t,r]of(this.tasks.buckets=[],e))for(let e=0;e<r.length;e++)r[e]()}this.deferred=!0}}let xm=nF(Symbol.for("effect/FiberRef/currentScheduler"),()=>dl(xp)),xg=nF(Symbol.for("effect/FiberRef/currentRequestMap"),()=>dl(new Map)),xb=(e,t,r,n)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return p8(dy,e=>"unbounded"===e?r():e>1?n(e):t());default:return e>1?n(e):t()}},xy=(e,t,r)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return p8(dy,e=>"unbounded"===e||e>1?r():t());default:return e>1?r():t()}},xx=e=>{let t=u4(e);return gW(e=>e.sleep(t))},xv=e=>e.replace(/[\s="]/g,"_"),xS=e=>t=>{let r=xv(t.label);return`${r}=${e-t.startTime}ms`},x_=e=>({_tag:"ExternalSpan",spanId:e.spanId,traceId:e.traceId,sampled:e.sampled??!0,context:e.context??uz}),xw="effect/MetricLabel",xk=Symbol.for(xw);class xO{key;value;[xk]=xk;_hash;constructor(e,t){this.key=e,this.value=t,this._hash=ir(xw+this.key+this.value)}[n4](){return this._hash}[io](e){return xE(e)&&this.key===e.key&&this.value===e.value}pipe(){return iw(this,arguments)}}let xE=e=>nL(e,xk),xC=nm(e=>fH(e[0]),function(){let e=arguments;return da(e[0],dd,"string"==typeof e[1]?ld(e[1],e[2]):t=>Object.entries(e[1]).reduce((e,[t,r])=>ld(e,t,r),t))}),xF=e=>px(e,i4),xR=e=>{let t,r;return"function"==typeof e?t=e:(t=e.try,r=e.catch),pR(()=>{try{return pF(n2(t))}catch(e){return f9(r?n2(()=>r(e)):new dQ(e,"An unknown error occurred in Effect.try"))}})},xI=nm(2,(e,t)=>pc(e,{onFailure:e=>{let r=t(e);switch(r._tag){case"None":return pt(e);case"Some":return r.value}},onSuccess:pF})),xT=nm(e=>fH(e[0]),(e,...t)=>{let r=t[t.length-1];return f2(e,2===t.length?nU(t[0]):e=>{let r=nL(e,"_tag")?e._tag:void 0;if(!r)return!1;for(let e=0;e<t.length-1;e++)if(t[e]===r)return!0;return!1},r)}),xA=nm(2,(e,t)=>{let r;return f2(e,e=>(r??=Object.keys(t),nL(e,"_tag")&&nR(e._tag)&&r.includes(e._tag)),e=>t[e._tag](e))}),xN=nm(3,(e,t,r)=>ps(e,e=>px(r(e),r=>({...e,[t]:r})))),xM=nm(2,(e,t)=>px(e,e=>({[t]:e}))),xj=((e,t)=>pR(()=>{let r,n=e[Symbol.iterator](),i=[],s=pF(!1),a=0;for(;(r=n.next())&&!r.done;){let e=r.value,n=a++;s=ps(s,r=>r?(i.push(e),pF(!0)):t(e,n))}return px(s,()=>i)}),nm(3,(e,t,r)=>ps(e,e=>t(e)?pF(e):r(e)))),xP=((e=>fH(e[0]),(e,t,r)=>xj(e,t,e=>void 0===r?f9(new dV):pe(()=>r(e)))),(e,t,r,n)=>ps(r(n,t),i=>{if(i)return pF(i4(n));let s=e.next();return s.done?pF(s_()):xP(e,t+1,r,s.value)})),xD=nm(2,(e,t)=>ph(e,{onFailure:e=>pF(t.onFailure(e)),onSuccess:e=>pF(t.onSuccess(e))})),x$=e=>{let t=ps(ps(e,()=>pU()),()=>t);return t},xz=fV(e=>pF(e.getFiberRefs())),xL=e=>(...t)=>{let r,n=sC(e);for(let e=0,n=t.length;e<n;e++){let n=t[e];l8(n)&&(r=void 0!==r?l6(r,n):n,t=[...t.slice(0,e),...t.slice(e+1)],e--)}return void 0===r&&(r=l1),fV(e=>(e.log(t,r,n),pj))},xU=xL(),xB=xL(p0),xq=xL(pX),xJ=xL(pY),xH=xL(pQ),xV=nm(2,(e,t)=>ps(gK,r=>da(e,dg,ht({label:t,startTime:r})))),xW=nm(2,(e,t)=>pc(e,{onFailure:e=>pr(()=>t(e)),onSuccess:pF})),xK=e=>px(xa(!0),t=>fG(pD(e,xl(t,!1)))),xG=e=>x8((t,r)=>nS(e,bP(t,r))),xZ=nm(3,(e,t,r)=>mv(n=>mS(e,uU(n,t,r)))),xQ=nm(3,(e,t,r)=>mv(n=>ps(r,r=>mS(e,nS(n,uU(t,r)))))),xY=nm(3,(e,t,r)=>s1(e).reduce((e,t,n)=>ps(e,e=>r(e,t,n)),pF(t))),xX=pF(s_()),x0=nm(3,(e,t,r)=>ps(t,n=>ps(e,e=>px(t,t=>[r(n,t),e]))));(e,t)=>pR(()=>{let r,n=e[Symbol.iterator](),i=[],s=pF(!0),a=0;for(;(r=n.next())&&!r.done;){let e=r.value,n=a++;s=ps(s,r=>nS(r?t(e,n):pF(!1),px(t=>(t&&i.push(e),t))))}return px(s,()=>i)});let x1=nm(2,(e,{onFailure:t,onSuccess:r})=>pc(e,{onFailure:e=>{let r=ui(e);switch(r._tag){case"Left":return pJ(t(r.left),pt(e));case"Right":return pt(e)}},onSuccess:e=>fK(r(e),e)})),x2=nm(2,(e,t)=>f0(e,e=>sw(uy(e,{onEmpty:s_(),onFail:()=>s_(),onDie:e=>i4(l3(e)),onInterrupt:()=>s_(),onSequential:sz(l6),onParallel:sz(l4)}),{onNone:()=>pt(e),onSome:r=>pJ(t(r),pt(e))}))),x3=nm(2,(e,t)=>pc(e,{onFailure:e=>{let r=ui(e);switch(r._tag){case"Left":return pJ(t(r.left),pt(e));case"Right":return pt(e)}},onSuccess:pF})),x5=nm(2,(e,t)=>pc(e,{onFailure:e=>pJ(t(e),pt(e)),onSuccess:pF})),x4=e=>{let t,r;"function"==typeof e?t=e:(t=e.try,r=e.catch);let n=e=>r?pe(()=>r(e)):f9(new dQ(e,"An unknown error occurred in Effect.tryPromise"));return t.length>=1?fX((e,r)=>{try{t(r).then(t=>e(mr(t)),t=>e(n(t)))}catch(t){e(n(t))}}):fX(e=>{try{t().then(t=>e(mr(t)),t=>e(n(t)))}catch(t){e(n(t))}})},x6=nm(2,(e,t)=>ps(e,e=>xR({try:()=>t.try(e),catch:t.catch}))),x8=e=>fV(t=>(t.setFiberRefs(e(t.id(),t.getFiberRefs())),pj)),x7=((e,t,r)=>mw(e,e=>uU(e,t,r(uJ(e,t)))),nm(2,(e,t)=>pR(()=>t()?px(e,i4):pF(s_())))),x9=BigInt(0),ve=sN(e=>uJ(e.context,gq)?"Span"===e._tag?ve(e.parent):s_():i4(e)),vt=(e,...t)=>{let r=gB(1===t.length?void 0:t[0]),n=t[t.length-1];return fV(t=>{let i=((e,t,r)=>{let n,i=!e.getFiberRef(dO)||r.context&&uJ(r.context,gq),s=e.getFiberRef(dh),a=r.parent?i4(r.parent):r.root?s_():ve(uH(s,g$));if(i){let e;e={name:t,parent:a,context:uU(r.context??uz,gq,!0)},n=Object.assign(Object.create(mO),e)}else{let i=e.getFiberRef(gH),s=uJ(i,gD),o=uJ(i,mq),l=e.getFiberRef(dE),u=e.getFiberRefs(),c=bk(u,dC),h=bk(u,dF),f="Some"===h._tag?void 0!==r.links?[...ov(h.value),...r.links??[]]:ov(h.value):r.links??aE();n=s.span(t,a,r.context??uz,f,l?o.unsafeCurrentTimeNanos():x9,r.kind??"internal"),"Some"===c._tag&&lw(c.value,(e,t)=>n.attribute(t,e)),void 0!==r.attributes&&Object.entries(r.attributes).forEach(([e,t])=>n.attribute(e,t))}return"function"==typeof r.captureStackTrace&&uE.set(n,r.captureStackTrace),n})(t,e,r),s=t.getFiberRef(dE),a=uJ(t.getFiberRef(gH),mq);return p_(n(i),e=>((e,t,r,n)=>pI(()=>{"Ended"!==e.status._tag&&("Failure"===t._tag&&uE.has(e)&&e.attribute("code.stacktrace",uE.get(e)()),e.end(n?r.unsafeCurrentTimeNanos():x9,t))}))(i,e,a,s))})},vr=nm(2,(e,t)=>xZ(e,g$,t)),vn="InterruptSignal",vi="Stateful",vs="Resume",va="YieldNow",vo=e=>({_tag:vn,cause:e}),vl=e=>({_tag:vi,onFiber:e}),vu=e=>({_tag:vs,effect:e}),vc=()=>({_tag:va}),vh=Symbol.for("effect/FiberScope");class vf{[vh]=vh;fiberId=cH;roots=new Set;add(e,t){this.roots.add(t),t.addObserver(()=>{this.roots.delete(t)})}}class vp{fiberId;parent;[vh]=vh;constructor(e,t){this.fiberId=e,this.parent=t}add(e,t){this.parent.tell(vl(e=>{e.addChild(t),t.addObserver(()=>{e.removeChild(t)})}))}}let vd=nF(Symbol.for("effect/FiberScope/Global"),()=>new vf),vm=Symbol.for("effect/Fiber"),vg={_E:e=>e,_A:e=>e},vb={[vm]:vg,pipe(){return iw(this,arguments)}},vy=Symbol.for("effect/Fiber"),vx=((e,t)=>e.interruptAsFork(t),e=>pq(pl(e.await),e.inheritAll)),vv=((e,t)=>vv(e,e=>pI(()=>t(e))),nm(2,(e,t)=>({...iV,commit(){return vx(this)},...vb,id:()=>e.id(),await:ps(e.await,d8(t)),children:e.children,inheritAll:e.inheritAll,poll:ps(e.poll,e=>{switch(e._tag){case"None":return pF(s_());case"Some":return nS(d8(e.value,t),px(i4))}}),interruptAsFork:t=>e.interruptAsFork(t)})));({...iV,commit(){return vx(this)},...vb,id:()=>cH,await:pV,children:pF([]),inheritAll:pV,poll:pF(s_()),interruptAsFork:()=>pV}),(e,t)=>({...iV,commit(){return vx(this)},...vb,id:()=>cL(e.id(),t.id()),await:pH(e.await,t.await,(e,t)=>dX(e)?e:t),children:e.children,inheritAll:pJ(t.inheritAll,e.inheritAll),poll:pH(e.poll,t.poll,(e,t)=>{switch(e._tag){case"None":return s_();case"Some":return dX(e.value)?e:t}}),interruptAsFork:r=>nS(pK(e,r),pJ(nS(t,pK(r))),fG)});let vS="effect/FiberCurrent",v_=Symbol.for("effect/Logger"),vw={_Message:e=>e,_Output:e=>e},vk=e=>({[v_]:vw,log:e,pipe(){return iw(this,arguments)}}),vO=nm(2,(e,t)=>vk(r=>e.log({...r,message:t(r.message)}))),vE=nm(2,(e,t)=>vk(r=>e.log(t(r)))),vC=nm(2,(e,t)=>vk(r=>t(r.logLevel)?i4(e.log(r)):s_())),vF=nm(2,(e,t)=>vk(r=>t(e.log(r)))),vR=e=>({[v_]:vw,log:({message:t})=>e(t),pipe(){return iw(this,arguments)}}),vI=nm(2,(e,t)=>vk(r=>[e.log(r),t.log(r)])),vT=nm(2,(e,t)=>vF(vI(e,t),e=>e[0])),vA=nm(2,(e,t)=>vF(vI(e,t),e=>e[1])),vN=/^[^\s"=]*$/,vM=(e,t)=>({annotations:r,cause:n,date:i,fiberId:s,logLevel:a,message:o,spans:l})=>{let u=t=>t.match(vN)?t:e(t),c=(e,t)=>`${xv(e)}=${u(t)}`,h=(e,t)=>" "+c(e,t),f=c("timestamp",i.toISOString());f+=h("level",a.label),f+=h("fiber",cq(s));let p=s2(o);for(let e=0;e<p.length;e++)f+=h("message",ib(p[e],t));for(let e of(n._tag===lW||(f+=h("cause",uS(n,{renderErrorCause:!0}))),l))f+=" "+xS(i.getTime())(e);for(let[e,n]of r)f+=h(e,ib(n,t));return f},vj=vk(vM(e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`)),vP=vk(vM(JSON.stringify,0)),vD=vk(({annotations:e,cause:t,date:r,fiberId:n,logLevel:i,message:s,spans:a})=>{let o=r.getTime(),l={},u={};if(e._size>0)for(let[t,r]of e)l[t]=v$(r);if(c5(a))for(let e of a)u[e.label]=o-e.startTime;let c=s2(s);return{message:1===c.length?v$(c[0]):c.map(v$),logLevel:i.label,timestamp:r.toISOString(),cause:l7(t)?void 0:uS(t,{renderErrorCause:!0}),annotations:l,spans:u,fiberId:cq(n)}}),v$=e=>{switch(typeof e){case"bigint":case"function":case"symbol":return String(e);default:return ip(e)}},vz=vF(vD,iy),vL=(e,...t)=>{let r="";for(let e=0;e<t.length;e++)r+=`\x1b[${t[e]}m`;return r+e+"\x1b[0m"},vU=(e,...t)=>e,vB={bold:"1",red:"31",green:"32",yellow:"33",blue:"34",cyan:"36",white:"37",gray:"90",black:"30",bgBrightRed:"101"},vq={None:[],All:[],Trace:[vB.gray],Debug:[vB.blue],Info:[vB.green],Warning:[vB.yellow],Error:[vB.red],Fatal:[vB.bgBrightRed,vB.black]},vJ={None:"",All:"",Trace:"color:gray",Debug:"color:blue",Info:"color:green",Warning:"color:orange",Error:"color:red",Fatal:"background-color:red;color:white"},vH=e=>`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}.${e.getMilliseconds().toString().padStart(3,"0")}`,vV="object"==typeof process&&null!==process&&"object"==typeof process.stdout&&null!==process.stdout,vW=vV&&!0===process.stdout.isTTY,vK=vV||"Deno"in globalThis,vG=e=>{let t=e?.mode??"auto",r="browser"===("auto"===t?vK?"tty":"browser":t),n="boolean"==typeof e?.colors?e.colors:vW||r,i=e?.formatDate??vH;return r?vQ({colors:n,formatDate:i}):vZ({colors:n,formatDate:i,stderr:e?.stderr===!0})},vZ=e=>{let t="object"==typeof process&&"isBun"in process&&!0===process.isBun,r=e.colors?vL:vU;return vk(({annotations:n,cause:i,context:s,date:a,fiberId:o,logLevel:l,message:u,spans:c})=>{let h=uJ(bO(s,gH),gI).unsafe,f=!0===e.stderr?h.error:h.log,p=s2(u),d=r(`[${e.formatDate(a)}]`,vB.white)+` ${r(l.label,...vq[l._tag])}`+` (${cq(o)})`;if(c5(c)){let e=xS(a.getTime());for(let t of c)d+=" "+e(t)}d+=":";let m=0;if(p.length>0){let e=v$(p[0]);"string"==typeof e&&(d+=" "+r(e,vB.bold,vB.cyan),m++)}if(f(d),t||h.group(),l7(i)||f(uS(i,{renderErrorCause:!0})),m<p.length)for(;m<p.length;m++)f(i_(p[m]));if(n._size>0)for(let[e,t]of n)f(r(`${e}:`,vB.bold,vB.white),i_(t));t||h.groupEnd()})},vQ=e=>{let t=e.colors?"%c":"";return vk(({annotations:r,cause:n,context:i,date:s,fiberId:a,logLevel:o,message:l,spans:u})=>{let c=uJ(bO(i,gH),gI).unsafe,h=s2(l),f=`${t}[${e.formatDate(s)}]`,p=[];if(e.colors&&p.push("color:gray"),f+=` ${t}${o.label}${t} (${cq(a)})`,e.colors&&p.push(vJ[o._tag],""),c5(u)){let e=xS(s.getTime());for(let t of u)f+=" "+e(t)}f+=":";let d=0;if(h.length>0){let r=v$(h[0]);"string"==typeof r&&(f+=` ${t}${r}`,e.colors&&p.push("color:deepskyblue"),d++)}if(c.groupCollapsed(f,...p),l7(n)||c.error(uS(n,{renderErrorCause:!0})),d<h.length)for(;d<h.length;d++)c.log(i_(h[d]));if(r._size>0)for(let[t,n]of r){let r=i_(n);e.colors?c.log(`%c${t}:`,"color:gray",r):c.log(`${t}:`,r)}c.groupEnd()})},vY=nF("effect/Logger/prettyLoggerDefault",()=>vG()),vX="effect/MetricBoundaries",v0=Symbol.for(vX);class v1{values;[v0]=v0;constructor(e){this.values=e,this._hash=nS(ir(vX),n7(is(this.values)))}_hash;[n4](){return this._hash}[io](e){return v2(e)&&il(this.values,e.values)}pipe(){return iw(this,arguments)}}let v2=e=>nL(e,v0),v3=e=>new v1(nS(e,s8(ob(1/0)),aU)),v5=Symbol.for("effect/MetricKeyType"),v4="effect/MetricKeyType/Counter",v6=Symbol.for(v4),v8="effect/MetricKeyType/Frequency",v7=Symbol.for(v8),v9="effect/MetricKeyType/Gauge",Se=Symbol.for(v9),St="effect/MetricKeyType/Histogram",Sr=Symbol.for(St),Sn=Symbol.for("effect/MetricKeyType/Summary"),Si={_In:e=>e,_Out:e=>e};class Ss{incremental;bigint;[v5]=Si;[v6]=v6;constructor(e,t){this.incremental=e,this.bigint=t,this._hash=ir(v4)}_hash;[n4](){return this._hash}[io](e){return Sa(e)}pipe(){return iw(this,arguments)}}let Sa=e=>nL(e,v6),So=e=>nL(e,Sr),Sl=Symbol.for("effect/MetricKey"),Su={_Type:e=>e},Sc=az(il);class Sh{name;keyType;description;tags;[Sl]=Su;constructor(e,t,r,n=[]){this.name=e,this.keyType=t,this.description=r,this.tags=n,this._hash=nS(ir(this.name+this.description),n7(n6(this.keyType)),n7(is(this.tags)))}_hash;[n4](){return this._hash}[io](e){return Sf(e)&&this.name===e.name&&il(this.keyType,e.keyType)&&il(this.description,e.description)&&Sc(this.tags,e.tags)}pipe(){return iw(this,arguments)}}let Sf=e=>nL(e,Sl),Sp=nm(2,(e,t)=>0===t.length?e:new Sh(e.name,e.keyType,e.description,aw(e.tags,t))),Sd=Symbol.for("effect/MutableHashMap"),Sm={[Sd]:Sd,[Symbol.iterator](){return new Sg(this)},toString(){return id(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(ip)}},[ih](){return this.toJSON()},pipe(){return iw(this,arguments)}};class Sg{self;referentialIterator;bucketIterator;constructor(e){this.self=e,this.referentialIterator=e.referential[Symbol.iterator]()}next(){if(void 0!==this.bucketIterator)return this.bucketIterator.next();let e=this.referentialIterator.next();return e.done?(this.bucketIterator=new Sb(this.self.buckets.values()),this.next()):e}[Symbol.iterator](){return new Sg(this.self)}}class Sb{backing;constructor(e){this.backing=e}currentBucket;next(){if(void 0===this.currentBucket){let e=this.backing.next();if(e.done)return e;this.currentBucket=e.value[Symbol.iterator]()}let e=this.currentBucket.next();return e.done?(this.currentBucket=void 0,this.next()):e}}let Sy=()=>{let e=Object.create(Sm);return e.referential=new Map,e.buckets=new Map,e.bucketsSize=0,e},Sx=nm(2,(e,t)=>{if(!1===ic(t))return e.referential.has(t)?i4(e.referential.get(t)):s_();let r=t[n4](),n=e.buckets.get(r);return void 0===n?s_():Sv(e,n,t)}),Sv=(e,t,r,n=!1)=>{for(let i=0,s=t.length;i<s;i++)if(r[io](t[i][0])){let r=t[i][1];return n&&(t.splice(i,1),e.bucketsSize--),i4(r)}return s_()},SS=nm(2,(e,t)=>i3(Sx(e,t))),S_=nm(3,(e,t,r)=>{if(!1===ic(t))return e.referential.set(t,r),e;let n=t[n4](),i=e.buckets.get(n);return void 0===i?e.buckets.set(n,[[t,r]]):(Sw(e,i,t),i.push([t,r])),e.bucketsSize++,e}),Sw=(e,t,r)=>{for(let n=0,i=t.length;n<i;n++)if(r[io](t[n][0])){t.splice(n,1),e.bucketsSize--;return}},Sk=nm(2,(e,t)=>{if(!1===ic(t))return e.referential.delete(t),e;let r=t[n4](),n=e.buckets.get(r);return void 0===n||(Sw(e,n,t),0===n.length&&e.buckets.delete(r)),e}),SO=e=>e.referential.size+e.bucketsSize,SE=Symbol.for("effect/MetricState"),SC="effect/MetricState/Counter",SF=Symbol.for(SC),SR="effect/MetricState/Frequency",SI=Symbol.for(SR),ST="effect/MetricState/Gauge",SA=Symbol.for(ST),SN="effect/MetricState/Histogram",SM=Symbol.for(SN),Sj="effect/MetricState/Summary",SP=Symbol.for(Sj),SD={_A:e=>e};class S${count;[SE]=SD;[SF]=SF;constructor(e){this.count=e}[n4](){return nS(n6(SC),n7(n6(this.count)),ia(this))}[io](e){return SJ(e)&&this.count===e.count}pipe(){return iw(this,arguments)}}let Sz=az(il);class SL{occurrences;[SE]=SD;[SI]=SI;constructor(e){this.occurrences=e}_hash;[n4](){return nS(ir(SR),n7(is(s1(this.occurrences.entries()))),ia(this))}[io](e){return SH(e)&&Sz(s1(this.occurrences.entries()),s1(e.occurrences.entries()))}pipe(){return iw(this,arguments)}}class SU{value;[SE]=SD;[SA]=SA;constructor(e){this.value=e}[n4](){return nS(n6(ST),n7(n6(this.value)),ia(this))}[io](e){return SV(e)&&this.value===e.value}pipe(){return iw(this,arguments)}}class SB{buckets;count;min;max;sum;[SE]=SD;[SM]=SM;constructor(e,t,r,n,i){this.buckets=e,this.count=t,this.min=r,this.max=n,this.sum=i}[n4](){return nS(n6(SN),n7(n6(this.buckets)),n7(n6(this.count)),n7(n6(this.min)),n7(n6(this.max)),n7(n6(this.sum)),ia(this))}[io](e){return SW(e)&&il(this.buckets,e.buckets)&&this.count===e.count&&this.min===e.min&&this.max===e.max&&this.sum===e.sum}pipe(){return iw(this,arguments)}}class Sq{error;quantiles;count;min;max;sum;[SE]=SD;[SP]=SP;constructor(e,t,r,n,i,s){this.error=e,this.quantiles=t,this.count=r,this.min=n,this.max=i,this.sum=s}[n4](){return nS(n6(Sj),n7(n6(this.error)),n7(n6(this.quantiles)),n7(n6(this.count)),n7(n6(this.min)),n7(n6(this.max)),n7(n6(this.sum)),ia(this))}[io](e){return SK(e)&&this.error===e.error&&il(this.quantiles,e.quantiles)&&this.count===e.count&&this.min===e.min&&this.max===e.max&&this.sum===e.sum}pipe(){return iw(this,arguments)}}let SJ=e=>nL(e,SF),SH=e=>nL(e,SI),SV=e=>nL(e,SA),SW=e=>nL(e,SM),SK=e=>nL(e,SP),SG=Symbol.for("effect/MetricHook"),SZ={_In:e=>e,_Out:e=>e},SQ=e=>({[SG]:SZ,pipe(){return iw(this,arguments)},...e}),SY=BigInt(0),SX=(e,t,r,n,i,s)=>{let a=e,o=t,l=r,u=n,c=i,h=s,f=e,p=t,d=r,m=n,g=i,b=s;for(;;){if(!s9(h))return{quantile:c,value:s_(),consumed:u,rest:[]};if(1===c)return{quantile:c,value:i4(ao(h)),consumed:u+h.length,rest:[]};let e=as(h),t=au(h,t=>t===e),r=c*o,n=a/2*r,i=u+t[0].length,s=Math.abs(i-r);if(i<r-n){f=a,p=o,d=ai(h),m=i,g=c,b=t[1],a=f,o=p,l=d,u=m,c=g,h=b;continue}if(i>r+n)return{quantile:c,value:i2(l)?i4(e):l,consumed:u,rest:h};switch(l._tag){case"None":f=a,p=o,d=ai(h),m=i,g=c,b=t[1],a=f,o=p,l=d,u=m,c=g,h=b;continue;case"Some":if(s<Math.abs(r-l.value)){f=a,p=o,d=ai(h),m=i,g=c,b=t[1],a=f,o=p,l=d,u=m,c=g,h=b;continue}return{quantile:c,value:i4(l.value),consumed:u,rest:h}}}throw Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")},S0=Symbol.for("effect/MetricPair"),S1={_Type:e=>e},S2=(e,t)=>({[S0]:S1,metricKey:e,metricState:t,pipe(){return iw(this,arguments)}}),S3=Symbol.for("effect/MetricRegistry");class S5{[S3]=S3;map=Sy();snapshot(){let e=[];for(let[t,r]of this.map)e.push(S2(t,r.get()));return e}get(e){let t=nS(this.map,Sx(e),sF);if(null!=t)return t;if(Sa(e.keyType))return this.getCounter(e);if(nL(e.keyType,Se))return this.getGauge(e);if(nL(e.keyType,v7))return this.getFrequency(e);if(So(e.keyType))return this.getHistogram(e);if(nL(e.keyType,Sn))return this.getSummary(e);throw Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}getCounter(e){let t=nS(this.map,Sx(e),sF);if(null==t){let r=(e=>{let t=e.keyType.bigint?SY:0,r=e.keyType.incremental?e.keyType.bigint?e=>e>=SY:e=>e>=0:e=>!0,n=e=>{r(e)&&(t+=e)};return SQ({get:()=>new S$(t),update:n,modify:n})})(e);nS(this.map,SS(e))||nS(this.map,S_(e,r)),t=r}return t}getFrequency(e){let t=nS(this.map,Sx(e),sF);if(null==t){let r=(e=>{let t=new Map;for(let r of e.keyType.preregisteredWords)t.set(r,0);let r=e=>{let r=t.get(e)??0;t.set(e,r+1)};return SQ({get:()=>new SL(t),update:r,modify:r})})(e);nS(this.map,SS(e))||nS(this.map,S_(e,r)),t=r}return t}getGauge(e){let t=nS(this.map,Sx(e),sF);if(null==t){let r,n=(r=e.keyType.bigint?BigInt(0):0,SQ({get:()=>new SU(r),update:e=>{r=e},modify:e=>{r+=e}}));nS(this.map,SS(e))||nS(this.map,S_(e,n)),t=n}return t}getHistogram(e){let t=nS(this.map,Sx(e),sF);if(null==t){let r=(e=>{let t=e.keyType.boundaries.values,r=t.length,n=new Uint32Array(r+1),i=new Float32Array(r),s=0,a=0,o=Number.MAX_VALUE,l=5e-324;nS(t,ap(sg),aF((e,t)=>{i[t]=e}));let u=e=>{let t=0,u=r;for(;t!==u;){let r=Math.floor(t+(u-t)/2);e<=i[r]?u=r:t=r,u===t+1&&(e<=i[t]?u=t:t=u)}n[t]=n[t]+1,s+=1,a+=e,e<o&&(o=e),e>l&&(l=e)};return SQ({get:()=>{let e;return new SB((e={buckets:(()=>{let e=sX(r),t=0;for(let s=0;s<r;s++){let r=i[s];t+=n[s],e[s]=[r,t]}return e})(),count:s,min:o,max:l,sum:a}).buckets,e.count,e.min,e.max,e.sum)},update:u,modify:u})})(e);nS(this.map,SS(e))||nS(this.map,S_(e,r)),t=r}return t}getSummary(e){let t=nS(this.map,Sx(e),sF);if(null==t){let r=(e=>{let{error:t,maxAge:r,maxSize:n,quantiles:i}=e.keyType,s=nS(i,ap(sg)),a=sX(n),o=0,l=0,u=0,c=0,h=0,f=(e,t)=>{n>0&&(a[(o+=1)%n]=[t,e]),c=0===l?e:Math.min(c,e),h=0===l?e:Math.max(h,e),l+=1,u+=e};return SQ({get:()=>{let e;return e={error:t,quantiles:(e=>{let i=[],o=0;for(;o!==n-1;){let t=a[o];if(null!=t){let[n,s]=t,a=cs(e-n);cv(a,ct)&&cy(a,r)&&i.push(s)}o+=1}return((e,t,r)=>{let n=r.length;if(!s9(t))return aE();let i=t[0],s=t.slice(1),a=SX(e,n,s_(),0,i,r),o=aC(a);return s.forEach(t=>{o.push(SX(e,n,a.value,a.consumed,t,a.rest))}),aF(o,e=>[e.quantile,e.value])})(t,s,ap(i,sg))})(Date.now()),count:l,min:c,max:h,sum:u},new Sq(e.error,e.quantiles,e.count,e.min,e.max,e.sum)},update:([e,t])=>f(e,t),modify:([e,t])=>f(e,t)})})(e);nS(this.map,SS(e))||nS(this.map,S_(e,r)),t=r}return t}}let S4=Symbol.for("effect/Metric"),S6={_Type:e=>e,_In:e=>e,_Out:e=>e},S8=nF(Symbol.for("effect/Metric/globalMetricRegistry"),()=>new S5),S7=function(e,t,r,n){let i=Object.assign(e=>pT(e,e=>_n(i,e)),{[S4]:S6,keyType:e,unsafeUpdate:t,unsafeValue:r,unsafeModify:n,register(){return this.unsafeValue([]),this},pipe(){return iw(this,arguments)}});return i},S9=((e,t)=>S7(e.keyType,(r,n)=>e.unsafeUpdate(t(r),n),e.unsafeValue,(r,n)=>e.unsafeModify(t(r),n)),(e,t)=>_e(((e,t)=>new Sh(e,(e=>new Ss(e?.incremental??!1,e?.bigint??!1))(t),sC(t?.description)))(e,t))),_e=e=>{let t,r=new WeakMap,n=n=>{if(0===n.length)return void 0!==t?t:t=S8.get(e);let i=r.get(n);return void 0!==i||(i=S8.get(Sp(e,n)),r.set(n,i)),i};return S7(e.keyType,(e,t)=>n(t).update(e),e=>n(e).get(),(e,t)=>n(t).modify(e))},_t=((e,t)=>S7(e.keyType,e.unsafeUpdate,r=>t(e.unsafeValue(r)),e.unsafeModify),nm(3,(e,t,r)=>_r(e,[new xO(t,r)]))),_r=nm(2,(e,t)=>S7(e.keyType,(r,n)=>e.unsafeUpdate(r,aw(t,n)),r=>e.unsafeValue(aw(t,r)),(r,n)=>e.unsafeModify(r,aw(t,n)))),_n=((e,t,r)=>{let n=e=>_n(t,r(e));return x2(e,e=>pp(ut(e),n))},nm(2,(e,t)=>p8(d_,r=>pI(()=>e.unsafeUpdate(t,r))))),_i=nm(2,(e,t)=>p8(xg,r=>pI(()=>{if(r.has(e)){let n=r.get(e);n.state.completed||(n.state.completed=!0,mb(n.result,t))}})));class _s{count=0;observers=new Set;interrupted=!1;addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}increment(){this.count++,this.observers.forEach(e=>e(this.count))}decrement(){this.count--,this.observers.forEach(e=>e(this.count))}}let _a={Forward:0,Backward:1};class _o{self;stack;direction;count=0;constructor(e,t,r){this.self=e,this.stack=t,this.direction=r}clone(){return new _o(this.self,this.stack.slice(),this.direction)}reversed(){return new _o(this.self,this.stack.slice(),this.direction===_a.Forward?_a.Backward:_a.Forward)}next(){let e=this.entry;switch(this.count++,this.direction===_a.Forward?this.moveNext():this.movePrev(),e._tag){case"None":return{done:!0,value:this.count};case"Some":return{done:!1,value:e.value}}}get key(){return this.stack.length>0?i4(this.stack[this.stack.length-1].key):s_()}get value(){return this.stack.length>0?i4(this.stack[this.stack.length-1].value):s_()}get entry(){return sA(aa(this.stack),e=>[e.key,e.value])}get index(){let e=0,t=this.stack;if(0===t.length){let e=this.self._root;return null!=e?e.count:0}null!=t[t.length-1].left&&(e=t[t.length-1].left.count);for(let r=t.length-2;r>=0;--r)t[r+1]===t[r].right&&(++e,null!=t[r].left&&(e+=t[r].left.count));return e}moveNext(){let e=this.stack;if(0===e.length)return;let t=e[e.length-1];if(null!=t.right)for(t=t.right;null!=t;)e.push(t),t=t.left;else for(e.pop();e.length>0&&e[e.length-1].right===t;)t=e[e.length-1],e.pop()}get hasNext(){let e=this.stack;if(0===e.length)return!1;if(null!=e[e.length-1].right)return!0;for(let t=e.length-1;t>0;--t)if(e[t-1].left===e[t])return!0;return!1}movePrev(){let e=this.stack;if(0===e.length)return;let t=e[e.length-1];if(null!=t&&null!=t.left)for(t=t.left;null!=t;)e.push(t),t=t.right;else for(e.pop();e.length>0&&e[e.length-1].left===t;)t=e[e.length-1],e.pop()}get hasPrev(){let e=this.stack;if(0===e.length)return!1;if(null!=e[e.length-1].left)return!0;for(let t=e.length-1;t>0;--t)if(e[t-1].right===e[t])return!0;return!1}}let _l={Red:0,Black:1},_u=({color:e,count:t,key:r,left:n,right:i,value:s})=>({color:e,key:r,value:s,left:n,right:i,count:t});function _c(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e.color=t.color,e.count=t.count}let _h=({count:e,key:t,left:r,right:n,value:i},s)=>({color:s,key:t,value:i,left:r,right:n,count:e}),_f=e=>{e.count=1+(e.left?.count??0)+(e.right?.count??0)},_p="effect/RedBlackTree",_d=Symbol.for(_p),_m={[_d]:{_Key:e=>e,_Value:e=>e},[n4](){let e=n6(_p);for(let t of this)e^=nS(n6(t[0]),n7(n6(t[1])));return ia(this,e)},[io](e){if(_b(e)){if((this._root?.count??0)!==(e._root?.count??0))return!1;let t=Array.from(e);return Array.from(this).every((e,r)=>{let n=t[r];return il(e[0],n[0])&&il(e[1],n[1])})}return!1},[Symbol.iterator](){let e=[],t=this._root;for(;null!=t;)e.push(t),t=t.left;return new _o(this,e,_a.Forward)},toString(){return id(this.toJSON())},toJSON(){return{_id:"RedBlackTree",values:Array.from(this).map(ip)}},[ih](){return this.toJSON()},pipe(){return iw(this,arguments)}},_g=(e,t)=>{let r=Object.create(_m);return r._ord=e,r._root=t,r},_b=e=>nL(e,_d),_y=e=>_g(e,void 0),_x=((e,t)=>{let r=_y(t);for(let[t,n]of e)r=_S(r,t,n);return r},nm(2,(e,t)=>{let r=e._ord,n=e._root;for(;void 0!==n;){let e=r(t,n.key);if(il(t,n.key))return i4(n.value);n=e<=0?n.left:n.right}return s_()})),_v=nm(2,(e,t)=>i3(_x(e,t))),_S=nm(3,(e,t,r)=>{let n=e._ord,i=e._root,s=[],a=[];for(;null!=i;){let e=n(t,i.key);s.push(i),a.push(e),i=e<=0?i.left:i.right}s.push({color:_l.Red,key:t,value:r,left:void 0,right:void 0,count:1});for(let e=s.length-2;e>=0;--e){let t=s[e];a[e]<=0?s[e]={color:t.color,key:t.key,value:t.value,left:s[e+1],right:t.right,count:t.count+1}:s[e]={color:t.color,key:t.key,value:t.value,left:t.left,right:s[e+1],count:t.count+1}}for(let e=s.length-1;e>1;--e){let t=s[e-1],r=s[e];if(t.color===_l.Black||r.color===_l.Black)break;let n=s[e-2];if(n.left===t)if(t.left===r){let i=n.right;if(i&&i.color===_l.Red)t.color=_l.Black,n.right=_h(i,_l.Black),n.color=_l.Red,e-=1;else{if(n.color=_l.Red,n.left=t.right,t.color=_l.Black,t.right=n,s[e-2]=t,s[e-1]=r,_f(n),_f(t),e>=3){let r=s[e-3];r.left===n?r.left=t:r.right=t}break}}else{let i=n.right;if(i&&i.color===_l.Red)t.color=_l.Black,n.right=_h(i,_l.Black),n.color=_l.Red,e-=1;else{if(t.right=r.left,n.color=_l.Red,n.left=r.right,r.color=_l.Black,r.left=t,r.right=n,s[e-2]=r,s[e-1]=t,_f(n),_f(t),_f(r),e>=3){let t=s[e-3];t.left===n?t.left=r:t.right=r}break}}else if(t.right===r){let i=n.left;if(i&&i.color===_l.Red)t.color=_l.Black,n.left=_h(i,_l.Black),n.color=_l.Red,e-=1;else{if(n.color=_l.Red,n.right=t.left,t.color=_l.Black,t.left=n,s[e-2]=t,s[e-1]=r,_f(n),_f(t),e>=3){let r=s[e-3];r.right===n?r.right=t:r.left=t}break}}else{let i=n.left;if(i&&i.color===_l.Red)t.color=_l.Black,n.left=_h(i,_l.Black),n.color=_l.Red,e-=1;else{if(t.left=r.right,n.color=_l.Red,n.right=r.left,r.color=_l.Black,r.right=t,r.left=n,s[e-2]=r,s[e-1]=t,_f(n),_f(t),_f(r),e>=3){let t=s[e-3];t.right===n?t.right=r:t.left=r}break}}}return s[0].color=_l.Black,_g(e._ord,s[0])}),__=(e,t)=>{let r=e[Symbol.iterator](),n=0;return{[Symbol.iterator]:()=>__(e,t),next:()=>{n++;let e=r.key;switch(t===_a.Forward?r.moveNext():r.movePrev(),e._tag){case"None":return{done:!0,value:n};case"Some":return{done:!1,value:e.value}}}}},_w=nm(2,(e,t)=>{let r=e._root;void 0!==r&&_O(r,(e,r)=>(t(e,r),s_()))}),_k=nm(2,(e,t)=>{if(!_v(e,t))return e;let r=e._ord,n=e._root,i=[];for(;void 0!==n;){let e=r(t,n.key);i.push(n),n=il(t,n.key)?void 0:e<=0?n.left:n.right}if(0===i.length)return e;let s=Array(i.length),a=i[i.length-1];s[s.length-1]={color:a.color,key:a.key,value:a.value,left:a.left,right:a.right,count:a.count};for(let e=i.length-2;e>=0;--e)(a=i[e]).left===i[e+1]?s[e]={color:a.color,key:a.key,value:a.value,left:s[e+1],right:a.right,count:a.count}:s[e]={color:a.color,key:a.key,value:a.value,left:a.left,right:s[e+1],count:a.count};if(void 0!==(a=s[s.length-1]).left&&void 0!==a.right){let e=s.length;for(a=a.left;null!=a.right;)s.push(a),a=a.right;let t=s[e-1];s.push({color:a.color,key:t.key,value:t.value,left:a.left,right:a.right,count:a.count}),s[e-1].key=a.key,s[e-1].value=a.value;for(let t=s.length-2;t>=e;--t)a=s[t],s[t]={color:a.color,key:a.key,value:a.value,left:a.left,right:s[t+1],count:a.count};s[e-1].left=s[e]}if((a=s[s.length-1]).color===_l.Red){let e=s[s.length-2];e.left===a?e.left=void 0:e.right===a&&(e.right=void 0),s.pop();for(let e=0;e<s.length;++e)s[e].count--}else if(void 0!==a.left||void 0!==a.right){void 0!==a.left?_c(a,a.left):void 0!==a.right&&_c(a,a.right),a.color=_l.Black;for(let e=0;e<s.length-1;++e)s[e].count--}else{if(1===s.length)return _g(r,void 0);for(let e=0;e<s.length;++e)s[e].count--;let e=s[s.length-2];_E(s),e.left===a?e.left=void 0:e.right=void 0}return _g(r,s[0])}),_O=(e,t)=>{let r,n=e,i=!1;for(;!i;)if(null!=n)r=o0(n,r),n=n.left;else if(null!=r){let e=t(r.value.key,r.value.value);if(i3(e))return e;n=r.value.right,r=r.previous}else i=!0;return s_()},_E=e=>{let t,r,n,i;for(let s=e.length-1;s>=0;--s){if(t=e[s],0===s){t.color=_l.Black;return}if((r=e[s-1]).left===t){if(void 0!==(n=r.right)&&void 0!==n.right&&n.right.color===_l.Red){if(i=(n=r.right=_u(n)).right=_u(n.right),r.right=n.left,n.left=r,n.right=i,n.color=r.color,t.color=_l.Black,r.color=_l.Black,i.color=_l.Black,_f(r),_f(n),s>1){let t=e[s-2];t.left===r?t.left=n:t.right=n}e[s-1]=n;return}if(void 0!==n&&void 0!==n.left&&n.left.color===_l.Red){if(i=(n=r.right=_u(n)).left=_u(n.left),r.right=i.left,n.left=i.right,i.left=r,i.right=n,i.color=r.color,r.color=_l.Black,n.color=_l.Black,t.color=_l.Black,_f(r),_f(n),_f(i),s>1){let t=e[s-2];t.left===r?t.left=i:t.right=i}e[s-1]=i;return}if(void 0!==n&&n.color===_l.Black)if(r.color===_l.Red){r.color=_l.Black,r.right=_h(n,_l.Red);return}else{r.right=_h(n,_l.Red);continue}if(void 0!==n){if(r.right=(n=_u(n)).left,n.left=r,n.color=r.color,r.color=_l.Red,_f(r),_f(n),s>1){let t=e[s-2];t.left===r?t.left=n:t.right=n}e[s-1]=n,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s+=2}}else{if(void 0!==(n=r.left)&&void 0!==n.left&&n.left.color===_l.Red){if(i=(n=r.left=_u(n)).left=_u(n.left),r.left=n.right,n.right=r,n.left=i,n.color=r.color,t.color=_l.Black,r.color=_l.Black,i.color=_l.Black,_f(r),_f(n),s>1){let t=e[s-2];t.right===r?t.right=n:t.left=n}e[s-1]=n;return}if(void 0!==n&&void 0!==n.right&&n.right.color===_l.Red){if(i=(n=r.left=_u(n)).right=_u(n.right),r.left=i.right,n.right=i.left,i.right=r,i.left=n,i.color=r.color,r.color=_l.Black,n.color=_l.Black,t.color=_l.Black,_f(r),_f(n),_f(i),s>1){let t=e[s-2];t.right===r?t.right=i:t.left=i}e[s-1]=i;return}if(void 0!==n&&n.color===_l.Black)if(r.color===_l.Red){r.color=_l.Black,r.left=_h(n,_l.Red);return}else{r.left=_h(n,_l.Red);continue}if(void 0!==n){if(r.left=(n=_u(n)).right,n.right=r,n.color=r.color,r.color=_l.Red,_f(r),_f(n),s>1){let t=e[s-2];t.right===r?t.right=n:t.left=n}e[s-1]=n,e[s]=r,s+1<e.length?e[s+1]=t:e.push(t),s+=2}}}},_C=Symbol.for("effect/SortedSet"),_F={[_C]:{_A:e=>e},[n4](){return nS(n6(this.keyTree),n7(n6(_C)),ia(this))},[io](e){return _I(e)&&il(this.keyTree,e.keyTree)},[Symbol.iterator](){return __(this.keyTree,_a.Forward)},toString(){return id(this.toJSON())},toJSON(){return{_id:"SortedSet",values:Array.from(this).map(ip)}},[ih](){return this.toJSON()},pipe(){return iw(this,arguments)}},_R=e=>{let t=Object.create(_F);return t.keyTree=e,t},_I=e=>nL(e,_C),_T=((e,t)=>_v(e.keyTree,t)?e:_R(_S(e.keyTree,t,!0)),Symbol.for("effect/Supervisor")),_A={_T:e=>e};class _N{underlying;value0;[_T]=_A;constructor(e,t){this.underlying=e,this.value0=t}get value(){return this.value0}onStart(e,t,r,n){this.underlying.onStart(e,t,r,n)}onEnd(e,t){this.underlying.onEnd(e,t)}onEffect(e,t){this.underlying.onEffect(e,t)}onSuspend(e){this.underlying.onSuspend(e)}onResume(e){this.underlying.onResume(e)}map(e){return new _N(this,nS(this.value,px(e)))}zip(e){return new _M(this,e)}}class _M{left;right;_tag="Zip";[_T]=_A;constructor(e,t){this.left=e,this.right=t}get value(){return pB(this.left.value,this.right.value)}onStart(e,t,r,n){this.left.onStart(e,t,r,n),this.right.onStart(e,t,r,n)}onEnd(e,t){this.left.onEnd(e,t),this.right.onEnd(e,t)}onEffect(e,t){this.left.onEffect(e,t),this.right.onEffect(e,t)}onSuspend(e){this.left.onSuspend(e),this.right.onSuspend(e)}onResume(e){this.left.onResume(e),this.right.onResume(e)}map(e){return new _N(this,nS(this.value,px(e)))}zip(e){return new _M(this,e)}}let _j=e=>nL(e,_T)&&nU(e,"Zip");class _P{[_T]=_A;fibers=new Set;get value(){return pI(()=>Array.from(this.fibers))}onStart(e,t,r,n){this.fibers.add(n)}onEnd(e,t){this.fibers.delete(t)}onEffect(e,t){}onSuspend(e){}onResume(e){}map(e){return new _N(this,nS(this.value,px(e)))}zip(e){return new _M(this,e)}onRun(e,t){return e()}}class _D{effect;[_T]=_A;constructor(e){this.effect=e}get value(){return this.effect}onStart(e,t,r,n){}onEnd(e,t){}onEffect(e,t){}onSuspend(e){}onResume(e){}map(e){return new _N(this,nS(this.value,px(e)))}zip(e){return new _M(this,e)}onRun(e,t){return e()}}let _$=pI(()=>new _P),_z=nF("effect/Supervisor/none",()=>new _D(pj)),_L="Empty",_U="AddSupervisor",_B="RemoveSupervisor",_q="AndThen",_J={_tag:_L},_H=(e,t)=>({_tag:_q,first:e,second:t}),_V=(e,t)=>il(e,t)?_z:_j(e)?_V(e.left,t).zip(_V(e.right,t)):e,_W=e=>il(e,_z)?lT():_j(e)?nS(_W(e.left),lU(_W(e.right))):lH(e),_K=h0({empty:_J,patch:(e,t)=>((e,t)=>{let r=e,n=t;for(;o$(n);){let e=oL(n);switch(e._tag){case _L:n=oV(n);break;case _U:r=r.zip(e.supervisor),n=oV(n);break;case _B:r=_V(r,e.supervisor),n=oV(n);break;case _q:n=oC(e.first)(oC(e.second)(oV(n)))}}return r})(t,ob(e)),combine:_H,diff:(e,t)=>{if(il(e,t))return _J;let r=_W(e),n=_W(t),i=nS(n,lL(r),lq(_J,(e,t)=>_H(e,{_tag:_U,supervisor:t}))),s=nS(r,lL(n),lq(_J,(e,t)=>_H(e,{_tag:_B,supervisor:t})));return _H(i,s)}}),_G=S9("effect_fiber_started",{incremental:!0}),_Z=S9("effect_fiber_active"),_Q=S9("effect_fiber_successes",{incremental:!0}),_Y=S9("effect_fiber_failures",{incremental:!0}),_X=_t(_e((n=(e=>nS(s0(e.count-1,t=>e.start*Math.pow(e.factor,t)),ow,v3))({start:.5,factor:2,count:35}),new Sh("effect_fiber_lifetimes",new class e{boundaries;[v5]=Si;[Sr]=Sr;constructor(e){this.boundaries=e,this._hash=nS(ir(St),n7(n6(this.boundaries)))}_hash;[n4](){return this._hash}[io](e){return So(e)&&il(this.boundaries,e.boundaries)}pipe(){return iw(this,arguments)}}(n),sC(i)))),"time_unit","milliseconds"),_0="Continue",_1="Yield",_2={_E:e=>e,_A:e=>e},_3=e=>{throw Error(`BUG: FiberRuntime - ${ib(e)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},_5=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),_4=nF("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),_6={[iF]:(e,t,r)=>n2(()=>t.effect_instruction_i1(r)),OnStep:(e,t,r)=>mr(mr(r)),[iR]:(e,t,r)=>n2(()=>t.effect_instruction_i2(r)),[iD]:(e,t,r)=>(e.patchRuntimeFlags(e.currentRuntimeFlags,t.patch),fe(e.currentRuntimeFlags)&&e.isInterrupted())?d4(e.getInterruptedCause()):mr(r),[iN]:(e,t,r)=>(n2(()=>t.effect_instruction_i2(r)),n2(()=>t.effect_instruction_i0()))?(e.pushStack(t),n2(()=>t.effect_instruction_i1())):pj,[iM]:(e,t,r)=>{let n=n2(()=>t.effect_instruction_i0.next(r));return n.done?mr(n.value):(e.pushStack(t),function(e){if("object"==typeof e&&null!==e&&nY in e)return e[nY]();throw Error(nW("yieldWrapGet"))}(n.value))}},_8={[vn]:(e,t,r,n)=>(e.processNewInterruptSignal(n.cause),fe(t)?d4(n.cause):r),[vs]:(e,t,r,n)=>{throw Error("It is illegal to have multiple concurrent run loops in a single fiber")},[vi]:(e,t,r,n)=>(n.onFiber(e,bW(t)),r),[va]:(e,t,r,n)=>ps(pU(),()=>r)},_7=i$();class _9 extends bc{[vm]=vg;[vy]=_2;_fiberRefs;_fiberId;_queue=[];_children=null;_observers=[];_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_isYielding=!1;currentRuntimeFlags;currentOpCount=0;currentSupervisor;currentScheduler;currentTracer;currentSpan;currentContext;currentDefaultServices;constructor(e,t,r){if(super(),this.currentRuntimeFlags=r,this._fiberId=e,this._fiberRefs=t,fs(r)){let e=this.getFiberRef(d_);_G.unsafeUpdate(1,e),_Z.unsafeUpdate(1,e)}this.refreshRefCache()}commit(){return vx(this)}id(){return this._fiberId}resume(e){this.tell(vu(e))}get status(){return this.ask((e,t)=>t)}get runtimeFlags(){return this.ask((e,t)=>t._tag===bz?e.currentRuntimeFlags:t.runtimeFlags)}scope(){return new vp(this.id(),this)}get children(){return this.ask(e=>Array.from(e.getChildren()))}getChildren(){return null===this._children&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(dk)}fiberRefs(){return this.ask(e=>e.getFiberRefs())}ask(e){return pR(()=>{let t=ml(this._fiberId);return this.tell(vl((r,n)=>{mb(t,pI(()=>e(r,n)))})),mh(t)})}tell(e){this._queue.push(e),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return fX(e=>{let t=t=>e(pF(t));return this.tell(vl((e,r)=>{null!==e._exitValue?t(this._exitValue):e.addObserver(t)})),pI(()=>this.tell(vl((e,r)=>{e.removeObserver(t)})))},this.id())}get inheritAll(){return fV((e,t)=>{let r=e.id(),n=e.getFiberRefs(),i=t.runtimeFlags,s=bv(n,r,this.getFiberRefs());return e.setFiberRefs(s),pP(nS(fo(i,e.getFiberRef(wU)),h4(1),h4(16)))})}get poll(){return pI(()=>sC(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(e){return pI(()=>this.tell(vo(l5(e))))}unsafeInterruptAsFork(e){this.tell(vo(l5(e)))}addObserver(e){null!==this._exitValue?e(this._exitValue):this._observers.push(e)}removeObserver(e){this._observers=this._observers.filter(t=>t!==e)}getFiberRefs(){return this.setFiberRef(wU,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef(e){this._fiberRefs=bw(this._fiberRefs,e)}getFiberRef(e){return this._fiberRefs.locals.has(e)?this._fiberRefs.locals.get(e)[0][1]:e.initial}setFiberRef(e,t){this._fiberRefs=bE(this._fiberRefs,{fiberId:this._fiberId,fiberRef:e,value:t}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(gH),this.currentTracer=this.currentDefaultServices.unsafeMap.get(gD.key),this.currentSupervisor=this.getFiberRef(wB),this.currentScheduler=this.getFiberRef(xm),this.currentContext=this.getFiberRef(dh),this.currentSpan=this.currentContext.unsafeMap.get(g$.key)}setFiberRefs(e){this._fiberRefs=e,this.refreshRefCache()}addChild(e){this.getChildren().add(e)}removeChild(e){this.getChildren().delete(e)}transferChildren(e){let t=this._children;if(this._children=null,null!==t&&t.size>0)for(let r of t)null===r._exitValue&&e.add(this.currentRuntimeFlags,r)}drainQueueOnCurrentThread(){let e=!0;for(;e;){let t=_0,r=globalThis[vS];globalThis[vS]=this;try{for(;t===_0;)t=0===this._queue.length?"Done":this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[vS]=r}this._queue.length>0&&!this._running?(this._running=!0,t===_1?(this.drainQueueLaterOnExecutor(),e=!1):e=!0):e=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(df))}drainQueueWhileRunning(e,t){let r=t;for(;this._queue.length>0;){let t=this._queue.splice(0,1)[0];r=_8[t._tag](this,e,r,t)}return r}isInterrupted(){return!l7(this.getFiberRef(dk))}addInterruptedCause(e){let t=this.getFiberRef(dk);this.setFiberRef(dk,l6(t,e))}processNewInterruptSignal(e){this.addInterruptedCause(e),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(null===this._children||0===this._children.size)return!1;let e=!1;for(let t of this._children)t.tell(vo(l5(this.id()))),e=!0;return e}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let e=this._children.values();this._children=null;let t=!1;return p$({while:()=>!t,body:()=>{let r=e.next();return r.done?pI(()=>{t=!0}):fG(r.value.await)},step:()=>{}})}return null}reportExitValue(e){if(fs(this.currentRuntimeFlags)){let t=this.getFiberRef(d_),r=this.id().startTimeMillis,n=Date.now();switch(_X.unsafeUpdate(n-r,t),_Z.unsafeUpdate(-1,t),e._tag){case iI:_Q.unsafeUpdate(1,t);break;case iE:_Y.unsafeUpdate(1,t)}}if("Failure"===e._tag){let t=this.getFiberRef(dv);ue(e.cause)||"Some"!==t._tag||this.log("Fiber terminated with an unhandled error",e.cause,t)}}setExitValue(e){this._exitValue=e,this.reportExitValue(e);for(let t=this._observers.length-1;t>=0;t--)this._observers[t](e);this._observers=[]}getLoggers(){return this.getFiberRef(wl)}log(e,t,r){let n=i3(r)?r.value:this.getFiberRef(dm);if(bK(this.getFiberRef(we),n))return;let i=this.getFiberRef(dg),s=this.getFiberRef(dd),a=this.getLoggers(),o=this.getFiberRefs();if(lV(a)>0){let r=new Date(uJ(this.getFiberRef(gH),mq).unsafeCurrentTimeMillis());((e,t)=>{let r=iS.fiberRefs;iS.fiberRefs=e;try{return t()}finally{iS.fiberRefs=r}})(o,()=>{for(let l of a)l.log({fiberId:this.id(),logLevel:n,message:e,cause:t,context:o,spans:i,annotations:s,date:r})})}}evaluateMessageWhileSuspended(e){switch(e._tag){case va:return _1;case vn:return this.processNewInterruptSignal(e.cause),null!==this._asyncInterruptor&&(this._asyncInterruptor(d4(e.cause)),this._asyncInterruptor=null),_0;case vs:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(e.effect),_0;case vi:return e.onFiber(this,null!==this._exitValue?bH:new bJ(this.currentRuntimeFlags,this._asyncBlockingOn)),_0;default:return _3(e)}}evaluateEffect(e){this.currentSupervisor.onResume(this);try{let t=fe(this.currentRuntimeFlags)&&this.isInterrupted()?d4(this.getInterruptedCause()):e;for(;null!==t;){let e=t,r=this.runLoop(e);if(r===_5){let e=_4.currentOp;_4.currentOp=null,e._op===iP?h8(this.currentRuntimeFlags)?(this.tell(vc()),this.tell(vu(mn)),t=null):t=mn:e._op===ik&&(t=null)}else{this.currentRuntimeFlags=nS(this.currentRuntimeFlags,h9(16));let e=this.interruptAllChildren();null!==e?t=ps(e,()=>r):(0===this._queue.length?this.setExitValue(r):this.tell(vu(r)),t=null)}}}finally{this.currentSupervisor.onSuspend(this)}}start(e){if(this._running)this.tell(vu(e));else{this._running=!0;let t=globalThis[vS];globalThis[vS]=this;try{this.evaluateEffect(e)}finally{this._running=!1,globalThis[vS]=t,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(e){this.tell(vu(e))}patchRuntimeFlags(e,t){let r=fl(e,t);return globalThis[vS]=this,this.currentRuntimeFlags=r,r}initiateAsync(e,t){let r=!1,n=e=>{r||(r=!0,this.tell(vu(e)))};fe(e)&&(this._asyncInterruptor=n);try{t(n)}catch(e){n(pt(l3(e)))}}pushStack(e){this._stack.push(e),"OnStep"===e._op&&this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){let e=this._stack.pop();if(e)return"OnStep"===e._op&&this._steps.pop(),e}getNextSuccessCont(){let e=this.popStack();for(;e;){if(e._op!==iC)return e;e=this.popStack()}}getNextFailCont(){let e=this.popStack();for(;e;){if(e._op!==iF&&e._op!==iN&&e._op!==iM)return e;e=this.popStack()}}Tag(e){return pI(()=>uJ(this.currentContext,e))}Left(e){return f9(e.left)}None(e){return f9(new dV)}Right(e){return mr(e.right)}Some(e){return mr(e.value)}Micro(e){return fQ(t=>{let r=t,n=((e,t)=>{let r=new b9(yJ.context(t?.scheduler??new yz));if(r.evaluate(e),t?.signal)if(t.signal.aborted)r.unsafeInterrupt();else{let e=()=>r.unsafeInterrupt();t.signal.addEventListener("abort",e,{once:!0}),r.addObserver(()=>t.signal.removeEventListener("abort",e))}return r})(yU(e,this.currentContext));return n.addObserver(e=>{if("Success"===e._tag)return r(mr(e.value));switch(e.cause._tag){case"Interrupt":return r(d4(l5(cH)));case"Fail":return r(f9(e.cause.error));case"Die":return r(f4(e.cause.defect))}}),fQ(e=>{r=t=>{e(pj)},n.unsafeInterrupt()})})}[iT](e){let t=n2(()=>e.effect_instruction_i0()),r=this.getNextSuccessCont();return void 0!==r?(r._op in _6||_3(r),_6[r._op](this,r,t)):(_4.currentOp=mr(t),_5)}[iI](e){let t=this.getNextSuccessCont();return void 0!==t?(t._op in _6||_3(t),_6[t._op](this,t,e.effect_instruction_i0)):(_4.currentOp=e,_5)}[iE](e){let t=e.effect_instruction_i0,r=this.getNextFailCont();if(void 0===r)return _4.currentOp=d4(t),_5;switch(r._op){case iC:case iR:if(!(fe(this.currentRuntimeFlags)&&this.isInterrupted()))return n2(()=>r.effect_instruction_i1(t));return d4(ua(t));case"OnStep":if(!(fe(this.currentRuntimeFlags)&&this.isInterrupted()))return mr(d4(t));return d4(ua(t));case iD:if(this.patchRuntimeFlags(this.currentRuntimeFlags,r.patch),fe(this.currentRuntimeFlags)&&this.isInterrupted())return d4(l6(t,this.getInterruptedCause()));return d4(t);default:_3(r)}}[ij](e){return n2(()=>e.effect_instruction_i0(this,bW(this.currentRuntimeFlags)))}Blocked(e){let t=this.getFiberRefs(),r=this.currentRuntimeFlags;if(this._steps.length>0){let n=[],i=this._steps[this._steps.length-1],s=this.popStack();for(;s&&"OnStep"!==s._op;)n.push(s),s=this.popStack();this.setFiberRefs(i.refs),this.currentRuntimeFlags=i.flags;let a=bM(i.refs,t),o=fo(i.flags,r);return mr(fz(e.effect_instruction_i0,fV(t=>{for(;n.length>0;)t.pushStack(n.pop());return t.setFiberRefs(bP(t.id(),t.getFiberRefs())(a)),t.currentRuntimeFlags=fl(o)(t.currentRuntimeFlags),e.effect_instruction_i1})))}return pM(t=>ps(wb((e=>{let t=new fB("RunBlocked");return t.effect_instruction_i0=e,t})(e.effect_instruction_i0)),()=>t(e.effect_instruction_i1)))}RunBlocked(e){return pp((e=>{let t=c7(e),r=c8();for(;;){let[e,n]=hs(t,[fS(),c8()],([e,t],r)=>{let[n,i]=fp(r);return[fw(e,n),he(t,i)]});if(r=fd(r,e),c3(n))return ha(r);t=n}throw Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")})(e.effect_instruction_i0),e=>wm(Array.from(e.map),([e,t])=>{let r=new Map,n=[];for(let e of t)for(let t of(n.push(ov(e)),e))r.set(t.request,t);let i=n.flat();return ds(wK(e.runAll(n),i,()=>i.forEach(e=>{e.listeners.interrupted=!0})),xg,r)},!1,!1))}[iA](e){let t=e.effect_instruction_i0,r=this.currentRuntimeFlags,n=fl(r,t);if(fe(n)&&this.isInterrupted())return d4(this.getInterruptedCause());if(this.patchRuntimeFlags(this.currentRuntimeFlags,t),!e.effect_instruction_i1)return mn;{let t=fo(n,r);return this.pushStack(new fU(t,e)),n2(()=>e.effect_instruction_i1(r))}}[iF](e){return this.pushStack(e),e.effect_instruction_i0}OnStep(e){return this.pushStack(e),e.effect_instruction_i0}[iC](e){return this.pushStack(e),e.effect_instruction_i0}[iR](e){return this.pushStack(e),e.effect_instruction_i0}[ik](e){return this._asyncBlockingOn=e.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,e.effect_instruction_i0),_4.currentOp=e,_5}[iP](e){return this._isYielding=!1,_4.currentOp=e,_5}[iN](e){let t=e.effect_instruction_i0,r=e.effect_instruction_i1;return t()?(this.pushStack(e),r()):mn}[iM](e){return _6[iM](this,e,void 0)}[iO](e){return n2(()=>e.commit())}runLoop(e){let t=e;for(this.currentOpCount=0;;){if((2&this.currentRuntimeFlags)!=0&&this.currentSupervisor.onEffect(this,t),this._queue.length>0&&(t=this.drainQueueWhileRunning(this.currentRuntimeFlags,t)),!this._isYielding){this.currentOpCount+=1;let e=this.currentScheduler.shouldYield(this);if(!1!==e){this._isYielding=!0,this.currentOpCount=0;let r=t;t=ps(pU({priority:e}),()=>r)}}try{if((t=this.currentTracer.context(()=>{if(_7!==t[fL]._V){let e=this.getFiberRef(dS);if("Some"===e._tag){let r=t[fL]._V;this.log(`Executing an Effect versioned ${r} with a Runtime of version ${i$()}, you may want to dedupe the effect dependencies, you can use the language service plugin to detect this at compile time: https://github.com/Effect-TS/language-service`,l1,e)}}return this[t._op](t)},this))===_5){let e=_4.currentOp;if(e._op===iP||e._op===ik)return _5;return _4.currentOp=null,e._op===iI||e._op===iE?e:d4(l3(e))}}catch(e){t=(t===_5||nL(t,"_op"))&&t._op in this?dB(e)?d4(l6(l3(e),l5(cH))):f4(e):f6(`Not a valid effect: ${ib(t)}`)}}}run=()=>{this.drainQueueOnCurrentThread()}}let we=nF("effect/FiberRef/currentMinimumLogLevel",()=>dl(bG("Info"))),wt=e=>vk(t=>{uJ(bO(t.context,gH),gI).unsafe.log(e.log(t))}),wr=nF(Symbol.for("effect/Logger/defaultLogger"),()=>wt(vj)),wn=nF(Symbol.for("effect/Logger/jsonLogger"),()=>wt(vz)),wi=nF(Symbol.for("effect/Logger/logFmtLogger"),()=>wt(vP)),ws=nF(Symbol.for("effect/Logger/prettyLogger"),()=>vY),wa=nF(Symbol.for("effect/Logger/structuredLogger"),()=>wt(vD)),wo=nF(Symbol.for("effect/Logger/tracerLogger"),()=>vk(({annotations:e,cause:t,context:r,fiberId:n,logLevel:i,message:s})=>{let a=uH(bO(r,dh),g$);if("None"===a._tag||"ExternalSpan"===a.value._tag)return;let o=uJ(bO(r,gH),mq),l={};for(let[t,r]of e)l[t]=r;l["effect.fiberId"]=cq(n),l["effect.logLevel"]=i.label,null!==t&&"Empty"!==t._tag&&(l["effect.cause"]=uS(t,{renderErrorCause:!0})),a.value.event(ib(Array.isArray(s)?s[0]:s),o.unsafeCurrentTimeNanos(),l)})),wl=nF(Symbol.for("effect/FiberRef/currentLoggers"),()=>(e=>{let t=h0({empty:hA,combine:(e,t)=>hP(t)(e),diff:(e,t)=>((e,t)=>{let[r,n]=lq([e,hA],([e,t],r)=>lA(r)(e)?[lz(r)(e),t]:[e,hP((e=>{let t=Object.create(hM);return t.value=e,t})(r))(t)])(t);return lq(n,(e,t)=>hP((e=>{let t=Object.create(hj);return t.value=e,t})(t))(e))(r)})(e,t),patch:(e,t)=>hD(t)(e)});return dc(e,{differ:t,fork:t.empty})})(lH(wr,wo))),wu=nm(3,(e,t,r)=>ps(wN,n=>{let i=[],s=pR(()=>{if(0===i.length)return pj;let e=i;return i=[],r(e)});return pM(r=>nS(xx(t),pJ(s),x$,r,wb,ps(e=>dT(n,pW(e))),pJ(wh(()=>s)),fK(vk(t=>{i.push(e.log(t))}))))})),wc=nm(e=>fH(e[0]),(e,t)=>pN(pT(e,e=>wh(r=>t(e,r))))),wh=e=>fV(t=>{let r=t.getFiberRefs(),n=h7(t.currentRuntimeFlags,1);return ps(wN,t=>dA(t,t=>fV(i=>{let s=i.getFiberRefs(),a=i.currentRuntimeFlags,o=bM(s,r),l=fo(a,n),u=bM(r,s);return i.setFiberRefs(bP(o,i.id(),r)),wW(pL(e(t),l),pI(()=>{i.setFiberRefs(bP(u,i.id(),i.getFiberRefs()))}))})))}),wf=((e=>nH(e[0])&&!fH(e[0]),(e,t,r)=>{let n=r?.negate?(e,r)=>px(t(e,r),oo):t;return xy(r?.concurrency,()=>pR(()=>s1(e).reduceRight((e,t,r)=>pH(e,pR(()=>n(t,r)),(e,r)=>r?[t,...e]:e),pI(()=>[]))),()=>px(wp(e,(e,t)=>px(n(e,t),t=>t?i4(e):s_()),r),aM))}),(e,t)=>{let[r,n]=(e=>{if(Array.isArray(e)||nH(e))return[e,s_()];let t=Object.keys(e),r=t.length;return[t.map(t=>e[t]),i4(e=>{let n={};for(let i=0;i<r;i++)n[t[i]]=e[i];return n})]})(e);return t?.mode==="validate"?((e,t,r)=>{let n=[];for(let t of e)n.push(f8(t));return ps(wp(n,ng,{concurrency:r?.concurrency,batching:r?.batching,concurrentFinalizers:r?.concurrentFinalizers}),e=>{let n=s_(),i=e.length,s=Array(i),a=Array(i),o=!1;for(let t=0;t<i;t++){let r=e[t];"Left"===r._tag?(s[t]=i4(r.left),o=!0):(a[t]=r.right,s[t]=n)}return o?"Some"===t._tag?f9(t.value(s)):f9(s):r?.discard?pj:"Some"===t._tag?pF(t.value(a)):pF(a)})})(r,n,t):t?.mode==="either"?((e,t,r)=>{let n=[];for(let t of e)n.push(f8(t));return r?.discard?wp(n,ng,{concurrency:r?.concurrency,batching:r?.batching,discard:!0,concurrentFinalizers:r?.concurrentFinalizers}):px(wp(n,ng,{concurrency:r?.concurrency,batching:r?.batching,concurrentFinalizers:r?.concurrentFinalizers}),e=>"Some"===t._tag?t.value(e):e)})(r,n,t):t?.discard!==!0&&"Some"===n._tag?px(wp(r,ng,t),n.value):wp(r,ng,t)}),wp=((e,t)=>Array.from({length:t},()=>e),nm(e=>nH(e[0]),(e,t,r)=>fV(n=>{let i=r?.batching===!0||r?.batching==="inherit"&&n.getFiberRef(dx);return r?.discard?xb(r.concurrency,()=>wk(bd,r?.concurrentFinalizers)(r=>i?wm(e,(e,n)=>r(t(e,n)),!0,!1,1):pp(e,(e,n)=>r(t(e,n)))),()=>wk(bm,r?.concurrentFinalizers)(r=>wm(e,(e,n)=>r(t(e,n)),i,!1)),n=>wk(bg(n),r?.concurrentFinalizers)(r=>wm(e,(e,n)=>r(t(e,n)),i,!1,n))):xb(r?.concurrency,()=>wk(bd,r?.concurrentFinalizers)(r=>i?wg(e,1,(e,n)=>r(t(e,n)),!0):pf(e,(e,n)=>r(t(e,n)))),()=>wk(bm,r?.concurrentFinalizers)(r=>wd(e,(e,n)=>r(t(e,n)),i)),n=>wk(bg(n),r?.concurrentFinalizers)(r=>wg(e,n,(e,n)=>r(t(e,n)),i)))}))),wd=(e,t,r)=>pR(()=>{let n=s1(e),i=Array(n.length);return pJ(wm(n,(e,r)=>ps(t(e,r),e=>pI(()=>i[r]=e)),r,!1),pF(i))}),wm=(e,t,r,n,i)=>pM(s=>{let a;return a=a=>fV(o=>{let l=Array.from(e).reverse(),u=l.length;if(0===u)return pj;let c=0,h=!1,f=i?Math.min(l.length,i):l.length,p=new Set,d=[],m=[],g=[],b=[],y=()=>{let e=d.filter(({exit:e})=>"Failure"===e._tag).sort((e,t)=>e.index<t.index?-1:+(e.index!==t.index)).map(({exit:e})=>e);return 0===e.length&&e.push(mn),e},x=(e,t=!1)=>{let r=pN(a(e)),n=wx(r,o,o.currentRuntimeFlags,vd);return o.currentScheduler.scheduleTask(()=>{t&&n.unsafeInterruptAsFork(o.id()),n.resume(r)},0),n},v=()=>{n||(u-=l.length,l=[]),h=!0,p.forEach(e=>{e.currentScheduler.scheduleTask(()=>{e.unsafeInterruptAsFork(o.id())},0)})},S=r?po:f7,_=x(fX(e=>{let n=(e,t)=>{"Blocked"===e._op?b.push(e):(d.push({index:t,exit:e}),"Failure"!==e._op||h||v())},a=()=>{if(l.length>0){let f=l.pop(),v=c++,_=e=>l.length>0&&(n(e,v),l.length>0)?(()=>{let e=l.pop();return v=c++,ps(pU(),()=>ps(S(s(t(e,v))),_))})():pF(e),w=x(ps(S(s(t(f,v))),_));m.push(w),p.add(w),h&&w.currentScheduler.scheduleTask(()=>{w.unsafeInterruptAsFork(o.id())},0),w.addObserver(t=>{let s;if(s="Failure"===t._op?t:t.effect_instruction_i0,g.push(w),p.delete(w),n(s,v),d.length===u)e(pF(sk(d2(y(),{parallel:!0}),()=>mn)));else if(b.length+d.length===u){let t=y();e(pF(fz(b.map(e=>e.effect_instruction_i0).reduce(fh),wm([sk(d2(t,{parallel:!0}),()=>mn),...b.map(e=>e.effect_instruction_i1)],e=>e,r,!0,i))))}else a()})}};for(let e=0;e<f;e++)a()}));return fG(p_(pl(s(vx(_))),me({onFailure:e=>{v();let t=b.length+1,r=Math.min("number"==typeof i?i:b.length,b.length),n=Array.from(b);return fX(i=>{let s=[],a=0,o=0,l=(r,o)=>l=>{s[r]=l,++a===t&&i(mr(d4(e))),n.length>0&&o&&u()},u=()=>{x(n.pop(),!0).addObserver(l(o,!0)),o++};_.addObserver(l(o,!1)),o++;for(let e=0;e<r;e++)u()})},onSuccess:()=>pf(g,e=>e.inheritAll)})))}),fV(e=>{let t=nS(e.getFiberRef(dw),sk(()=>e.scope()));return a(ds(dw,i4(t)))})}),wg=(e,t,r,n)=>pR(()=>{let i=s1(e),s=Array(i.length);return pJ(wm(i,(e,t)=>px(r(e,t),e=>s[t]=e),n,!1,t),pF(s))}),wb=e=>wS(e,vd),wy=(e,t,r,n=null)=>{let i=wv(e,t,r,n);return i.resume(e),i},wx=(e,t,r,n=null)=>wv(e,t,r,n),wv=(e,t,r,n=null)=>{let i=cK(),s=bS(t.getFiberRefs(),i),a=new _9(i,s,r),o=bO(s,dh),l=a.currentSupervisor;return l.onStart(o,e,i4(t),a),a.addObserver(e=>l.onEnd(e,a)),(null!==n?n:nS(t.getFiberRef(dw),sk(()=>t.scope()))).add(r,a),a},wS=(e,t)=>fV((r,n)=>pF(wy(e,r,n.runtimeFlags,t))),w_=((e=>"function"==typeof e[2],(e,t,r,n)=>xy(n?.concurrency,()=>s1(e).reduce((e,t,n)=>pH(e,t,(e,t)=>r(e,t,n)),pF(t)),()=>ps(xa(t),t=>ps(wp(e,(e,n)=>ps(e,e=>xc(t,t=>r(t,e,n))),n),()=>t.get)))),e=>mv(t=>sw(uH(t,wA),{onNone:()=>e,onSome:t=>{switch(t.strategy._tag){case"Parallel":return e;case"Sequential":case"ParallelN":return ps(dM(t,bm),t=>wD(e,t))}}}))),ww=e=>t=>mv(r=>sw(uH(r,wA),{onNone:()=>t,onSome:r=>"ParallelN"===r.strategy._tag&&r.strategy.parallelism===e?t:ps(dM(r,bg(e)),e=>wD(t,e))})),wk=(e,t)=>r=>mv(n=>sw(uH(n,wA),{onNone:()=>r(ng),onSome:n=>{if(!0!==t)return r(ng);{let t="Parallel"===e._tag?w_:"Sequential"===e._tag?wC:ww(e.parallelism);switch(n.strategy._tag){case"Parallel":return t(r(w_));case"Sequential":return t(r(wC));case"ParallelN":return t(r(ww(n.strategy.parallelism)))}}}})),wO=e=>ps(wA,e),wE=e=>ps(wP(),t=>p_(e(t),e=>t.close(e))),wC=e=>mv(t=>sw(uH(t,wA),{onNone:()=>e,onSome:t=>{switch(t.strategy._tag){case"Sequential":return e;case"Parallel":case"ParallelN":return ps(dM(t,bd),t=>wD(e,t))}}})),wF=((e=>fH(e[1]),(e,t,r,n)=>pl(wT(f7(e),f7(t),(e,t)=>ma(e,t,{onSuccess:r,onFailure:(e,t)=>n?.concurrent?l4(e,t):l6(e,t)}),n))),nm(e=>fH(e[1]),(e,t,r)=>wT(e,t,(e,t)=>[e,t],r))),wR=nm(e=>fH(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||!1===r.batching)?pq(e,t):wT(e,t,(e,t)=>e,r)),wI=nm(e=>fH(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||!1===r.batching)?pJ(e,t):wT(e,t,(e,t)=>t,r)),wT=nm(e=>fH(e[1]),(e,t,r,n)=>px(wf([e,t],{concurrency:n?.concurrent?2:1,batching:n?.batching,concurrentFinalizers:n?.concurrentFinalizers}),([e,t])=>r(e,t))),wA=uW("effect/Scope"),wN=wA,wM={[dR]:dR,[dI]:dI,pipe(){return iw(this,arguments)},fork(e){return pI(()=>{var t;let r=wj(e);if("Closed"===this.state._tag)return r.state=this.state,r;let n={};return this.state.finalizers.set(n,e=>r.close(e)),t=e=>pI(()=>{"Open"===this.state._tag&&this.state.finalizers.delete(n)}),"Open"===r.state._tag&&r.state.finalizers.set({},t),r})},close(e){return pR(()=>{if("Closed"===this.state._tag)return pj;let t=Array.from(this.state.finalizers.values()).reverse();return(this.state={_tag:"Closed",exit:e},0===t.length)?pj:this.strategy._tag===bf?nS(pf(t,t=>f7(t(e))),ps(e=>nS(d2(e),sA(d1),sk(()=>mn)))):this.strategy._tag===bp?nS(wd(t,t=>f7(t(e)),!1),ps(e=>nS(d2(e,{parallel:!0}),sA(d1),sk(()=>mn)))):nS(wg(t,this.strategy.parallelism,t=>f7(t(e)),!1),ps(e=>nS(d2(e,{parallel:!0}),sA(d1),sk(()=>mn))))})},addFinalizer(e){return pR(()=>"Closed"===this.state._tag?e(this.state.exit):(this.state.finalizers.set({},e),pj))}},wj=(e=bd)=>{let t=Object.create(wM);return t.strategy=e,t.state={_tag:"Open",finalizers:new Map},t},wP=(e=bd)=>pI(()=>wj(e)),wD=nm(2,(e,t)=>mw(e,uV(uL(wA,t)))),w$=nm(2,(e,t)=>nS(e,wD(t),p_(e=>t.close(e)))),wz=nm(2,(e,t)=>fG(wc(ps(p6(e),r=>fK(p7(e,t),r)),t=>p7(e,t)))),wL=nm(2,(e,t)=>p8(e,r=>wz(e,t(r)))),wU=dc(fi,{differ:fu,fork:fu.empty}),wB=dc(_z,{differ:_K,fork:_J}),wq=nm(3,(e,t,r)=>wH(e,t,{onSelfWin:(e,t)=>ps(e.await,n=>{switch(n._tag){case iI:return ps(e.inheritAll,()=>r.onSelfDone(n,t));case iE:return r.onSelfDone(n,t)}}),onOtherWin:(e,t)=>ps(e.await,n=>{switch(n._tag){case iI:return ps(e.inheritAll,()=>r.onOtherDone(n,t));case iE:return r.onOtherDone(n,t)}})})),wJ=nm(2,(e,t)=>pi(r=>wq(e,t,{onSelfDone:(e,t)=>mt(e,{onFailure:e=>nS(vx(t),xW(t=>l4(e,t))),onSuccess:e=>nS(t,pK(r),fK(e))}),onOtherDone:(e,t)=>mt(e,{onFailure:e=>nS(vx(t),xW(t=>l4(t,e))),onSuccess:e=>nS(t,pK(r),fK(e))})}))),wH=nm(3,(e,t,r)=>fV((n,i)=>{let s=i.runtimeFlags,a=cO(!0),o=wv(e,n,s,r.selfScope),l=wv(t,n,s,r.otherScope);return fX(n=>{o.addObserver(()=>wV(o,l,r.onSelfWin,a,n)),l.addObserver(()=>wV(l,o,r.onOtherWin,a,n)),o.startFork(e),l.startFork(t)},cz(o.id(),l.id()))})),wV=(e,t,r,n,i)=>{cE(!0,!1)(n)&&i(r(e,t))},wW=nm(2,(e,t)=>pM(r=>pc(r(e),{onFailure:e=>pc(t,{onFailure:t=>pt(l6(e,t)),onSuccess:()=>pt(e)}),onSuccess:e=>fK(t,e)}))),wK=(e,t,r)=>pi(n=>ps(ps(wb(pb(e)),e=>fX(n=>{let i=t.map(e=>e.listeners.count),s=()=>{i.every(e=>0===e)&&t.every(e=>"Pending"===e.result.state.current._tag||!!("Done"===e.result.state.current._tag&&dY(e.result.state.current.effect)&&"Failure"===e.result.state.current.effect._tag&&l9(e.result.state.current.effect.cause)))&&(a.forEach(e=>e()),r?.(),n(pW(e)))};e.addObserver(e=>{a.forEach(e=>e()),n(e)});let a=t.map((e,t)=>{let r=e=>{i[t]=e,s()};return e.listeners.addObserver(r),()=>e.listeners.removeObserver(r)});return s(),pI(()=>{a.forEach(e=>e())})})),()=>pR(()=>pp(t.flatMap(e=>e.state.completed?[]:[e]),e=>_i(e.request,d7(n)))))),wG=Symbol.for("effect/ScheduleInterval"),wZ={[wG]:wG,startMillis:0,endMillis:0},wQ=(e,t)=>e>t?wZ:{[wG]:wG,startMillis:e,endMillis:t},wY=nm(2,(e,t)=>wX(e,t)===e),wX=nm(2,(e,t)=>e.endMillis<=t.startMillis?e:t.endMillis<=e.startMillis?t:e.startMillis<t.startMillis?e:t.startMillis<e.startMillis?t:e.endMillis<=t.endMillis?e:t),w0=nm(2,(e,t)=>wQ(Math.max(e.startMillis,t.startMillis),Math.min(e.endMillis,t.endMillis))),w1=e=>e.startMillis>=e.endMillis,w2=e=>wQ(e,1/0),w3=Symbol.for("effect/ScheduleIntervals"),w5=e=>({[w3]:w3,intervals:e}),w4=nm(2,(e,t)=>o$(t.intervals)?o$(e.intervals)?oL(e.intervals).startMillis<oL(t.intervals).startMillis?w6(oV(e.intervals),t.intervals,oL(e.intervals),om()):w6(e.intervals,oV(t.intervals),oL(t.intervals),om()):t:e),w6=(e,t,r,n)=>{let i=e,s=t,a=r,o=n;for(;o$(i)||o$(s);)if(!o$(i)&&o$(s))a.endMillis<oL(s).startMillis?(o=nS(o,oC(a)),a=oL(s)):a=wQ(a.startMillis,oL(s).endMillis),s=oV(s),i=om();else if(o$(i)&&oD(s))a.endMillis<oL(i).startMillis?(o=nS(o,oC(a)),a=oL(i)):a=wQ(a.startMillis,oL(i).endMillis),s=om(),i=oV(i);else if(o$(i)&&o$(s))oL(i).startMillis<oL(s).startMillis?(a.endMillis<oL(i).startMillis?(o=nS(o,oC(a)),a=oL(i)):a=wQ(a.startMillis,oL(i).endMillis),i=oV(i)):(a.endMillis<oL(s).startMillis?(o=nS(o,oC(a)),a=oL(s)):a=wQ(a.startMillis,oL(s).endMillis),s=oV(s));else throw Error(nW("Intervals.unionLoop"));return w5(nS(o,oC(a),oS))},w8=nm(2,(e,t)=>w7(e.intervals,t.intervals,om())),w7=(e,t,r)=>{let n=e,i=t,s=r;for(;o$(n)&&o$(i);){let e=nS(oL(n),w0(oL(i))),t=w1(e)?s:nS(s,oC(e));nS(oL(n),wY(oL(i)))?n=oV(n):i=oV(i),s=t}return w5(oS(s))},w9=e=>nS(e.intervals,oz,sk(()=>wZ)).startMillis,ke=nm(2,(e,t)=>w9(e)<w9(t)),kt=((e,t)=>ke(e,t)?t:e,e=>nS(e.intervals,oz,sk(()=>wZ)).endMillis),kr="Continue",kn="Done",ki=e=>({_tag:kr,intervals:e}),ks=e=>({_tag:kr,intervals:w5(ob(e))}),ka={_tag:kn};class ko{permits;waiters=new Set;taken=0;constructor(e){this.permits=e}get free(){return this.permits-this.taken}take=e=>fY(t=>{if(this.free<e){let r=()=>{this.free<e||(this.waiters.delete(r),this.taken+=e,t(pF(e)))};return this.waiters.add(r),pI(()=>{this.waiters.delete(r)})}return this.taken+=e,t(pF(e))});updateTaken=e=>fV(t=>(this.taken=e(this.taken),this.waiters.size>0&&t.getFiberRef(xm).scheduleTask(()=>{let e=this.waiters.values(),t=e.next();for(;!1===t.done&&this.free>0;)t.value(),t=e.next()},t.getFiberRef(df)),pF(this.free)));release=e=>this.updateTaken(t=>t-e);releaseAll=this.updateTaken(e=>0);withPermits=e=>t=>pM(r=>ps(r(this.take(e)),e=>wW(r(t),this.release(e))));withPermitsIfAvailable=e=>t=>pM(r=>pR(()=>this.free<e?xX:(this.taken+=e,wW(r(xF(t)),this.release(e)))))}let kl=e=>new ko(e);class ku extends bc{isOpen;waiters=[];scheduled=!1;constructor(e){super(),this.isOpen=e}commit(){return this.await}unsafeSchedule(e){return this.scheduled||0===this.waiters.length||(this.scheduled=!0,e.currentScheduler.scheduleTask(this.flushWaiters,e.getFiberRef(df))),pj}flushWaiters=()=>{this.scheduled=!1;let e=this.waiters;this.waiters=[];for(let t=0;t<e.length;t++)e[t](mn)};open=fV(e=>this.isOpen?pj:(this.isOpen=!0,this.unsafeSchedule(e)));unsafeOpen(){this.isOpen||(this.isOpen=!0,this.flushWaiters())}release=fV(e=>this.isOpen?pj:this.unsafeSchedule(e));await=fY(e=>this.isOpen?e(pj):(this.waiters.push(e),pI(()=>{let t=this.waiters.indexOf(e);-1!==t&&this.waiters.splice(t,1)})));unsafeClose(){this.isOpen=!1}close=pI(()=>{this.isOpen=!1});whenOpen=e=>pJ(this.await,e)}(e,t)=>{let r=u4(t);return ps(mx,t=>px(k_(s_()),n=>[mS(kh(e,r,n),t),kf(n)]))};let kc=(e,t,r)=>{let n=ch(u4(t));return nS(mu(),pT(t=>py(e,t)),px(e=>i4([r+n,e])))},kh=(e,t,r)=>pM(n=>nS(gW(e=>e.currentTimeMillis),ps(n=>kk(r,r=>{switch(r._tag){case"None":return i4(kc(e,t,n));case"Some":{let[i]=r.value;return i-n<=0?i4(kc(e,t,n)):s_()}}})),ps(e=>i2(e)?f6("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/effect/issues"):n(mh(e.value[1]))))),kf=e=>xo(e,s_()),kp=((e,t)=>ps(_$,r=>nS(kg(e,r),wW(ps(r.value,t)))),nm(2,(e,t)=>fV((r,n)=>{let i=wy(e,r,n.runtimeFlags,vd);if("Open"===t.state._tag){let e={};t.state.finalizers.set(e,()=>pi(e=>il(e,i.id())?pj:fG(pW(i)))),i.addObserver(()=>{"Closed"!==t.state._tag&&t.state.finalizers.delete(e)})}else i.unsafeInterruptAsFork(r.id());return pF(i)}))),kd=e=>wO(t=>kp(e,t)),km=nm(2,(e,t)=>nS(f7(e),wJ(f7(t)),e=>pl(e))),kg=nm(2,(e,t)=>da(wB,e=>e.zip(t))(e)),kb=((e,{duration:t,onTimeout:r})=>pl(ky(e,{onTimeout:()=>pe(r),onSuccess:pF,duration:t})),nm(2,(e,{duration:t,onTimeout:r})=>pl(ky(e,{onTimeout:()=>pr(r),onSuccess:pF,duration:t})))),ky=nm(2,(e,{duration:t,onSuccess:r,onTimeout:n})=>pi(i=>pM(s=>wH(s(e),pb(xx(t)),{onSelfWin:(e,t)=>ps(e.await,n=>"Success"===n._tag?ps(e.inheritAll,()=>fK(pK(t,i),r(n.value))):ps(pK(t,i),()=>d4(n.cause))),onOtherWin:(e,t)=>ps(e.await,r=>"Success"===r._tag?ps(e.inheritAll,()=>fK(pK(t,i),n())):ps(pK(t,i),()=>d4(r.cause))),otherScope:vd})))),kx=Symbol.for("effect/Ref/SynchronizedRef"),kv={_A:e=>e};class kS extends bc{ref;withLock;[kx]=kv;[xr]=xn;[xt]=xt;constructor(e,t){super(),this.ref=e,this.withLock=t,this.get=this.ref.get}get;commit(){return this.get}modify(e){return this.modifyEffect(t=>pF(e(t)))}modifyEffect(e){return this.withLock(nS(ps(this.ref.get,e),ps(([e,t])=>fK(xo(this.ref,t),e))))}}let k_=e=>pI(()=>kw(e)),kw=e=>new kS(xs(e),kl(1).withPermits(1)),kk=nm(2,(e,t)=>e.modifyEffect(e=>{let r=t(e);switch(r._tag){case"None":return pF([e,e]);case"Some":return px(r.value,e=>[e,e])}})),kO=((e,t,r)=>({...iV,commit(){return vx(this)},[vm]:vg,id:()=>nS(e.id(),cL(t.id())),await:nS(e.await,pl,wT(pl(t.await),r,{concurrent:!0}),f7),children:e.children,inheritAll:pJ(t.inheritAll,e.inheritAll),poll:pH(e.poll,t.poll,(e,t)=>nS(e,sN(e=>nS(t,sA(t=>ma(e,t,{onSuccess:r,onFailure:l4})))))),interruptAsFork:r=>pJ(e.interruptAsFork(r),t.interruptAsFork(r)),pipe(){return iw(this,arguments)}}),Symbol.for("effect/ManagedRuntime")),kE="Fresh",kC="ProvideMerge",kF=e=>function(){if(1==arguments.length){let t=arguments[0];return(r,...n)=>e(t,r,...n)}return e.apply(this,arguments)},kR=kF((e,t,r)=>{let n=cK(),i=[[dh,[[n,e.context]]]];r?.scheduler&&i.push([xm,[[n,r.scheduler]]]);let s=bF(e.fiberRefs,{entries:i,forkAs:n});r?.updateRefs&&(s=r.updateRefs(s,n));let a=new _9(n,s,e.runtimeFlags),o=t;r?.scope&&(o=ps(dM(r.scope,bd),e=>pJ(dT(e,pi(e=>il(e,a.id())?pj:pK(a,e))),p_(t,t=>dN(e,t)))));let l=a.currentSupervisor;return l!==_z&&(l.onStart(e.context,o,s_(),a),a.addObserver(e=>l.onEnd(e,a))),vd.add(e.runtimeFlags,a),r?.immediate===!1?a.resume(o):a.start(o),a}),kI=kF((e,t,r={})=>{let n=kR(e,t,r);return r.onExit&&n.addObserver(e=>{r.onExit(e)}),(t,r)=>kI(e)(nS(n,pK(t??cH)),{...r,onExit:r?.onExit?e=>r.onExit(nS(e,d6(ng))):void 0})}),kT=kF((e,t)=>{let r=k$(e)(t);if("Failure"===r._tag)throw kP(r.effect_instruction_i0);return r.effect_instruction_i0});class kA extends Error{fiber;_tag="AsyncFiberException";constructor(e){super(`Fiber #${e.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`),this.fiber=e,this.name=this._tag,this.stack=this.message}}let kN=Symbol.for("effect/Runtime/FiberFailure"),kM=Symbol.for("effect/Runtime/FiberFailure/Cause");class kj extends Error{[kN];[kM];constructor(e){let t=uR(e)[0];super(t?.message||"An error has occurred"),this[kN]=kN,this[kM]=e,this.name=t?`(FiberFailure) ${t.name}`:"FiberFailure",t?.stack&&(this.stack=t.stack)}toJSON(){return{_id:"FiberFailure",cause:this[kM].toJSON()}}toString(){return"(FiberFailure) "+uS(this[kM],{renderErrorCause:!0})}[ih](){return this.toString()}}let kP=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new kj(e);return Error.stackTraceLimit=t,r},kD=e=>{switch(e._op){case"Failure":case"Success":return e;case"Left":return d5(e.left);case"Right":return mr(e.right);case"Some":return mr(e.value);case"None":return d5(dV())}},k$=kF((e,t)=>{let r=kD(t);if(r)return r;let n=new xd,i=kR(e)(t,{scheduler:n});n.flush();let s=i.unsafePoll();return s||d3(f5((e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new kA(e);return Error.stackTraceLimit=t,r})(i),mk(i)))}),kz=kF((e,t,r)=>kL(e,t,r).then(e=>{switch(e._tag){case iI:return e.effect_instruction_i0;case iE:throw kP(e.effect_instruction_i0)}})),kL=kF((e,t,r)=>new Promise(n=>{let i=kD(t);i&&n(i);let s=kR(e)(t);s.addObserver(e=>{n(e)}),r?.signal!==void 0&&(r.signal.aborted?s.unsafeInterruptAsFork(s.id()):r.signal.addEventListener("abort",()=>{s.unsafeInterruptAsFork(s.id())},{once:!0}))}));class kU{context;runtimeFlags;fiberRefs;constructor(e,t,r){this.context=e,this.runtimeFlags=t,this.fiberRefs=r}pipe(){return iw(this,arguments)}}let kB=e=>new kU(e.context,e.runtimeFlags,e.fiberRefs),kq=()=>fV((e,t)=>pF(new kU(e.getFiberRef(dh),t.runtimeFlags,e.getFiberRefs()))),kJ=kB({context:uz,runtimeFlags:fn(1,32,4),fiberRefs:bb()}),kH=((e,t)=>kB({context:e.context,runtimeFlags:t(e.runtimeFlags),fiberRefs:e.fiberRefs}),kR(kJ)),kV=kz(kJ),kW=kL(kJ),kK=kT(kJ),kG=k$(kJ),kZ=nm(2,(e,t)=>e.modifyEffect(t)),kQ=Symbol.for("effect/Layer"),kY={[kQ]:{_RIn:e=>e,_E:e=>e,_ROut:e=>e},pipe(){return iw(this,arguments)}},kX=Symbol.for("effect/Layer/MemoMap"),k0=uZ()("effect/Layer/CurrentMemoMap",{defaultValue:()=>k3()});class k1{ref;[kX];constructor(e){this.ref=e,this[kX]=kX}getOrElseMemoize(e,t){return nS(kZ(this.ref,r=>{let n=r.get(e);if(void 0!==n){let[e,i]=n;return pF([nS(e,ps(([e,t])=>nS(xG(e),fK(t))),p_(me({onFailure:()=>pj,onSuccess:()=>dA(t,i)}))),r])}return nS(xa(0),ps(n=>nS(mu(),ps(i=>nS(xa(()=>pj),px(s=>{let a=pM(a=>nS(wP(),ps(o=>nS(a(ps(k6(e,o,!0),e=>x0(e(this),xz,bM))),f7,ps(a=>{switch(a._tag){case iE:return nS(md(i,a.effect_instruction_i0),pJ(dN(o,a)),pJ(pt(a.effect_instruction_i0)));case iI:return nS(xo(s,e=>nS(dN(o,e),pD(xu(n,e=>[1===e,e-1])),fG)),pJ(xc(n,e=>e+1)),pJ(dA(t,t=>nS(pI(()=>r.delete(e)),pJ(s.get),ps(e=>e(t))))),pJ(mg(i,a.effect_instruction_i0)),fK(a.effect_instruction_i0[1]))}}))))),o=[nS(mh(i),p_(mt({onFailure:()=>pj,onSuccess:()=>xc(n,e=>e+1)}))),e=>nS(s.get,ps(t=>t(e)))];return[a,e._op_layer===kE?r:r.set(e,o)]}))))))}),pl)}}let k2=pR(()=>px(k_(new Map),e=>new k1(e))),k3=()=>new k1(kw(new Map)),k5=nm(2,(e,t)=>ps(k2,r=>k4(e,r,t))),k4=nm(3,(e,t,r)=>ps(k6(e,r),e=>xZ(e(t),k0,t))),k6=(e,t,r=!1)=>{switch(e._op_layer){case"Locally":return pI(()=>r=>e.f(r.getOrElseMemoize(e.self,t)));case"ExtendScope":return pI(()=>t=>wO(r=>t.getOrElseMemoize(e.layer,r)));case"Fold":return pI(()=>r=>nS(r.getOrElseMemoize(e.layer,t),pc({onFailure:n=>r.getOrElseMemoize(e.failureK(n),t),onSuccess:n=>r.getOrElseMemoize(e.successK(n),t)})));case"Fresh":return pI(()=>r=>nS(e.layer,k5(t)));case"FromEffect":return r?pI(()=>t=>e.effect):pI(()=>r=>r.getOrElseMemoize(e,t));case"Provide":return pI(()=>r=>nS(r.getOrElseMemoize(e.first,t),ps(n=>nS(r.getOrElseMemoize(e.second,t),mS(n)))));case"Scoped":return r?pI(()=>r=>wD(e.effect,t)):pI(()=>r=>r.getOrElseMemoize(e,t));case"Suspend":return pI(()=>r=>r.getOrElseMemoize(e.evaluate(),t));case"ProvideMerge":return pI(()=>r=>nS(r.getOrElseMemoize(e.first,t),pH(r.getOrElseMemoize(e.second,t),e.zipK)));case"ZipWith":return pI(()=>r=>nS(r.getOrElseMemoize(e.first,t),wT(r.getOrElseMemoize(e.second,t),e.zipK,{concurrent:!0})))}},k8=nm(2,(e,t)=>Oa(e,{onFailure:t,onSuccess:Op})),k7=((e,t)=>Os(e,{onFailure:t,onSuccess:Op}),()=>On(mx)),k9=e=>Oe(l2(e)),Oe=e=>On(pt(e)),Ot=nm(2,(e,t)=>Oa(e,{onFailure:k9,onSuccess:t})),Or=nm(2,(e,t)=>{let r=uK(e),n=r?e:t;return On(px(r?t:e,e=>uL(n,e)))});function On(e){let t=Object.create(kY);return t._op_layer="FromEffect",t.effect=e,t}(e,t,r)=>Oi(e,ds(t,r));let Oi=nm(2,(e,t)=>{let r=Object.create(kY);return r._op_layer="Locally",r.self=e,r.f=t,r});(e,t)=>Ot(e,e=>Op(t(e)));let Os=nm(2,(e,{onFailure:t,onSuccess:r})=>{let n=Object.create(kY);return n._op_layer="Fold",n.layer=e,n.failureK=t,n.successK=r,n}),Oa=nm(2,(e,{onFailure:t,onSuccess:r})=>Os(e,{onFailure:e=>{let r=ui(e);switch(r._tag){case"Left":return t(r.left);case"Right":return Oe(r.right)}},onSuccess:r})),Oo=nm(2,(e,t)=>Ox(e,t,(e,t)=>uV(e,t))),Ol=(...e)=>{let t=e[0];for(let r=1;r<e.length;r++)t=Oo(t,e[r]);return t},Ou=nm(2,(e,t)=>{let r=uK(e),n=r?e:t;return Oh(px(r?t:e,e=>uL(n,e)))}),Oc=e=>Oh(nS(e,fK(uz))),Oh=e=>{let t=Object.create(kY);return t._op_layer="Scoped",t.effect=e,t},Of=nm(2,(e,t)=>{let r=uK(e);return On(pF(uL(r?e:t,r?t:e)))}),Op=e=>On(pF(e)),Od=e=>{let t=Object.create(kY);return t._op_layer="Suspend",t.evaluate=e,t},Om=nm(2,(e,t)=>{let r=uK(e),n=r?e:t,i=r?t:e;return On(pI(()=>uL(n,i())))}),Og=nm(2,(e,t)=>ps(wO(r=>k4(e,t,r)),e=>nS(kq(),mS(e)))),Ob=nm(2,(e,t)=>Od(()=>{let r=Object.create(kY);return r._op_layer="Provide",r.first=Object.create(kY,{_op_layer:{value:kC,enumerable:!0},first:{value:k7(),enumerable:!0},second:{value:Array.isArray(t)?Ol(...t):t},zipK:{value:(e,t)=>nS(e,uV(t))}}),r.second=e,r})),Oy=nm(2,(e,t)=>{let r=Object.create(kY);return r._op_layer=kC,r.first=t,r.second=Ob(e,t),r.zipK=(e,t)=>nS(e,uV(t)),r}),Ox=nm(3,(e,t,r)=>Od(()=>{let n=Object.create(kY);return n._op_layer="ZipWith",n.first=e,n.second=t,n.zipK=r,n})),Ov=e=>{let t=uW("effect/Layer/unwrapEffect/Layer.Layer<R1, E1, A>");return Ot(Or(t,e),e=>uJ(e,t))},OS=nm(2,(e,t)=>wE(r=>ps(k5(t,r),t=>m_(e,t)))),O_=nm(2,(e,t)=>{let r=bM(kJ.fiberRefs,t.fiberRefs),n=fo(kJ.runtimeFlags,t.runtimeFlags);return pM(i=>fV(s=>{let a=s.getFiberRef(dh),o=s.getFiberRefs(),l=bP(s.id(),o)(r),u=s.currentRuntimeFlags,c=fl(n)(u),h=bM(l,o),f=fo(c,u);return s.setFiberRefs(l),s.currentRuntimeFlags=c,wW(m_(i(e),uV(a,t.context)),fV(e=>(e.setFiberRefs(bP(e.id(),e.getFiberRefs())(h)),e.currentRuntimeFlags=fl(f)(e.currentRuntimeFlags),pj)))}))}),Ow=nm(2,(e,t)=>{if(Array.isArray(t))return OS(e,Ol(...t));return nL(t,kQ)?OS(e,t):u$(t)?m_(e,t):kO in t?ps(t.runtimeEffect,t=>O_(e,t)):O_(e,t)}),Ok=Symbol.for("effect/DateTime"),OO=Symbol.for("effect/DateTime/TimeZone"),OE={[Ok]:Ok,pipe(){return iw(this,arguments)},[ih](){return this.toString()},toJSON(){return OQ(this).toJSON()}},OC={...OE,_tag:"Utc",[n4](){return ia(this,it(this.epochMillis))},[io](e){return ON(e)&&"Utc"===e._tag&&this.epochMillis===e.epochMillis},toString(){return`DateTime.Utc(${OQ(this).toJSON()})`}},OF={...OE,_tag:"Zoned",[n4](){return nS(it(this.epochMillis),n7(n6(this.zone)),ia(this))},[io](e){return ON(e)&&"Zoned"===e._tag&&this.epochMillis===e.epochMillis&&il(this.zone,e.zone)},toString(){return`DateTime.Zoned(${Er(this)})`}},OR={[OO]:OO,[ih](){return this.toString()}},OI={...OR,_tag:"Named",[n4](){return ia(this,ir(`Named:${this.id}`))},[io](e){return Oj(e)&&"Named"===e._tag&&this.id===e.id},toString(){return`TimeZone.Named(${this.id})`},toJSON(){return{_id:"TimeZone",_tag:"Named",id:this.id}}},OT={...OR,_tag:"Offset",[n4](){return ia(this,ir(`Offset:${this.offset}`))},[io](e){return Oj(e)&&"Offset"===e._tag&&this.offset===e.offset},toString(){return`TimeZone.Offset(${O0(this.offset)})`},toJSON(){return{_id:"TimeZone",_tag:"Offset",offset:this.offset}}},OA=(e,t,r)=>{let n=Object.create(OF);return n.epochMillis=e,n.zone=t,Object.defineProperty(n,"partsUtc",{value:r,enumerable:!1,writable:!0}),Object.defineProperty(n,"adjustedEpochMillis",{value:void 0,enumerable:!1,writable:!0}),Object.defineProperty(n,"partsAdjusted",{value:void 0,enumerable:!1,writable:!0}),n},ON=e=>nL(e,Ok),OM=e=>ON(e[0]),Oj=e=>nL(e,OO),OP=e=>"Zoned"===e._tag,OD=n_((e,t)=>e.epochMillis===t.epochMillis),O$=e=>{let t=Object.create(OC);return t.epochMillis=e,Object.defineProperty(t,"partsUtc",{value:void 0,enumerable:!1,writable:!0}),t},Oz=e=>{let t=e.getTime();if(Number.isNaN(t))throw new dJ("Invalid date");return O$(t)},OL=e=>{if(ON(e))return e;if(e instanceof Date)return Oz(e);if("object"==typeof e){let t=new Date(0);return O2(t,e),Oz(t)}return"string"!=typeof e||OU(e)?Oz(new Date(e)):Oz(new Date(e+"Z"))},OU=e=>/Z|[+-]\d{2}$|[+-]\d{2}:?\d{2}$|\]$/.test(e),OB=(e,t)=>{let r;if(t?.timeZone===void 0&&ON(e)&&OP(e))return e;let n=OL(e);if(n.epochMillis<-86399999568e5||n.epochMillis>86399999496e5)throw RangeError(`Epoch millis out of range: ${n.epochMillis}`);if(t?.timeZone===void 0)r=OW(-60*new Date(n.epochMillis).getTimezoneOffset()*1e3);else if(Oj(t?.timeZone))r=t.timeZone;else if("number"==typeof t?.timeZone)r=OW(t.timeZone);else{let e=OZ(t.timeZone);if(i2(e))throw new dJ(`Invalid time zone: ${t.timeZone}`);r=e.value}return t?.adjustForTimeZone!==!0?OA(n.epochMillis,r,n.partsUtc):O3(n.epochMillis,r,t?.disambiguation??"compatible")},Oq=sR(OB),OJ=((e,t,r)=>r?.adjustForTimeZone===!0?O3(e.epochMillis,t,r?.disambiguation??"compatible"):OA(e.epochMillis,t,e.partsUtc),nF("effect/DateTime/validZoneCache",()=>new Map)),OH={day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"longOffset",fractionalSecondDigits:3,hourCycle:"h23"},OV=e=>{if(OJ.has(e))return OJ.get(e);try{return(e=>{let t=e.resolvedOptions().timeZone;if(OJ.has(t))return OJ.get(t);let r=Object.create(OI);return r.id=t,r.format=e,OJ.set(t,r),r})(new Intl.DateTimeFormat("en-US",{...OH,timeZone:e}))}catch{throw new dJ(`Invalid time zone: ${e}`)}},OW=e=>{let t=Object.create(OT);return t.offset=e,t},OK=sR(OV),OG=/^(?:GMT|[+-])/,OZ=e=>{if(OG.test(e)){let t=O4(e);return null===t?s_():i4(OW(t))}return OK(e)},OQ=((e,t)=>O1(t)-O1(e),e=>new Date(e.epochMillis)),OY=e=>{if("Utc"===e._tag)return new Date(e.epochMillis);if("Offset"===e.zone._tag)return new Date(e.epochMillis+e.zone.offset);if(void 0!==e.adjustedEpochMillis)return new Date(e.adjustedEpochMillis);let t=e.zone.format.formatToParts(e.epochMillis).filter(e=>"literal"!==e.type),r=new Date(0);return r.setUTCFullYear(Number(t[2].value),Number(t[0].value)-1,Number(t[1].value)),r.setUTCHours(Number(t[3].value),Number(t[4].value),Number(t[5].value),Number(t[6].value)),e.adjustedEpochMillis=r.getTime(),r},OX=e=>OY(e).getTime()-O1(e),O0=e=>{let t=Math.abs(e),r=Math.floor(t/36e5),n=Math.round(t%36e5/6e4);return 60===n&&(r+=1,n=0),`${e<0?"-":"+"}${String(r).padStart(2,"0")}:${String(n).padStart(2,"0")}`},O1=e=>e.epochMillis,O2=(e,t)=>{if(void 0!==t.year&&e.setUTCFullYear(t.year),void 0!==t.month&&e.setUTCMonth(t.month-1),void 0!==t.day&&e.setUTCDate(t.day),void 0!==t.weekDay){let r=t.weekDay-e.getUTCDay();e.setUTCDate(e.getUTCDate()+r)}void 0!==t.hours&&e.setUTCHours(t.hours),void 0!==t.minutes&&e.setUTCMinutes(t.minutes),void 0!==t.seconds&&e.setUTCSeconds(t.seconds),void 0!==t.millis&&e.setUTCMilliseconds(t.millis)},O3=(e,t,r)=>{if("Offset"===t._tag)return OA(e-t.offset,t);let n=O6(e-864e5,e,t),i=O6(e+864e5,e,t);if(n===i)return OA(e-n,t);let s=n-i;if(n<i){if(O6(e-i,e,t)===i)return OA(e-i,t);let s=OA(e-n,t);if(e!==OY(s).getTime())switch(r){case"reject":{let r=new Date(e).toISOString();throw RangeError(`Gap time: ${r} does not exist in time zone ${t.id}`)}case"earlier":return OA(e-i,t)}return s}if(O6(e-n,e,t)===n){if("earlier"===r||"compatible"===r||O6(e-n+s,e+s,t)===n)return OA(e-n,t);if("reject"===r){let r=new Date(e).toISOString();throw RangeError(`Ambiguous time: ${r} occurs twice in time zone ${t.id}`)}}return OA(e-i,t)},O5=/([+-])(\d{2}):(\d{2})$/,O4=e=>{let t=O5.exec(e);if(null===t)return null;let[,r,n,i]=t;return("+"===r?1:-1)*(60*Number(n)+Number(i))*6e4},O6=(e,t,r)=>{let n=r.format.formatToParts(e).find(e=>"timeZoneName"===e.type)?.value??"";if("GMT"===n)return 0;let i=O4(n);return null===i?OX(OA(t,r)):i},O8=nm(OM,(e,t,r)=>{if("Utc"===e._tag){let r=OQ(e);return t(r),O$(r.getTime())}let n=new Date(OY(e).getTime());return t(n),O3(n.getTime(),e.zone,r?.disambiguation??"compatible")}),O7=((e,t)=>O7(e,e=>{let r=new Date(e);return t(r),r.getTime()}),nm(2,(e,t)=>{let r=t(O1(e));return"Utc"===e._tag?O$(r):OA(r,e.zone)})),O9=((e,t)=>t(OY(e)),nm(2,(e,t)=>t(OQ(e)))),Ee=(e,t)=>{e.setTime(e.getTime()+t)},Et=((e,t)=>O8(e,e=>{if(t.millis&&Ee(e,t.millis),t.seconds&&Ee(e,1e3*t.seconds),t.minutes&&Ee(e,60*t.minutes*1e3),t.hours&&Ee(e,60*t.hours*6e4),t.days&&e.setUTCDate(e.getUTCDate()+t.days),t.weeks&&e.setUTCDate(e.getUTCDate()+7*t.weeks),t.months){let r=e.getUTCDate();e.setUTCMonth(e.getUTCMonth()+t.months+1,0),r<e.getUTCDate()&&e.setUTCDate(r)}if(t.years){let r=e.getUTCDate(),n=e.getUTCMonth();e.setUTCFullYear(e.getUTCFullYear()+t.years,n+1,0),r<e.getUTCDate()&&e.setUTCDate(r)}}),e=>{let t=OY(e);return"Utc"===e._tag?t.toISOString():`${t.toISOString().slice(0,-1)}${O0(OX(e))}`}),Er=e=>"Offset"===e.zone._tag?Et(e):`${Et(e)}[${e.zone.id}]`;class En{s;stripped;index;length;constructor(e,t=!1){this.s=e,this.stripped=t,this.index=0,this.length=e.length}next(){if(this.done)return{done:!0,value:void 0};let e=this.index;for(;!this.done&&!Ei(this.s[this.index]);)this.index=this.index+1;let t=this.index;if(!this.done){let e=this.s[this.index];this.index=this.index+1,!this.done&&Es(e,this.s[this.index])&&(this.index=this.index+1),this.stripped||(t=this.index)}return{done:!1,value:this.s.substring(e,t)}}[Symbol.iterator](){return new En(this.s,this.stripped)}get done(){return this.index>=this.length}}let Ei=e=>{let t=e.charCodeAt(0);return 13===t||10===t},Es=(e,t)=>13===e.charCodeAt(0)&&10===t.charCodeAt(0),Ea=((e,t)=>Eo(e.seconds,t.seconds)&&Eo(e.minutes,t.minutes)&&Eo(e.hours,t.hours)&&Eo(e.days,t.days)&&Eo(e.months,t.months)&&Eo(e.weekdays,t.weekdays),nE(nw)),Eo=(e,t)=>Ea(s1(e),s1(t)),El=Symbol.for("effect/Schedule"),Eu=e=>nL(e,El),Ec=Symbol.for("effect/ScheduleDriver"),Eh={start:0,now:0,input:void 0,output:void 0,elapsed:ct,elapsedSincePrevious:ct,recurrence:0},Ef=uZ()("effect/Schedule/CurrentIterationMetadata",{defaultValue:()=>Eh}),Ep={_Out:e=>e,_In:e=>e,_R:e=>e},Ed={_Out:e=>e,_In:e=>e,_R:e=>e};class Em{initial;step;[El]=Ep;constructor(e,t){this.initial=e,this.step=t}pipe(){return iw(this,arguments)}}let Eg=(e,t,r,n)=>xc(e,e=>0===e.recurrence?{now:t,input:r,output:n,recurrence:e.recurrence+1,elapsed:ct,elapsedSincePrevious:ct,start:t}:{now:t,input:r,output:n,recurrence:e.recurrence+1,elapsed:cs(t-e.start),elapsedSincePrevious:cs(t-e.now),start:e.start});class Eb{schedule;ref;[Ec]=Ed;constructor(e,t){this.schedule=e,this.ref=t}get state(){return px(this.ref.get,e=>e[1])}get last(){return ps(this.ref.get,([e,t])=>{switch(e._tag){case"None":return pe(()=>new dV);case"Some":return pF(e.value)}})}iterationMeta=xs(Eh);get reset(){return xo(this.ref,[s_(),this.schedule.initial]).pipe(pq(xo(this.iterationMeta,Eh)))}next(e){return nS(px(this.ref.get,e=>e[1]),ps(t=>nS(gK,ps(r=>nS(pR(()=>this.schedule.step(r,e,t)),ps(([t,n,i])=>{let s=xo(this.ref,[i4(n),t]);if(i._tag===kn)return s.pipe(pJ(f9(s_())));let a=w9(i.intervals)-r;if(a<=0)return s.pipe(pJ(Eg(this.iterationMeta,r,e,n)),fK(n));let o=cs(a);return nS(s,pJ(Eg(this.iterationMeta,r,e,n)),pJ(xx(o)),fK(n))}))))))}}let Ey=(e,t)=>new Em(e,t),Ex=((e,t)=>Ex(e,e=>pI(()=>t(e))),nm(2,(e,t)=>ER(e,(e,r)=>px(t(e),e=>cb(r,u4(e)))))),Ev=((e,t)=>Ey([e.initial,t.initial,!0],(r,n,i)=>i[2]?ps(e.step(r,n,i[0]),([e,s,a])=>a._tag===kn?px(t.step(r,n,i[1]),([t,r,n])=>[[e,t,!1],si(r),n]):pF([[e,i[1],!0],sn(s),a])):px(t.step(r,n,i[1]),([e,t,r])=>[[i[0],e,!1],si(t),r])),nm(2,(e,t)=>ES(e,(e,r)=>pI(()=>t(e,r))))),ES=nm(2,(e,t)=>Ey(e.initial,(r,n,i)=>ps(e.step(r,n,i),([e,r,i])=>i._tag===kn?pF([e,r,ka]):px(t(n,r),t=>t?[e,r,i]:[e,r,ka])))),E_=((e,t)=>E_(e,e=>pI(()=>t(e))),nm(2,(e,t)=>Ey(e.initial,(r,n,i)=>ps(t(n),t=>e.step(r,t,i))))),Ew=((e,t)=>ER(e,(e,r)=>t(r)),e=>nS(xa([s_(),e.initial]),px(t=>new Eb(e,t)))),Ek=nm(2,(e,t)=>EO(e,t,w8)),EO=nm(3,(e,t,r)=>Ey([e.initial,t.initial],(n,i,s)=>nS(pH(e.step(n,i,s[0]),t.step(n,i,s[1]),(e,t)=>[e,t]),ps(([[n,s,a],[o,l,u]])=>a._tag===kr&&u._tag===kr?EE(e,t,i,n,s,a.intervals,o,l,u.intervals,r):pF([[n,o],[s,l],ka]))))),EE=(e,t,r,n,i,s,a,o,l,u)=>{let c=u(s,l);return o$(c.intervals)?pF([[n,a],[i,o],ki(c)]):nS(s,ke(l))?ps(e.step(kt(s),r,n),([n,i,s])=>s._tag===kn?pF([[n,a],[i,o],ka]):EE(e,t,r,n,i,s.intervals,a,o,l,u)):ps(t.step(kt(l),r,a),([a,o,l])=>l._tag===kn?pF([[n,a],[i,o],ka]):EE(e,t,r,n,i,s,a,o,l.intervals,u))},EC=nm(2,(e,t)=>EF(e,e=>pI(()=>t(e)))),EF=nm(2,(e,t)=>Ey(e.initial,(r,n,i)=>ps(e.step(r,n,i),([e,r,n])=>px(t(r),t=>[e,t,n])))),ER=nm(2,(e,t)=>Ey(e.initial,(r,n,i)=>ps(e.step(r,n,i),([e,n,i])=>{if(i._tag===kn)return pF([e,n,i]);let s=i.intervals;return px(t(n,(e=>cs(e.endMillis-e.startMillis))(wQ(r,w9(s)))),t=>{let i=u4(t),a=w9(s),o=r+ch(i),l=o-a;return[e,n,ks(wQ(o,Math.max(0,kt(s)+l)))]})}))),EI=e=>EM(EZ,t=>t<e),ET=((e,t,r)=>Ey([e.initial,t],(t,n,[i,s])=>ps(e.step(t,n,i),([e,t,n])=>n._tag===kn?pF([[e,s],s,n]):px(r(s,t),t=>[[e,t],s,n]))),nm(3,(e,t,r)=>Ey([e.initial,t.initial],(n,i,s)=>pH(e.step(n,i,s[0]),t.step(n,i,s[1]),([e,t,n],[i,s,a])=>{if(n._tag===kn&&a._tag===kn)return[[e,i],[t,s],ka];if(n._tag===kn&&a._tag===kr)return[[e,i],[t,s],ki(a.intervals)];if(n._tag===kr&&a._tag===kn)return[[e,i],[t,s],ki(n.intervals)];if(n._tag===kr&&a._tag===kr)return[[e,i],[t,s],ki(r(n.intervals,a.intervals))];throw Error("BUG: Schedule.unionWith - please report an issue at https://github.com/Effect-TS/effect/issues")})))),EA=nm(2,(e,t)=>ES(e,(e,r)=>px(t(e),e=>!e))),EN=nm(2,(e,t)=>ES(e,(e,r)=>t(e))),EM=nm(2,(e,t)=>Ev(e,(e,r)=>t(r))),Ej=((e,t)=>EC(Ek(e,t),e=>e[0]),Symbol.for("effect/Schedule/ScheduleDefect"));class EP{error;[Ej];constructor(e){this.error=e,this[Ej]=Ej}}let ED=e=>f1(e,e=>f4(new EP(e))),E$=e=>sw(up(e,e=>"Die"===e._tag&&nL(e.defect,Ej)?i4(e.defect):s_()),{onNone:()=>e,onSome:e=>l2(e.error)}),Ez=e=>f0(e,e=>pt(E$(e))),EL=nm(2,(e,t)=>EB(e,t,(e,t)=>f9(e))),EU=nm(2,(e,t)=>{if(Eu(t))return EL(e,t);let r=t.schedule??(e=>Ey(e.initial,(t,r,n)=>nS(e.step(t,r,n),px(([e,t,n])=>[e,r,n]))))(EZ),n=t.while?EN(r,e=>{let r=t.while(e);return"boolean"==typeof r?pF(r):ED(r)}):r,i=t.until?EA(n,e=>{let r=t.until(e);return"boolean"==typeof r?pF(r):ED(r)}):n;return Ez(EL(e,t.times?Ek(i,EI(t.times)).pipe(EC(e=>e[0])):i))}),EB=nm(3,(e,t,r)=>ps(Ew(t),t=>ph(e,{onFailure:e=>r(e,s_()),onSuccess:n=>Eq(xQ(e,Ef,t.iterationMeta.get),t,(e,n)=>xQ(r(e,n),Ef,t.iterationMeta.get),n)}))),Eq=(e,t,r,n)=>ph(t.next(n),{onFailure:()=>pO(t.last),onSuccess:n=>ph(e,{onFailure:e=>r(e,i4(n)),onSuccess:n=>Eq(e,t,r,n)})}),EJ=nm(2,(e,t)=>EV(e,t,(e,t)=>f9(e))),EH=((e,t)=>Eu(t)?EJ(e,t):Ez(EJ(e,EH(t))),e=>{let t=e.schedule??EZ,r=e.while?EN(t,t=>{let r=e.while(t);return"boolean"==typeof r?pF(r):ED(r)}):t,n=e.until?EA(r,t=>{let r=e.until(t);return"boolean"==typeof r?pF(r):ED(r)}):r;return e.times?Ek(n,EI(e.times)):n}),EV=nm(3,(e,t,r)=>ps(Ew(t),t=>EW(xQ(e,Ef,t.iterationMeta.get),t,(e,n)=>xQ(r(e,n),Ef,t.iterationMeta.get)))),EW=(e,t,r)=>f1(e,n=>ph(t.next(n),{onFailure:()=>nS(t.last,pO,ps(e=>r(n,e))),onSuccess:()=>EW(e,t,r)})),EK=((e,t)=>EK(e,void 0,t),nm(3,(e,t,r)=>ps(Ew(r),r=>EG(xQ(e,Ef,r.iterationMeta.get),t,r)))),EG=(e,t,r)=>ph(r.next(t),{onFailure:()=>pO(r.last),onSuccess:()=>ps(e,t=>EG(e,t,r))}),EZ=(s=e=>e+1,Ey(0,(e,t,r)=>pI(()=>[s(r),r,ks(w2(e))]))),EQ=EC(EI(1),nv),EY=Symbol.for("effect/MutableList"),EX={[EY]:EY,[Symbol.iterator](){let e=!1,t=this.head;return{next(){if(e)return this.return();if(null==t)return e=!0,this.return();let r=t.value;return t=t.next,{done:e,value:r}},return:t=>(e||(e=!0),{done:!0,value:t})}},toString(){return id(this.toJSON())},toJSON(){return{_id:"MutableList",values:Array.from(this).map(ip)}},[ih](){return this.toJSON()},pipe(){return iw(this,arguments)}},E0=e=>0===E1(e),E1=e=>e._length,E2=nm(2,(e,t)=>{let r={value:t,removed:!1,prev:void 0,next:void 0};return void 0===e.head&&(e.head=r),void 0===e.tail||(e.tail.next=r,r.prev=e.tail),e.tail=r,e._length+=1,e}),E3=Symbol.for("effect/MutableQueue"),E5=Symbol.for("effect/mutable/MutableQueue/Empty"),E4={[E3]:E3,[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()},toString(){return id(this.toJSON())},toJSON(){return{_id:"MutableQueue",values:Array.from(this).map(ip)}},[ih](){return this.toJSON()},pipe(){return iw(this,arguments)}},E6=e=>{let t=Object.create(E4);return t.queue=(()=>{let e=Object.create(EX);return e.head=void 0,e.tail=void 0,e._length=0,e})(),t.capacity=e,t},E8=e=>E6(e),E7=()=>E6(void 0),E9=e=>E1(e.queue),Ce=e=>E0(e.queue),Ct=nm(2,(e,t)=>{let r=E1(e.queue);return(void 0===e.capacity||r!==e.capacity)&&(E2(t)(e.queue),!0)}),Cr=nm(2,(e,t)=>{let r,n=t[Symbol.iterator](),i=om(),s=!0;for(;s&&(r=n.next())&&!r.done;)s=Ct(r.value)(e);for(;null!=r&&!r.done;)i=oC(r.value)(i),r=n.next();return oS(i)}),Cn=nm(2,(e,t)=>E0(e.queue)?t:(e=>{let t=e.head;if(void 0!==t)return((e,t)=>{!t.removed&&(t.removed=!0,void 0!==t.prev&&void 0!==t.next?(t.prev.next=t.next,t.next.prev=t.prev):void 0!==t.prev?(e.tail=t.prev,t.prev.next=void 0):void 0!==t.next?(e.head=t.next,t.next.prev=void 0):(e.tail=void 0,e.head=void 0),e._length>0&&(e._length-=1))})(e,t),t.value})(e.queue)),Ci=nm(2,(e,t)=>{let r=om(),n=0;for(;n<t;){let t=Cn(E5)(e);if(t===E5)break;r=oC(t)(r),n+=1}return oS(r)}),Cs=(e,t,r,n)=>hh({_tag:"Complete",key:e,exit:t,entryStats:r,timeToLiveMillis:n}),Ca=(e,t)=>hh({_tag:"Pending",key:e,deferred:t}),Co=Symbol.for("effect/Cache/MapKey");class Cl{current;[Co]=Co;previous=void 0;next=void 0;constructor(e){this.current=e}[n4](){return nS(n6(this.current),n7(n6(this.previous)),n7(n6(this.next)),ia(this))}[io](e){return this===e||Cc(e)&&il(this.current,e.current)&&il(this.previous,e.previous)&&il(this.next,e.next)}}let Cu=e=>new Cl(e),Cc=e=>nL(e,Co);class Ch{head=void 0;tail=void 0;add(e){if(e!==this.tail)if(void 0===this.tail)this.head=e,this.tail=e;else{let t=e.previous,r=e.next;void 0!==r&&(e.next=void 0,void 0!==t?(t.next=r,r.previous=t):(this.head=r,this.head.previous=void 0)),this.tail.next=e,e.previous=this.tail,this.tail=e}}remove(){let e=this.head;if(void 0!==e){let t=e.next;void 0!==t?(e.next=void 0,this.head=t,this.head.previous=void 0):(this.head=void 0,this.tail=void 0)}return e}}let Cf=Symbol.for("effect/Cache"),Cp={_Key:e=>e,_Error:e=>e,_Value:e=>e},Cd=Symbol.for("effect/ConsumerCache"),Cm={_Key:e=>e,_Error:e=>e,_Value:e=>e},Cg=e=>({loadedMillis:e});class Cb{capacity;context;fiberId;lookup;timeToLive;[Cf]=Cp;[Cd]=Cm;cacheState;constructor(e,t,r,n,i){this.capacity=e,this.context=t,this.fiberId=r,this.lookup=n,this.timeToLive=i,this.cacheState=(()=>{let e,t;return e=Sy(),t=new Ch,{map:e,keys:t,accesses:E7(),updating:cO(!1),hits:0,misses:0}})()}get(e){return px(this.getEither(e),sc)}get cacheStats(){return pI(()=>({hits:this.cacheState.hits,misses:this.cacheState.misses,size:SO(this.cacheState.map)}))}getOption(e){return pR(()=>sw(Sx(this.cacheState.map,e),{onNone:()=>{let t=Cu(e);return this.trackAccess(t),this.trackMiss(),pF(s_())},onSome:e=>this.resolveMapValue(e)}))}getOptionComplete(e){return pR(()=>sw(Sx(this.cacheState.map,e),{onNone:()=>{let t=Cu(e);return this.trackAccess(t),this.trackMiss(),pF(s_())},onSome:e=>this.resolveMapValue(e,!0)}))}contains(e){return pI(()=>SS(this.cacheState.map,e))}entryStats(e){return pI(()=>{let t=Sx(this.cacheState.map,e);if(i3(t))switch(t.value._tag){case"Complete":return i4(Cg(t.value.entryStats.loadedMillis));case"Pending":break;case"Refreshing":return i4(Cg(t.value.complete.entryStats.loadedMillis))}return s_()})}getEither(e){return pR(()=>{let t,r,n=sF(Sx(this.cacheState.map,e));return(void 0===n&&(r=ml(this.fiberId),t=Cu(e),SS(this.cacheState.map,e)?n=sF(Sx(this.cacheState.map,e)):S_(this.cacheState.map,e,Ca(t,r))),void 0===n)?(this.trackAccess(t),this.trackMiss(),px(this.lookupValueOf(e,r),si)):ps(this.resolveMapValue(n),sw({onNone:()=>this.getEither(e),onSome:e=>pF(sn(e))}))})}invalidate(e){return pI(()=>{Sk(this.cacheState.map,e)})}invalidateWhen(e,t){return pI(()=>{let r=Sx(this.cacheState.map,e);i3(r)&&"Complete"===r.value._tag&&"Success"===r.value.exit._tag&&t(r.value.exit.value)&&Sk(this.cacheState.map,e)})}get invalidateAll(){return pI(()=>{this.cacheState.map=Sy()})}refresh(e){return gW(t=>pR(()=>{let r=ml(this.fiberId),n=sF(Sx(this.cacheState.map,e));if(void 0===n&&(SS(this.cacheState.map,e)?n=sF(Sx(this.cacheState.map,e)):S_(this.cacheState.map,e,Ca(Cu(e),r))),void 0===n)return fG(this.lookupValueOf(e,r));switch(n._tag){case"Complete":if(this.hasExpired(t,n.timeToLiveMillis))return il(sF(Sx(this.cacheState.map,e)),n)&&Sk(this.cacheState.map,e),fG(this.get(e));return nS(this.lookupValueOf(e,r),x7(()=>{if(il(sF(Sx(this.cacheState.map,e)),n)){let t=hh({_tag:"Refreshing",deferred:r,complete:n});return S_(this.cacheState.map,e,t),!0}return!1}),fG);case"Pending":case"Refreshing":return mh(n.deferred)}}))}set(e,t){return gW(r=>pI(()=>{let n=r.unsafeCurrentTimeMillis(),i=mr(t),s=Cs(Cu(e),i,Cg(n),n+ch(u4(this.timeToLive(i))));S_(this.cacheState.map,e,s)}))}get size(){return pI(()=>SO(this.cacheState.map))}get values(){return pI(()=>{let e=[];for(let t of this.cacheState.map)"Complete"===t[1]._tag&&"Success"===t[1].exit._tag&&e.push(t[1].exit.value);return e})}get entries(){return pI(()=>{let e=[];for(let t of this.cacheState.map)"Complete"===t[1]._tag&&"Success"===t[1].exit._tag&&e.push([t[0],t[1].exit.value]);return e})}get keys(){return pI(()=>{let e=[];for(let t of this.cacheState.map)"Complete"===t[1]._tag&&"Success"===t[1].exit._tag&&e.push(t[0]);return e})}resolveMapValue(e,t=!1){return gW(r=>{switch(e._tag){case"Complete":if(this.trackAccess(e.key),this.hasExpired(r,e.timeToLiveMillis))return Sk(this.cacheState.map,e.key.current),pF(s_());return this.trackHit(),px(e.exit,i4);case"Pending":if(this.trackAccess(e.key),this.trackHit(),t)return pF(s_());return px(mh(e.deferred),i4);case"Refreshing":if(this.trackAccess(e.complete.key),this.trackHit(),this.hasExpired(r,e.complete.timeToLiveMillis)){if(t)return pF(s_());return px(mh(e.deferred),i4)}return px(e.complete.exit,i4)}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess(e){if(Ct(this.cacheState.accesses,e),cE(this.cacheState.updating,!1,!0)){let e=!0;for(;e;){let t=Cn(this.cacheState.accesses,E5);t===E5?e=!1:this.cacheState.keys.add(t)}let t=SO(this.cacheState.map);for(e=t>this.capacity;e;){let r=this.cacheState.keys.remove();void 0!==r?SS(this.cacheState.map,r.current)&&(Sk(this.cacheState.map,r.current),t-=1,e=t>this.capacity):e=!1}cC(this.cacheState.updating,!1)}}hasExpired(e,t){return e.unsafeCurrentTimeMillis()>t}lookupValueOf(e,t){return gW(r=>pR(()=>nS(this.lookup(e),mS(this.context),f7,ps(n=>{let i=r.unsafeCurrentTimeMillis(),s=Cg(i),a=Cs(Cu(e),n,s,i+ch(u4(this.timeToLive(n))));return S_(this.cacheState.map,e,a),pJ(mp(t,n),n)}),pw(()=>pJ(ps(pn,e=>mf(t,pg(e))),pI(()=>{Sk(this.cacheState.map,e)}))))))}}()=>{let e,t;return dl((e=()=>px(mu(),e=>({listeners:new _s,handle:e})),t=()=>ca(60),new Cb(65536,uz,cP,e,e=>u4(t(e)))))},()=>dl(!1);let Cy=e=>nS(mu(),ps(t=>nS(x0(e,pB(xz,pC),([e,t],[r,n])=>[bM(e,r),fo(t,n)]),py(t),xK,px(e=>pJ(e,nS(mh(t),ps(([e,t])=>fK(pB(xG(e[0]),pP(e[1])),t)))))))),Cx=function(){let e=1==arguments.length?arguments[0]:arguments[1].bind(arguments[0]);return pz(()=>e(nS))},Cv=e=>e.length>=1?fX((t,r)=>{try{e(r).then(e=>t(mr(e)),e=>t(d3(e)))}catch(e){t(d3(e))}}):fX(t=>{try{e().then(e=>t(mr(e)),e=>t(d3(e)))}catch(e){t(d3(e))}}),CS=e=>pc(e,{onFailure:e=>xB(e,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>pj}),C_=e=>ps(wP(),t=>w$(e,t)),Cw=e=>pI(()=>kl(e)),Ck=nm(2,(e,t)=>wT(e,t,(e,t)=>e(t))),CO=function(){let e="string"!=typeof arguments[0],t=e?arguments[1]:arguments[0],r=gB(e?arguments[2]:arguments[1]);if(e){let e=arguments[0];return vt(t,r,t=>vr(e,t))}return e=>vt(t,r,t=>vr(e,t))},CE=function(e,...t){let r=Error.stackTraceLimit;Error.stackTraceLimit=2;let n=Error();if(Error.stackTraceLimit=r,"string"!=typeof e)return CC(e.length,function(...r){let i=Error.stackTraceLimit;Error.stackTraceLimit=2;let s=Error();return Error.stackTraceLimit=i,CF({self:this,body:e,args:r,pipeables:t,spanName:"<anonymous>",spanOptions:{context:gq.context(!0)},errorDef:n,errorCall:s})});let i=t[0];return(t,...r)=>CC(t.length,{[e](...s){let a=Error.stackTraceLimit;Error.stackTraceLimit=2;let o=Error();return Error.stackTraceLimit=a,CF({self:this,body:t,args:s,pipeables:r,spanName:e,spanOptions:i,errorDef:n,errorCall:o})}}[e])};function CC(e,t){return Object.defineProperty(t,"length",{value:e,configurable:!0})}function CF(e){let t,r,n;if(nz(n=e.body)&&n.constructor===n3)t=pz(()=>e.body.apply(e.self,e.args));else try{t=e.body.apply(e.self,e.args)}catch(e){r=e,t=f4(e)}if(e.pipeables.length>0)try{for(let r of e.pipeables)t=r(t,...e.args)}catch(e){t=r?pt(l6(l3(r),l3(e))):f4(e)}let i=!1,s=e.spanOptions&&"captureStackTrace"in e.spanOptions?e.spanOptions:{captureStackTrace:()=>{if(!1!==i)return i;if(e.errorCall.stack){let t=e.errorDef.stack.trim().split("\n"),r=e.errorCall.stack.trim().split("\n"),n=t.slice(2).join("\n").trim();n.includes("(")||(n=n.replace(/at (.*)/,"at ($1)"));let s=r.slice(2).join("\n").trim();return s.includes("(")||(s=s.replace(/at (.*)/,"at ($1)")),i=`${n}
${s}`}},...e.spanOptions};return CO(t,e.spanName,s)}let CR=nm(2,(e,t)=>ds(we,t)(e)),CI=e=>Oc(wL(wl,l$(e))),CT=e=>Ov(px(e,CI)),CA=e=>(e=>{let t=uW("effect/Layer/unwrapScoped/Layer.Layer<R1, E1, A>");return Ot(Ou(t,e),e=>uJ(e,t))})(px(e,CI)),CN=e=>Oc(wL(wl,lz(e))),CM=nm(2,(e,t)=>Ot(CN(e),()=>CI(t))),Cj=nm(2,(e,t)=>Ot(CN(e),()=>CT(t))),CP=nm(2,(e,t)=>Ot(CN(e),()=>CA(t))),CD=ON,C$=e=>Oj(e)&&"Offset"===e._tag,Cz=e=>Oj(e)&&"Named"===e._tag,CL=e=>"Utc"===e._tag,CU=OP,CB=OD,Cq=Oz,CJ=OB,CH=Symbol.for("effect/Encoding/errors/Decode"),CV=(e,t)=>{let r={_tag:"DecodeException",[CH]:CH,input:e};return nR(t)&&(r.message=t),r},CW=Symbol.for("effect/Encoding/errors/Encode"),CK=new TextEncoder,CG=e=>{let t,r=e.length,n="";for(t=2;t<r;t+=3)n+=CY[e[t-2]>>2],n+=CY[(3&e[t-2])<<4|e[t-1]>>4],n+=CY[(15&e[t-1])<<2|e[t]>>6],n+=CY[63&e[t]];return t===r+1&&(n+=CY[e[t-2]>>2],n+=CY[(3&e[t-2])<<4],n+="=="),t===r&&(n+=CY[e[t-2]>>2],n+=CY[(3&e[t-2])<<4|e[t-1]>>4],n+=CY[(15&e[t-1])<<2],n+="="),n},CZ=e=>e.replace(/[\n\r]/g,"");function CQ(e){if(e>=CX.length)throw TypeError(`Invalid character ${String.fromCharCode(e)}`);let t=CX[e];if(255===t)throw TypeError(`Invalid character ${String.fromCharCode(e)}`);return t}let CY=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],CX=[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,62,255,255,255,63,52,53,54,55,56,57,58,59,60,61,255,255,255,0,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];e.s(["__commitHash",()=>R3,"__type",()=>R1,"__version",()=>R2],31345);class C0 extends Error{constructor(e=!1){super(),this.interruptExecution=e,this.footprint=C0.SharedFootPrint}static isFailure(e){return null!=e&&e.footprint===C0.SharedFootPrint}}C0.SharedFootPrint=Symbol.for("fast-check/PreconditionFailure");class C1{[Symbol.iterator](){return this}next(e){return{value:e,done:!0}}}C1.nil=new C1;let C2=Symbol.iterator;class C3{static nil(){return new C3(C1.nil)}static of(...e){return new C3(e[C2]())}constructor(e){this.g=e}next(){return this.g.next()}[Symbol.iterator](){return this.g}map(e){return new C3(function*(e,t){for(let r of e)yield t(r)}(this.g,e))}flatMap(e){return new C3(function*(e,t){for(let r of e)yield*t(r)}(this.g,e))}dropWhile(e){let t=!1;return this.flatMap(function*(r){(t||!e(r))&&(t=!0,yield r)})}drop(e){if(e<=0)return this;let t=0;return this.dropWhile(function(){return t++<e})}takeWhile(e){return new C3(function*(e,t){let r=e.next();for(;!r.done&&t(r.value);)yield r.value,r=e.next()}(this.g,e))}take(e){return new C3(function*(e,t){for(let r=0;r<t;++r){let t=e.next();if(t.done)break;yield t.value}}(this.g,e))}filter(e){return new C3(function*(e,t){for(let r of e)t(r)&&(yield r)}(this.g,e))}every(e){for(let t of this.g)if(!e(t))return!1;return!0}has(e){for(let t of this.g)if(e(t))return[!0,t];return[!1,null]}join(...e){return new C3(function*(e,t){for(let t=e.next();!t.done;t=e.next())yield t.value;for(let e of t)for(let t=e.next();!t.done;t=e.next())yield t.value}(this.g,e))}getNthOrLast(e){let t=e,r=null;for(let e of this.g){if(0==t--)return e;r=e}return r}}let C5=Symbol.for("fast-check/cloneMethod");function C4(e){return null!==e&&("object"==typeof e||"function"==typeof e)&&C5 in e&&"function"==typeof e[C5]}let C6=Object.defineProperty;class C8{constructor(e,t,r){this.value_=e,this.context=t,this.hasToBeCloned=void 0!==r||C4(e),this.readOnce=!1,this.hasToBeCloned?C6(this,"value",{get:void 0!==r?r:this.getValue}):this.value=e}getValue(){return this.hasToBeCloned?this.readOnce?this.value_[C5]():(this.readOnce=!0,this.value_):this.value_}}let C7=Object.assign;class C9{filter(e){return new Fr(this,e)}map(e,t){return new Ft(this,e,t)}chain(e){return new Fe(this,e)}noShrink(){return new Fn(this)}noBias(){return new Fi(this)}}class Fe extends C9{constructor(e,t){super(),this.arb=e,this.chainer=t}generate(e,t){let r=e.clone(),n=this.arb.generate(e,t);return this.valueChainer(n,e,r,t)}canShrinkWithoutContext(e){return!1}shrink(e,t){return this.isSafeContext(t)?(!t.stoppedForOriginal?this.arb.shrink(t.originalValue,t.originalContext).map(e=>this.valueChainer(e,t.clonedMrng.clone(),t.clonedMrng,t.originalBias)):C3.nil()).join(t.chainedArbitrary.shrink(e,t.chainedContext).map(e=>{let r=C7(C7({},t),{chainedContext:e.context,stoppedForOriginal:!0});return new C8(e.value_,r)})):C3.nil()}valueChainer(e,t,r,n){let i=this.chainer(e.value_),s=i.generate(t,n),a={originalBias:n,originalValue:e.value_,originalContext:e.context,stoppedForOriginal:!1,chainedArbitrary:i,chainedContext:s.context,clonedMrng:r};return new C8(s.value_,a)}isSafeContext(e){return null!=e&&"object"==typeof e&&"originalBias"in e&&"originalValue"in e&&"originalContext"in e&&"stoppedForOriginal"in e&&"chainedArbitrary"in e&&"chainedContext"in e&&"clonedMrng"in e}}class Ft extends C9{constructor(e,t,r){super(),this.arb=e,this.mapper=t,this.unmapper=r,this.bindValueMapper=e=>this.valueMapper(e)}generate(e,t){let r=this.arb.generate(e,t);return this.valueMapper(r)}canShrinkWithoutContext(e){if(void 0!==this.unmapper)try{let t=this.unmapper(e);return this.arb.canShrinkWithoutContext(t)}catch(e){}return!1}shrink(e,t){if(this.isSafeContext(t))return this.arb.shrink(t.originalValue,t.originalContext).map(this.bindValueMapper);if(void 0!==this.unmapper){let t=this.unmapper(e);return this.arb.shrink(t,void 0).map(this.bindValueMapper)}return C3.nil()}mapperWithCloneIfNeeded(e){let t=e.value,r=this.mapper(t);return e.hasToBeCloned&&("object"==typeof r&&null!==r||"function"==typeof r)&&Object.isExtensible(r)&&!C4(r)&&Object.defineProperty(r,C5,{get:()=>()=>this.mapperWithCloneIfNeeded(e)[0]}),[r,t]}valueMapper(e){let[t,r]=this.mapperWithCloneIfNeeded(e);return new C8(t,{originalValue:r,originalContext:e.context})}isSafeContext(e){return null!=e&&"object"==typeof e&&"originalValue"in e&&"originalContext"in e}}class Fr extends C9{constructor(e,t){super(),this.arb=e,this.refinement=t,this.bindRefinementOnValue=e=>this.refinementOnValue(e)}generate(e,t){for(;;){let r=this.arb.generate(e,t);if(this.refinementOnValue(r))return r}}canShrinkWithoutContext(e){return this.arb.canShrinkWithoutContext(e)&&this.refinement(e)}shrink(e,t){return this.arb.shrink(e,t).filter(this.bindRefinementOnValue)}refinementOnValue(e){return this.refinement(e.value)}}class Fn extends C9{constructor(e){super(),this.arb=e}generate(e,t){return this.arb.generate(e,t)}canShrinkWithoutContext(e){return this.arb.canShrinkWithoutContext(e)}shrink(e,t){return C3.nil()}noShrink(){return this}}class Fi extends C9{constructor(e){super(),this.arb=e}generate(e,t){return this.arb.generate(e,void 0)}canShrinkWithoutContext(e){return this.arb.canShrinkWithoutContext(e)}shrink(e,t){return this.arb.shrink(e,t)}noBias(){return this}}let Fs=Function.prototype.apply,Fa=Symbol("apply");function Fo(e,t,r){if(function(e){try{return e.apply}catch(e){return}}(e)===Fs)return e.apply(t,r);e[Fa]=Fs;let n=e[Fa](t,r);return delete e[Fa],n}let Fl="undefined"!=typeof Array?Array:void 0;"undefined"!=typeof BigInt64Array&&BigInt64Array,"undefined"!=typeof BigUint64Array&&BigUint64Array;let Fu="undefined"!=typeof Error?Error:void 0;"undefined"!=typeof Float32Array&&Float32Array,"undefined"!=typeof Float64Array&&Float64Array,"undefined"!=typeof Int8Array&&Int8Array,"undefined"!=typeof Int16Array&&Int16Array,"undefined"!=typeof Int32Array&&Int32Array;let Fc="undefined"!=typeof String?String:void 0;"undefined"!=typeof Uint8Array&&Uint8Array,"undefined"!=typeof Uint8ClampedArray&&Uint8ClampedArray,"undefined"!=typeof Uint16Array&&Uint16Array,"undefined"!=typeof Uint32Array&&Uint32Array;let Fh="undefined"!=typeof encodeURIComponent?encodeURIComponent:void 0,Ff=Symbol;Array.prototype.forEach;let Fp=Array.prototype.indexOf,Fd=Array.prototype.join,Fm=Array.prototype.map,Fg=Array.prototype.filter,Fb=Array.prototype.push;function Fy(e,...t){return function(e){try{return e.join}catch(e){return}}(e)===Fd?e.join(...t):Fo(Fd,e,t)}function Fx(e,t){return function(e){try{return e.map}catch(e){return}}(e)===Fm?e.map(t):Fo(Fm,e,[t])}Array.prototype.pop,Array.prototype.splice,Array.prototype.slice,Array.prototype.sort,Array.prototype.every;let Fv=Date.prototype.getTime,FS=Date.prototype.toISOString;Set.prototype.add,Set.prototype.has,WeakMap.prototype.set,WeakMap.prototype.get,Map.prototype.set,Map.prototype.get;let F_=String.prototype.split;String.prototype.startsWith,String.prototype.endsWith,String.prototype.substring,String.prototype.toLowerCase,String.prototype.toUpperCase,String.prototype.padStart;let Fw=String.prototype.charCodeAt;function Fk(e,...t){return function(e){try{return e.split}catch(e){return}}(e)===F_?e.split(...t):Fo(F_,e,t)}function FO(e,t){return function(e){try{return e.charCodeAt}catch(e){return}}(e)===Fw?e.charCodeAt(t):Fo(Fw,e,[t])}String.prototype.normalize,String.prototype.replace;let FE=Number.prototype.toString;Object.prototype.hasOwnProperty;let FC=Object.prototype.toString;Symbol.iterator;let FF=Math.log;function FR(e){return 2+~~(.4342944819032518*FF(e+1))}let FI={},FT=Symbol("UndefinedContextPlaceholder");function FA(e){return void 0!==e.context?e:e.hasToBeCloned?new C8(e.value_,FT,()=>e.value):new C8(e.value_,FT)}class FN{constructor(e,t){this.arb=e,this.predicate=t;let{asyncBeforeEach:r,asyncAfterEach:n,beforeEach:i,afterEach:s}=FI||{};if(void 0!==r&&void 0!==i)throw Fu('Global "asyncBeforeEach" and "beforeEach" parameters can\'t be set at the same time when running async properties');if(void 0!==n&&void 0!==s)throw Fu('Global "asyncAfterEach" and "afterEach" parameters can\'t be set at the same time when running async properties');this.beforeEachHook=r||i||FN.dummyHook,this.afterEachHook=n||s||FN.dummyHook}isAsync(){return!0}generate(e,t){return FA(this.arb.generate(e,null!=t?FR(t):void 0))}shrink(e){if(void 0===e.context&&!this.arb.canShrinkWithoutContext(e.value_))return C3.nil();let t=e.context!==FT?e.context:void 0;return this.arb.shrink(e.value_,t).map(FA)}async runBeforeEach(){await this.beforeEachHook()}async runAfterEach(){await this.afterEachHook()}async run(e,t){t||await this.beforeEachHook();try{let t=await this.predicate(e);return null==t||!0===t?null:{error:new Fu("Property failed by returning false"),errorMessage:"Error: Property failed by returning false"}}catch(e){if(C0.isFailure(e))return e;if(e instanceof Fu&&e.stack)return{error:e,errorMessage:e.stack};return{error:e,errorMessage:Fc(e)}}finally{t||await this.afterEachHook()}}beforeEach(e){let t=this.beforeEachHook;return this.beforeEachHook=()=>e(t),this}afterEach(e){let t=this.afterEachHook;return this.afterEachHook=()=>e(t),this}}FN.dummyHook=()=>{};class FM{constructor(e,t){this.arb=e,this.predicate=t;let{beforeEach:r=FM.dummyHook,afterEach:n=FM.dummyHook,asyncBeforeEach:i,asyncAfterEach:s}=FI||{};if(void 0!==i)throw Fu('"asyncBeforeEach" can\'t be set when running synchronous properties');if(void 0!==s)throw Fu('"asyncAfterEach" can\'t be set when running synchronous properties');this.beforeEachHook=r,this.afterEachHook=n}isAsync(){return!1}generate(e,t){return FA(this.arb.generate(e,null!=t?FR(t):void 0))}shrink(e){if(void 0===e.context&&!this.arb.canShrinkWithoutContext(e.value_))return C3.nil();let t=e.context!==FT?e.context:void 0;return this.arb.shrink(e.value_,t).map(FA)}runBeforeEach(){this.beforeEachHook()}runAfterEach(){this.afterEachHook()}run(e,t){t||this.beforeEachHook();try{let t=this.predicate(e);return null==t||!0===t?null:{error:new Fu("Property failed by returning false"),errorMessage:"Error: Property failed by returning false"}}catch(e){if(C0.isFailure(e))return e;if(e instanceof Fu&&e.stack)return{error:e,errorMessage:e.stack};return{error:e,errorMessage:Fc(e)}}finally{t||this.afterEachHook()}}beforeEach(e){let t=this.beforeEachHook;return this.beforeEachHook=()=>e(t),this}afterEach(e){let t=this.afterEachHook;return this.afterEachHook=()=>e(t),this}}function Fj(e,t){for(var r=[],n=0;n!=t;++n)r.push(e.unsafeNext());return r}function FP(e,t){var r=e.clone();return[Fj(r,t),r]}function FD(e,t){for(var r=0;r!=t;++r)e.unsafeNext()}function F$(e,t){var r=e.clone();return FD(r,t),r}FM.dummyHook=()=>{},e.s(["__commitHash",()=>Rl,"__type",()=>Ra,"__version",()=>Ro],82258);var Fz=-0x80000000-1,FL=function(e){return 214013*e+2531011|0},FU=function(e){return(e&Fz)>>16},FB=function(){function e(e){this.seed=e}return e.prototype.clone=function(){return new e(this.seed)},e.prototype.next=function(){var t=new e(this.seed);return[t.unsafeNext(),t]},e.prototype.unsafeNext=function(){var e=FL(this.seed),t=FU(e),r=FL(e),n=FU(r);return this.seed=FL(r),0|FU(this.seed)+(n+(t<<15)<<15)},e.prototype.getState=function(){return[this.seed]},e}(),Fq=Object.assign(function(e){return new FB(e)},{fromState:function(e){if(1!==e.length)throw Error("The state must have been produced by a congruential32 RandomGenerator");return new FB(e[0])}}),FJ=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return a},FH=function(e,t,r){if(r||2==arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},FV=function(){function e(e,t){this.states=e,this.index=t}return e.twist=function(t){for(var r=t.slice(),n=0;n!==e.N-e.M;++n){var i=(r[n]&e.MASK_UPPER)+(r[n+1]&e.MASK_LOWER);r[n]=r[n+e.M]^i>>>1^-(1&i)&e.A}for(var n=e.N-e.M;n!==e.N-1;++n){var s=(r[n]&e.MASK_UPPER)+(r[n+1]&e.MASK_LOWER);r[n]=r[n+e.M-e.N]^s>>>1^-(1&s)&e.A}var a=(r[e.N-1]&e.MASK_UPPER)+(r[0]&e.MASK_LOWER);return r[e.N-1]=r[e.M-1]^a>>>1^-(1&a)&e.A,r},e.seeded=function(t){var r=Array(e.N);r[0]=t;for(var n=1;n!==e.N;++n){var i=r[n-1]^r[n-1]>>>30;r[n]=Math.imul(e.F,i)+n|0}return r},e.from=function(t){return new e(e.twist(e.seeded(t)),0)},e.prototype.clone=function(){return new e(this.states,this.index)},e.prototype.next=function(){var t=new e(this.states,this.index);return[t.unsafeNext(),t]},e.prototype.unsafeNext=function(){var t=this.states[this.index];return t^=this.states[this.index]>>>e.U,t^=t<<e.S&e.B,t^=t<<e.T&e.C,t^=t>>>e.L,++this.index>=e.N&&(this.states=e.twist(this.states),this.index=0),t},e.prototype.getState=function(){return FH([this.index],FJ(this.states),!1)},e.fromState=function(t){if(!(t.length===e.N+1&&t[0]>=0&&t[0]<e.N))throw Error("The state must have been produced by a mersenne RandomGenerator");return new e(t.slice(1),t[0])},e.N=624,e.M=397,e.R=31,e.A=0x9908b0df,e.F=0x6c078965,e.U=11,e.S=7,e.B=0x9d2c5680,e.T=15,e.C=0xefc60000,e.L=18,e.MASK_LOWER=Math.pow(2,e.R)-1,e.MASK_UPPER=Math.pow(2,e.R),e}();let FW=Object.assign(function(e){return FV.from(e)},{fromState:function(e){return FV.fromState(e)}});var FK=function(){function e(e,t,r,n){this.s01=e,this.s00=t,this.s11=r,this.s10=n}return e.prototype.clone=function(){return new e(this.s01,this.s00,this.s11,this.s10)},e.prototype.next=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return[t.unsafeNext(),t]},e.prototype.unsafeNext=function(){var e=this.s00^this.s00<<23,t=this.s01^(this.s01<<23|this.s00>>>9),r=e^this.s10^(e>>>18|t<<14)^(this.s10>>>5|this.s11<<27),n=t^this.s11^t>>>18^this.s11>>>5,i=this.s00+this.s10|0;return this.s01=this.s11,this.s00=this.s10,this.s11=n,this.s10=r,i},e.prototype.jump=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return t.unsafeJump(),t},e.prototype.unsafeJump=function(){for(var e=0,t=0,r=0,n=0,i=[0x635d2dff,0x8a5cd789,0x5c472f96,0x121fd215],s=0;4!==s;++s)for(var a=1;a;a<<=1)i[s]&a&&(e^=this.s01,t^=this.s00,r^=this.s11,n^=this.s10),this.unsafeNext();this.s01=e,this.s00=t,this.s11=r,this.s10=n},e.prototype.getState=function(){return[this.s01,this.s00,this.s11,this.s10]},e}(),FG=Object.assign(function(e){return new FK(-1,~e,0|e,0)},{fromState:function(e){if(4!==e.length)throw Error("The state must have been produced by a xorshift128plus RandomGenerator");return new FK(e[0],e[1],e[2],e[3])}}),FZ=function(){function e(e,t,r,n){this.s01=e,this.s00=t,this.s11=r,this.s10=n}return e.prototype.clone=function(){return new e(this.s01,this.s00,this.s11,this.s10)},e.prototype.next=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return[t.unsafeNext(),t]},e.prototype.unsafeNext=function(){var e=this.s00+this.s10|0,t=this.s10^this.s00,r=this.s11^this.s01,n=this.s00,i=this.s01;return this.s00=n<<24^i>>>8^t^t<<16,this.s01=i<<24^n>>>8^r^(r<<16|t>>>16),this.s10=r<<5^t>>>27,this.s11=t<<5^r>>>27,e},e.prototype.jump=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return t.unsafeJump(),t},e.prototype.unsafeJump=function(){for(var e=0,t=0,r=0,n=0,i=[0xd8f554a5,0xdf900294,0x4b3201fc,0x170865df],s=0;4!==s;++s)for(var a=1;a;a<<=1)i[s]&a&&(e^=this.s01,t^=this.s00,r^=this.s11,n^=this.s10),this.unsafeNext();this.s01=e,this.s00=t,this.s11=r,this.s10=n},e.prototype.getState=function(){return[this.s01,this.s00,this.s11,this.s10]},e}(),FQ=Object.assign(function(e){return new FZ(-1,~e,0|e,0)},{fromState:function(e){if(4!==e.length)throw Error("The state must have been produced by a xoroshiro128plus RandomGenerator");return new FZ(e[0],e[1],e[2],e[3])}});function FY(e,t){if(e.sign!==t.sign)return FX(e,{sign:-t.sign,data:t.data});for(var r=[],n=0,i=e.data,s=t.data,a=i.length-1,o=s.length-1;a>=0||o>=0;--a,--o){var l=(a>=0?i[a]:0)+(o>=0?s[o]:0)+n;r.push(l>>>0),n=~~(l/0x100000000)}return 0!==n&&r.push(n),{sign:e.sign,data:r.reverse()}}function FX(e,t){if(e.sign!==t.sign)return FY(e,{sign:-t.sign,data:t.data});var r=e.data,n=t.data;if(function(e,t){for(var r=Math.max(e.length,t.length),n=0;n<r;++n){var i=n+e.length-r,s=n+t.length-r,a=i>=0?e[i]:0,o=s>=0?t[s]:0;if(a<o)return!0;if(a>o)break}return!1}(r,n)){var i=FX(t,e);return i.sign=-i.sign,i}for(var s=[],a=0,o=r.length-1,l=n.length-1;o>=0||l>=0;--o,--l){var u=(o>=0?r[o]:0)-(l>=0?n[l]:0)-a;s.push(u>>>0),a=+(u<0)}return{sign:e.sign,data:s.reverse()}}function F0(e){for(var t=e.data,r=0;r!==t.length&&0===t[r];++r);return r===t.length?(e.sign=1,e.data=[0]):t.splice(0,r),e}function F1(e,t){if(t<0){var r=-t;e.sign=-1,e.data[0]=~~(r/0x100000000),e.data[1]=r>>>0}else e.sign=1,e.data[0]=~~(t/0x100000000),e.data[1]=t>>>0;return e}function F2(e,t){for(var r=e>2?~~(0x100000000/e)*e:0x100000000,n=t.unsafeNext()+0x80000000;n>=r;)n=t.unsafeNext()+0x80000000;return n%e}function F3(e,t,r){for(var n=t.length;;){for(var i=0;i!==n;++i){var s=F2(0===i?t[0]+1:0x100000000,r);e[i]=s}for(var i=0;i!==n;++i){var a=e[i],o=t[i];if(a<o)return e;if(a>o)break}}}function F5(e,t,r){var n=F0(function(e){e.sign=1;for(var t=e.data,r=t.length-1;r>=0;--r)if(0xffffffff!==t[r])return t[r]+=1,e;else t[r]=0;return t.unshift(1),e}(FX(t,e)));return F0(FY({sign:1,data:F3(n.data.slice(0),n.data,r)},e))}function F4(e,t,r){if(null!=r){var n=r.clone();return[F5(e,t,n),n]}return function(r){var n=r.clone();return[F5(e,t,n),n]}}var F6="undefined"!=typeof BigInt?BigInt:void 0;function F8(e,t,r){for(var n=t-e+F6(1),i=F6(-0x80000000),s=F6(0x100000000),a=s,o=1;a<n;)a*=s,++o;for(var l=a-a%n;;){for(var u=F6(0),c=0;c!==o;++c)u=s*u+(F6(r.unsafeNext())-i);if(u<l)return u%n+e}}function F7(e,t,r){if(null!=r){var n=r.clone();return[F8(e,t,n),n]}return function(r){var n=r.clone();return[F8(e,t,n),n]}}var F9=Number.MAX_SAFE_INTEGER,Re={sign:1,data:[0,0]},Rt={sign:1,data:[0,0]},Rr={sign:1,data:[0,0]},Rn=[0,0];function Ri(e,t,r){var n,i=t-e;return i<=0xffffffff?F2(i+1,r)+e:(0xffffffff===(n=i<=F9?F1(Rr,i):function(e,t,r){var n=t.data[1],i=t.data[0],s=t.sign,a=r.data[1],o=r.data[0],l=r.sign;if(e.sign=1,1===s&&-1===l){var u=n+a;return e.data[0]=i+o+ +(u>0xffffffff)>>>0,e.data[1]=u>>>0,e}var c=n,h=i,f=a,p=o;-1===s&&(c=a,h=o,f=n,p=i);var d=0,m=c-f;return m<0&&(d=1,m>>>=0),e.data[0]=h-p-d,e.data[1]=m,e}(Rr,F1(Re,t),F1(Rt,e))).data[1]?(n.data[0]+=1,n.data[1]=0):n.data[1]+=1,F3(Rn,n.data,r),0x100000000*Rn[0]+Rn[1]+e)}function Rs(e,t,r){if(null!=r){var n=r.clone();return[Ri(e,t,n),n]}return function(r){var n=r.clone();return[Ri(e,t,n),n]}}var Ra="module",Ro="6.1.0",Rl="a413dd2b721516be2ef29adffb515c5ae67bfbad";e.s(["__commitHash",()=>Rl,"__type",()=>Ra,"__version",()=>Ro,"congruential32",()=>Fq,"generateN",()=>FP,"mersenne",()=>FW,"skipN",()=>F$,"uniformArrayIntDistribution",()=>F4,"uniformBigIntDistribution",()=>F7,"uniformIntDistribution",()=>Rs,"unsafeGenerateN",()=>Fj,"unsafeSkipN",()=>FD,"unsafeUniformArrayIntDistribution",()=>F5,"unsafeUniformBigIntDistribution",()=>F8,"unsafeUniformIntDistribution",()=>Ri,"xoroshiro128plus",()=>FQ,"xorshift128plus",()=>FG],98425),e.i(82258);var Ru=e.i(98425);!function(e){e[e.None=0]="None",e[e.Verbose=1]="Verbose",e[e.VeryVerbose=2]="VeryVerbose"}(f||(f={}));let Rc=Date.now,Rh=Math.min,Rf=Math.random;class Rp{constructor(e){let t=e||{};this.seed=Rp.readSeed(t),this.randomType=Rp.readRandomType(t),this.numRuns=Rp.readNumRuns(t),this.verbose=Rp.readVerbose(t),this.maxSkipsPerRun=Rp.readOrDefault(t,"maxSkipsPerRun",100),this.timeout=Rp.safeTimeout(Rp.readOrDefault(t,"timeout",null)),this.skipAllAfterTimeLimit=Rp.safeTimeout(Rp.readOrDefault(t,"skipAllAfterTimeLimit",null)),this.interruptAfterTimeLimit=Rp.safeTimeout(Rp.readOrDefault(t,"interruptAfterTimeLimit",null)),this.markInterruptAsFailure=Rp.readBoolean(t,"markInterruptAsFailure"),this.skipEqualValues=Rp.readBoolean(t,"skipEqualValues"),this.ignoreEqualValues=Rp.readBoolean(t,"ignoreEqualValues"),this.logger=Rp.readOrDefault(t,"logger",e=>{console.log(e)}),this.path=Rp.readOrDefault(t,"path",""),this.unbiased=Rp.readBoolean(t,"unbiased"),this.examples=Rp.readOrDefault(t,"examples",[]),this.endOnFailure=Rp.readBoolean(t,"endOnFailure"),this.reporter=Rp.readOrDefault(t,"reporter",null),this.asyncReporter=Rp.readOrDefault(t,"asyncReporter",null),this.errorWithCause=Rp.readBoolean(t,"errorWithCause")}toParameters(){let e=e=>null!==e?e:void 0;return{seed:this.seed,randomType:this.randomType,numRuns:this.numRuns,maxSkipsPerRun:this.maxSkipsPerRun,timeout:e(this.timeout),skipAllAfterTimeLimit:e(this.skipAllAfterTimeLimit),interruptAfterTimeLimit:e(this.interruptAfterTimeLimit),markInterruptAsFailure:this.markInterruptAsFailure,skipEqualValues:this.skipEqualValues,ignoreEqualValues:this.ignoreEqualValues,path:this.path,logger:this.logger,unbiased:this.unbiased,verbose:this.verbose,examples:this.examples,endOnFailure:this.endOnFailure,reporter:e(this.reporter),asyncReporter:e(this.asyncReporter),errorWithCause:this.errorWithCause}}static read(e){return new Rp(e)}}Rp.createQualifiedRandomGenerator=e=>t=>{let r=e(t);return void 0===r.unsafeJump&&(r.unsafeJump=()=>FD(r,42)),r},Rp.readSeed=e=>{if(null==e.seed)return Rc()^0x100000000*Rf();let t=0|e.seed;if(e.seed===t)return t;let r=e.seed-t;return t^0x100000000*r},Rp.readRandomType=e=>{if(null==e.randomType)return Ru.xorshift128plus;if("string"==typeof e.randomType)switch(e.randomType){case"mersenne":return Rp.createQualifiedRandomGenerator(Ru.mersenne);case"congruential":case"congruential32":return Rp.createQualifiedRandomGenerator(Ru.congruential32);case"xorshift128plus":return Ru.xorshift128plus;case"xoroshiro128plus":return Ru.xoroshiro128plus;default:throw Error(`Invalid random specified: '${e.randomType}'`)}let t=e.randomType(0);if("min"in t&&-0x80000000!==t.min)throw Error(`Invalid random number generator: min must equal -0x80000000, got ${String(t.min)}`);if("max"in t&&0x7fffffff!==t.max)throw Error(`Invalid random number generator: max must equal 0x7fffffff, got ${String(t.max)}`);return"unsafeJump"in t?e.randomType:Rp.createQualifiedRandomGenerator(e.randomType)},Rp.readNumRuns=e=>null!=e.numRuns?e.numRuns:null!=e.num_runs?e.num_runs:100,Rp.readVerbose=e=>null==e.verbose?f.None:"boolean"==typeof e.verbose?!0===e.verbose?f.Verbose:f.None:e.verbose<=f.None?f.None:e.verbose>=f.VeryVerbose?f.VeryVerbose:0|e.verbose,Rp.readBoolean=(e,t)=>!0===e[t],Rp.readOrDefault=(e,t,r)=>{let n=e[t];return null!=n?n:r},Rp.safeTimeout=e=>null===e?null:Rh(e,0x7fffffff);let Rd=Array.from,Rm="undefined"!=typeof Buffer?Buffer.isBuffer:void 0,Rg=JSON.stringify,Rb=Number.isNaN,Ry=Object.keys,Rx=Object.getOwnPropertySymbols,Rv=Object.getOwnPropertyDescriptor,RS=Object.getPrototypeOf,R_=-1/0,Rw=1/0,Rk=Symbol.for("fast-check/toStringMethod"),RO=Symbol.for("fast-check/asyncToStringMethod"),RE=/^Symbol\((.*)\)$/;function RC(e){switch(e){case 0:return 1/e===R_?"-0":"0";case R_:return"Number.NEGATIVE_INFINITY";case Rw:return"Number.POSITIVE_INFINITY";default:return e==e?Fc(e):"Number.NaN"}}function RF(e){return function e(t,r,n){var i,s;let a=[...r,t];if("object"==typeof t&&-1!==function(e,...t){return function(e){try{return e.indexOf}catch(e){return}}(e)===Fp?e.indexOf(...t):Fo(Fp,e,t)}(r,t))return"[cyclic]";if(null!==t&&("object"==typeof t||"function"==typeof t)&&RO in t&&"function"==typeof t[RO]){let e=n(t);if("fulfilled"===e.state)return e.value}if(null!==t&&("object"==typeof t||"function"==typeof t)&&Rk in t&&"function"==typeof t[Rk])try{return t[Rk]()}catch(e){}switch(Fo(FC,t,[])){case"[object Array]":{if(t.length>=50&&function(e){let t=-1;for(let r in e){let e=Number(r);if(e!==t+1)return!0;t=e}return t+1!==e.length}(t)){let r=[];for(let i in t)Rb(Number(i))||function(e,...t){(function(e){try{return e.push}catch(e){return}})(e)===Fb?e.push(...t):Fo(Fb,e,t)}(r,`${i}:${e(t[i],a,n)}`);return 0!==r.length?`Object.assign(Array(${t.length}),{${Fy(r,",")}})`:`Array(${t.length})`}let r=Fy(Fx(t,t=>e(t,a,n)),",");return 0===t.length||t.length-1 in t?`[${r}]`:`[${r},]`}case"[object BigInt]":return`${t}n`;case"[object Boolean]":{let e=!0==t?"true":"false";return"boolean"==typeof t?e:`new Boolean(${e})`}case"[object Date]":return Rb(function(e){try{return e.getTime}catch(e){return}}(t)===Fv?t.getTime():Fo(Fv,t,[]))?"new Date(NaN)":`new Date(${Rg(function(e){try{return e.toISOString}catch(e){return}}(t)===FS?t.toISOString():Fo(FS,t,[]))})`;case"[object Map]":return`new Map(${e(Array.from(t),a,n)})`;case"[object Null]":return"null";case"[object Number]":return"number"==typeof t?RC(t):`new Number(${RC(Number(t))})`;case"[object Object]":{try{let e=t.toString;if("function"==typeof e&&e!==Object.prototype.toString)return t.toString()}catch(e){return"[object Object]"}let r=r=>`${"__proto__"===r?'["__proto__"]':"symbol"==typeof r?`[${e(r,a,n)}]`:Rg(r)}:${e(t[r],a,n)}`,o="{"+Fy([...Fx(Ry(t),r),...Fx((i=Rx(t),s=e=>{let r=Rv(t,e);return r&&r.enumerable},function(e){try{return e.filter}catch(e){return}}(i)===Fg?i.filter(s):Fo(Fg,i,[s])),r)],",")+"}";if(null===RS(t))return"{}"===o?"Object.create(null)":`Object.assign(Object.create(null),${o})`;return o}case"[object Set]":return`new Set(${e(Array.from(t),a,n)})`;case"[object String]":return"string"==typeof t?Rg(t):`new String(${Rg(t)})`;case"[object Symbol]":{if(void 0!==Ff.keyFor(t))return`Symbol.for(${Rg(Ff.keyFor(t))})`;let e=function(e){if(void 0!==e.description)return e.description;let t=RE.exec(Fc(e));return t&&t[1].length?t[1]:null}(t);if(null===e)return"Symbol()";return t===(e.startsWith("Symbol.")&&Ff[e.substring(7)])?e:`Symbol(${Rg(e)})`}case"[object Promise]":{let r=n(t);switch(r.state){case"fulfilled":return`Promise.resolve(${e(r.value,a,n)})`;case"rejected":return`Promise.reject(${e(r.value,a,n)})`;case"pending":return"new Promise(() => {/*pending*/})";default:return"new Promise(() => {/*unknown*/})"}}case"[object Error]":if(t instanceof Error)return`new Error(${e(t.message,a,n)})`;break;case"[object Undefined]":return"undefined";case"[object Int8Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Int16Array]":case"[object Uint16Array]":case"[object Int32Array]":case"[object Uint32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object BigInt64Array]":case"[object BigUint64Array]":{if("function"==typeof Rm&&Rm(t))return`Buffer.from(${e(Rd(t.values()),a,n)})`;let r=RS(t),i=r&&r.constructor&&r.constructor.name;if("string"==typeof i){let r=t.values();return`${i}.from(${e(Rd(r),a,n)})`}}}try{return t.toString()}catch(e){return Fo(FC,t,[])}}(e,[],()=>({state:"unknown",value:void 0}))}!function(e){e[e.Success=0]="Success",e[e.Skipped=-1]="Skipped",e[e.Failure=1]="Failure"}(p||(p={}));class RR{constructor(e,t){this.verbosity=e,this.interruptedAsFailure=t,this.isSuccess=()=>null==this.pathToFailure,this.firstFailure=()=>this.pathToFailure?+Fk(this.pathToFailure,":")[0]:-1,this.numShrinks=()=>this.pathToFailure?Fk(this.pathToFailure,":").length-1:0,this.rootExecutionTrees=[],this.currentLevelExecutionTrees=this.rootExecutionTrees,this.failure=null,this.numSkips=0,this.numSuccesses=0,this.interrupted=!1}appendExecutionTree(e,t){let r={status:e,value:t,children:[]};return this.currentLevelExecutionTrees.push(r),r}fail(e,t,r){if(this.verbosity>=f.Verbose){let t=this.appendExecutionTree(p.Failure,e);this.currentLevelExecutionTrees=t.children}null==this.pathToFailure?this.pathToFailure=`${t}`:this.pathToFailure+=`:${t}`,this.value=e,this.failure=r}skip(e){this.verbosity>=f.VeryVerbose&&this.appendExecutionTree(p.Skipped,e),null==this.pathToFailure&&++this.numSkips}success(e){this.verbosity>=f.VeryVerbose&&this.appendExecutionTree(p.Success,e),null==this.pathToFailure&&++this.numSuccesses}interrupt(){this.interrupted=!0}extractFailures(){if(this.isSuccess())return[];let e=[],t=this.rootExecutionTrees;for(;t.length>0&&t[t.length-1].status===p.Failure;){let r=t[t.length-1];e.push(r.value),t=r.children}return e}toRunDetails(e,t,r,n){if(!this.isSuccess())return{failed:!0,interrupted:this.interrupted,numRuns:this.firstFailure()+1-this.numSkips,numSkips:this.numSkips,numShrinks:this.numShrinks(),seed:e,counterexample:this.value,counterexamplePath:RR.mergePaths(t,this.pathToFailure),error:this.failure.errorMessage,errorInstance:this.failure.error,failures:this.extractFailures(),executionSummary:this.rootExecutionTrees,verbose:this.verbosity,runConfiguration:n.toParameters()};let i=this.interruptedAsFailure||0===this.numSuccesses;return{failed:this.numSkips>r||this.interrupted&&i,interrupted:this.interrupted,numRuns:this.numSuccesses,numSkips:this.numSkips,numShrinks:0,seed:e,counterexample:null,counterexamplePath:null,error:null,errorInstance:null,failures:[],executionSummary:this.rootExecutionTrees,verbose:this.verbosity,runConfiguration:n.toParameters()}}}RR.mergePaths=(e,t)=>{if(0===e.length)return t;let r=e.split(":"),n=t.split(":"),i=+r[r.length-1]+ +n[0];return[...r.slice(0,r.length-1),`${i}`,...n.slice(1)].join(":")},Symbol.iterator,Symbol.iterator;class RI{constructor(e){this.internalRng=e.clone()}clone(){return new RI(this.internalRng)}next(e){return Ri(0,(1<<e)-1,this.internalRng)}nextBoolean(){return 1==Ri(0,1,this.internalRng)}nextInt(e,t){return Ri(null==e?RI.MIN_INT:e,null==t?RI.MAX_INT:t,this.internalRng)}nextBigInt(e,t){return F8(e,t,this.internalRng)}nextArrayInt(e,t){return F5(e,t,this.internalRng)}nextDouble(){let e=this.next(26),t=this.next(27);return(e*RI.DBL_FACTOR+t)*RI.DBL_DIVISOR}getState(){if("getState"in this.internalRng&&"function"==typeof this.internalRng.getState)return this.internalRng.getState()}}RI.MIN_INT=-0x80000000,RI.MAX_INT=0x7fffffff,RI.DBL_FACTOR=0x8000000,RI.DBL_DIVISOR=11102230246251565e-32,Object.assign,Object.assign,Object.assign,Object.keys,Object.is;let RT=Math.floor,RA=Math.log;function RN(e){return RT(RA(e)/RA(2))}let RM=Math.ceil,Rj=Math.floor;function RP(e,t,r){let n=e-t;return new C3(n>0?function*(){let i=r?void 0:t,s=r?n:Rj(n/2);for(let r=s;r>0;r=Rj(r/2)){let s=r===n?t:e-r;yield new C8(s,i),i=s}}():function*(){let i=r?void 0:t,s=r?n:RM(n/2);for(let r=s;r<0;r=RM(r/2)){let s=r===n?t:e-r;yield new C8(s,i),i=s}}())}let RD=Math.sign,R$=Number.isInteger,Rz=Object.is;class RL extends C9{constructor(e,t){super(),this.min=e,this.max=t}generate(e,t){let r=this.computeGenerateRange(e,t);return new C8(e.nextInt(r.min,r.max),void 0)}canShrinkWithoutContext(e){return"number"==typeof e&&R$(e)&&!Rz(e,-0)&&this.min<=e&&e<=this.max}shrink(e,t){return RL.isValidContext(e,t)?this.isLastChanceTry(e,t)?C3.of(new C8(t,void 0)):RP(e,t,!1):RP(e,this.defaultTarget(),!0)}defaultTarget(){return this.min<=0&&this.max>=0?0:this.min<0?this.max:this.min}computeGenerateRange(e,t){if(void 0===t||1!==e.nextInt(1,t))return{min:this.min,max:this.max};let r=function(e,t,r){if(e===t)return[{min:e,max:t}];if(e<0&&t>0){let n=r(-e),i=r(t);return[{min:-n,max:i},{min:t-i,max:t},{min:e,max:e+n}]}let n=r(t-e),i={min:e,max:e+n},s={min:t-n,max:t};return e<0?[s,i]:[i,s]}(this.min,this.max,RN);if(1===r.length)return r[0];let n=e.nextInt(-2*(r.length-1),r.length-2);return n<0?r[0]:r[n+1]}isLastChanceTry(e,t){return e>0?e===t+1&&e>this.min:e<0&&e===t-1&&e<this.max}static isValidContext(e,t){if(void 0===t)return!1;if("number"!=typeof t)throw Error("Invalid context type passed to IntegerArbitrary (#1)");if(0!==t&&RD(e)!==RD(t))throw Error("Invalid context value passed to IntegerArbitrary (#2)");return!0}}let RU=Number.isInteger;Object.is;let RB=String.fromCodePoint;function Rq(e,t,r,n){return(function(e={}){var t;let r={min:void 0!==(t=e).min?t.min:-0x80000000,max:void 0!==t.max?t.max:0x7fffffff};if(r.min>r.max)throw Error("fc.integer maximum value should be equal or greater than the minimum one");if(!RU(r.min))throw Error("fc.integer minimum value should be an integer");if(!RU(r.max))throw Error("fc.integer maximum value should be an integer");return new RL(r.min,r.max)})({min:e,max:t}).map(e=>RB(r(e)),e=>n(function(e){if("string"!=typeof e)throw Error("Cannot unmap non-string");if(0===e.length||e.length>2)throw Error("Cannot unmap string with more or less than one character");let t=FO(e,0);if(1===e.length)return t;let r=FO(e,1);if(t<55296||t>56319||r<56320||r>57343)throw Error("Cannot unmap invalid surrogate pairs");return e.codePointAt(0)}(e)))}function RJ(e){return e}class RH{constructor(){this.receivedLogs=[]}log(e){this.receivedLogs.push(e)}size(){return this.receivedLogs.length}toString(){return JSON.stringify({logs:this.receivedLogs})}[C5](){return new RH}}Symbol.iterator,Object.is,Object.is,Object.create,Object.getOwnPropertyDescriptor,Object.getPrototypeOf,Object.getOwnPropertySymbols,Object.getOwnPropertyNames,Object.entries,Number.MAX_SAFE_INTEGER,Number.isInteger,Number.isInteger,Object.is,Rq(0,1112063,function(e){if(e<55296)return e<95?e+32:e<=126?e-95:e;return e+2048},function(e){if(e<55296)return e>=32&&e<=126?e-32:e>=0&&e<=31?e+95:e;return e<=57343?-1:e-2048}).map(function(e){let t=Fh(e);return e!==t?t:`%${function(e,...t){return function(e){try{return e.toString}catch(e){return}}(e)===FE?e.toString(...t):Fo(FE,e,t)}(FO(e,0),16)}`},function(e){if("string"!=typeof e)throw Error("Unsupported");return decodeURIComponent(e)}),new WeakMap,String.fromCodePoint,Object.create(null),Object.assign,Symbol("adapted-value"),Number.EPSILON;let RV=new Float64Array(1);new Uint32Array(RV.buffer,RV.byteOffset),Number.isInteger,Object.is,Number.MAX_VALUE,Number.isInteger,Number.MAX_VALUE;let RW=new Float32Array(1);new Uint32Array(RW.buffer,RW.byteOffset),Number.isInteger,Object.assign,Object.keys,Object.assign,Object.assign,Object.defineProperties,Object.keys,Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.parseInt,Object.assign,Object.create,Fl.isArray,Object.entries,Object.assign,Object.assign,Object.keys,Object.getOwnPropertySymbols,Object.getOwnPropertyDescriptor,Object.create,Object.getOwnPropertyDescriptor,Object.getOwnPropertyNames,Object.getOwnPropertySymbols,Symbol("no-key"),Object.defineProperties,Object.assign,Object.assign,Object.assign,Object.is;let RK={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F",16:"G",17:"H",18:"J",19:"K",20:"M",21:"N",22:"P",23:"Q",24:"R",25:"S",26:"T",27:"V",28:"W",29:"X",30:"Y",31:"Z"};function RG(e,t){let r="";for(;e.length+r.length<t;)r+="0";return r+e}function RZ(e){let t="";for(let n=e;0!==n;){var r;let e=n>>5;t=((r=n-(e<<5))<10?Fc(r):RK[r])+t,n=e}return t}function RQ(e){return function(t){return RG(RZ(~~(t/0x40000000)),e-6)+RG(RZ(0x3fffffff&t),6)}}RQ(10),RQ(8),Object.assign;class RY{constructor(e,t){this.commands=e,this.metadataForReplay=t}[Symbol.iterator](){return this.commands[Symbol.iterator]()}[C5](){return new RY(this.commands.map(e=>e.clone()),this.metadataForReplay)}toString(){let e=this.commands.filter(e=>e.hasRan).map(e=>e.toString()).join(","),t=this.metadataForReplay();return 0!==t.length?`${e} /*${t}*/`:e}}let RX=e=>e();class R0{constructor(e,t){this.act=e,this.taskSelector=t,this.lastTaskId=0,this.sourceTaskSelector=t.clone(),this.scheduledTasks=[],this.triggeredTasks=[],this.scheduledWatchers=[]}static buildLog(e){return`[task\${${e.taskId}}] ${0!==e.label.length?`${e.schedulingType}::${e.label}`:e.schedulingType} ${e.status}${void 0!==e.outputValue?` with value ${e.outputValue.replace(/([$`\\])/g,"\\$1").replace(/\r/g,"\\r")}`:""}`}log(e,t,r,n,i,s){this.triggeredTasks.push({status:i,schedulingType:e,taskId:t,label:r,metadata:n,outputValue:void 0!==s?RF(s):void 0})}scheduleInternal(e,t,r,n,i,s){let a=null,o=++this.lastTaskId,l=new Promise((i,l)=>{a=()=>{(s?r.then(()=>s()):r).then(r=>(this.log(e,o,t,n,"resolved",r),i(r)),r=>(this.log(e,o,t,n,"rejected",r),l(r)))}});return this.scheduledTasks.push({original:r,scheduled:l,trigger:a,schedulingType:e,taskId:o,label:t,metadata:n,customAct:i}),0!==this.scheduledWatchers.length&&this.scheduledWatchers[0](),l}schedule(e,t,r,n){return this.scheduleInternal("promise",t||"",e,r,n||RX)}scheduleFunction(e,t){return(...r)=>this.scheduleInternal("function",`${e.name}(${r.map(RF).join(",")})`,e(...r),void 0,t||RX)}scheduleSequence(e,t){let r={done:!1,faulty:!1},n={then:e=>e()},i=()=>{},s=new Promise(e=>i=e);return e.reduce((e,s)=>{let[a,o,l]="function"==typeof s?[s,s.name,void 0]:[s.builder,s.label,s.metadata];return e.then(()=>{let e=this.scheduleInternal("sequence",o,n,l,t||RX,()=>a());return e.catch(()=>{r.faulty=!0,i()}),e})},n).then(()=>{r.done=!0,i()},()=>{}),Object.assign(r,{task:Promise.resolve(s).then(()=>({done:r.done,faulty:r.faulty}))})}count(){return this.scheduledTasks.length}internalWaitOne(){if(0===this.scheduledTasks.length)throw Error("No task scheduled");let e=this.taskSelector.nextTaskIndex(this.scheduledTasks),[t]=this.scheduledTasks.splice(e,1);return t.customAct(async()=>{t.trigger();try{await t.scheduled}catch(e){}})}async waitOne(e){let t=e||RX;await this.act(()=>t(async()=>await this.internalWaitOne()))}async waitAll(e){for(;this.scheduledTasks.length>0;)await this.waitOne(e)}async waitFor(e,t){let r=!1,n=null,i=async()=>{for(;!r&&this.scheduledTasks.length>0;)await this.waitOne(t);n=null},s=()=>{null===n&&(n=Promise.resolve().then(i))},a=()=>{let e=this.scheduledWatchers.indexOf(s);-1!==e&&this.scheduledWatchers.splice(e,1),0===e&&0!==this.scheduledWatchers.length&&this.scheduledWatchers[0]()},o=e.then(e=>(r=!0,null===n)?(a(),e):n.then(()=>(a(),e)),e=>{if(r=!0,null===n)throw a(),e;return n.then(()=>{throw a(),e})});return this.scheduledTasks.length>0&&0===this.scheduledWatchers.length&&s(),this.scheduledWatchers.push(s),o}report(){return[...this.triggeredTasks,...this.scheduledTasks.map(e=>({status:"pending",schedulingType:e.schedulingType,taskId:e.taskId,label:e.label,metadata:e.metadata}))]}toString(){return"schedulerFor()`\n"+this.report().map(R0.buildLog).map(e=>`-> ${e}`).join("\n")+"`"}[C5](){return new R0(this.act,this.sourceTaskSelector)}}!function(e){e[e.Full=0]="Full",e[e.Character=1]="Character"}(d||(d={})),String.fromCodePoint,String.fromCodePoint,[..."abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_"],[..."0123456789"],[..." 	\r\n\v\f"],[..."\r\n",..."\x1e\x15"],Rq(32,126,RJ,RJ);let R1="module",R2="3.23.2",R3="a4a600eaa08c833707067a877db144289a724b91";e.i(31345);let R5=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return R5(e,t.from)}},R4=e=>Object.keys(e).concat(Object.getOwnPropertySymbols(e)),R6=e=>{let t,r=!1;return()=>(r||(t=e(),r=!0),t)},R8=e=>{try{return e.toISOString()}catch{return String(e)}},R7=(e,t=!0)=>{if(Array.isArray(e))return`[${e.map(e=>R7(e,t)).join(",")}]`;if(nJ(e))return R8(e);if(nL(e,"toString")&&"function"==typeof e.toString&&e.toString!==Object.prototype.toString)return e.toString();if(nR(e))return JSON.stringify(e);if(nI(e)||null==e||nT(e)||nN(e))return String(e);if(nA(e))return String(e)+"n";if(nH(e))return`${e.constructor.name}(${R7(Array.from(e),t)})`;try{t&&JSON.stringify(e);let r=`{${R4(e).map(t=>`${nR(t)?JSON.stringify(t):String(t)}:${R7(e[t],!1)}`).join(",")}}`,n=e.constructor.name;return e.constructor!==Object.prototype.constructor?`${n}(${r})`:r}catch{return"<circular structure>"}},R9=e=>"string"==typeof e?JSON.stringify(e):String(e),Ie=e=>Array.isArray(e),It=e=>`[${R9(e)}]`,Ir=e=>Ie(e)?e.map(It).join(""):It(e),In=(e,t,r,n)=>{let i=e;return r&&s9(r)&&(i+=`
at path: ${Ir(r)}`),void 0!==t&&(i+=`
details: ${t}`),n&&(i+=`
schema (${n._tag}): ${n}`),i},Ii=(e,t,r)=>In("Unsupported schema",e,t,r),Is=(e,t,r)=>In("Unsupported schema or overlapping types",`cannot extend ${e} with ${t}`,r),Ia=e=>Ii(void 0,void 0,e),Io=e=>In("Duplicate index signature",`${e} index signature`),Il=In("Unsupported index signature parameter","An index signature parameter type must be `string`, `symbol`, a template literal type or a refinement of the previous types"),Iu=In("Invalid element","A required element cannot follow an optional element. ts(1257)"),Ic=e=>In("Duplicate property signature transformation",`Duplicate key ${R7(e)}`),Ih=e=>In("Duplicate property signature",`Duplicate key ${R7(e)}`),If=Symbol.for("effect/SchemaId/DateFromSelf"),Ip=Symbol.for("effect/SchemaId/GreaterThan"),Id=Symbol.for("effect/SchemaId/GreaterThanOrEqualTo"),Im=Symbol.for("effect/SchemaId/LessThan"),Ig=Symbol.for("effect/SchemaId/LessThanOrEqualTo"),Ib=Symbol.for("effect/SchemaId/Int"),Iy=Symbol.for("effect/SchemaId/NonNaN"),Ix=Symbol.for("effect/SchemaId/Finite"),Iv=Symbol.for("effect/SchemaId/JsonNumber"),IS=Symbol.for("effect/SchemaId/Between"),I_=Symbol.for("effect/SchemaId/GreaterThanOrEqualToBigint"),Iw=Symbol.for("effect/SchemaId/BetweenBigint"),Ik=Symbol.for("effect/SchemaId/MinLength"),IO=Symbol.for("effect/SchemaId/Length"),IE=Symbol.for("effect/annotation/Brand"),IC=Symbol.for("effect/annotation/SchemaId"),IF=Symbol.for("effect/annotation/Message"),IR=Symbol.for("effect/annotation/MissingMessage"),II=Symbol.for("effect/annotation/Identifier"),IT=Symbol.for("effect/annotation/Title"),IA=Symbol.for("effect/annotation/AutoTitle"),IN=Symbol.for("effect/annotation/Description"),IM=Symbol.for("effect/annotation/Examples"),Ij=Symbol.for("effect/annotation/Default"),IP=Symbol.for("effect/annotation/JSONSchema"),ID=Symbol.for("effect/annotation/Arbitrary"),I$=Symbol.for("effect/annotation/Pretty"),Iz=Symbol.for("effect/annotation/Equivalence"),IL=Symbol.for("effect/annotation/Documentation"),IU=Symbol.for("effect/annotation/Concurrency"),IB=Symbol.for("effect/annotation/Batching"),Iq=Symbol.for("effect/annotation/ParseIssueTitle"),IJ=Symbol.for("effect/annotation/ParseOptions"),IH=Symbol.for("effect/annotation/DecodingFallback"),IV=Symbol.for("effect/annotation/Surrogate"),IW=Symbol.for("effect/annotation/StableFilter"),IK=nm(2,(e,t)=>Object.prototype.hasOwnProperty.call(e.annotations,t)?i4(e.annotations[t]):s_()),IG=IK(IE),IZ=IK(IF),IQ=IK(IR),IY=IK(IT),IX=IK(IA),I0=IK(II),I1=IK(IN),I2=IK(IU),I3=IK(IB),I5=IK(Iq),I4=IK(IJ),I6=IK(IH),I8=IK(IV),I7=IK(IW),I9=e=>s$(I7(e),e=>!0===e),Te=Symbol.for("effect/annotation/JSONIdentifier"),Tt=IK(Te),Tr=Symbol.for("effect/schema/ParseJson");class Tn{typeParameters;decodeUnknown;encodeUnknown;annotations;_tag="Declaration";constructor(e,t,r,n={}){this.typeParameters=e,this.decodeUnknown=t,this.encodeUnknown=r,this.annotations=n}toString(){return sk(Av(this),()=>"<declaration schema>")}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map(e=>e.toJSON()),annotations:Ah(this.annotations)}}}let Ti=e=>t=>t._tag===e;class Ts{literal;annotations;_tag="Literal";constructor(e,t={}){this.literal=e,this.annotations=t}toString(){return sk(Av(this),()=>R7(this.literal))}toJSON(){return{_tag:this._tag,literal:nA(this.literal)?String(this.literal):this.literal,annotations:Ah(this.annotations)}}}let Ta=Ti("Literal"),To=new Ts(null);class Tl{symbol;annotations;_tag="UniqueSymbol";constructor(e,t={}){this.symbol=e,this.annotations=t}toString(){return sk(Av(this),()=>R7(this.symbol))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:Ah(this.annotations)}}}let Tu=Ti("UniqueSymbol"),Tc=new class{annotations;_tag="UndefinedKeyword";constructor(e={}){this.annotations=e}toString(){return Ay(this)}toJSON(){return{_tag:this._tag,annotations:Ah(this.annotations)}}}({[IT]:"undefined"}),Th=new class{annotations;_tag="NeverKeyword";constructor(e={}){this.annotations=e}toString(){return Ay(this)}toJSON(){return{_tag:this._tag,annotations:Ah(this.annotations)}}}({[IT]:"never"}),Tf=Ti("NeverKeyword"),Tp=new class{annotations;_tag="UnknownKeyword";constructor(e={}){this.annotations=e}toString(){return Ay(this)}toJSON(){return{_tag:this._tag,annotations:Ah(this.annotations)}}}({[IT]:"unknown"}),Td=new class{annotations;_tag="AnyKeyword";constructor(e={}){this.annotations=e}toString(){return Ay(this)}toJSON(){return{_tag:this._tag,annotations:Ah(this.annotations)}}}({[IT]:"any"}),Tm=new class{annotations;_tag="StringKeyword";constructor(e={}){this.annotations=e}toString(){return Ay(this)}toJSON(){return{_tag:this._tag,annotations:Ah(this.annotations)}}}({[IT]:"string",[IN]:"a string"}),Tg=Ti("StringKeyword"),Tb=new class{annotations;_tag="NumberKeyword";constructor(e={}){this.annotations=e}toString(){return Ay(this)}toJSON(){return{_tag:this._tag,annotations:Ah(this.annotations)}}}({[IT]:"number",[IN]:"a number"}),Ty=Ti("NumberKeyword"),Tx=new class{annotations;_tag="BooleanKeyword";constructor(e={}){this.annotations=e}toString(){return Ay(this)}toJSON(){return{_tag:this._tag,annotations:Ah(this.annotations)}}}({[IT]:"boolean",[IN]:"a boolean"}),Tv=Ti("BooleanKeyword"),TS=new class{annotations;_tag="BigIntKeyword";constructor(e={}){this.annotations=e}toString(){return Ay(this)}toJSON(){return{_tag:this._tag,annotations:Ah(this.annotations)}}}({[IT]:"bigint",[IN]:"a bigint"}),T_=new class{annotations;_tag="SymbolKeyword";constructor(e={}){this.annotations=e}toString(){return Ay(this)}toJSON(){return{_tag:this._tag,annotations:Ah(this.annotations)}}}({[IT]:"symbol",[IN]:"a symbol"}),Tw=Ti("SymbolKeyword"),Tk=Ti("Enums"),TO=e=>{switch(e._tag){case"Literal":case"NumberKeyword":case"StringKeyword":case"TemplateLiteral":return!0;case"Union":return e.types.every(TO)}return!1},TE=e=>{switch(e._tag){case"Literal":return JSON.stringify(String(e.literal));case"StringKeyword":return"string";case"NumberKeyword":return"number";case"TemplateLiteral":return String(e);case"Union":return e.types.map(TE).join(" | ")}},TC=Ti("TemplateLiteral");class TF{type;annotations;constructor(e,t={}){this.type=e,this.annotations=t}toJSON(){return{type:this.type.toJSON(),annotations:Ah(this.annotations)}}toString(){return String(this.type)}}class TR extends TF{isOptional;constructor(e,t,r={}){super(e,r),this.isOptional=t}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:Ah(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}let TI=e=>e.map(e=>e.type);class TT{elements;rest;isReadonly;annotations;_tag="TupleType";constructor(e,t,r,n={}){this.elements=e,this.rest=t,this.isReadonly=r,this.annotations=n;let i=!1,s=!1;for(let t of e)if(t.isOptional)i=!0;else if(i){s=!0;break}if(s||i&&t.length>1)throw Error(Iu)}toString(){return sk(Av(this),()=>TA(this))}toJSON(){return{_tag:this._tag,elements:this.elements.map(e=>e.toJSON()),rest:this.rest.map(e=>e.toJSON()),isReadonly:this.isReadonly,annotations:Ah(this.annotations)}}}let TA=e=>{let t=e.elements.map(String).join(", ");return s5(e.rest,{onEmpty:()=>`readonly [${t}]`,onNonEmpty:(r,n)=>{let i=String(r),s=i.includes(" | ")?`(${i})`:i;if(n.length>0){let r=n.map(String).join(", ");return e.elements.length>0?`readonly [${t}, ...${s}[], ${r}]`:`readonly [...${s}[], ${r}]`}return e.elements.length>0?`readonly [${t}, ...${s}[]]`:`ReadonlyArray<${i}>`}})};class TN extends TR{name;isReadonly;constructor(e,t,r,n,i){super(t,r,i),this.name=e,this.isReadonly=n}toString(){return(this.isReadonly?"readonly ":"")+String(this.name)+(this.isOptional?"?":"")+": "+this.type}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:Ah(this.annotations)}}}let TM=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return TM(e.from)}return!1};class Tj{type;isReadonly;parameter;constructor(e,t,r){if(this.type=t,this.isReadonly=r,TM(e))this.parameter=e;else throw Error(Il)}toString(){return(this.isReadonly?"readonly ":"")+`[x: ${this.parameter}]: ${this.type}`}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class TP{annotations;_tag="TypeLiteral";propertySignatures;indexSignatures;constructor(e,t,r={}){this.annotations=r;let n={};for(let t=0;t<e.length;t++){let r=e[t].name;if(Object.prototype.hasOwnProperty.call(n,r))throw Error(Ih(r));n[r]=null}let i={string:!1,symbol:!1};for(let e=0;e<t.length;e++){let r=Af(t[e].parameter);if(Tg(r)){if(i.string)throw Error(Io("string"));i.string=!0}else if(Tw(r)){if(i.symbol)throw Error(Io("symbol"));i.symbol=!0}}this.propertySignatures=e,this.indexSignatures=t}toString(){return sk(Av(this),()=>T$(this))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map(e=>e.toJSON()),indexSignatures:this.indexSignatures.map(e=>e.toJSON()),annotations:Ah(this.annotations)}}}let TD=e=>e.map(String).join("; "),T$=e=>{if(e.propertySignatures.length>0){let t=e.propertySignatures.map(String).join("; ");return e.indexSignatures.length>0?`{ ${t}; ${TD(e.indexSignatures)} }`:`{ ${t} }`}return e.indexSignatures.length>0?`{ ${TD(e.indexSignatures)} }`:"{}"},Tz=Ti("TypeLiteral"),TL=ap(sy(sg,e=>{switch(e._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4})),TU={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},TB=e=>aR(e,e=>TH(e)?TB(e.types):[e]);class Tq{types;annotations;static make=(e,t)=>TJ(e)?new Tq(e,t):1===e.length?e[0]:Th;static unify=(e,t)=>Tq.make((e=>{let t=TL(e),r=[],n={},i=[];for(let e of t)switch(e._tag){case"NeverKeyword":break;case"AnyKeyword":return[Td];case"UnknownKeyword":return[Tp];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":n[e._tag]||(n[e._tag]=e,r.push(e));break;case"Literal":{let t=typeof e.literal;switch(t){case"string":case"number":case"bigint":case"boolean":n[TU[t]]||i.includes(e.literal)||(i.push(e.literal),r.push(e));break;case"object":i.includes(e.literal)||(i.push(e.literal),r.push(e))}break}case"UniqueSymbol":n.SymbolKeyword||i.includes(e.symbol)||(i.push(e.symbol),r.push(e));break;case"TupleType":n.ObjectKeyword||r.push(e);break;case"TypeLiteral":0===e.propertySignatures.length&&0===e.indexSignatures.length?n["{}"]||(n["{}"]=e,r.push(e)):n.ObjectKeyword||r.push(e);break;default:r.push(e)}return r})(TB(e)),t);_tag="Union";constructor(e,t={}){this.types=e,this.annotations=t}toString(){return sk(Av(this),()=>this.types.map(String).join(" | "))}toJSON(){return{_tag:this._tag,types:this.types.map(e=>e.toJSON()),annotations:Ah(this.annotations)}}}let TJ=e=>e.length>1,TH=Ti("Union"),TV=nF(Symbol.for("effect/Schema/AST/toJSONMemoMap"),()=>new WeakMap);class TW{f;annotations;_tag="Suspend";constructor(e,t={}){this.f=e,this.annotations=t,this.f=R6(e)}toString(){return Av(this).pipe(sO(()=>sN(sR(this.f)(),e=>Av(e))),sk(()=>"<suspended schema>"))}toJSON(){let e=this.f(),t=TV.get(e);return t||(TV.set(e,{_tag:this._tag}),t={_tag:this._tag,ast:e.toJSON(),annotations:Ah(this.annotations)},TV.set(e,t)),t}}class TK{from;filter;annotations;_tag="Refinement";constructor(e,t,r={}){this.from=e,this.filter=t,this.annotations=r}toString(){return I0(this).pipe(sk(()=>sw(Ax(this),{onNone:()=>`{ ${this.from} | filter }`,onSome:e=>TG(this.from)?String(this.from)+" & "+e:e})))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:Ah(this.annotations)}}}let TG=Ti("Refinement"),TZ={};class TQ{from;to;transformation;annotations;_tag="Transformation";constructor(e,t,r,n={}){this.from=e,this.to=t,this.transformation=r,this.annotations=n}toString(){return sk(Av(this),()=>`(${String(this.from)} <-> ${String(this.to)})`)}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:Ah(this.annotations)}}}let TY=Ti("Transformation");class TX{decode;encode;_tag="FinalTransformation";constructor(e,t){this.decode=e,this.encode=t}}let T0=new class{_tag="ComposeTransformation"};class T1{from;to;decode;encode;constructor(e,t,r,n){this.from=e,this.to=t,this.decode=r,this.encode=n}}class T2{propertySignatureTransformations;_tag="TypeLiteralTransformation";constructor(e){this.propertySignatureTransformations=e;let t={},r={};for(let n of e){let e=n.from;if(t[e])throw Error(Ic(e));t[e]=!0;let i=n.to;if(r[i])throw Error(Ic(i));r[i]=!0}}}let T3=(e,t)=>{let r=Object.getOwnPropertyDescriptors(e),n={...e.annotations,...t},i=I8(e);return i3(i)&&(n[IV]=T3(i.value,t)),r.annotations.value=n,Object.create(Object.getPrototypeOf(e),r)},T5=(e,t)=>{switch(e._tag){case"Literal":return mG(String(e.literal));case"StringKeyword":return"[\\s\\S]*?";case"NumberKeyword":return"[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?";case"TemplateLiteral":return T6(e,t,!1);case"Union":return e.types.map(e=>T5(e,t)).join("|")}},T4=(e,t,r,n)=>{if(TH(e)){if(r&&!n)return`(?:${t})`}else if(!r||!n)return t;return`(${t})`},T6=(e,t,r)=>{let n="";if(""!==e.head){let i=mG(e.head);n+=t&&r?`(${i})`:i}for(let i of e.spans){let e=T5(i.type,t);if(n+=T4(i.type,e,t,r),""!==i.literal){let e=mG(i.literal);n+=t&&r?`(${e})`:e}}return n},T8=e=>RegExp(`^${T6(e,!1,!0)}$`),T7=e=>{switch(e._tag){case"TupleType":{let t=!1,r=[];for(let n of e.elements)n.isOptional&&(t=!0),r.push(n.type);return t&&r.push(Tc),r=r.concat(TI(e.rest)),Tq.make(r)}case"Refinement":return T7(e.from);case"Union":return Tq.make(e.types.map(T7));case"Suspend":return T7(e.f())}throw Error(Ia(e))},T9=(e,t)=>{let r=sB(e.propertySignatures,e=>e.name===t);if(i3(r))return r.value;if(nR(t)){let r;for(let n of e.indexSignatures){let e=Af(n.parameter);switch(e._tag){case"TemplateLiteral":if(T8(e).test(t))return new TN(t,n.type,!1,!0);break;case"StringKeyword":void 0===r&&(r=new TN(t,n.type,!1,!0))}}if(r)return r}else if(nN(t)){for(let r of e.indexSignatures)if(Tw(Af(r.parameter)))return new TN(t,r.type,!1,!0)}},Ae=(e,t)=>{let r=I8(e);if(i3(r))return Ae(r.value,t);switch(e._tag){case"TypeLiteral":{let r=T9(e,t);if(r)return r;break}case"Union":return new TN(t,Tq.make(e.types.map(e=>Ae(e,t).type)),!1,!0);case"Suspend":return Ae(e.f(),t);case"Refinement":return Ae(e.from,t)}throw Error(Ia(e))},At=(e,t)=>{let r=[],n=[],i=e=>{switch(e._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":n.push(new Tj(e,t,!0));break;case"Literal":if(nR(e.literal)||nI(e.literal))r.push(new TN(e.literal,t,!1,!0));else{let t;throw Error((t=e.literal,In("Unsupported literal",`literal value: ${R7(t)}`)))}break;case"Enums":for(let[n,i]of e.enums)r.push(new TN(i,t,!1,!0));break;case"UniqueSymbol":r.push(new TN(e.symbol,t,!1,!0));break;case"Union":e.types.forEach(i);break;default:throw Error(In("Unsupported key schema",void 0,void 0,e))}};return i(e),{propertySignatures:r,indexSignatures:n}},Ar=e=>{switch(e._tag){case"TupleType":return!1===e.isReadonly?e:new TT(e.elements,e.rest,!1,e.annotations);case"TypeLiteral":{let t=Ao(e.propertySignatures,e=>!1===e.isReadonly?e:new TN(e.name,e.type,e.isOptional,!1,e.annotations)),r=Ao(e.indexSignatures,e=>!1===e.isReadonly?e:new Tj(e.parameter,e.type,!1));return t===e.propertySignatures&&r===e.indexSignatures?e:new TP(t,r,e.annotations)}case"Union":{let t=Ao(e.types,Ar);return t===e.types?e:Tq.make(t,e.annotations)}case"Suspend":return new TW(()=>Ar(e.f()),e.annotations);case"Refinement":{let t=Ar(e.from);return t===e.from?e:new TK(t,e.filter,e.annotations)}case"Transformation":{let t=Ar(e.from),r=Ar(e.to);return t===e.from&&r===e.to?e:new TQ(t,r,e.transformation,e.annotations)}}return e},An=e=>t=>{let r;for(let n of e)Object.prototype.hasOwnProperty.call(t.annotations,n)&&(void 0===r&&(r={}),r[n]=t.annotations[n]);return r},Ai=An([IM,Ij,IP,ID,I$,Iz]),As=e=>{switch(e._tag){case"Declaration":{let t=Ao(e.typeParameters,As);return t===e.typeParameters?e:new Tn(t,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{let t=Ao(e.elements,e=>{let t=As(e.type);return t===e.type?e:new TR(t,e.isOptional)}),r=TI(e.rest),n=Ao(r,As);return t===e.elements&&n===r?e:new TT(t,n.map(e=>new TF(e)),e.isReadonly,e.annotations)}case"TypeLiteral":{let t=Ao(e.propertySignatures,e=>{let t=As(e.type);return t===e.type?e:new TN(e.name,t,e.isOptional,e.isReadonly)}),r=Ao(e.indexSignatures,e=>{let t=As(e.type);return t===e.type?e:new Tj(e.parameter,t,e.isReadonly)});return t===e.propertySignatures&&r===e.indexSignatures?e:new TP(t,r,e.annotations)}case"Union":{let t=Ao(e.types,As);return t===e.types?e:Tq.make(t,e.annotations)}case"Suspend":return new TW(()=>As(e.f()),e.annotations);case"Refinement":{let t=As(e.from);return t===e.from?e:new TK(t,e.filter,e.annotations)}case"Transformation":{let t=Ai(e);return As(void 0!==t?T3(e.to,t):e.to)}}return e},Aa=e=>sw((e=>sO(Tt(e),()=>I0(e)))(e),{onNone:()=>void 0,onSome:e=>({[Te]:e})});function Ao(e,t){let r=!1,n=sX(e.length);for(let i=0;i<e.length;i++){let s=e[i],a=t(s);a!==s&&(r=!0),n[i]=a}return r?n:e}let Al=e=>{switch(e._tag){case"Transformation":return e.from;case"Refinement":return Al(e.from);case"Suspend":return Al(e.f())}},Au=(e,t)=>{switch(e._tag){case"Declaration":{let r=Ao(e.typeParameters,e=>Au(e,t));return r===e.typeParameters?e:new Tn(r,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{let r=Ao(e.elements,e=>{let r=Au(e.type,t);return r===e.type?e:new TR(r,e.isOptional)}),n=TI(e.rest),i=Ao(n,e=>Au(e,t));return r===e.elements&&i===n?e:new TT(r,i.map(e=>new TF(e)),e.isReadonly,Aa(e))}case"TypeLiteral":{let r=Ao(e.propertySignatures,e=>{let r=Au(e.type,t);return r===e.type?e:new TN(e.name,r,e.isOptional,e.isReadonly)}),n=Ao(e.indexSignatures,e=>{let r=Au(e.type,t);return r===e.type?e:new Tj(e.parameter,r,e.isReadonly)});return r===e.propertySignatures&&n===e.indexSignatures?e:new TP(r,n,Aa(e))}case"Union":{let r=Ao(e.types,e=>Au(e,t));return r===e.types?e:Tq.make(r,Aa(e))}case"Suspend":return new TW(()=>Au(e.f(),t),Aa(e));case"Refinement":{let r=Au(e.from,t);if(t){if(r===e.from)return e;if(void 0===Al(e.from)&&I9(e))return new TK(r,e.filter,e.annotations)}let n=Aa(e);return n?T3(r,n):r}case"Transformation":{let r=Aa(e);return Au(r?T3(e.from,r):e.from,t)}}return e},Ac=e=>Au(e,!1),Ah=e=>{let t={};for(let r of Object.getOwnPropertySymbols(e))t[String(r)]=e[r];return t},Af=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return Af(e.from)}},Ap=(e,t)=>{switch(e._tag){case"Literal":return Ta(t)&&t.literal===e.literal;case"UniqueSymbol":return Tu(t)&&t.symbol===e.symbol;case"UndefinedKeyword":case"VoidKeyword":case"NeverKeyword":case"UnknownKeyword":case"AnyKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":case"ObjectKeyword":return t._tag===e._tag;case"TemplateLiteral":return TC(t)&&t.head===e.head&&Ad(t.spans,e.spans);case"Enums":return Tk(t)&&Am(t.enums,e.enums);case"Union":return TH(t)&&Ag(e.types,t.types);case"Refinement":case"TupleType":case"TypeLiteral":case"Suspend":case"Transformation":case"Declaration":return e===t}},Ad=az((e,t)=>e.literal===t.literal&&Ap(e.type,t.type)),Am=az((e,t)=>t[0]===e[0]&&t[1]===e[1]),Ag=az(Ap),Ab=(e,t)=>new TQ(e,t,T0),Ay=e=>sk(Av(e),()=>e._tag),Ax=e=>IY(e).pipe(sO(()=>I1(e)),sO(()=>IX(e)),sA(t=>t+sw(IG(e),{onNone:()=>"",onSome:e=>e.map(e=>` & Brand<${R7(e)}>`).join("")}))),Av=e=>sO(I0(e),()=>Ax(e));class AS{path;actual;issue;_tag="Pointer";constructor(e,t,r){this.path=e,this.actual=t,this.issue=r}}class A_{actual;message;_tag="Unexpected";constructor(e,t){this.actual=e,this.message=t}}class Aw{ast;message;_tag="Missing";actual=void 0;constructor(e,t){this.ast=e,this.message=t}}class Ak{ast;actual;issues;output;_tag="Composite";constructor(e,t,r,n){this.ast=e,this.actual=t,this.issues=r,this.output=n}}class AO{ast;actual;kind;issue;_tag="Refinement";constructor(e,t,r,n){this.ast=e,this.actual=t,this.kind=r,this.issue=n}}class AE{ast;actual;kind;issue;_tag="Transformation";constructor(e,t,r,n){this.ast=e,this.actual=t,this.kind=r,this.issue=n}}class AC{ast;actual;message;_tag="Type";constructor(e,t,r){this.ast=e,this.actual=t,this.message=r}}class AF{ast;actual;message;_tag="Forbidden";constructor(e,t,r){this.ast=e,this.actual=t,this.message=r}}let AR=Symbol.for("effect/Schema/ParseErrorTypeId");class AI extends ba("ParseError"){[AR]=AR;get message(){return this.toString()}toString(){return A8.formatIssueSync(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[ih](){return this.toJSON()}}let AT=e=>new AI({issue:e}),AA=si,AN=e=>{if("function"==typeof e)try{return si(e())}catch(e){return sn(e)}try{return si(e.try())}catch(t){return sn(e.catch(t))}},AM=ss,Aj=nm(2,(e,t)=>se(e)?su(e,{onLeft:sn,onRight:t}):ps(e,t)),AP=nm(2,(e,t)=>se(e)?sl(e,t):px(e,t)),AD=nm(2,(e,t)=>se(e)?so(e,t):pS(e,t)),A$=nm(2,(e,t)=>se(e)?sa(e,{onLeft:t.onFailure,onRight:t.onSuccess}):pv(e,t)),Az=nm(2,(e,t)=>se(e)?su(e,{onLeft:t,onRight:si}):f1(e,t)),AL=(e,t)=>void 0===t||nI(t)?e:void 0===e?t:{...e,...t},AU=(e,t,r)=>{let n=AK(e,t);return(e,t)=>n(e,AL(r,t))},AB=(e,t,r)=>{let n=AK(e,t);return(e,t)=>n(e,{...AL(r,t),isEffectAllowed:!0})},Aq=(e,t)=>AB(e.ast,!0,t),AJ=(e,t)=>AB(e.ast,!1,t),AH=(e,t)=>((e,t,r)=>{let n=AU(e,t,r);return(e,t)=>sh(n(e,t),AT)})(As(e.ast),!0,t),AV=nF(Symbol.for("effect/ParseResult/decodeMemoMap"),()=>new WeakMap),AW=nF(Symbol.for("effect/ParseResult/encodeMemoMap"),()=>new WeakMap),AK=(e,t)=>{let r=t?AV:AW,n=r.get(e);if(n)return n;let i=AQ(e,t),s=I4(e),a=i3(s)?(e,t)=>i(e,AL(t,s.value)):i,o=I6(e),l=t&&i3(o)?(t,r)=>A2(Az(a(t,r),o.value),e,t,r):a;return r.set(e,l),l},AG=e=>sF(I2(e)),AZ=e=>sF(I3(e)),AQ=(e,t)=>{switch(e._tag){case"Refinement":if(t){let t=AK(e.from,!0);return(r,n)=>{n=n??TZ;let i=n?.errors==="all";return A2(Aj(Az(t(r,n),t=>{let s=new AO(e,r,"From",t);return i&&I9(e)&&Nn(t)?sw(e.filter(r,n,e),{onNone:()=>sn(s),onSome:t=>sn(new Ak(e,r,[s,new AO(e,r,"Predicate",t)]))}):sn(s)}),t=>sw(e.filter(t,n,e),{onNone:()=>si(t),onSome:t=>sn(new AO(e,r,"Predicate",t))})),e,r,n)}}{let t=AK(As(e),!0),r=AK(A1(e.from),!1);return(n,i)=>A2(Aj(t(n,i),e=>r(e,i)),e,n,i)}case"Transformation":{let r=A4(e.transformation,t),n=t?AK(e.from,!0):AK(e.to,!1),i=t?AK(e.to,!0):AK(e.from,!1);return(s,a)=>A2(Aj(AD(n(s,a),r=>new AE(e,s,t?"Encoded":"Type",r)),n=>Aj(AD(r(n,a??TZ,e,s),t=>new AE(e,s,"Transformation",t)),r=>AD(i(r,a),r=>new AE(e,s,t?"Type":"Encoded",r)))),e,s,a)}case"Declaration":{let r=t?e.decodeUnknown(...e.typeParameters):e.encodeUnknown(...e.typeParameters);return(t,n)=>A2(r(t,n??TZ,e),e,t,n)}case"Literal":return AY(e,t=>t===e.literal);case"UniqueSymbol":return AY(e,t=>t===e.symbol);case"UndefinedKeyword":return AY(e,nM);case"NeverKeyword":return AY(e,nD);case"UnknownKeyword":case"AnyKeyword":case"VoidKeyword":return si;case"StringKeyword":return AY(e,nR);case"NumberKeyword":return AY(e,nI);case"BooleanKeyword":return AY(e,nT);case"BigIntKeyword":return AY(e,nA);case"SymbolKeyword":return AY(e,nN);case"ObjectKeyword":return AY(e,nz);case"Enums":return AY(e,t=>e.enums.some(([e,r])=>r===t));case"TemplateLiteral":{let t=T8(e);return AY(e,e=>nR(e)&&t.test(e))}case"TupleType":{let r=e.elements.map(e=>AK(e.type,t)),n=e.rest.map(e=>AK(e.type,t)),i=e.elements.filter(e=>!e.isOptional);e.rest.length>0&&(i=i.concat(e.rest.slice(1)));let s=i.length,a=e.elements.length>0?e.elements.map((e,t)=>t).join(" | "):"never",o=AG(e),l=AZ(e);return(t,u)=>{let c;if(!s7(t))return sn(new AC(e,t));let h=u?.errors==="all",f=[],p=0,d=[],m=t.length;for(let r=m;r<=s-1;r++){let n=new AS(r,t,new Aw(i[r-m]));if(!h)return sn(new Ak(e,t,n,d));f.push([p++,n])}if(0===e.rest.length)for(let r=e.elements.length;r<=m-1;r++){let n=new AS(r,t,new A_(t[r],`is unexpected, expected: ${a}`));if(!h)return sn(new Ak(e,t,n,d));f.push([p++,n])}let g=0;for(;g<r.length;g++)if(m<g+1){if(e.elements[g].isOptional)continue}else{let n=(0,r[g])(t[g],u);if(se(n)){if(st(n)){let r=new AS(g,t,n.left);if(!h)return sn(new Ak(e,t,r,A5(d)));f.push([p++,r]);continue}d.push([p++,n.right])}else{let r=p++,i=g;c||(c=[]),c.push(({es:s,output:a})=>ps(f8(n),n=>{if(st(n)){let o=new AS(i,t,n.left);return h?(s.push([r,o]),pj):sn(new Ak(e,t,o,A5(a)))}return a.push([r,n.right]),pj}))}}if(s9(n)){let[r,...i]=n;for(;g<m-i.length;g++){let n=r(t[g],u);if(se(n))if(st(n)){let r=new AS(g,t,n.left);if(!h)return sn(new Ak(e,t,r,A5(d)));f.push([p++,r]);continue}else d.push([p++,n.right]);else{let r=p++,i=g;c||(c=[]),c.push(({es:s,output:a})=>ps(f8(n),n=>{if(!st(n))return a.push([r,n.right]),pj;{let o=new AS(i,t,n.left);return h?(s.push([r,o]),pj):sn(new Ak(e,t,o,A5(a)))}}))}}for(let r=0;r<i.length;r++)if(!(m<(g+=r)+1)){let n=i[r](t[g],u);if(se(n)){if(st(n)){let r=new AS(g,t,n.left);if(!h)return sn(new Ak(e,t,r,A5(d)));f.push([p++,r]);continue}d.push([p++,n.right])}else{let r=p++,i=g;c||(c=[]),c.push(({es:s,output:a})=>ps(f8(n),n=>{if(st(n)){let o=new AS(i,t,n.left);return h?(s.push([r,o]),pj):sn(new Ak(e,t,o,A5(a)))}return a.push([r,n.right]),pj}))}}}let b=({es:r,output:n})=>sd(r)?sn(new Ak(e,t,A5(r),A5(n))):si(A5(n));if(c&&c.length>0){let e=c;return pR(()=>{let t={es:aS(f),output:aS(d)};return ps(wp(e,e=>e(t),{concurrency:o,batching:l,discard:!0}),()=>b(t))})}return b({output:d,es:f})}}case"TypeLiteral":{if(0===e.propertySignatures.length&&0===e.indexSignatures.length)return AY(e,nB);let r=[],n={},i=[];for(let s of e.propertySignatures)r.push([AK(s.type,t),s]),n[s.name]=null,i.push(s.name);let s=e.indexSignatures.map(e=>[AK(e.parameter,t),AK(e.type,t),e.parameter]),a=Tq.make(e.indexSignatures.map(e=>e.parameter).concat(i.map(e=>nN(e)?new Tl(e):new Ts(e)))),o=AK(a,t),l=AG(e),u=AZ(e);return(t,c)=>{let h,f;if(!(e=>n$(e)&&!Array.isArray(e))(t))return sn(new AC(e,t));let p=c?.errors==="all",d=[],m=0,g=c?.onExcessProperty==="error",b=c?.onExcessProperty==="preserve",y={};if(g||b)for(let r of h=R4(t)){let n=o(r,c);if(se(n)&&st(n))if(g){let n=new AS(r,t,new A_(t[r],`is unexpected, expected: ${String(a)}`));if(!p)return sn(new Ak(e,t,n,y));d.push([m++,n]);continue}else y[r]=t[r]}let x=c?.exact===!0;for(let n=0;n<r.length;n++){let i=r[n][1],s=i.name,a=Object.prototype.hasOwnProperty.call(t,s);if(!a){if(i.isOptional)continue;else if(x){let r=new AS(s,t,new Aw(i));if(!p)return sn(new Ak(e,t,r,y));d.push([m++,r]);continue}}let o=(0,r[n][0])(t[s],c);if(se(o)){if(st(o)){let r=new AS(s,t,a?o.left:new Aw(i));if(!p)return sn(new Ak(e,t,r,y));d.push([m++,r]);continue}y[s]=o.right}else{let r=m++;f||(f=[]),f.push(({es:n,output:l})=>ps(f8(o),o=>{if(st(o)){let u=new AS(s,t,a?o.left:new Aw(i));return p?(n.push([r,u]),pj):sn(new Ak(e,t,u,l))}return l[s]=o.right,pj}))}}for(let r=0;r<s.length;r++){let i=s[r],a=i[0],o=i[1];for(let r of R5(t,i[2])){let i=a(r,c);if(se(i)&&sr(i)){let i=o(t[r],c);if(se(i))if(st(i)){let n=new AS(r,t,i.left);if(!p)return sn(new Ak(e,t,n,y));d.push([m++,n]);continue}else Object.prototype.hasOwnProperty.call(n,r)||(y[r]=i.right);else{let s=m++,a=r;f||(f=[]),f.push(({es:o,output:l})=>ps(f8(i),i=>{if(!st(i))return Object.prototype.hasOwnProperty.call(n,r)||(l[r]=i.right),pj;{let r=new AS(a,t,i.left);return p?(o.push([s,r]),pj):sn(new Ak(e,t,r,l))}}))}}}}let v=({es:r,output:n})=>{if(sd(r))return sn(new Ak(e,t,A5(r),n));if(c?.propertyOrder==="original"){let e=h||R4(t);for(let t of i)-1===e.indexOf(t)&&e.push(t);let r={};for(let t of e)Object.prototype.hasOwnProperty.call(n,t)&&(r[t]=n[t]);return si(r)}return si(n)};if(f&&f.length>0){let e=f;return pR(()=>{let t={es:aS(d),output:Object.assign({},y)};return ps(wp(e,e=>e(t),{concurrency:l,batching:u,discard:!0}),()=>v(t))})}return v({es:d,output:y})}}case"Union":{let r=A0(e.types,t),n=R4(r.keys),i=n.length,s=e.types.length,a=new Map;for(let r=0;r<s;r++)a.set(e.types[r],AK(e.types[r],t));let o=AG(e)??1,l=AZ(e);return(t,u)=>{let c,h=[],f=0,p=[];if(i>0)if(n$(t))for(let e=0;e<i;e++){let i=n[e],a=r.keys[i].buckets;if(Object.prototype.hasOwnProperty.call(t,i)){let e=String(t[i]);if(Object.prototype.hasOwnProperty.call(a,e))p=p.concat(a[e]);else{let{candidates:e,literals:n}=r.keys[i],a=Tq.make(n),o=e.length===s?new TP([new TN(i,a,!1,!0)],[]):Tq.make(e);h.push([f++,new Ak(o,t,new AS(i,t,new AC(a,t[i])))])}}else{let{candidates:e,literals:n}=r.keys[i],a=new TN(i,Tq.make(n),!1,!0),o=e.length===s?new TP([a],[]):Tq.make(e);h.push([f++,new Ak(o,t,new AS(i,t,new Aw(a)))])}}else{let n=r.candidates.length===s?e:Tq.make(r.candidates);h.push([f++,new AC(n,t)])}r.otherwise.length>0&&(p=p.concat(r.otherwise));for(let e=0;e<p.length;e++){let r=p[e],n=a.get(r)(t,u);if(se(n)&&(!c||0===c.length))if(sr(n))return n;else h.push([f++,n.left]);else{let e=f++;c||(c=[]),c.push(t=>pR(()=>"finalResult"in t?pj:ps(f8(n),r=>(sr(r)?t.finalResult=r:t.es.push([e,r.left]),pj))))}}let d=r=>sd(r)?1===r.length&&"Type"===r[0][1]._tag?sn(r[0][1]):sn(new Ak(e,t,A5(r))):sn(new AC(e,t));if(c&&c.length>0){let e=c;return pR(()=>{let t={es:aS(h)};return ps(wp(e,e=>e(t),{concurrency:o,batching:l,discard:!0}),()=>"finalResult"in t?t.finalResult:d(t.es))})}return d(h)}}case"Suspend":{let r=R6(()=>AK(T3(e.f(),e.annotations),t));return(e,t)=>r()(e,t)}}},AY=(e,t)=>r=>t(r)?si(r):sn(new AC(e,r)),AX=(e,t)=>{switch(e._tag){case"Declaration":{let r=I8(e);if(i3(r))return AX(r.value,t);break}case"TypeLiteral":{let r=[];for(let n=0;n<e.propertySignatures.length;n++){let i=e.propertySignatures[n],s=t?Ac(i.type):As(i.type);Ta(s)&&!i.isOptional&&r.push([i.name,s])}return r}case"TupleType":{let r=[];for(let n=0;n<e.elements.length;n++){let i=e.elements[n],s=t?Ac(i.type):As(i.type);Ta(s)&&!i.isOptional&&r.push([n,s])}return r}case"Refinement":return AX(e.from,t);case"Suspend":return AX(e.f(),t);case"Transformation":return AX(t?e.from:e.to,t)}return[]},A0=(e,t)=>{let r={},n=[],i=[];for(let s=0;s<e.length;s++){let a=e[s],o=AX(a,t);if(o.length>0){i.push(a);for(let e=0;e<o.length;e++){let[t,n]=o[e],i=String(n.literal);r[t]=r[t]||{buckets:{},literals:[],candidates:[]};let s=r[t].buckets;if(Object.prototype.hasOwnProperty.call(s,i)){if(e<o.length-1)continue;s[i].push(a),r[t].literals.push(n),r[t].candidates.push(a)}else{s[i]=[a],r[t].literals.push(n),r[t].candidates.push(a);break}}}else n.push(a)}return{keys:r,otherwise:n,candidates:i}},A1=e=>TG(e)?A1(e.from):e,A2=(e,t,r,n)=>{if(n?.isEffectAllowed===!0||se(e))return e;let i=new xd,s=kH(e,{scheduler:i});i.flush();let a=s.unsafePoll();if(a){if(dX(a))return si(a.value);let e=a.cause;return e._tag===lK?sn(e.error):sn(new AF(t,r,uS(e)))}return sn(new AF(t,r,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))},A3=([e],[t])=>e>t?1:e<t?-1:0;function A5(e){return e.sort(A3).map(e=>e[1])}let A4=(e,t)=>{switch(e._tag){case"FinalTransformation":return t?e.decode:e.encode;case"ComposeTransformation":return si;case"TypeLiteralTransformation":return r=>{let n=si(r);for(let r of e.propertySignatureTransformations){let[e,i]=t?[r.from,r.to]:[r.to,r.from],s=t?r.decode:r.encode;n=AP(n,t=>{let r=s(Object.prototype.hasOwnProperty.call(t,e)?i4(t[e]):s_());return delete t[e],i3(r)&&(t[i]=r.value),t})}return n}}},A6=(e,t=[])=>({value:e,forest:t}),A8={formatIssue:e=>AP(Nh(e),A7),formatIssueSync:e=>{let t=A8.formatIssue(e);return se(t)?sf(t):kK(t)},formatError:e=>A8.formatIssue(e.issue),formatErrorSync:e=>A8.formatIssueSync(e.issue)},A7=e=>e.value+A9("\n",e.forest),A9=(e,t)=>{let r,n="",i=t.length;for(let s=0;s<i;s++){r=t[s];let a=s===i-1;n+=e+(a?"└":"├")+"─ "+r.value,n+=A9(e+(i>1&&!a?"│  ":"   "),r.forest)}return n},Ne=e=>"ast"in e?i4(e.ast):s_(),Nt=si(void 0),Nr=e=>t=>t._tag===e,Nn=Nr("Composite"),Ni=Nr("Refinement"),Ns=Nr("Transformation"),Na=e=>Aj((e=>Ne(e).pipe(sN(IZ),sw({onNone:()=>Nt,onSome:t=>{let r=t(e);return nR(r)?si({message:r,override:!1}):fH(r)?px(r,e=>({message:e,override:!1})):nR(r.message)?si({message:r.message,override:r.override}):px(r.message,e=>({message:e,override:r.override}))}})))(e),t=>void 0!==t?!t.override&&(Nn(e)||Ni(e)&&"From"===e.kind||Ns(e)&&"Transformation"!==e.kind)?Ns(e)||Ni(e)?Na(e.issue):Nt:si(t.message):Nt),No=e=>Ne(e).pipe(sN(I5),sM(t=>t(e)),sF),Nl=e=>AP(Na(e),t=>t??No(e)??function(e){var t;if(void 0!==e.message)return e.message;let r=TG(e.ast)?I1(t=e.ast).pipe(sO(()=>IY(t)),sO(()=>IX(t)),sO(()=>I0(t)),sk(()=>`{ ${t.from} | filter }`)):String(e.ast);return`Expected ${r}, actual ${R7(e.actual)}`}(e)),Nu=e=>No(e)??String(e.ast),Nc=e=>{let t=IQ(e.ast);if(i3(t)){let e=t.value();return nR(e)?si(e):e}return si(e.message??"is missing")},Nh=e=>{switch(e._tag){case"Type":return AP(Nl(e),A6);case"Forbidden":return si(A6(Nu(e),[A6(e.message??"is forbidden")]));case"Unexpected":return si(A6(e.message??"is unexpected"));case"Missing":return AP(Nc(e),A6);case"Transformation":return Aj(Na(e),t=>void 0!==t?si(A6(t)):AP(Nh(e.issue),t=>A6(Nu(e),[A6((e=>{switch(e){case"Encoded":return"Encoded side transformation failure";case"Transformation":return"Transformation process failure";case"Type":return"Type side transformation failure"}})(e.kind),[t])])));case"Refinement":return Aj(Na(e),t=>void 0!==t?si(A6(t)):AP(Nh(e.issue),t=>A6(Nu(e),[A6((e=>{switch(e){case"From":return"From side refinement failure";case"Predicate":return"Predicate refinement failure"}})(e.kind),[t])])));case"Pointer":return AP(Nh(e.issue),t=>A6(Ir(e.path),[t]));case"Composite":return Aj(Na(e),t=>{if(void 0!==t)return si(A6(t));let r=Nu(e);return Ie(e.issues)?AP(wp(e.issues,Nh),e=>A6(r,e)):AP(Nh(e.issues),e=>A6(r,[e]))})}},Nf=e=>{let t=Object.create(gY);return gZ.set(t,e),t},Np=e=>{if(gZ.has(e))return gZ.get(e);throw Error("Unable to get redacted value")},Nd=e=>n_((t,r)=>e(Np(t),Np(r))),Nm=nm(e=>nz(e[0]),(e,...t)=>{let r={};for(let n of t)n in e&&(r[n]=e[n]);return r}),Ng=nm(e=>nz(e[0]),(e,...t)=>{let r={...e};for(let e of t)delete r[e];return r}),Nb=Symbol.for("effect/Schema");function Ny(e){return class{[Nb]=Nx;static ast=e;static annotations(e){return Ny(N_(this.ast,e))}static pipe(){return iw(this,arguments)}static toString(){return String(e)}static Type;static Encoded;static Context;static [Nb]=Nx}}let Nx={_A:e=>e,_I:e=>e,_R:e=>e},Nv={schemaId:IC,message:IF,missingMessage:IR,identifier:II,title:IT,description:IN,examples:IM,default:Ij,documentation:IL,jsonSchema:IP,arbitrary:ID,pretty:I$,equivalence:Iz,concurrency:IU,batching:IB,parseIssueTitle:Iq,parseOptions:IJ,decodingFallback:IH},NS=e=>{if(!e)return{};let t={...e};for(let r in Nv)r in e&&(t[Nv[r]]=e[r],delete t[r]);return t},N_=(e,t)=>T3(e,NS(t)),Nw=e=>String(e.ast),Nk=e=>Ny(As(e.ast)),NO=(e,t)=>{let r=Aq(e,t);return(e,t)=>AD(r(e,t),AT)},NE=e=>nL(e,Nb)&&nz(e[Nb]);function NC(...e){return s9(e)?function e(t,r=function(e){let t;return TJ(e)?Tq.make((t=e=>new Ts(e),e.map(t))):new Ts(e[0])}(t)){return class extends Ny(r){static annotations(t){return e(this.literals,N_(this.ast,t))}static literals=[...t]}}(e):NM}function NF(e,t){return class extends Ny(t){static annotations(e){return NF(this.typeParameters,N_(this.ast,e))}static typeParameters=[...e]}}let NR=function(){if(Array.isArray(arguments[0])){let e=arguments[0],t=arguments[1],r=arguments[2];return NF(e,new Tn(e.map(e=>e.ast),(...e)=>t.decode(...e.map(Ny)),(...e)=>t.encode(...e.map(Ny)),NS(r)))}let e=arguments[0],t=arguments[1],r=()=>(t,r,n)=>e(t)?AA(t):sn(new AC(n,t));return NF([],new Tn([],r,r,NS(t)))},NI=Symbol.for("effect/SchemaId/InstanceOf"),NT=(e,t)=>NR(t=>t instanceof e,{title:e.name,description:`an instance of ${e.name}`,pretty:()=>String,schemaId:NI,[NI]:{constructor:e},...t});class NA extends Ny(Tc){}class NN extends Ny(To){}class NM extends Ny(Th){}class Nj extends Ny(Tp){}class NP extends Ny(TS){}class ND extends Ny(T_){}class N$ extends Ny(Tm){}class Nz extends Ny(Tb){}class NL extends Ny(Tx){}function NU(...e){return TJ(e)?function e(t,r=(e=>Tq.make(e.map(e=>e.ast)))(t)){return class extends Ny(r){static annotations(t){return e(this.members,N_(this.ast,t))}static members=[...t]}}(e):s9(e)?e[0]:NM}let NB=e=>NU(e,NN),Nq=e=>NU(e,NA),NJ=e=>NU(e,NN,NA),NH=e=>new NV(new TR(e.ast,!1),e);class NV{ast;from;[Nb];_Token;constructor(e,t){this.ast=e,this.from=t}annotations(e){return new NV(new TR(this.ast.type,this.ast.isOptional,{...this.ast.annotations,...NS(e)}),this.from)}toString(){return`${this.ast.type}${this.ast.isOptional?"?":""}`}}function NW(e,t,r=((e,t)=>new TT(e.map(e=>NE(e)?new TR(e.ast,!1):e.ast),t.map(e=>NE(e)?new TF(e.ast):e.ast),!0))(e,t)){return class extends Ny(r){static annotations(e){return NW(this.elements,this.rest,N_(this.ast,e))}static elements=[...e];static rest=[...t]}}function NK(...e){return Array.isArray(e[0])?NW(e[0],e.slice(1)):NW(e,[])}let NG=e=>(function e(t,r){return class extends NW([],[t],r){static annotations(t){return e(this.value,N_(this.ast,t))}static value=t}})(e),NZ=e=>e?'"?:"':'":"';class NQ extends TR{isReadonly;defaultValue;_tag="PropertySignatureDeclaration";constructor(e,t,r,n,i){super(e,t,n),this.isReadonly=r,this.defaultValue=i}toString(){let e=NZ(this.isOptional),t=String(this.type);return`PropertySignature<${e}, ${t}, never, ${e}, ${t}>`}}class NY extends TR{isReadonly;fromKey;constructor(e,t,r,n,i){super(e,t,n),this.isReadonly=r,this.fromKey=i}}class NX extends TR{isReadonly;defaultValue;constructor(e,t,r,n,i){super(e,t,n),this.isReadonly=r,this.defaultValue=i}}class N0{from;to;decode;encode;_tag="PropertySignatureTransformation";constructor(e,t,r,n){this.from=e,this.to=t,this.decode=r,this.encode=n}toString(){var e;return`PropertySignature<${NZ(this.to.isOptional)}, ${this.to.type}, ${void 0===(e=this.from.fromKey)?"never":nR(e)?JSON.stringify(e):String(e)}, ${NZ(this.from.isOptional)}, ${this.from.type}>`}}let N1=(e,t)=>{switch(e._tag){case"PropertySignatureDeclaration":return new NQ(e.type,e.isOptional,e.isReadonly,{...e.annotations,...t},e.defaultValue);case"PropertySignatureTransformation":return new N0(e.from,new NX(e.to.type,e.to.isOptional,e.to.isReadonly,{...e.to.annotations,...t},e.to.defaultValue),e.decode,e.encode)}},N2=Symbol.for("effect/PropertySignature"),N3=e=>nL(e,N2);class N5{ast;[Nb];[N2]=null;_TypeToken;_Key;_EncodedToken;_HasDefault;constructor(e){this.ast=e}pipe(){return iw(this,arguments)}annotations(e){return new N5(N1(this.ast,NS(e)))}toString(){return String(this.ast)}}let N4=e=>new N5(e);class N6 extends N5{from;constructor(e,t){super(e),this.from=t}annotations(e){return new N6(N1(this.ast,NS(e)),this.from)}}let N8=e=>new N6(new NQ(e.ast,!1,!0,{},void 0),e),N7=nm(2,(e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":return N4(new NQ(r.type,r.isOptional,r.isReadonly,r.annotations,t));case"PropertySignatureTransformation":return N4(new N0(r.from,new NX(r.to.type,r.to.isOptional,r.to.isReadonly,r.to.annotations,t),r.decode,r.encode))}}),N9=(e,t)=>sw(e,{onNone:()=>i4(t()),onSome:e=>i4(void 0===e?t():e)}),Me=e=>((e,t,r)=>{switch(e._tag){case"UndefinedKeyword":return Th;case"Union":{let r=[],n=!1;for(let i of e.types){let e=t(i);e?(n=!0,Tf(e)||r.push(e)):r.push(i)}if(n)return Tq.make(r);break}case"Suspend":return t(e.f());case"Transformation":return r(e)}})(e,Me,e=>{let t=Me(e.to);if(t)return new TQ(e.from,t,e.transformation)}),Mt=((e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":{let e=As(r.type);return N4(new N0(new NY(r.type,r.isOptional,r.isReadonly,r.annotations),new NX(Me(e)??e,!1,!0,{},r.defaultValue),e=>N9(e,t),ng))}case"PropertySignatureTransformation":{let e=r.to.type;return N4(new N0(r.from,new NX(Me(e)??e,!1,r.to.isReadonly,r.to.annotations,r.to.defaultValue),e=>N9(r.decode(e),t),r.encode))}}},(e,t,r)=>N4(new N0(new NY(e.ast,!0,!0,{},void 0),new NX(t.ast,!1,!0,{},void 0),e=>i4(r.decode(e)),sN(r.encode)))),Mr=(e,t,r)=>N4(new N0(new NY(e.ast,!0,!0,{},void 0),new NX(t.ast,!0,!0,{},void 0),r.decode,r.encode)),Mn=e=>new N6(new NQ(e.ast===Tc||e.ast===Th?Tc:Nq(e).ast,!0,!0,{},void 0),e),Mi=nm(e=>NE(e[0]),(e,t)=>new N6(((e,t)=>{let r=t?.exact,n=t?.default,i=t?.nullable,s=t?.as=="Option",a=t?.onNoneEncoding?sO(t.onNoneEncoding):ng;if(r)if(n)if(i)return N7(Mt(NB(e),Nk(e),{decode:sw({onNone:n,onSome:e=>null===e?n():e}),encode:i4}),n).ast;else return N7(Mt(e,Nk(e),{decode:sw({onNone:n,onSome:ng}),encode:i4}),n).ast;else if(s)if(i)return Mt(NB(e),js(Nk(e)),{decode:sj(nP),encode:a}).ast;else return Mt(e,js(Nk(e)),{decode:ng,encode:ng}).ast;else if(i)return Mr(NB(e),Nk(e),{decode:sj(nP),encode:ng}).ast;else return new NQ(e.ast,!0,!0,{},void 0);if(n)if(i)return N7(Mt(NJ(e),Nk(e),{decode:sw({onNone:n,onSome:e=>null==e?n():e}),encode:i4}),n).ast;else return N7(Mt(Nq(e),Nk(e),{decode:sw({onNone:n,onSome:e=>void 0===e?n():e}),encode:i4}),n).ast;if(s)if(i)return Mt(NJ(e),js(Nk(e)),{decode:sj(e=>null!=e),encode:a}).ast;else return Mt(Nq(e),js(Nk(e)),{decode:sj(nj),encode:a}).ast;if(i)return Mr(NJ(e),Nq(Nk(e)),{decode:sj(nP),encode:ng}).ast;return new NQ(Nq(e).ast,!0,!0,{},void 0)})(e,t),e)),Ms=An([IR]),Ma=(e,t)=>{for(let r of R4(e)){let n=e[r];if(void 0===t[r]&&N3(n)){let e=n.ast,i="PropertySignatureDeclaration"===e._tag?e.defaultValue:e.to.defaultValue;void 0!==i&&(t[r]=i())}}return t};function Mo(e,t,r=((e,t)=>{let r=R4(e),n=[];if(r.length>0){let i=[],s=[],a=[];for(let t=0;t<r.length;t++){let o=r[t],l=e[o];if(N3(l)){let e=l.ast;switch(e._tag){case"PropertySignatureDeclaration":{let t=e.type,r=e.isOptional,a=e.annotations;i.push(new TN(o,t,r,!0,Ms(e))),s.push(new TN(o,As(t),r,!0,a)),n.push(new TN(o,t,r,!0,a));break}case"PropertySignatureTransformation":{let t=e.from.fromKey??o;i.push(new TN(t,e.from.type,e.from.isOptional,!0,e.from.annotations)),s.push(new TN(o,e.to.type,e.to.isOptional,!0,e.to.annotations)),a.push(new T1(t,o,e.decode,e.encode))}}}else i.push(new TN(o,l.ast,!1,!0)),s.push(new TN(o,As(l.ast),!1,!0)),n.push(new TN(o,l.ast,!1,!0))}if(s9(a)){let e=[],r=[];for(let n of t){let{indexSignatures:t,propertySignatures:a}=At(n.key.ast,n.value.ast);a.forEach(e=>{i.push(e),s.push(new TN(e.name,As(e.type),e.isOptional,e.isReadonly,e.annotations))}),t.forEach(t=>{e.push(t),r.push(new Tj(t.parameter,As(t.type),t.isReadonly))})}return new TQ(new TP(i,e,{[IA]:"Struct (Encoded side)"}),new TP(s,r,{[IA]:"Struct (Type side)"}),new T2(a))}}let i=[];for(let e of t){let{indexSignatures:t,propertySignatures:r}=At(e.key.ast,e.value.ast);r.forEach(e=>n.push(e)),t.forEach(e=>i.push(e))}return new TP(n,i)})(e,t)){return class extends Ny(r){static annotations(e){return Mo(this.fields,this.records,N_(this.ast,e))}static fields={...e};static records=[...t];static make=(t,r)=>{let n=Ma(e,{...t});return jm(r)?n:AH(this)(n)};static pick(...t){return Ml(Nm(e,...t))}static omit(...t){return Ml(Ng(e,...t))}}}function Ml(e,...t){return Mo(e,t)}let Mu=(e,t)=>Ml({_tag:(e=>NC(e).pipe(N8,N7(()=>e)))(e),...t}),Mc=(e,t,r)=>{if(Tz(e)&&Tz(t)){let n=[...e.propertySignatures];for(let e of t.propertySignatures){let t=e.name,i=n.findIndex(e=>e.name===t);if(-1===i)n.push(e);else{let{isOptional:s,type:a}=n[i];n[i]=new TN(t,Mp(a,e.type,r.concat(t)),s,!0)}}return new TP(n,e.indexSignatures.concat(t.indexSignatures))}throw Error(Is(e,t,r))},Mh=(a=[II],e=>{let t={...e.annotations};for(let e of a)delete t[e];return t}),Mf=(e,t)=>t.map(t=>new TK(t,e.filter,Mh(e))),Mp=(e,t,r)=>Tq.make(Mm([e],[t],r)),Md=e=>TH(e)?e.types:[e],Mm=(e,t,r)=>aR(e,e=>aR(t,t=>{switch(t._tag){case"Literal":if(nR(t.literal)&&Tg(e)||nI(t.literal)&&Ty(e)||nT(t.literal)&&Tv(e))return[t];break;case"StringKeyword":if(t===Tm){if(Tg(e)||Ta(e)&&nR(e.literal))return[e];else if(TG(e))return Mf(e,Mm(Md(e.from),[t],r))}else if(e===Tm)return[t];break;case"NumberKeyword":if(t===Tb){if(Ty(e)||Ta(e)&&nI(e.literal))return[e];else if(TG(e))return Mf(e,Mm(Md(e.from),[t],r))}else if(e===Tb)return[t];break;case"BooleanKeyword":if(t===Tx){if(Tv(e)||Ta(e)&&nT(e.literal))return[e];else if(TG(e))return Mf(e,Mm(Md(e.from),[t],r))}else if(e===Tx)return[t];break;case"Union":return Mm(Md(e),t.types,r);case"Suspend":return[new TW(()=>Mp(e,t.f(),r))];case"Refinement":return Mf(t,Mm(Md(e),Md(t.from),r));case"TypeLiteral":switch(e._tag){case"Union":return Mm(e.types,[t],r);case"Suspend":return[new TW(()=>Mp(e.f(),t,r))];case"Refinement":return Mf(e,Mm(Md(e.from),[t],r));case"TypeLiteral":return[Mc(e,t,r)];case"Transformation":{let n=e.transformation,i=Mc(e.from,t,r),s=Mc(e.to,As(t),r);switch(n._tag){case"TypeLiteralTransformation":return[new TQ(i,s,new T2(n.propertySignatureTransformations))];case"ComposeTransformation":return[new TQ(i,s,T0)];case"FinalTransformation":return[new TQ(i,s,new TX((e,t,r,i)=>AP(n.decode(e,t,r,i),t=>({...e,...t})),(e,t,r,i)=>AP(n.encode(e,t,r,i),t=>({...e,...t}))))]}}}break;case"Transformation":if(!TY(e))return Mm([t],[e],r);if("TypeLiteralTransformation"===t.transformation._tag&&"TypeLiteralTransformation"===e.transformation._tag)return[new TQ(Mc(e.from,t.from,r),Mc(e.to,t.to,r),new T2(t.transformation.propertySignatureTransformations.concat(e.transformation.propertySignatureTransformations)))]}throw Error(Is(e,t,r))})),Mg=nm(2,(e,t)=>Ny(Mp(e.ast,t.ast,[]))),Mb=nm(e=>NE(e[1]),(e,t)=>M_(e,t,Ab(e.ast,t.ast))),My=e=>Ny(new TW(()=>e().ast)),Mx=Symbol.for("effect/SchemaId/Refine"),Mv=(e,t,r)=>{if(nT(e))return e?s_():i4(new AC(t,r));if(nR(e))return i4(new AC(t,r,e));if(void 0!==e){if("_tag"in e)return i4(e);let n=new AC(t,r,e.message);return i4(s9(e.path)?new AS(e.path,r,n):n)}return s_()};function MS(e,t){return r=>{function n(t,r,n){var i=e(t,r,n),s=n,a=t;if(!Array.isArray(i))return Mv(i,s,a);if(s9(i)){let e=aT(i,e=>Mv(e,s,a));if(s9(e))return i4(1===e.length?e[0]:new Ak(s,a,e))}return s_()}let i=new TK(r.ast,n,NS(t));return function e(t,r,n){return class extends Ny(n){static annotations(t){return e(this.from,this.filter,N_(this.ast,t))}static [Mx]=t;static from=t;static filter=r;static make=(e,t)=>jm(t)?e:AH(this)(e)}}(r,n,i)}}function M_(e,t,r){return class extends Ny(r){static annotations(e){return M_(this.from,this.to,N_(this.ast,e))}static from=e;static to=t}}let Mw=nm(e=>NE(e[0])&&NE(e[1]),(e,t,r)=>M_(e,t,new TQ(e.ast,t.ast,new TX(r.decode,r.encode)))),Mk=nm(e=>NE(e[0])&&NE(e[1]),(e,t,r)=>Mw(e,t,{strict:!0,decode:(e,t,n,i)=>AA(r.decode(e,i)),encode:(e,t,n,i)=>AA(r.encode(e,i))})),MO=Symbol.for("effect/SchemaId/Trimmed"),ME=e=>t=>t.pipe(MS(e=>e===e.trim(),{schemaId:MO,title:"trimmed",description:"a string with no leading or trailing whitespace",jsonSchema:{pattern:"^\\S[\\s\\S]*\\S$|^\\S$|^$"},...e})),MC=Symbol.for("effect/SchemaId/Pattern"),MF=Symbol.for("effect/SchemaId/StartsWith"),MR=Symbol.for("effect/SchemaId/Lowercased"),MI=e=>t=>t.pipe(MS(e=>e===e.toLowerCase(),{schemaId:MR,title:"lowercased",description:"a lowercase string",jsonSchema:{pattern:"^[^A-Z]*$"},...e})),MT=Symbol.for("effect/SchemaId/Uppercased"),MA=e=>t=>t.pipe(MS(e=>e===e.toUpperCase(),{schemaId:MT,title:"uppercased",description:"an uppercase string",jsonSchema:{pattern:"^[^a-z]*$"},...e})),MN=Symbol.for("effect/SchemaId/Capitalized"),MM=e=>t=>t.pipe(MS(e=>e[0]?.toUpperCase()===e[0],{schemaId:MN,title:"capitalized",description:"a capitalized string",jsonSchema:{pattern:"^[^a-z]?.*$"},...e})),Mj=Symbol.for("effect/SchemaId/Uncapitalized"),MP=e=>t=>t.pipe(MS(e=>e[0]?.toLowerCase()===e[0],{schemaId:Mj,title:"uncapitalized",description:"a uncapitalized string",jsonSchema:{pattern:"^[^A-Z]?.*$"},...e})),MD=e=>((e,t)=>r=>r.pipe(MS(t=>t.length>=e,{schemaId:Ik,title:`minLength(${e})`,description:`a string at least ${e} character(s) long`,jsonSchema:{minLength:e},...t})))(1,{title:"nonEmptyString",description:"a non empty string",...e});class M$ extends N$.pipe(ME({identifier:"Trimmed"})){}let Mz=e=>e instanceof Error?e.message:String(e),ML=(e,t)=>NE(e)?Mb(ML(t),e):(e=>Mw(N$.annotations({description:"a string to be decoded into JSON"}),Nj,{strict:!0,decode:(t,r,n)=>AN({try:()=>JSON.parse(t,e?.reviver),catch:e=>new AC(n,t,Mz(e))}),encode:(t,r,n)=>AN({try:()=>JSON.stringify(t,e?.replacer,e?.space),catch:e=>new AC(n,t,Mz(e))})}).annotations({title:"parseJson",schemaId:Tr}))(e);/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i.source,URL;let MU=e=>t=>t.pipe(MS(e=>Number.isSafeInteger(e),{schemaId:Ib,title:"int",description:"an integer",jsonSchema:{type:"integer"},...e})),MB=(e,t,r)=>n=>n.pipe(MS(r=>r>=e&&r<=t,{schemaId:IS,title:`between(${e}, ${t})`,description:`a number between ${e} and ${t}`,jsonSchema:{minimum:e,maximum:t},...r})),Mq=e=>((e,t)=>r=>r.pipe(MS(t=>t>=e,{schemaId:Id,title:`greaterThanOrEqualTo(${e})`,description:0===e?"a non-negative number":`a number greater than or equal to ${e}`,jsonSchema:{minimum:e},...t})))(0,{title:"nonNegative",...e});class MJ extends Nz.pipe(MU({identifier:"Int"})){}class MH extends Nz.pipe(Mq({identifier:"NonNegative"})){}class MV extends Mw(N$.annotations({description:"a string to be decoded into a bigint"}),NP,{strict:!0,decode:(e,t,r)=>AM(oa(e),()=>new AC(r,e,`Unable to decode ${JSON.stringify(e)} into a bigint`)),encode:e=>AA(String(e))}).annotations({identifier:"BigInt"}){}((e,t)=>r=>r.pipe(MS(t=>t>=e,{schemaId:I_,[I_]:{min:e},title:`greaterThanOrEqualToBigInt(${e})`,description:0n===e?"a non-negative bigint":`a bigint greater than or equal to ${e}n`,...t})))(0n,{title:"nonNegativeBigInt",identifier:"NonNegativeBigintFromSelf"});let MW=e=>t=>e(t).map(Nf),MK=(e,t,r,n)=>A$(e,{onFailure:e=>new Ak(r,n,e),onSuccess:t}),MG=e=>(t,r,n)=>gX(t)?MK(e(Np(t),r),Nf,n,t):sn(new AC(n,t)),MZ=MH.pipe(MU()).annotations({identifier:"NonNegativeInt"}),MQ=Mu("Millis",{millis:MZ}),MY=Mu("Nanos",{nanos:MV}),MX=Mu("Infinity",{}),M0=NK(NH(MZ).annotations({title:"seconds"}),NH(MZ).annotations({title:"nanos"})).annotations({identifier:"FiniteHRTime"});class M1 extends NR(nq,{identifier:"Uint8ArrayFromSelf",pretty:()=>e=>`new Uint8Array(${JSON.stringify(Array.from(e))})`,arbitrary:()=>e=>e.uint8Array(),equivalence:()=>az(il)}){}let M2=(o=e=>(e=>{let t=CZ(e),r=t.length;if(r%4!=0)return sn(CV(t,`Length must be a multiple of 4, but is ${r}`));let n=t.indexOf("=");if(-1!==n&&(n<r-2||n===r-2&&"="!==t[r-1]))return sn(CV(t,"Found a '=' character, but it is not at the end"));try{let e=t.endsWith("==")?2:+!!t.endsWith("="),n=new Uint8Array(r/4*3-e);for(let e=0,i=0;e<r;e+=4,i+=3){let r=CQ(t.charCodeAt(e))<<18|CQ(t.charCodeAt(e+1))<<12|CQ(t.charCodeAt(e+2))<<6|CQ(t.charCodeAt(e+3));n[i]=r>>16,n[i+1]=r>>8&255,n[i+2]=255&r}return si(n)}catch(e){return sn(CV(t,e instanceof Error?e.message:"Invalid input"))}})(e),l=e=>"string"==typeof e?CG(CK.encode(e)):CG(e),Mw(N$.annotations({description:"a string to be decoded into a Uint8Array"}),M1,{strict:!0,decode:(e,t,r)=>so(o(e),t=>new AC(r,e,t.message)),encode:e=>AA(l(e))}).annotations({identifier:"Uint8ArrayFromBase64"})),M3=Symbol.for("effect/SchemaId/ValidDate"),M5=If;class M4 extends NR(nJ,{identifier:"DateFromSelf",schemaId:M5,[M5]:{noInvalidDate:!1},description:"a potentially invalid Date instance",pretty:()=>e=>`new Date(${JSON.stringify(e)})`,arbitrary:()=>e=>e.date({noInvalidDate:!1}),equivalence:()=>nO}){}e=>CD(e)&&CL(e);let M6=()=>e=>e.integer({min:-432e5,max:504e5}).map(OW);class M8 extends NR(C$,{identifier:"TimeZoneOffsetFromSelf",description:"a TimeZone.Offset instance",pretty:()=>e=>e.toString(),arbitrary:M6}){}let M7=()=>e=>e.constantFrom(...Intl.supportedValuesOf("timeZone")).map(OV);class M9 extends NR(Cz,{identifier:"TimeZoneNamedFromSelf",description:"a TimeZone.Named instance",pretty:()=>e=>e.toString(),arbitrary:M7}){}let je=e=>e.oneof(M6()(e),M7()(e));e=>CD(e)&&CU(e);let jt=e=>"None"===e._tag?s_():i4(e.value),jr=(e,t)=>r=>r.oneof(t,r.record({_tag:r.constant("None")}),r.record({_tag:r.constant("Some"),value:e(r)})).map(jt),jn=e=>sw({onNone:()=>"none()",onSome:t=>`some(${e(t)})`}),ji=e=>(t,r,n)=>i1(t)?i2(t)?AA(s_()):MK(e(t.value,r),i4,n,t):sn(new AC(n,t)),js=e=>NR([e],{decode:e=>ji(Aq(e)),encode:e=>ji(AJ(e))},{description:`Option<${Nw(e)}>`,pretty:jn,arbitrary:jr,equivalence:sP}),ja=()=>e=>`BigDecimal(${a9(a0(e))})`,jo=()=>e=>e.tuple(e.bigInt(),e.integer({min:0,max:18})).map(([e,t])=>aK(e,t)),jl=e=>R4(e).every(t=>(e=>NE(e)||N3(e))(e[t])),ju=e=>"fields"in e?e.fields:ju(e[Mx]),jc=e=>jl(e)?Ml(e):NE(e)?e:Ml(ju(e)),jh=e=>jl(e)?e:ju(e),jf=e=>(t,r)=>jb({kind:"Class",identifier:e,schema:jc(t),fields:jh(t),Base:hc,annotations:r}),jp=e=>(t,r,n)=>{class i extends bs{}i.prototype.name=t;let s=jh(r),a=jc(r),o={_tag:(e=>N7(N8(NC(e)),()=>e))(t)},l=jd(o,s),u="message"in l;class c extends jb({kind:"TaggedError",identifier:e??t,schema:Mg(a,Ml(o)),fields:l,Base:i,annotations:n,disableToString:!0}){static _tag=t}return u||Object.defineProperty(c.prototype,"message",{get(){return`{ ${R4(s).map(e=>`${R9(e)}: ${R7(this[e])}`).join(", ")} }`},enumerable:!1,configurable:!0}),c},jd=(e,t)=>{let r={...e};for(let n of R4(t)){if(n in e)throw Error(Ih(n));r[n]=t[n]}return r};function jm(e){return nT(e)?e:e?.disableValidation??!1}let jg=nF("effect/Schema/astCache",()=>new WeakMap),jb=({Base:e,annotations:t,disableToString:r,fields:n,identifier:i,kind:s,schema:a})=>{let o=Symbol.for(`effect/Schema/${s}/${i}`),[l,u,c]=(e=>void 0===e?[]:Array.isArray(e)?e:[e])(t),h=Nk(a),f=h.annotations({identifier:i,...l}),p=h.annotations({[IA]:`${i} (Type side)`,...l}),d=a.annotations({[IA]:`${i} (Constructor)`,...l}),m=a.annotations({[IA]:`${i} (Encoded side)`,...c}),g=a.annotations({[Te]:i,...c,...l,...u}),b=class extends e{constructor(e={},t=!1){e={...e},"Class"!==s&&delete e._tag,e=Ma(n,e),jm(t)||(e=AH(d)(e)),super(e,!0)}static [Nb]=Nx;static get ast(){let e=jg.get(this);return e||(e=Mk(m,NR([a],{decode:()=>(e,t,r)=>e instanceof this||nL(e,o)&&((e,t)=>{let r=AK(As(e.ast),!0);return(e,n)=>sr(r(e,{exact:!0,...AL(t,n)}))})(p)(e)?AA(e):sn(new AC(r,e)),encode:()=>(e,t)=>e instanceof this?AA(e):AP(AJ(p)(e,t),e=>new this(e,!0))},{identifier:i,pretty:e=>t=>`${i}(${e(t)})`,arbitrary:e=>t=>e(t).map(e=>new this(e)),equivalence:ng,[IV]:f.ast,...l}),{strict:!0,decode:e=>new this(e,!0),encode:ng}).annotations({[IV]:g.ast,...u}).ast,jg.set(this,e)),e}static pipe(){return iw(this,arguments)}static annotations(e){return Ny(this.ast).annotations(e)}static toString(){return`(${String(m)} <-> ${i})`}static make(...e){return new this(...e)}static fields={...n};static identifier=i;static extend(e){return(t,r)=>{let i=jh(t),o=jc(t),l=jd(n,i);return jb({kind:s,identifier:e,schema:Mg(a,o),fields:l,Base:this,annotations:r})}}static transformOrFail(e){return(t,r,i)=>{let o=jd(n,t);return jb({kind:s,identifier:e,schema:Mw(a,Nk(Ml(o)),r),fields:o,Base:this,annotations:i})}}static transformOrFailFrom(e){return(t,r,i)=>{let o=jd(n,t);return jb({kind:s,identifier:e,schema:Mw(Ny(Ac(a.ast)),Ml(o),r),fields:o,Base:this,annotations:i})}}get[o](){return o}};return!0!==r&&Object.defineProperty(b.prototype,"toString",{value(){return`${i}({ ${R4(n).map(e=>`${R9(e)}: ${R7(this[e])}`).join(", ")} })`},configurable:!0,writable:!0}),b},jy=Ml({_tag:NC("None")}).annotations({identifier:"FiberIdNoneEncoded"}),jx=NU(jy,Ml({_tag:NC("Runtime"),id:MJ,startTimeMillis:MJ}).annotations({identifier:"FiberIdRuntimeEncoded"}),Ml({_tag:NC("Composite"),left:My(()=>jx),right:My(()=>jx)}).annotations({identifier:"FiberIdCompositeEncoded"})).annotations({identifier:"FiberIdEncoded"}),jv=e=>e.letrec(t=>({None:e.record({_tag:e.constant("None")}),Runtime:e.record({_tag:e.constant("Runtime"),id:e.integer(),startTimeMillis:e.integer()}),Composite:e.record({_tag:e.constant("Composite"),left:t("FiberId"),right:t("FiberId")}),FiberId:e.oneof(t("None"),t("Runtime"),t("Composite"))})).FiberId.map(j_),jS=e=>{switch(e._tag){case"None":return"FiberId.none";case"Runtime":return`FiberId.runtime(${e.id}, ${e.startTimeMillis})`;case"Composite":return`FiberId.composite(${jS(e.right)}, ${jS(e.left)})`}},j_=e=>{switch(e._tag){case"None":return cH;case"Runtime":return cV(e.id,e.startTimeMillis);case"Composite":return new cj(j_(e.left),j_(e.right))}},jw=Ml({_tag:NC("Empty")}),jk=Ml({_tag:NC("Interrupt"),fiberId:jx});class jO extends Mk(Nj,Nj,{strict:!0,decode:e=>{if(nz(e)&&"message"in e&&"string"==typeof e.message){let t=Error(e.message,{cause:e});return"name"in e&&"string"==typeof e.name&&(t.name=e.name),t.stack="stack"in e&&"string"==typeof e.stack?e.stack:"",t}return String(e)},encode:e=>e instanceof Error?{name:e.name,message:e.message}:uk(e)}).annotations({identifier:"Defect"}){}let jE=Symbol.for("effect/Schema/Serializable/symbolResult"),jC=nF("effect/Schema/Serializable/exitSchemaCache",()=>new WeakMap),jF=Mu("symbol",{key:N$}).annotations({description:"an object to be decoded into a globally shared symbol"}),jR=Mw(jF,ND,{strict:!0,decode:e=>AA(Symbol.for(e.key)),encode:(e,t,r)=>AP(((e,t)=>{let r=Symbol.keyFor(e);return void 0===r?sn(new AC(t,e,`Unable to encode a unique symbol ${String(e)} into a string`)):AA(r)})(e,r),e=>jF.make({key:e}))});NC("inline","attachment"),NC("public-read","private");let jI=NC("upload"),jT=NC("callback","error"),jA=Mk(M1,N$,{decode:e=>new TextDecoder().decode(e),encode:e=>new TextEncoder().encode(e)}),jN=Ml({apiKey:function(e){return Mk(e,NR([Nk(e)],{decode:e=>MG(Aq(e)),encode:e=>MG(AJ(e))},{description:"Redacted(<redacted>)",pretty:()=>()=>"Redacted(<redacted>)",arbitrary:MW,equivalence:Nd}),{strict:!0,decode:e=>Nf(e),encode:e=>Np(e)})}(N$.pipe(((e,t)=>r=>{let n=JSON.stringify(e);return r.pipe(MS(t=>t.startsWith(e),{schemaId:MF,[MF]:{startsWith:e},title:`startsWith(${n})`,description:`a string starting with ${n}`,jsonSchema:{pattern:`^${e}`},...t}))})("sk_"))),appId:N$,regions:function e(t,r){return class extends NW([t],[t],r){static annotations(t){return e(this.value,N_(this.ast,t))}static value=t}}(N$),ingestHost:N$.pipe(Mi({default:()=>"ingest.uploadthing.com"}))}),jM=M2.pipe(Mb(jA),Mb(ML(jN)));var jj=class extends jf("FileUploadData")({name:N$,size:Nz,type:N$,lastModified:Nz.pipe(Mn)}){},jP=class extends jj.extend("FileUploadDataWithCustomId")({customId:NB(N$)}){},jD=class extends jP.extend("UploadedFileData")({key:N$,url:N$,appUrl:N$,ufsUrl:N$,fileHash:N$}){},j$=class extends jf("MetadataFetchStreamPart")({payload:N$,signature:N$,hook:jT}){},jz=class extends jf("MetadataFetchResponse")({ok:NL}){},jL=class extends jf("CallbackResultResponse")({ok:NL}){},jU=class extends jf("UploadActionPayload")({files:NG(jj),input:Nj}){};let jB=Symbol.for("effect/QueueEnqueue"),jq=Symbol.for("effect/QueueDequeue"),jJ=Symbol.for("effect/QueueStrategy"),jH=Symbol.for("effect/BackingQueue"),jV={_A:e=>e},jW={_A:e=>e},jK={_In:e=>e},jG={_Out:e=>e};class jZ extends bc{queue;takers;shutdownHook;shutdownFlag;strategy;[jB]=jK;[jq]=jG;constructor(e,t,r,n,i){super(),this.queue=e,this.takers=t,this.shutdownHook=r,this.shutdownFlag=n,this.strategy=i}pipe(){return iw(this,arguments)}commit(){return this.take}capacity(){return this.queue.capacity()}get size(){return pR(()=>f1(this.unsafeSize(),()=>pm))}unsafeSize(){return this.shutdownFlag.current?s_():i4(this.queue.length()-E9(this.takers)+this.strategy.surplusSize())}get isEmpty(){return px(this.size,e=>e<=0)}get isFull(){return px(this.size,e=>e>=this.capacity())}get shutdown(){return pN(fV(e=>(nS(this.shutdownFlag,cC(!0)),nS(wm(Pn(this.takers),t=>mm(t,e.id()),!1,!1),pJ(this.strategy.shutdown),pD(mg(this.shutdownHook,void 0)),fG))))}get isShutdown(){return pI(()=>this.shutdownFlag.current)}get awaitShutdown(){return mh(this.shutdownHook)}isActive(){return!this.shutdownFlag.current}unsafeOffer(e){let t;if(this.shutdownFlag.current)return!1;if(0===this.queue.length()){let r=nS(this.takers,Cn(E5));r!==E5?(Pt(r,e),t=!0):t=!1}else t=!1;if(t)return!0;let r=this.queue.offer(e);return Pa(this.strategy,this.queue,this.takers),r}offer(e){return pR(()=>{let t;if(this.shutdownFlag.current)return pm;if(0===this.queue.length()){let r=nS(this.takers,Cn(E5));r!==E5?(Pt(r,e),t=!0):t=!1}else t=!1;if(t)return pF(!0);let r=this.queue.offer(e);return Pa(this.strategy,this.queue,this.takers),r?pF(!0):this.strategy.handleSurplus([e],this.queue,this.takers,this.shutdownFlag)})}offerAll(e){return pR(()=>{if(this.shutdownFlag.current)return pm;let t=s1(e),r=0===this.queue.length()?s1(Pi(this.takers,t.length)):aE,[n,i]=nS(t,ax(r.length));for(let e=0;e<r.length;e++)Pt(r[e],n[e]);if(0===i.length)return pF(!0);let s=this.queue.offerAll(i);return Pa(this.strategy,this.queue,this.takers),oD(s)?pF(!0):this.strategy.handleSurplus(s,this.queue,this.takers,this.shutdownFlag)})}get take(){return fV(e=>{if(this.shutdownFlag.current)return pm;let t=this.queue.poll(E5);if(t!==E5)return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),pF(t);{let t=ml(e.id());return nS(pR(()=>(nS(this.takers,Ct(t)),Pa(this.strategy,this.queue,this.takers),this.shutdownFlag.current?pm:mh(t))),pw(()=>pI(()=>Ps(this.takers,t))))}})}get takeAll(){return pR(()=>this.shutdownFlag.current?pm:pI(()=>{let e=this.queue.pollUpTo(1/0);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),oy(e)}))}takeUpTo(e){return pR(()=>this.shutdownFlag.current?pm:pI(()=>{let t=this.queue.pollUpTo(e);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),oy(t)}))}takeBetween(e,t){return pR(()=>jQ(this,e,t,om()))}}let jQ=(e,t,r,n)=>r<t?pF(n):nS(j5(e,r),ps(i=>{let s=t-i.length;return 1===s?nS(j3(e),px(e=>nS(n,oT(i),oE(e)))):s>1?nS(j3(e),ps(t=>jQ(e,s-1,r-i.length-1,nS(n,oT(i),oE(t))))):pF(nS(n,oT(i)))})),jY=(e,t)=>nS(mu(),px(r=>{let n;return n=E7(),new jZ(e,n,r,cO(!1),t)}));class jX{mutable;[jH]=jW;constructor(e){this.mutable=e}poll(e){return Cn(this.mutable,e)}pollUpTo(e){return Ci(this.mutable,e)}offerAll(e){return Cr(this.mutable,e)}offer(e){return Ct(this.mutable,e)}capacity(){let e;return void 0===(e=this.mutable).capacity?1/0:e.capacity}length(){return E9(this.mutable)}}let j0=e=>new jX(e),j1=nm(2,(e,t)=>e.offer(t)),j2=nm(2,(e,t)=>e.offerAll(t)),j3=e=>e.take,j5=nm(2,(e,t)=>e.takeUpTo(t)),j4=nm(3,(e,t,r)=>e.takeBetween(t,r)),j6=nm(2,(e,t)=>e.takeBetween(t,t)),j8=()=>new j9;class j7{[jJ]=jV;putters=E7();surplusSize(){return E9(this.putters)}onCompleteTakersWithEmptyQueue(e){for(;!Ce(this.putters)&&!Ce(e);){let t=Cn(e,void 0),r=Cn(this.putters,void 0);r[2]&&Pt(r[1],!0),Pt(t,r[0])}}get shutdown(){return nS(pn,ps(e=>nS(pI(()=>Pn(this.putters)),ps(t=>wm(t,([t,r,n])=>n?nS(mm(r,e),fG):pj,!1,!1)))))}handleSurplus(e,t,r,n){return fV(i=>{let s=ml(i.id());return nS(pR(()=>(this.unsafeOffer(e,s),this.unsafeOnQueueEmptySpace(t,r),Pa(this,t,r),n.current?pm:mh(s))),pw(()=>pI(()=>this.unsafeRemove(s))))})}unsafeOnQueueEmptySpace(e,t){let r=!0;for(;r&&(e.capacity()===1/0||e.length()<e.capacity());){let n=nS(this.putters,Cn(E5));if(n===E5)r=!1;else{let r=e.offer(n[0]);r&&n[2]?Pt(n[1],!0):r||Pr(this.putters,nS(Pn(this.putters),oC(n))),Pa(this,e,t)}}}unsafeOffer(e,t){let r=s1(e);for(let e=0;e<r.length;e++){let n=r[e];e===r.length-1?nS(this.putters,Ct([n,t,!0])):nS(this.putters,Ct([n,t,!1]))}}unsafeRemove(e){Pr(this.putters,nS(Pn(this.putters),oN(([,t])=>t!==e)))}}class j9{[jJ]=jV;surplusSize(){return 0}get shutdown(){return pj}onCompleteTakersWithEmptyQueue(){}handleSurplus(e,t,r,n){return pF(!1)}unsafeOnQueueEmptySpace(e,t){}}class Pe{[jJ]=jV;surplusSize(){return 0}get shutdown(){return pj}onCompleteTakersWithEmptyQueue(){}handleSurplus(e,t,r,n){return pI(()=>(this.unsafeOffer(t,e),Pa(this,t,r),!0))}unsafeOnQueueEmptySpace(e,t){}unsafeOffer(e,t){let r,n=t[Symbol.iterator](),i=!0;for(;!(r=n.next()).done&&i;){if(0===e.capacity())return;e.poll(E5),i=e.offer(r.value)}}}let Pt=(e,t)=>mb(e,pF(t)),Pr=(e,t)=>nS(e,Cr(t)),Pn=e=>nS(e,Ci(1/0)),Pi=(e,t)=>nS(e,Ci(t)),Ps=(e,t)=>{Pr(e,nS(Pn(e),oN(e=>t!==e)))},Pa=(e,t,r)=>{let n=!0;for(;n&&0!==t.length();){let i=nS(r,Cn(E5));if(i!==E5){let s=t.poll(E5);s!==E5?(Pt(i,s),e.unsafeOnQueueEmptySpace(t,r)):Pr(r,nS(Pn(r),oC(i))),n=!0}else n=!1}n&&0===t.length()&&!Ce(r)&&e.onCompleteTakersWithEmptyQueue(r)},Po=e=>nS(pI(()=>E8(e)),ps(e=>jY(j0(e),new j7))),Pl=e=>nS(pI(()=>E8(e)),ps(e=>jY(j0(e),j8()))),Pu=e=>nS(pI(()=>E8(e)),ps(e=>jY(j0(e),new Pe))),Pc=()=>nS(pI(()=>E7()),ps(e=>jY(j0(e),j8()))),Ph=e=>e.shutdown,Pf=Symbol.for("effect/PubSub/AbsentValue"),Pp=(e,t)=>r=>{r.has(e)||r.set(e,new Set),r.get(e).add(t)},Pd=(e,t)=>r=>{if(!r.has(e))return;let n=r.get(e);n.delete(t),0===n.size&&r.delete(e)},Pm=e=>{let t="number"==typeof e?{capacity:e}:e;PR(t.capacity);let r=t.replay&&t.replay>0?new PB(Math.ceil(t.replay)):void 0;return 1===t.capacity?new Pv(r):Math.max(Math.pow(2,Math.ceil(Math.log(t.capacity)/Math.log(2))),2)===t.capacity?new Py(t.capacity,r):new Pg(t.capacity,r)};class Pg{capacity;replayBuffer;array;publisherIndex=0;subscribers;subscriberCount=0;subscribersIndex=0;constructor(e,t){this.capacity=e,this.replayBuffer=t,this.array=Array.from({length:e}),this.subscribers=Array.from({length:e})}replayWindow(){return this.replayBuffer?new Pq(this.replayBuffer):PJ}isEmpty(){return this.publisherIndex===this.subscribersIndex}isFull(){return this.publisherIndex===this.subscribersIndex+this.capacity}size(){return this.publisherIndex-this.subscribersIndex}publish(e){if(this.isFull())return!1;if(0!==this.subscriberCount){let t=this.publisherIndex%this.capacity;this.array[t]=e,this.subscribers[t]=this.subscriberCount,this.publisherIndex+=1}return this.replayBuffer&&this.replayBuffer.offer(e),!0}publishAll(e){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(e),om();let t=oy(e),r=t.length,n=this.publisherIndex-this.subscribersIndex,i=Math.min(r,this.capacity-n);if(0===i)return t;let s=0,a=this.publisherIndex+i;for(;this.publisherIndex!==a;){let e=oO(t,s++),r=this.publisherIndex%this.capacity;this.array[r]=e,this.subscribers[r]=this.subscriberCount,this.publisherIndex+=1,this.replayBuffer&&this.replayBuffer.offer(e)}return oR(t,s)}slide(){if(this.subscribersIndex!==this.publisherIndex){let e=this.subscribersIndex%this.capacity;this.array[e]=Pf,this.subscribers[e]=0,this.subscribersIndex+=1}this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new Pb(this,this.publisherIndex,!1)}}class Pb{self;subscriberIndex;unsubscribed;constructor(e,t,r){this.self=e,this.subscriberIndex=t,this.unsubscribed=r}isEmpty(){return this.unsubscribed||this.self.publisherIndex===this.subscriberIndex||this.self.publisherIndex===this.self.subscribersIndex}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(e){if(this.unsubscribed)return e;if(this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex),this.subscriberIndex!==this.self.publisherIndex){let e=this.subscriberIndex%this.self.capacity,t=this.self.array[e];return this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=Pf,this.self.subscribersIndex+=1),this.subscriberIndex+=1,t}return e}pollUpTo(e){if(this.unsubscribed)return om();this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);let t=Math.min(e,this.self.publisherIndex-this.subscriberIndex);if(t<=0)return om();let r=[],n=this.subscriberIndex+t;for(;this.subscriberIndex!==n;){let e=this.subscriberIndex%this.self.capacity,t=this.self.array[e];this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=Pf,this.self.subscribersIndex+=1),r.push(t),this.subscriberIndex+=1}return oy(r)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);this.subscriberIndex!==this.self.publisherIndex;){let e=this.subscriberIndex%this.self.capacity;this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=Pf,this.self.subscribersIndex+=1),this.subscriberIndex+=1}}}class Py{capacity;replayBuffer;array;mask;publisherIndex=0;subscribers;subscriberCount=0;subscribersIndex=0;constructor(e,t){this.capacity=e,this.replayBuffer=t,this.array=Array.from({length:e}),this.mask=e-1,this.subscribers=Array.from({length:e})}replayWindow(){return this.replayBuffer?new Pq(this.replayBuffer):PJ}isEmpty(){return this.publisherIndex===this.subscribersIndex}isFull(){return this.publisherIndex===this.subscribersIndex+this.capacity}size(){return this.publisherIndex-this.subscribersIndex}publish(e){if(this.isFull())return!1;if(0!==this.subscriberCount){let t=this.publisherIndex&this.mask;this.array[t]=e,this.subscribers[t]=this.subscriberCount,this.publisherIndex+=1}return this.replayBuffer&&this.replayBuffer.offer(e),!0}publishAll(e){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(e),om();let t=oy(e),r=t.length,n=this.publisherIndex-this.subscribersIndex,i=Math.min(r,this.capacity-n);if(0===i)return t;let s=0,a=this.publisherIndex+i;for(;this.publisherIndex!==a;){let e=oO(t,s++),r=this.publisherIndex&this.mask;this.array[r]=e,this.subscribers[r]=this.subscriberCount,this.publisherIndex+=1,this.replayBuffer&&this.replayBuffer.offer(e)}return oR(t,s)}slide(){if(this.subscribersIndex!==this.publisherIndex){let e=this.subscribersIndex&this.mask;this.array[e]=Pf,this.subscribers[e]=0,this.subscribersIndex+=1}this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new Px(this,this.publisherIndex,!1)}}class Px{self;subscriberIndex;unsubscribed;constructor(e,t,r){this.self=e,this.subscriberIndex=t,this.unsubscribed=r}isEmpty(){return this.unsubscribed||this.self.publisherIndex===this.subscriberIndex||this.self.publisherIndex===this.self.subscribersIndex}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(e){if(this.unsubscribed)return e;if(this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex),this.subscriberIndex!==this.self.publisherIndex){let e=this.subscriberIndex&this.self.mask,t=this.self.array[e];return this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=Pf,this.self.subscribersIndex+=1),this.subscriberIndex+=1,t}return e}pollUpTo(e){if(this.unsubscribed)return om();this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);let t=Math.min(e,this.self.publisherIndex-this.subscriberIndex);if(t<=0)return om();let r=[],n=this.subscriberIndex+t;for(;this.subscriberIndex!==n;){let e=this.subscriberIndex&this.self.mask,t=this.self.array[e];this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=Pf,this.self.subscribersIndex+=1),r.push(t),this.subscriberIndex+=1}return oy(r)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);this.subscriberIndex!==this.self.publisherIndex;){let e=this.subscriberIndex&this.self.mask;this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=Pf,this.self.subscribersIndex+=1),this.subscriberIndex+=1}}}class Pv{replayBuffer;publisherIndex=0;subscriberCount=0;subscribers=0;value=Pf;capacity=1;constructor(e){this.replayBuffer=e}replayWindow(){return this.replayBuffer?new Pq(this.replayBuffer):PJ}pipe(){return iw(this,arguments)}isEmpty(){return 0===this.subscribers}isFull(){return!this.isEmpty()}size(){return+!this.isEmpty()}publish(e){return!this.isFull()&&(0!==this.subscriberCount&&(this.value=e,this.subscribers=this.subscriberCount,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(e),!0)}publishAll(e){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(e),om();let t=oy(e);return oD(t)?t:this.publish(oL(t))?oR(t,1):t}slide(){this.isFull()&&(this.subscribers=0,this.value=Pf),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new PS(this,this.publisherIndex,!1)}}class PS{self;subscriberIndex;unsubscribed;constructor(e,t,r){this.self=e,this.subscriberIndex=t,this.unsubscribed=r}isEmpty(){return this.unsubscribed||0===this.self.subscribers||this.subscriberIndex===this.self.publisherIndex}size(){return+!this.isEmpty()}poll(e){if(this.isEmpty())return e;let t=this.self.value;return this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=Pf),this.subscriberIndex+=1,t}pollUpTo(e){if(this.isEmpty()||e<1)return om();let t=this.self.value;return this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=Pf),this.subscriberIndex+=1,ob(t)}unsubscribe(){this.unsubscribed||(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex!==this.self.publisherIndex&&(this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=Pf)))}}class P_{replayBuffer;publisherHead={value:Pf,subscribers:0,next:null};publisherTail=this.publisherHead;publisherIndex=0;subscribersIndex=0;capacity=Number.MAX_SAFE_INTEGER;constructor(e){this.replayBuffer=e}replayWindow(){return this.replayBuffer?new Pq(this.replayBuffer):PJ}isEmpty(){return this.publisherHead===this.publisherTail}isFull(){return!1}size(){return this.publisherIndex-this.subscribersIndex}publish(e){let t=this.publisherTail.subscribers;return 0!==t&&(this.publisherTail.next={value:e,subscribers:t,next:null},this.publisherTail=this.publisherTail.next,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(e),!0}publishAll(e){if(0!==this.publisherTail.subscribers)for(let t of e)this.publish(t);else this.replayBuffer&&this.replayBuffer.offerAll(e);return om()}slide(){this.publisherHead!==this.publisherTail&&(this.publisherHead=this.publisherHead.next,this.publisherHead.value=Pf,this.subscribersIndex+=1),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.publisherTail.subscribers+=1,new Pw(this,this.publisherTail,this.publisherIndex,!1)}}class Pw{self;subscriberHead;subscriberIndex;unsubscribed;constructor(e,t,r,n){this.self=e,this.subscriberHead=t,this.subscriberIndex=r,this.unsubscribed=n}isEmpty(){if(this.unsubscribed)return!0;let e=!0,t=!0;for(;t;)this.subscriberHead===this.self.publisherTail?t=!1:this.subscriberHead.next.value!==Pf?(e=!1,t=!1):(this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1);return e}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(e){if(this.unsubscribed)return e;let t=!0,r=e;for(;t;)if(this.subscriberHead===this.self.publisherTail)t=!1;else{let e=this.subscriberHead.next.value;e!==Pf&&(r=e,this.subscriberHead.subscribers-=1,0===this.subscriberHead.subscribers&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=Pf,this.self.subscribersIndex+=1),t=!1),this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1}return r}pollUpTo(e){let t=[],r=0;for(;r!==e;){let n=this.poll(Pf);n===Pf?r=e:(t.push(n),r+=1)}return oy(t)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.publisherTail.subscribers-=1;this.subscriberHead!==this.self.publisherTail;)this.subscriberHead.next.value!==Pf&&(this.subscriberHead.subscribers-=1,0===this.subscriberHead.subscribers&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=Pf,this.self.subscribersIndex+=1)),this.subscriberHead=this.subscriberHead.next}}class Pk extends bc{pubsub;subscribers;subscription;pollers;shutdownHook;shutdownFlag;strategy;replayWindow;[jq]=jG;constructor(e,t,r,n,i,s,a,o){super(),this.pubsub=e,this.subscribers=t,this.subscription=r,this.pollers=n,this.shutdownHook=i,this.shutdownFlag=s,this.strategy=a,this.replayWindow=o}commit(){return this.take}pipe(){return iw(this,arguments)}capacity(){return this.pubsub.capacity}isActive(){return!this.shutdownFlag.current}get size(){return pR(()=>this.shutdownFlag.current?pm:pF(this.subscription.size()+this.replayWindow.remaining))}unsafeSize(){return this.shutdownFlag.current?s_():i4(this.subscription.size()+this.replayWindow.remaining)}get isFull(){return pR(()=>this.shutdownFlag.current?pm:pF(this.subscription.size()===this.capacity()))}get isEmpty(){return px(this.size,e=>0===e)}get shutdown(){return pN(fV(e=>(cC(this.shutdownFlag,!0),nS(wd(PA(this.pollers),t=>mm(t,e.id()),!1),pJ(pI(()=>{this.subscribers.delete(this.subscription),this.subscription.unsubscribe(),this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers)})),pD(mg(this.shutdownHook,void 0)),fG))))}get isShutdown(){return pI(()=>this.shutdownFlag.current)}get awaitShutdown(){return mh(this.shutdownHook)}get take(){return fV(e=>{if(this.shutdownFlag.current)return pm;if(this.replayWindow.remaining>0)return pF(this.replayWindow.take());let t=Ce(this.pollers)?this.subscription.poll(E5):E5;if(t!==E5)return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),pF(t);{let t=ml(e.id());return nS(pR(()=>(nS(this.pollers,Ct(t)),nS(this.subscribers,Pp(this.subscription,this.pollers)),this.strategy.unsafeCompletePollers(this.pubsub,this.subscribers,this.subscription,this.pollers),this.shutdownFlag.current?pm:mh(t))),pw(()=>pI(()=>PP(this.pollers,t))))}})}get takeAll(){return pR(()=>{if(this.shutdownFlag.current)return pm;let e=Ce(this.pollers)?PN(this.subscription):om();return(this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),this.replayWindow.remaining>0)?pF(oT(this.replayWindow.takeAll(),e)):pF(e)})}takeUpTo(e){return pR(()=>{let t;if(this.shutdownFlag.current)return pm;if(this.replayWindow.remaining>=e)return pF(this.replayWindow.takeN(e));this.replayWindow.remaining>0&&(t=this.replayWindow.takeAll(),e-=t.length);let r=Ce(this.pollers)?PM(this.subscription,e):om();return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),t?pF(oT(t,r)):pF(r)})}takeBetween(e,t){return pR(()=>PO(this,e,t,om()))}}let PO=(e,t,r,n)=>r<t?pF(n):nS(e.takeUpTo(r),ps(i=>{let s=t-i.length;return 1===s?nS(e.take,px(e=>nS(n,oT(i),oE(e)))):s>1?nS(e.take,ps(t=>PO(e,s-1,r-i.length-1,nS(n,oT(i),oE(t))))):pF(nS(n,oT(i)))}));class PE{pubsub;subscribers;scope;shutdownHook;shutdownFlag;strategy;[jB]=jK;[jq]=jG;constructor(e,t,r,n,i,s){this.pubsub=e,this.subscribers=t,this.scope=r,this.shutdownHook=n,this.shutdownFlag=i,this.strategy=s}capacity(){return this.pubsub.capacity}get size(){return pR(()=>this.shutdownFlag.current?pm:pI(()=>this.pubsub.size()))}unsafeSize(){return this.shutdownFlag.current?s_():i4(this.pubsub.size())}get isFull(){return px(this.size,e=>e===this.capacity())}get isEmpty(){return px(this.size,e=>0===e)}get awaitShutdown(){return mh(this.shutdownHook)}get isShutdown(){return pI(()=>this.shutdownFlag.current)}get shutdown(){return pN(fV(e=>(nS(this.shutdownFlag,cC(!0)),nS(this.scope.close(d7(e.id())),pJ(this.strategy.shutdown),pD(mg(this.shutdownHook,void 0)),fG))))}publish(e){return pR(()=>this.shutdownFlag.current?pm:this.pubsub.publish(e)?(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),pF(!0)):this.strategy.handleSurplus(this.pubsub,this.subscribers,ob(e),this.shutdownFlag))}isActive(){return!this.shutdownFlag.current}unsafeOffer(e){return!this.shutdownFlag.current&&!!this.pubsub.publish(e)&&(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),!0)}publishAll(e){return pR(()=>{if(this.shutdownFlag.current)return pm;let t=Pj(this.pubsub,e);return(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),oD(t))?pF(!0):this.strategy.handleSurplus(this.pubsub,this.subscribers,t,this.shutdownFlag)})}get subscribe(){let e,t,r,n=pT(wf([this.scope.fork(bd),(e=this.pubsub,t=this.subscribers,r=this.strategy,px(mu(),n=>{let i,s,a,o,l,u;return i=e,s=t,a=e.subscribe(),o=E7(),l=n,u=cO(!1),new Pk(i,s,a,o,l,u,r,i.replayWindow())}))]),e=>e[0].addFinalizer(()=>e[1].shutdown));return px(wc(n,(e,t)=>e[0].close(t)),e=>e[1])}offer(e){return this.publish(e)}offerAll(e){return this.publishAll(e)}pipe(){return iw(this,arguments)}}let PC=(e,t)=>ps(wP(),r=>px(mu(),n=>PF(e,new Map,r,n,cO(!1),t))),PF=(e,t,r,n,i,s)=>new PE(e,t,r,n,i,s),PR=e=>{if(e<=0)throw new dK(`Cannot construct PubSub with capacity of ${e}`)},PI=(e,t)=>{mb(e,pF(t))},PT=(e,t)=>nS(e,Cr(t)),PA=e=>nS(e,Ci(1/0)),PN=e=>e.pollUpTo(1/0),PM=(e,t)=>e.pollUpTo(t),Pj=(e,t)=>e.publishAll(t),PP=(e,t)=>{PT(e,nS(PA(e),oN(e=>e!==t)))};class PD{publishers=E7();get shutdown(){return ps(pn,e=>ps(pI(()=>PA(this.publishers)),t=>wm(t,([t,r,n])=>n?nS(mm(r,e),fG):pj,!1,!1)))}handleSurplus(e,t,r,n){return fV(i=>{let s=ml(i.id());return nS(pR(()=>(this.unsafeOffer(r,s),this.unsafeOnPubSubEmptySpace(e,t),this.unsafeCompleteSubscribers(e,t),n.current?pm:mh(s))),pw(()=>pI(()=>this.unsafeRemove(s))))})}unsafeOnPubSubEmptySpace(e,t){let r=!0;for(;r&&!e.isFull();){let n=nS(this.publishers,Cn(E5));if(n===E5)r=!1;else{let r=e.publish(n[0]);r&&n[2]?PI(n[1],!0):r||PT(this.publishers,nS(PA(this.publishers),oC(n))),this.unsafeCompleteSubscribers(e,t)}}}unsafeCompletePollers(e,t,r,n){return PL(this,e,t,r,n)}unsafeCompleteSubscribers(e,t){return PU(this,e,t)}unsafeOffer(e,t){let r=e[Symbol.iterator](),n=r.next();if(!n.done)for(;;){let e=n.value;if((n=r.next()).done){nS(this.publishers,Ct([e,t,!0]));break}nS(this.publishers,Ct([e,t,!1]))}}unsafeRemove(e){PT(this.publishers,nS(PA(this.publishers),oN(([t,r])=>r!==e)))}}class P${get shutdown(){return pj}handleSurplus(e,t,r,n){return pF(!1)}unsafeOnPubSubEmptySpace(e,t){}unsafeCompletePollers(e,t,r,n){return PL(this,e,t,r,n)}unsafeCompleteSubscribers(e,t){return PU(this,e,t)}}class Pz{get shutdown(){return pj}handleSurplus(e,t,r,n){return pI(()=>(this.unsafeSlidingPublish(e,r),this.unsafeCompleteSubscribers(e,t),!0))}unsafeOnPubSubEmptySpace(e,t){}unsafeCompletePollers(e,t,r,n){return PL(this,e,t,r,n)}unsafeCompleteSubscribers(e,t){return PU(this,e,t)}unsafeSlidingPublish(e,t){let r=t[Symbol.iterator](),n=r.next();if(!n.done&&e.capacity>0){let t=n.value,i=!0;for(;i;){e.slide();let s=e.publish(t);s&&(n=r.next())&&!n.done?t=n.value:s&&(i=!1)}}}}let PL=(e,t,r,n,i)=>{let s=!0;for(;s&&!n.isEmpty();){let a=nS(i,Cn(E5));if(a===E5)nS(r,Pd(n,i)),Ce(i)?s=!1:nS(r,Pp(n,i));else{let s=n.poll(E5);s===E5?PT(i,nS(PA(i),oC(a))):(PI(a,s),e.unsafeOnPubSubEmptySpace(t,r))}}},PU=(e,t,r)=>{for(let[n,i]of r)for(let s of i)e.unsafeCompletePollers(t,r,n,s)};class PB{capacity;constructor(e){this.capacity=e}head={value:Pf,next:null};tail=this.head;size=0;index=0;slide(){this.index++}offer(e){this.tail.value=e,this.tail.next={value:Pf,next:null},this.tail=this.tail.next,this.size===this.capacity?this.head=this.head.next:this.size+=1}offerAll(e){for(let t of e)this.offer(t)}}class Pq{buffer;head;index;remaining;constructor(e){this.buffer=e,this.index=e.index,this.remaining=e.size,this.head=e.head}fastForward(){for(;this.index<this.buffer.index;)this.head=this.head.next,this.index++}take(){if(0===this.remaining)return;this.index<this.buffer.index&&this.fastForward(),this.remaining--;let e=this.head.value;return this.head=this.head.next,e}takeN(e){if(0===this.remaining)return om();this.index<this.buffer.index&&this.fastForward();let t=Math.min(e,this.remaining),r=Array(t);for(let e=0;e<t;e++){let t=this.head.value;this.head=this.head.next,r[e]=t}return this.remaining-=t,ow(r)}takeAll(){return this.takeN(this.remaining)}}let PJ={remaining:0,take:()=>void 0,takeN:()=>om(),takeAll:()=>om()},PH=e=>pR(()=>PC(Pm(e),new PD)),PV="Continue",PW=Symbol.for("effect/ChannelChildExecutorDecision"),PK={[PW]:PW},PG=e=>{let t=Object.create(PK);return t._tag=PV,t},PZ="ContinuationK",PQ=Symbol.for("effect/ChannelContinuation"),PY={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutDone:e=>e,_OutErr2:e=>e,_OutElem:e=>e,_OutDone2:e=>e};class PX{onSuccess;onHalt;_tag=PZ;[PQ]=PY;constructor(e,t){this.onSuccess=e,this.onHalt=t}onExit(e){return"Failure"===e._tag?this.onHalt(e.cause):this.onSuccess(e.value)}}class P0{finalizer;_tag="ContinuationFinalizer";[PQ]=PY;constructor(e){this.finalizer=e}}let P1="PullAfterNext",P2={[Symbol.for("effect/ChannelUpstreamPullStrategy")]:{_A:e=>e}},P3=e=>{let t=Object.create(P2);return t._tag=P1,t.emitSeparator=e,t},P5="BracketOut",P4="Bridge",P6="ConcatAll",P8="Emit",P7="Ensuring",P9="Fail",De="Fold",Dt="FromEffect",Dr="PipeTo",Dn="Provide",Di="Read",Ds="Succeed",Da="SucceedNow",Do="Suspend",Dl=Symbol.for("effect/Channel"),Du={[Dl]:{_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},pipe(){return iw(this,arguments)}},Dc=e=>nL(e,Dl)||fH(e),Dh=nm(2,(e,t)=>{let r=Object.create(Du);return r._tag=P5,r.acquire=()=>e,r.finalizer=t,r}),Df=nm(2,(e,t)=>{let r=Object.create(Du);return r._tag=De,r.channel=e,r.k=new PX(DR,t),r}),Dp=e=>DT(()=>{let t=[];return D_(DO(e,Dd(t)),e=>DA(()=>[oy(t),e]))}),Dd=e=>DC({onInput:t=>D_(DA(()=>{e.push(t)}),()=>Dd(e)),onFailure:Dx,onDone:DI}),Dm=(e,t,r)=>{let n=Object.create(Du);return n._tag=P6,n.combineInners=t,n.combineAll=r,n.onPull=()=>P3(s_()),n.onEmit=()=>PG,n.value=()=>e,n.k=ng,n},Dg=nm(4,(e,t,r,n)=>{let i=Object.create(Du);return i._tag=P6,i.combineInners=r,i.combineAll=n,i.onPull=()=>P3(s_()),i.onEmit=()=>PG,i.value=()=>e,i.k=t,i}),Db=nm(2,(e,t)=>{let r=Object.create(Du);return r._tag=P4,r.input=t,r.channel=e,r}),Dy=nm(2,(e,t)=>{let r=Object.create(Du);return r._tag=P7,r.channel=e,r.finalizer=t,r}),Dx=e=>Dv(l2(e)),Dv=e=>DS(()=>e),DS=e=>{let t=Object.create(Du);return t._tag=P9,t.error=e,t},D_=nm(2,(e,t)=>{let r=Object.create(Du);return r._tag=De,r.channel=e,r.k=new PX(t,Dv),r}),Dw=nm(2,(e,t)=>{let r=Object.create(Du);return r._tag=De,r.channel=e,r.k=new PX(t.onSuccess,t.onFailure),r}),Dk=e=>{let t=Object.create(Du);return t._tag=Dt,t.effect=()=>e,t},DO=nm(2,(e,t)=>{let r=Object.create(Du);return r._tag=Dr,r.left=()=>e,r.right=()=>t,r}),DE=nm(2,(e,t)=>{let r=Object.create(Du);return r._tag=Dn,r.context=()=>t,r.inner=e,r}),DC=e=>DF({onInput:e.onInput,onFailure:t=>su(ui(t),{onLeft:e.onFailure,onRight:Dv}),onDone:e.onDone}),DF=e=>{let t=Object.create(Du);return t._tag=Di,t.more=e.onInput,t.done=new PX(e.onDone,e.onFailure),t},DR=e=>DA(()=>e),DI=e=>{let t=Object.create(Du);return t._tag=Da,t.terminal=e,t},DT=e=>{let t=Object.create(Du);return t._tag=Do,t.channel=e,t},DA=e=>{let t=Object.create(Du);return t._tag=Ds,t.evaluate=e,t},DN=DI(void 0),DM=e=>{let t=Object.create(Du);return t._tag=P8,t.out=e,t},Dj="Done",DP="Emit",DD="FromEffect",D$="Read",Dz={[Symbol.for("effect/ChannelState")]:{_E:e=>e,_R:e=>e}},DL=()=>{let e=Object.create(Dz);return e._tag=Dj,e},DU=()=>{let e=Object.create(Dz);return e._tag=DP,e},DB=e=>{let t=Object.create(Dz);return t._tag=DD,t.effect=e,t},Dq=(e,t,r,n)=>{let i=Object.create(Dz);return i._tag=D$,i.upstream=e,i.onEffect=t,i.onEmit=r,i.onDone=n,i},DJ=e=>e._tag===DD,DH=e=>DJ(e)?xD(e.effect,{onFailure:nv,onSuccess:nv}):void 0,DV="PullFromChild",DW="PullFromUpstream",DK="DrainChildExecutors",DG="Emit";class DZ{childExecutor;parentSubexecutor;onEmit;_tag=DV;constructor(e,t,r){this.childExecutor=e,this.parentSubexecutor=t,this.onEmit=r}close(e){let t=this.childExecutor.close(e),r=this.parentSubexecutor.close(e);return void 0!==t&&void 0!==r?wT(f7(t),f7(r),(e,t)=>nS(e,ms(t))):void 0!==t?t:void 0!==r?r:void 0}enqueuePullFromChild(e){return this}}class DQ{upstreamExecutor;createChild;lastDone;activeChildExecutors;combineChildResults;combineWithChildResult;onPull;onEmit;_tag=DW;constructor(e,t,r,n,i,s,a,o){this.upstreamExecutor=e,this.createChild=t,this.lastDone=r,this.activeChildExecutors=n,this.combineChildResults=i,this.combineWithChildResult=s,this.onPull=a,this.onEmit=o}close(e){let t=this.upstreamExecutor.close(e);return[...this.activeChildExecutors.map(t=>void 0!==t?t.childExecutor.close(e):void 0),t].reduce((e,t)=>void 0!==e&&void 0!==t?wT(e,f7(t),(e,t)=>ms(e,t)):void 0!==e?e:void 0!==t?f7(t):void 0,void 0)}enqueuePullFromChild(e){return new DQ(this.upstreamExecutor,this.createChild,this.lastDone,[...this.activeChildExecutors,e],this.combineChildResults,this.combineWithChildResult,this.onPull,this.onEmit)}}class DY{upstreamExecutor;lastDone;activeChildExecutors;upstreamDone;combineChildResults;combineWithChildResult;onPull;_tag=DK;constructor(e,t,r,n,i,s,a){this.upstreamExecutor=e,this.lastDone=t,this.activeChildExecutors=r,this.upstreamDone=n,this.combineChildResults=i,this.combineWithChildResult=s,this.onPull=a}close(e){let t=this.upstreamExecutor.close(e);return[...this.activeChildExecutors.map(t=>void 0!==t?t.childExecutor.close(e):void 0),t].reduce((e,t)=>void 0!==e&&void 0!==t?wT(e,f7(t),(e,t)=>ms(e,t)):void 0!==e?e:void 0!==t?f7(t):void 0,void 0)}enqueuePullFromChild(e){return new DY(this.upstreamExecutor,this.lastDone,[...this.activeChildExecutors,e],this.upstreamDone,this.combineChildResults,this.combineWithChildResult,this.onPull)}}class DX{value;next;_tag=DG;constructor(e,t){this.value=e,this.next=t}close(e){return this.next.close(e)}enqueuePullFromChild(e){return this}}let D0={[Symbol.for("effect/ChannelUpstreamPullRequest")]:{_A:e=>e}},D1=e=>{let t=Object.create(D0);return t._tag="Pulled",t.value=e,t};class D2{_activeSubexecutor=void 0;_cancelled=void 0;_closeLastSubstream=void 0;_currentChannel;_done=void 0;_doneStack=[];_emitted=void 0;_executeCloseLastSubstream;_input=void 0;_inProgressFinalizer=void 0;_providedEnv;constructor(e,t,r){this._currentChannel=e,this._executeCloseLastSubstream=r,this._providedEnv=t}run(){let e;for(;void 0===e;)if(void 0!==this._cancelled)e=this.processCancellation();else if(void 0!==this._activeSubexecutor)e=this.runSubexecutor();else try{if(void 0===this._currentChannel)e=DL();else switch(fH(this._currentChannel)&&(this._currentChannel=Dk(this._currentChannel)),this._currentChannel._tag){case P5:e=this.runBracketOut(this._currentChannel);break;case P4:{let t=this._currentChannel.input;if(this._currentChannel=this._currentChannel.channel,void 0!==this._input){let r=this._input;this._input=void 0;let n=()=>ps(t.awaitRead(),()=>pR(()=>{let e=r.run();switch(e._tag){case Dj:return me(r.getDone(),{onFailure:e=>t.error(e),onSuccess:e=>t.done(e)});case DP:return ps(t.emit(r.getEmit()),()=>n());case DD:return pc(e.effect,{onFailure:e=>t.error(e),onSuccess:()=>n()});case D$:return D4(e,()=>n(),e=>t.error(e))}}));e=DB(ps(wb(pb(n())),e=>pI(()=>this.addFinalizer(t=>ps(pW(e),()=>pR(()=>{let e=this.restorePipe(t,r);return void 0!==e?e:pj}))))))}break}case P6:{let e=new D2(this._currentChannel.value(),this._providedEnv,e=>pI(()=>{let t=void 0===this._closeLastSubstream?pj:this._closeLastSubstream;this._closeLastSubstream=nS(t,wI(e))}));e._input=this._input;let t=this._currentChannel;this._activeSubexecutor=new DQ(e,e=>t.k(e),void 0,[],(e,r)=>t.combineInners(e,r),(e,r)=>t.combineAll(e,r),e=>t.onPull(e),e=>t.onEmit(e)),this._closeLastSubstream=void 0,this._currentChannel=void 0;break}case P8:this._emitted=this._currentChannel.out,this._currentChannel=void 0!==this._activeSubexecutor?void 0:DN,e=DU();break;case P7:this.runEnsuring(this._currentChannel);break;case P9:e=this.doneHalt(this._currentChannel.error());break;case De:this._doneStack.push(this._currentChannel.k),this._currentChannel=this._currentChannel.channel;break;case Dt:{let t=void 0===this._providedEnv?this._currentChannel.effect():nS(this._currentChannel.effect(),Ow(this._providedEnv));e=DB(pc(t,{onFailure:e=>{let t=this.doneHalt(e);return void 0!==t&&DJ(t)?t.effect:pj},onSuccess:e=>{let t=this.doneSucceed(e);return void 0!==t&&DJ(t)?t.effect:pj}}));break}case Dr:{let e=this._input,t=new D2(this._currentChannel.left(),this._providedEnv,e=>this._executeCloseLastSubstream(e));t._input=e,this._input=t,this.addFinalizer(t=>{let r=this.restorePipe(t,e);return void 0!==r?r:pj}),this._currentChannel=this._currentChannel.right();break}case Dn:{let e=this._providedEnv;this._providedEnv=this._currentChannel.context(),this._currentChannel=this._currentChannel.inner,this.addFinalizer(()=>pI(()=>{this._providedEnv=e}));break}case Di:{let t=this._currentChannel;e=Dq(this._input,ng,e=>{try{this._currentChannel=t.more(e)}catch(e){this._currentChannel=t.done.onExit(d3(e))}},e=>{let r=e=>t.done.onExit(e);this._currentChannel=r(e)});break}case Ds:e=this.doneSucceed(this._currentChannel.evaluate());break;case Da:e=this.doneSucceed(this._currentChannel.terminal);break;case Do:this._currentChannel=this._currentChannel.channel()}}catch(e){this._currentChannel=Dv(l3(e))}return e}getDone(){return this._done}getEmit(){return this._emitted}cancelWith(e){this._cancelled=e}clearInProgressFinalizer(){this._inProgressFinalizer=void 0}storeInProgressFinalizer(e){this._inProgressFinalizer=e}popAllFinalizers(e){let t=[],r=this._doneStack.pop();for(;r;)"ContinuationFinalizer"===r._tag&&t.push(r.finalizer),r=this._doneStack.pop();let n=0===t.length?pj:D5(t,e);return this.storeInProgressFinalizer(n),n}popNextFinalizers(){let e=[];for(;0!==this._doneStack.length;){let t=this._doneStack[this._doneStack.length-1];if(t._tag===PZ)break;e.push(t),this._doneStack.pop()}return e}restorePipe(e,t){let r=this._input;return(this._input=t,void 0!==r)?r.close(e):pj}close(e){let t,r,n=this._inProgressFinalizer;void 0!==n&&(t=nS(n,wW(pI(()=>this.clearInProgressFinalizer()))));let i=this.popAllFinalizers(e);void 0!==i&&(r=nS(i,wW(pI(()=>this.clearInProgressFinalizer()))));let s=void 0===this._activeSubexecutor?void 0:this._activeSubexecutor.close(e);if(void 0!==s||void 0!==t||void 0!==r)return nS(f7(D3(s)),wF(f7(D3(t))),wF(f7(D3(r))),px(([[e,t],r])=>nS(e,ms(t),ms(r))),pN,ps(e=>pR(()=>e)))}doneSucceed(e){if(0===this._doneStack.length)return this._done=mr(e),this._currentChannel=void 0,DL();let t=this._doneStack[this._doneStack.length-1];if(t._tag===PZ){this._doneStack.pop(),this._currentChannel=t.onSuccess(e);return}let r=this.popNextFinalizers();if(0===this._doneStack.length)return this._doneStack=r.reverse(),this._done=mr(e),this._currentChannel=void 0,DL();let n=D5(r.map(e=>e.finalizer),mr(e));return this.storeInProgressFinalizer(n),DB(nS(n,wW(pI(()=>this.clearInProgressFinalizer())),pN,ps(()=>pI(()=>this.doneSucceed(e)))))}doneHalt(e){if(0===this._doneStack.length)return this._done=d4(e),this._currentChannel=void 0,DL();let t=this._doneStack[this._doneStack.length-1];if(t._tag===PZ){this._doneStack.pop();try{this._currentChannel=t.onHalt(e)}catch(e){this._currentChannel=Dv(l3(e))}return}let r=this.popNextFinalizers();if(0===this._doneStack.length)return this._doneStack=r.reverse(),this._done=d4(e),this._currentChannel=void 0,DL();let n=D5(r.map(e=>e.finalizer),d4(e));return this.storeInProgressFinalizer(n),DB(nS(n,wW(pI(()=>this.clearInProgressFinalizer())),pN,ps(()=>pI(()=>this.doneHalt(e)))))}processCancellation(){return this._currentChannel=void 0,this._done=this._cancelled,this._cancelled=void 0,DL()}runBracketOut(e){return DB(pN(pc(this.provide(e.acquire()),{onFailure:e=>pI(()=>{this._currentChannel=Dv(e)}),onSuccess:t=>pI(()=>{this.addFinalizer(r=>this.provide(e.finalizer(t,r))),this._currentChannel=DM(t)})})))}provide(e){return void 0===this._providedEnv?e:nS(e,Ow(this._providedEnv))}runEnsuring(e){this.addFinalizer(e.finalizer),this._currentChannel=e.channel}addFinalizer(e){this._doneStack.push(new P0(e))}runSubexecutor(){let e=this._activeSubexecutor;switch(e._tag){case DV:return this.pullFromChild(e.childExecutor,e.parentSubexecutor,e.onEmit,e);case DW:return this.pullFromUpstream(e);case DK:return this.drainChildExecutors(e);case DG:return this._emitted=e.value,this._activeSubexecutor=e.next,DU()}}replaceSubexecutor(e){this._currentChannel=void 0,this._activeSubexecutor=e}finishWithExit(e){let t=me(e,{onFailure:e=>this.doneHalt(e),onSuccess:e=>this.doneSucceed(e)});return this._activeSubexecutor=void 0,void 0===t?pj:DJ(t)?t.effect:pj}finishSubexecutorWithCloseEffect(e,...t){this.addFinalizer(()=>nS(t,wp(t=>nS(pI(()=>t(e)),ps(e=>void 0!==e?e:pj)),{discard:!0})));let r=nS(e,me({onFailure:e=>this.doneHalt(e),onSuccess:e=>this.doneSucceed(e)}));return this._activeSubexecutor=void 0,r}applyUpstreamPullStrategy(e,t,r){switch(r._tag){case P1:{let n=!e||t.some(e=>void 0!==e);return[r.emitSeparator,n?[void 0,...t]:t]}case"PullAfterAllEnqueued":{let n=!e||t.some(e=>void 0!==e);return[r.emitSeparator,n?[...t,void 0]:t]}}}pullFromChild(e,t,r,n){return Dq(e,ng,i=>{let s=r(i);switch(s._tag){case PV:break;case"Close":this.finishWithDoneValue(e,t,s.value);break;case"Yield":{let e=t.enqueuePullFromChild(n);this.replaceSubexecutor(e)}}this._activeSubexecutor=new DX(i,this._activeSubexecutor)},me({onFailure:r=>{let n=this.handleSubexecutorFailure(e,t,r);return void 0===n?void 0:DH(n)},onSuccess:r=>{this.finishWithDoneValue(e,t,r)}}))}finishWithDoneValue(e,t,r){switch(t._tag){case DW:{let n=new DQ(t.upstreamExecutor,t.createChild,void 0!==t.lastDone?t.combineChildResults(t.lastDone,r):r,t.activeChildExecutors,t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit);this._closeLastSubstream=e.close(mr(r)),this.replaceSubexecutor(n);break}case DK:{let n=new DY(t.upstreamExecutor,void 0!==t.lastDone?t.combineChildResults(t.lastDone,r):r,t.activeChildExecutors,t.upstreamDone,t.combineChildResults,t.combineWithChildResult,t.onPull);this._closeLastSubstream=e.close(mr(r)),this.replaceSubexecutor(n)}}}handleSubexecutorFailure(e,t,r){return this.finishSubexecutorWithCloseEffect(d4(r),e=>t.close(e),t=>e.close(t))}pullFromUpstream(e){if(0===e.activeChildExecutors.length)return this.performPullFromUpstream(e);let t=e.activeChildExecutors[0],r=new DQ(e.upstreamExecutor,e.createChild,e.lastDone,e.activeChildExecutors.slice(1),e.combineChildResults,e.combineWithChildResult,e.onPull,e.onEmit);if(void 0===t)return this.performPullFromUpstream(r);this.replaceSubexecutor(new DZ(t.childExecutor,r,t.onEmit))}performPullFromUpstream(e){return Dq(e.upstreamExecutor,e=>{let t=void 0===this._closeLastSubstream?pj:this._closeLastSubstream;return this._closeLastSubstream=void 0,nS(this._executeCloseLastSubstream(t),wI(e))},t=>{if(void 0!==this._closeLastSubstream){let r=this._closeLastSubstream;return this._closeLastSubstream=void 0,nS(this._executeCloseLastSubstream(r),px(()=>{let r=new D2(e.createChild(t),this._providedEnv,this._executeCloseLastSubstream);r._input=this._input;let[n,i]=this.applyUpstreamPullStrategy(!1,e.activeChildExecutors,e.onPull(D1(t)));this._activeSubexecutor=new DZ(r,new DQ(e.upstreamExecutor,e.createChild,e.lastDone,i,e.combineChildResults,e.combineWithChildResult,e.onPull,e.onEmit),e.onEmit),i3(n)&&(this._activeSubexecutor=new DX(n.value,this._activeSubexecutor))}))}let r=new D2(e.createChild(t),this._providedEnv,this._executeCloseLastSubstream);r._input=this._input;let[n,i]=this.applyUpstreamPullStrategy(!1,e.activeChildExecutors,e.onPull(D1(t)));this._activeSubexecutor=new DZ(r,new DQ(e.upstreamExecutor,e.createChild,e.lastDone,i,e.combineChildResults,e.combineWithChildResult,e.onPull,e.onEmit),e.onEmit),i3(n)&&(this._activeSubexecutor=new DX(n.value,this._activeSubexecutor))},t=>{if(e.activeChildExecutors.some(e=>void 0!==e)){let t=new DY(e.upstreamExecutor,e.lastDone,[void 0,...e.activeChildExecutors],e.upstreamExecutor.getDone(),e.combineChildResults,e.combineWithChildResult,e.onPull);if(void 0!==this._closeLastSubstream){let e=this._closeLastSubstream;return this._closeLastSubstream=void 0,nS(this._executeCloseLastSubstream(e),px(()=>this.replaceSubexecutor(t)))}return void this.replaceSubexecutor(t)}let r=this._closeLastSubstream,n=this.finishSubexecutorWithCloseEffect(nS(t,d9(t=>e.combineWithChildResult(e.lastDone,t))),()=>r,t=>e.upstreamExecutor.close(t));return void 0===n?void 0:DH(n)})}drainChildExecutors(e){if(0===e.activeChildExecutors.length){let t=this._closeLastSubstream;return void 0!==t&&this.addFinalizer(()=>pF(t)),this.finishSubexecutorWithCloseEffect(e.upstreamDone,()=>t,t=>e.upstreamExecutor.close(t))}let t=e.activeChildExecutors[0],r=e.activeChildExecutors.slice(1);if(void 0===t){let[t,n]=this.applyUpstreamPullStrategy(!0,r,e.onPull((e=>{let t=Object.create(D0);return t._tag="NoUpstream",t.activeDownstreamCount=e,t})(r.reduce((e,t)=>void 0!==t?e+1:e,0))));return(this.replaceSubexecutor(new DY(e.upstreamExecutor,e.lastDone,n,e.upstreamDone,e.combineChildResults,e.combineWithChildResult,e.onPull)),i3(t))?(this._emitted=t.value,DU()):void 0}let n=new DY(e.upstreamExecutor,e.lastDone,r,e.upstreamDone,e.combineChildResults,e.combineWithChildResult,e.onPull);this.replaceSubexecutor(new DZ(t.childExecutor,n,t.onEmit))}}let D3=e=>void 0!==e?e:pj,D5=(e,t)=>nS(wp(e,e=>f7(e(t))),px(e=>nS(d2(e),sk(()=>mn))),ps(e=>pR(()=>e))),D4=(e,t,r)=>{let n=[e],i=()=>{let e=n.pop();if(void 0===e||void 0===e.upstream)return f6("Unexpected end of input for channel execution");let s=e.upstream.run();switch(s._tag){case DP:{let s=e.onEmit(e.upstream.getEmit());if(0===n.length){if(void 0===s)return pR(t);return nS(s,pc({onFailure:r,onSuccess:t}))}if(void 0===s)return pR(()=>i());return nS(s,pc({onFailure:r,onSuccess:()=>i()}))}case Dj:{let s=e.onDone(e.upstream.getDone());if(0===n.length){if(void 0===s)return pR(t);return nS(s,pc({onFailure:r,onSuccess:t}))}if(void 0===s)return pR(()=>i());return nS(s,pc({onFailure:r,onSuccess:()=>i()}))}case DD:return n.push(e),nS(e.onEffect(s.effect),f0(t=>pR(()=>{let r=e.onDone(d4(t));return void 0===r?pj:r})),pc({onFailure:r,onSuccess:()=>i()}));case D$:return n.push(e),n.push(s),pR(()=>i())}};return i()},D6=nm(2,(e,t)=>pM(r=>wf([dM(t,bd),mu(),mu()]).pipe(ps(([n,i,s])=>r(((t,r,n)=>fW(pI(()=>new D2(e,void 0,ng)),e=>pR(()=>D8(e.run(),e).pipe(py(t),wI(mh(t)),wR(mh(r)))),(e,t)=>{let r=e.close(t);return void 0===r?pj:x5(r,e=>dT(n,pt(e)))}))(i,s,n)).pipe(kp(t),ps(e=>t.addFinalizer(t=>{let r="Failure"===t._tag?ur(t.cause):void 0;return bo(i).pipe(ps(t=>t?mg(s,void 0).pipe(wI(e.await),wI(e.inheritAll)):mg(s,void 0).pipe(wI(r&&lV(r)>0?pK(e,nS(r,lq(cP,(e,t)=>cz(t)(e)))):pW(e)),wI(e.inheritAll))))}).pipe(wI(r(mh(i)))))))))),D8=(e,t)=>{switch(e._tag){case DD:return nS(e.effect,ps(()=>D8(t.run(),t)));case DP:return D8(t.run(),t);case Dj:return pR(()=>t.getDone());case D$:return D4(e,()=>D8(t.run(),t),pt)}},D7="Done",D9={[Symbol.for("effect/ChannelMergeDecision")]:{_R:e=>e,_E0:e=>e,_Z0:e=>e,_E:e=>e,_Z:e=>e}},$e=e=>{let t=Object.create(D9);return t._tag=D7,t.effect=e,t},$t=e=>{let t=Object.create(D9);return t._tag="Await",t.f=e,t},$r="BothRunning",$n="LeftDone",$i="RightDone",$s=Symbol.for("effect/ChannelMergeState"),$a={[$s]:$s},$o=(e,t)=>{let r=Object.create($a);return r._tag=$r,r.left=e,r.right=t,r},$l=e=>{let t=Object.create($a);return t._tag=$n,t.f=e,t},$u=e=>{let t=Object.create($a);return t._tag=$i,t.f=e,t},$c="BackPressure",$h="BufferSliding",$f=Symbol.for("effect/ChannelMergeStrategy"),$p={[$f]:$f},$d=e=>{let t=Object.create($p);return t._tag=$c,t},$m=nm(2,(e,{onBackPressure:t,onBufferSliding:r})=>{switch(e._tag){case $c:return t();case $h:return r()}}),$g="Empty",$b="Emit",$y="Error",$x="Done",$v=e=>({_tag:$g,notifyProducer:e}),$S=e=>({_tag:$b,notifyConsumers:e});class $_{ref;constructor(e){this.ref=e}awaitRead(){return pl(xu(this.ref,e=>e._tag===$g?[mh(e.notifyProducer),e]:[pj,e]))}get close(){return pi(e=>this.error(l5(e)))}done(e){return pl(xu(this.ref,t=>{switch(t._tag){case $g:return[mh(t.notifyProducer),t];case $b:return[wp(t.notifyConsumers,t=>mg(t,sn(e)),{discard:!0}),{_tag:$x,done:e}];case $y:case $x:return[pm,t]}}))}emit(e){return ps(mu(),t=>pl(xu(this.ref,r=>{switch(r._tag){case $g:return[mh(r.notifyProducer),r];case $b:{let n=r.notifyConsumers[0],i=r.notifyConsumers.slice(1);if(void 0!==n)return[mg(n,si(e)),0===i.length?$v(t):$S(i)];throw Error("Bug: Channel.SingleProducerAsyncInput.emit - Queue was empty! please report an issue at https://github.com/Effect-TS/effect/issues")}case $y:case $x:return[pm,r]}})))}error(e){return pl(xu(this.ref,t=>{switch(t._tag){case $g:return[mh(t.notifyProducer),t];case $b:return[wp(t.notifyConsumers,t=>md(t,e),{discard:!0}),{_tag:$y,cause:e}];case $y:case $x:return[pm,t]}}))}get take(){return this.takeWith(e=>d4(ul(e,sn)),e=>mr(e),e=>d5(si(e)))}takeWith(e,t,r){return ps(mu(),n=>pl(xu(this.ref,i=>{switch(i._tag){case $g:return[wI(mg(i.notifyProducer,void 0),pu(mh(n),{onFailure:e,onSuccess:su({onLeft:r,onRight:t})})),$S([n])];case $b:return[pu(mh(n),{onFailure:e,onSuccess:su({onLeft:r,onRight:t})}),$S([...i.notifyConsumers,n])];case $y:return[pF(e(i.cause)),i];case $x:return[pF(r(i.done)),i]}})))}}let $w=()=>nS(mu(),ps(e=>xa($v(e))),px(e=>new $_(e))),$k=nm(2,(e,t)=>$D(e,()=>t)),$O=nm(2,(e,t)=>Df(e,e=>su(ui(e),{onLeft:t,onRight:Dv}))),$E=nm(2,(e,t)=>Dg(e,t,()=>void 0,()=>void 0)),$C=e=>DC({onInput:t=>D_(DA(()=>{e.push(t)}),()=>$C(e)),onFailure:Dx,onDone:DR}),$F=e=>{let t=DF({onInput:()=>t,onFailure:Dv,onDone:DR});return DO(e,t)},$R=nm(2,(e,t)=>Dy(e,()=>t)),$I=nm(2,(e,t)=>Dw(e,{onFailure:e=>{let r=ui(e);switch(r._tag){case"Left":return t.onFailure(r.left);case"Right":return Dv(r.right)}},onSuccess:t.onSuccess})),$T=e=>$3(e.takeWith(Dv,t=>D_(DM(t),()=>$T(e)),DR)),$A=e=>DT(()=>$N(e)),$N=e=>nS(Dk(j3(e)),D_(su({onLeft:me({onFailure:Dv,onSuccess:DI}),onRight:t=>D_(DM(t),()=>$N(e))}))),$M=()=>DC({onInput:e=>D_(DM(e),()=>$M()),onFailure:Dx,onDone:DI}),$j=nm(2,(e,t)=>$V(e,{other:Dk(t),onSelfDone:e=>$e(pR(()=>e)),onOtherDone:e=>$e(pR(()=>e))})),$P=nm(2,(e,t)=>$j(e,mh(t))),$D=nm(2,(e,t)=>D_(e,e=>DA(()=>t(e)))),$$=nm(2,(e,t)=>D_(e,e=>Dk(t(e)))),$z=nm(2,(e,t)=>$L(e,ul(t))),$L=nm(2,(e,t)=>Df(e,e=>Dv(t(e)))),$U=nm(2,(e,t)=>{let r=DC({onInput:e=>D_(DM(t(e)),()=>r),onFailure:Dx,onDone:DI});return DO(e,r)}),$B=nm(2,(e,t)=>{let r=DF({onInput:e=>nS(Dk(t(e)),D_(DM),D_(()=>r)),onFailure:Dv,onDone:DI});return DO(e,r)}),$q=nm(3,(e,t,r)=>$4(n=>Cx(function*(){let i=yield*$w(),s=$T(i),a=yield*Po(r);yield*dT(n,Ph(a));let o=yield*mu(),l=r===1/0?e=>ng:(yield*Cw(r)).withPermits,u=yield*s.pipe(DO(e),$0(n));yield*u.pipe(pc({onFailure:e=>j1(a,pt(e)),onSuccess:su({onLeft:e=>wI(pb(l(r)(pj)),fG(j1(a,pF(sn(e))))),onRight:e=>Cx(function*(){let r=yield*mu(),i=yield*mu();yield*j1(a,px(mh(r),si)),yield*mg(i,void 0).pipe(wI(pM(r=>f7(r(mh(o))).pipe(km(f7(r(t(e)))),ps(ng))).pipe(x5(e=>md(o,e)),py(r))),l(1),kp(n)),yield*mh(i)})})}),x$,pb,kp(n));let c=$3(pu(pl(j3(a)),{onFailure:Dv,onSuccess:su({onLeft:DI,onRight:e=>D_(DM(e),()=>c)})}));return Db(c,i)}))),$J=({bufferSize:e=16,concurrency:t,mergeStrategy:r=$d()})=>(n,i)=>$4(s=>Cx(function*(){let a="unbounded"===t?Number.MAX_SAFE_INTEGER:t,o=yield*$w(),l=$T(o),u=yield*Po(e);yield*dT(s,Ph(u));let c=yield*Pc();yield*dT(s,Ph(c));let h=yield*xa(s_()),f=yield*mu(),p=(yield*Cw(a)).withPermits,d=yield*$0(DO(l,n),s);function m(e){return e.pipe(ps(su({onLeft:e=>pF(i4(e)),onRight:e=>fK(j1(u,pF(si(e))),s_())})),EU({until:e=>i3(e)}),ps(e=>xc(h,sw({onNone:()=>i4(e.value),onSome:t=>i4(i(t,e.value))}))),f0(e=>l9(e)?pt(e):j1(u,pt(e)).pipe(wI(mg(f,void 0)),fG)))}yield*d.pipe(pc({onFailure:e=>j1(u,pt(e)).pipe(wI(pF(!1))),onSuccess:su({onLeft:e=>wq(pb(mh(f)),pb(p(a)(pj)),{onSelfDone:(e,t)=>fK(pW(t),!1),onOtherDone:(t,r)=>wI(pW(r),h.get.pipe(ps(sw({onNone:()=>j1(u,pF(sn(e))),onSome:t=>j1(u,pF(sn(i(t,e))))})),fK(!1)))}),onRight:e=>$m(r,{onBackPressure:()=>Cx(function*(){let t=yield*mu(),r=wE(t=>$0(DO(l,e),t).pipe(ps(e=>wJ(f7(m(e)),f7(pb(mh(f))))),ps(ng)));return yield*mg(t,void 0).pipe(wI(r),p(1),kp(s)),yield*mh(t),!(yield*bo(f))}),onBufferSliding:()=>Cx(function*(){let t=yield*mu(),r=yield*mu(),n=yield*c.size;yield*j3(c).pipe(ps(e=>mg(e,void 0)),x7(()=>n>=a)),yield*j1(c,t);let i=wE(r=>$0(DO(l,e),r).pipe(ps(e=>f7(m(e)).pipe(wJ(f7(pb(mh(f)))),wJ(f7(pb(mh(t)))))),ps(ng)));return yield*mg(r,void 0).pipe(wI(i),p(1),kp(s)),yield*mh(r),!(yield*bo(f))})})})}),EU({while:e=>e}),kp(s));let g=nS(j3(u),pl,pu({onFailure:Dv,onSuccess:su({onLeft:DI,onRight:e=>D_(DM(e),()=>g)})}),$3);return Db(g,o)})),$H=nm(3,(e,t,r)=>{let n;return(n=r,e=>$J(n)(e,nv))($U(e,t))}),$V=nm(2,(e,t)=>$4(function(r){return Cx(function*(){let n=yield*$w(),i=$T(n),s=yield*$0(DO(i,e),r),a=yield*$0(DO(i,t.other),r);function o(e,t,n){return(i,s,a)=>{function o(e){return e._tag===D7?pF(Dk(wI(pW(t),e.effect))):px(t.await,me({onFailure:t=>Dk(e.f(d4(t))),onSuccess:su({onLeft:t=>Dk(e.f(mr(t))),onRight:t=>ze(DM(t),l(a(e.f)))})}))}return me(e,{onFailure:e=>o(i(d4(e))),onSuccess:su({onLeft:e=>o(i(mr(e))),onRight:e=>pF(D_(DM(e),()=>D_(Dk(kp(pb(n),r)),e=>l(s(e,t)))))})})}}function l(e){switch(e._tag){case $r:return $3(wq(pb(vx(e.left)),pb(vx(e.right)),{onSelfDone:(r,n)=>wI(pW(n),o(r,e.right,s)(t.onSelfDone,$o,e=>$l(e))),onOtherDone:(r,n)=>wI(pW(n),o(r,e.left,a)(t.onOtherDone,(e,t)=>$o(t,e),e=>$u(e)))}));case $n:return $3(px(f7(a),me({onFailure:t=>Dk(e.f(d4(t))),onSuccess:su({onLeft:t=>Dk(e.f(mr(t))),onRight:t=>D_(DM(t),()=>l($l(e.f)))})})));case $i:return $3(px(f7(s),me({onFailure:t=>Dk(e.f(d4(t))),onSuccess:su({onLeft:t=>Dk(e.f(mr(t))),onRight:t=>D_(DM(t),()=>l($u(e.f)))})})))}}return Dk(fV(e=>{let t=fV(t=>(t.transferChildren(e.scope()),pj));return wT(pb(s).pipe(wW(t),kp(r)),pb(a).pipe(wW(t),kp(r)),(e,t)=>$o(e,t))})).pipe(D_(l),Db(n))})})),$W=((e,t)=>$O(e,e=>DS(()=>l3(t(e)))),nm(2,(e,t)=>$O(e,t))),$K=nm(2,(e,t)=>DT(()=>{let r,n=DC({onInput:e=>D_(DM(e),()=>n),onFailure:e=>Dv(l3(r=zr(e))),onDone:DI}),i=DF({onInput:e=>nS(DM(e),D_(()=>i)),onFailure:e=>"Die"===e._tag&&zn(e.defect)&&il(e.defect,r)?Dx(e.defect.error):Dv(e),onDone:DI});return DO(DO(DO(e,n),t),i)})),$G=((e,t)=>$4(r=>px(k5(t,r),t=>DE(e,t))),e=>wE(t=>D6(e,t))),$Z=e=>$G($F(e)),$Q=e=>wO(t=>D6(e,t)),$Y=e=>$3(pM(t=>px(wP(),r=>Dh(x5(t(wD(e,r)),e=>dN(r,d4(e))),(e,t)=>dN(r,t))))),$X=e=>$5(px(wN,t=>D_(Dk(e(t)),DM))),$0=nm(2,(e,t)=>wF(pI(()=>new D2(e,void 0,ng)),kq()).pipe(pT(([e,r])=>dA(t,t=>{let n=e.close(t);return void 0!==n?Ow(n,r):pj})),pN,px(([e])=>pR(()=>$1(e.run(),e))))),$1=(e,t)=>{switch(e._tag){case Dj:return me(t.getDone(),{onFailure:pt,onSuccess:e=>pF(sn(e))});case DP:return pF(si(t.getEmit()));case DD:return nS(e.effect,ps(()=>$1(t.run(),t)));case D$:return D4(e,()=>$1(t.run(),t),e=>pt(e))}},$2=e=>DF({onInput:t=>D_(Dk(j1(e,si(t))),()=>$2(e)),onFailure:t=>Dk(j1(e,sn(d4(t)))),onDone:t=>Dk(j1(e,sn(mr(t))))}),$3=e=>D_(Dk(e),ng),$5=e=>Dm($Y(e),(e,t)=>e,(e,t)=>e),$4=e=>Dm($X(e),(e,t)=>e,(e,t)=>e),$6=e=>$8(0,e.length,e),$8=(e,t,r)=>e===t?DN:nS(DM(nS(r,oO(e))),D_(()=>$8(e+1,t,r))),$7=nm(e=>Dc(e[1]),(e,t,r)=>r?.concurrent?$V(e,{other:t,onSelfDone:e=>$t(t=>pR(()=>mi(e,t))),onOtherDone:e=>$t(t=>pR(()=>mi(t,e)))}):D_(e,e=>$D(t,t=>[e,t]))),$9=nm(e=>Dc(e[1]),(e,t,r)=>r?.concurrent?$D($7(e,t,{concurrent:!0}),e=>e[0]):D_(e,e=>$k(t,e))),ze=nm(e=>Dc(e[1]),(e,t,r)=>r?.concurrent?$D($7(e,t,{concurrent:!0}),e=>e[1]):D_(e,()=>t)),zt=Symbol.for("effect/Channel/ChannelException"),zr=e=>({_tag:"ChannelException",[zt]:zt,error:e}),zn=e=>nL(e,zt),zi=Symbol.for("effect/RcRef"),zs={_tag:"Left"},za={_tag:"Right"},zo={_tag:"Both"},zl={_tag:"Either"},zu=Symbol.for("effect/Sink"),zc={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e};class zh{channel;[zu]=zc;constructor(e){this.channel=e}pipe(){return iw(this,arguments)}}let zf=e=>nL(e,zu),zp=e=>new zh(DT(()=>zM(e()))),zd=((e,t)=>nS(e,zd(oB(t))),nm(2,(e,t)=>{let r=DC({onInput:e=>nS(DM(t(e)),D_(()=>r)),onFailure:Dx,onDone:DR});return new zh(nS(r,DO(zM(e))))})),zm=nm(2,(e,t)=>{let r=DC({onInput:e=>nS(Dk(t(e)),D_(DM),D_(()=>r)),onFailure:Dx,onDone:DR});return new zh(nS(r,$K(zM(e))))}),zg=new zh($F($M())),zb=e=>new zh(Dx(e)),zy=(e,t,r)=>zp(()=>new zh(zx(e,t,r))),zx=(e,t,r)=>t(e)?DC({onInput:n=>{let[i,s]=zv(e,n,t,r,0,n.length);return o$(s)?nS(DM(s),$k(i)):zx(i,t,r)},onFailure:Dx,onDone:()=>DI(e)}):DI(e),zv=(e,t,r,n,i,s)=>{if(i===s)return[e,om()];let a=n(e,nS(t,oO(i)));return r(a)?zv(a,t,r,n,i+1,s):[a,nS(t,oR(i+1))]},zS=nm(2,(e,t)=>new zh(nS(zM(e),Dp,$I({onFailure:e=>zM(t.onFailure(e)),onSuccess:([e,r])=>DT(()=>{let n={ref:nS(e,oN(o$))},i=nS(DA(()=>{let e=n.ref;return n.ref=om(),e}),D_(e=>$6(e)));return D_(Dp(nS(i,ze($M()),DO(zM(t.onSuccess(r))))),([e,t])=>nS(DR(n.ref),D_($6),ze($6(e)),$k(t)))})})))),z_=(e,t,r)=>zp(()=>new zh(zw(e,t,r))),zw=(e,t,r)=>t(e)?DC({onInput:n=>nS(Dk(zk(e,n,t,r)),D_(([e,n])=>nS(n,sw({onNone:()=>zw(e,t,r),onSome:t=>nS(DM(t),$k(e))})))),onFailure:Dx,onDone:()=>DI(e)}):DI(e),zk=(e,t,r,n)=>zO(e,t,0,t.length,r,n),zO=(e,t,r,n,i,s)=>r===n?pF([e,s_()]):nS(s(e,nS(t,oO(r))),ps(e=>i(e)?zO(e,t,r+1,n,i,s):pF([e,i4(nS(t,oR(r+1)))]))),zE=nm(2,(e,t)=>zS(e,{onFailure:zb,onSuccess:t})),zC=e=>{let t=DF({onInput:r=>nS(Dk(wp(r,t=>e(t),{discard:!0})),D_(()=>t)),onFailure:Dv,onDone:()=>DN});return new zh(t)},zF=e=>{let t=DF({onInput:r=>nS(Dk(e(r)),D_(()=>t)),onFailure:Dv,onDone:()=>DN});return new zh(t)},zR=(e,t,r,n,i)=>r===n?i:nS(Dk(e(nS(t,oO(r)))),D_(s=>s?zR(e,t,r+1,n,i):DM(nS(t,oR(r)))),$O(e=>nS(DM(nS(t,oR(r))),ze(Dx(e))))),zI=(e,t)=>t?.shutdown?zj(px(wc(pF(e),Ph),zI)):zF(t=>j2(e,t)),zT=nm(2,(e,t)=>new zh(nS(zM(e),$D(t)))),zA=((e,t)=>new zh(nS(zM(e),$$(t))),nm(2,(e,t)=>zP(function(r){return Cx(function*(){let n,i=yield*PH(t?.capacity??16),s=yield*wD(i.subscribe,r),a=yield*wD(i.subscribe,r),o=(n=i,DT(()=>$2(n))),l=$A(s).pipe(DO(zM(e)),$9(Dk(Ph(s))),$V({other:$A(a).pipe(DO(zM(t.other)),$9(Dk(Ph(a)))),onSelfDone:t.onSelfDone,onOtherDone:t.onOtherDone}));return new zh($V(o,{other:l,onSelfDone:()=>$t(ng),onOtherDone:e=>$e(e)}))})}))),zN=((e,t,r)=>new zh(nS(e,zM,$O(e=>sw(t(e),{onNone:()=>DS(()=>l3(r(e))),onSome:Dx})))),(e,t,r=0)=>{let n,i=e[Symbol.iterator](),s=0,a=-1;for(;a<0&&(n=i.next())&&!n.done;){let e=n.value;s>=r&&t(e)&&(a=s),s+=1}return a}),zM=((e,t,r)=>new zh(nS(Dk(t),D_(n=>nS(e,zM,D_(e=>nS(Dk(t),$D(t=>[e,r(n,t)]))))))),e=>fH(e)?zM(new zh(Dk(e))):e.channel),zj=e=>new zh($5(e.pipe(px(e=>zM(e))))),zP=e=>new zh($4(t=>e(t).pipe(px(e=>zM(e))))),zD=((e=>zf(e[1]),(e,t,r)=>zD(e,t,(e,t)=>t,r)),nm(e=>zf(e[1]),(e,t,r,n)=>n?.concurrent?zA(e,{other:t,onSelfDone:me({onFailure:e=>$e(pt(e)),onSuccess:e=>$t(me({onFailure:pt,onSuccess:t=>pF(r(e,t))}))}),onOtherDone:me({onFailure:e=>$e(pt(e)),onSuccess:e=>$t(me({onFailure:pt,onSuccess:t=>pF(r(t,e))}))})}):zE(e,e=>zT(t,t=>r(e,t)))));class z${value;constructor(e){this.value=e}}let zz=(e,t)=>{e.isChanged=!0,e.newValue=t},zL=e=>{e.ref.versioned=new z$(e.newValue)},zU=e=>({ref:e.ref,isNew:e.isNew,isChanged:e.isChanged,expected:e.expected,newValue:e.newValue}),zB=e=>e.ref.versioned!==e.expected,zq=e=>e.isChanged,zJ="Invalid",zH="ReadWrite",zV=e=>{for(let t of e)zL(t[1])},zW=e=>{let t="ReadOnly";for(let[,r]of e)if((t=zB(r)?zJ:zq(r)?zH:t)===zJ)break;return t},zK="WithSTMRuntime",zG="OnFailure",zZ="OnRetry",zQ="OnSuccess",zY="Provide",zX="Sync",z0="Succeed",z1="Retry",z2="Fail",z3="Interrupt",z5="Fail",z4="Interrupt",z6="Succeed",z8="Retry",z7="Done",z9="Suspend",Le="Done",Lt="Interrupted",Lr="Running",Ln="effect/STM/State",Li=Symbol.for(Ln),Ls=e=>nL(e,Li),La=e=>({[Li]:Li,_tag:Le,exit:e,[n4](){return nS(n6(Ln),n7(n6(Le)),n7(n6(e)),ia(this))},[io]:t=>Ls(t)&&t._tag===Le&&il(e,t.exit)}),Lo=nS(n6(Ln),n7(n6(Lt)),n7(n6("interrupted"))),Ll={[Li]:Li,_tag:Lt,[n4]:()=>Lo,[io]:e=>Ls(e)&&e._tag===Lt},Lu=nS(n6(Ln),n7(n6(Lr)),n7(n6("running"))),Lc={[Li]:Li,_tag:Lr,[n4]:()=>Lu,[io]:e=>Ls(e)&&e._tag===Lr},Lh=e=>{switch(e._tag){case z5:return La(d5(e.error));case"Die":return La(d3(e.defect));case z4:return La(d7(e.fiberId));case z6:return La(mr(e.value));case z8:throw Error("BUG: STM.STMState.fromTExit - please report an issue at https://github.com/Effect-TS/effect/issues")}},Lf="effect/TExit",Lp=Symbol.for(Lf),Ld={_A:e=>e,_E:e=>e},Lm=e=>nL(e,Lp),Lg=e=>({[Lp]:Ld,_tag:z5,error:e,[n4](){return nS(n6(Lf),n7(n6(z5)),n7(n6(e)),ia(this))},[io]:t=>Lm(t)&&t._tag===z5&&il(e,t.error)}),Lb=e=>({[Lp]:Ld,_tag:"Die",defect:e,[n4](){return nS(n6(Lf),n7(n6("Die")),n7(n6(e)),ia(this))},[io]:t=>Lm(t)&&"Die"===t._tag&&il(e,t.defect)}),Ly=e=>({[Lp]:Ld,_tag:z4,fiberId:e,[n4](){return nS(n6(Lf),n7(n6(z4)),n7(n6(e)),ia(this))},[io]:t=>Lm(t)&&t._tag===z4&&il(e,t.fiberId)}),Lx=e=>({[Lp]:Ld,_tag:z6,value:e,[n4](){return nS(n6(Lf),n7(n6(z6)),n7(n6(e)),ia(this))},[io]:t=>Lm(t)&&t._tag===z6&&il(e,t.value)}),Lv=nS(n6(Lf),n7(n6(z8)),n7(n6("retry"))),LS={[Lp]:Ld,_tag:z8,[n4]:()=>Lv,[io]:e=>Lm(e)&&e._tag===z8},L_=e=>({_tag:z9,journal:e}),Lw={ref:0},Lk=Symbol.for("effect/STM"),LO={_R:e=>e,_E:e=>e,_A:e=>e};class LE{effect_instruction_i0;_op=iO;effect_instruction_i1=void 0;effect_instruction_i2=void 0;[fL];[iL];[zu];[Dl];get[Lk](){return LO}constructor(e){this.effect_instruction_i0=e,this[fL]=iq,this[iL]=LO,this[zu]=LO,this[Dl]=LO}[io](e){return this===e}[n4](){return ia(this,n8(this))}[Symbol.iterator](){return new f$(new nX(this))}commit(){return LC(this,nv,nv)}pipe(){return iw(this,arguments)}}let LC=(e,t,r)=>fV(n=>{let i=n.id(),s=n.getFiberRef(dh),a=n.getFiberRef(xm),o=n.getFiberRef(df),l=LF(i,e,s,a,o);switch(l._tag){case z7:return t(l.exit),l.exit;case z9:{let n=(()=>{let e=Lw.ref+1;return Lw.ref=e,e})(),l={value:Lc},u=fX(t=>LR(i,e,n,l,s,a,o,t));return pM(e=>nS(e(u),f0(e=>{let n=l.value;return n._tag===Lr&&(l.value=Ll),(n=l.value)._tag===Le?(t(n.exit),n.exit):(r(),pt(e))})))}}}),LF=(e,t,r,n,i)=>{let s=new Map,a=new LA(t,s,e,r).run(),o=zW(s);if(o===zH&&a._tag===z6)zV(s);else if(o===zJ)throw Error("BUG: STM.TryCommit.tryCommitSync - please report an issue at https://github.com/Effect-TS/effect/issues");switch(a._tag){case z6:return LI(mr(a.value),s,n,i);case z5:return LI(d4(l2(a.error)),s,n,i);case"Die":return LI(d4(l3(a.defect)),s,n,i);case z4:return LI(d4(l5(e)),s,n,i);case z8:return L_(s)}},LR=(e,t,r,n,i,s,a,o)=>{if(n.value._tag===Lr){let l=((e,t,r,n,i,s)=>{let a=new Map,o=new LA(t,a,e,n).run(),l=zW(a);if(l===zH)zV(a);else if(l===zJ)throw Error("BUG: STM.TryCommit.tryCommit - please report an issue at https://github.com/Effect-TS/effect/issues");switch(o._tag){case z6:return r.value=Lh(o),LI(mr(o.value),a,i,s);case z5:return r.value=Lh(o),LI(d4(l2(o.error)),a,i,s);case"Die":return r.value=Lh(o),LI(d4(l3(o.defect)),a,i,s);case z4:return r.value=Lh(o),LI(d4(l5(e)),a,i,s);case z8:return L_(a)}})(e,t,n,i,s,a);switch(l._tag){case z7:LT(l.exit,o);break;case z9:((e,t,r)=>{for(let[,n]of t)n.ref.todos.has(e)||n.ref.todos.set(e,r)})(r,l.journal,()=>LR(e,t,r,n,i,s,a,o))}}},LI=(e,t,r,n)=>{let i=(e=>{let t=new Map;for(let[,r]of e){for(let e of r.ref.todos)t.set(e[0],e[1]);r.ref.todos=new Map}return t})(t);return i.size>0&&r.scheduleTask(()=>(e=>{for(let[t,r]of Array.from(e.entries()).sort((e,t)=>e[0]-t[0]))r()})(i),n),{_tag:z7,exit:e}},LT=(e,t)=>{t(e)};class LA{self;journal;fiberId;contStack=[];env;constructor(e,t,r,n){this.self=e,this.journal=t,this.fiberId=r,this.env=n}getEnv(){return this.env}pushStack(e){this.contStack.push(e)}popStack(){return this.contStack.pop()}nextSuccess(){let e=this.popStack();for(;void 0!==e&&e.effect_instruction_i0!==zQ;)e=this.popStack();return e}nextFailure(){let e=this.popStack();for(;void 0!==e&&e.effect_instruction_i0!==zG;)e=this.popStack();return e}nextRetry(){let e=this.popStack();for(;void 0!==e&&e.effect_instruction_i0!==zZ;)e=this.popStack();return e}run(){let e,t=this.self;for(;void 0===e&&void 0!==t;)try{let r=t;if(r)switch(r._op){case"Tag":t=LD((e,t,n)=>uJ(n,r));break;case"Left":t=Lz(r.left);break;case"None":t=Lz(new dV);break;case"Right":t=LW(r.right);break;case"Some":t=LW(r.value);break;case"Commit":switch(r.effect_instruction_i0){case"Die":e=Lb(n2(()=>r.effect_instruction_i1()));break;case z2:{let n=this.nextFailure();void 0===n?e=Lg(n2(()=>r.effect_instruction_i1())):t=n2(()=>n.effect_instruction_i2(n2(()=>r.effect_instruction_i1())));break}case z1:{let r=this.nextRetry();void 0===r?e=LS:t=n2(()=>r.effect_instruction_i2());break}case z3:e=Ly(this.fiberId);break;case zK:t=n2(()=>r.effect_instruction_i1(this));break;case zQ:case zG:case zZ:this.pushStack(r),t=r.effect_instruction_i1;break;case zY:{let e=this.env;this.env=n2(()=>r.effect_instruction_i2(e)),t=nS(r.effect_instruction_i1,L$(LK(()=>this.env=e)));break}case z0:{let n=r.effect_instruction_i1,i=this.nextSuccess();void 0===i?e=Lx(n):t=n2(()=>i.effect_instruction_i2(n));break}case zX:{let n=n2(()=>r.effect_instruction_i1()),i=this.nextSuccess();void 0===i?e=Lx(n):t=n2(()=>i.effect_instruction_i2(n))}}}}catch(e){t=Lj(e)}return e}}let LN=nm(2,(e,t)=>{let r=new LE(zG);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),LM=nm(2,(e,t)=>{let r=new LE(zY);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),Lj=e=>LP(()=>e),LP=e=>{let t=new LE("Die");return t.effect_instruction_i1=e,t},LD=e=>Lq(t=>LW(e(t.journal,t.fiberId,t.getEnv()))),L$=nm(2,(e,t)=>LB(e,{onFailure:e=>LG(t,Lz(e)),onSuccess:e=>LG(t,LW(e))})),Lz=e=>LL(()=>e),LL=e=>{let t=new LE(z2);return t.effect_instruction_i1=e,t},LU=nm(2,(e,t)=>{let r=new LE(zQ);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),LB=nm(2,(e,{onFailure:t,onSuccess:r})=>nS(e,LJ(si),LN(e=>nS(t(e),LJ(sn))),LU(e=>{switch(e._tag){case"Left":return LW(e.left);case"Right":return r(e.right)}}))),Lq=e=>{let t=new LE(zK);return t.effect_instruction_i1=e,t},LJ=nm(2,(e,t)=>nS(e,LU(e=>LK(()=>t(e))))),LH=nm(2,(e,t)=>{let r=new LE(zZ);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),LV=new LE(z1),LW=e=>{let t=new LE(z0);return t.effect_instruction_i1=e,t},LK=e=>{let t=new LE(zX);return t.effect_instruction_i1=e,t},LG=nm(2,(e,t)=>nS(e,LU(()=>t))),LZ=nm(3,(e,t,r)=>nS(e,LU(e=>nS(t,LJ(t=>r(e,t)))))),LQ=((e,t)=>nS(e,LJ(()=>t)),nm(2,(e,{onFailure:t,onSuccess:r})=>LB(e,{onFailure:e=>LW(t(e)),onSuccess:e=>LW(r(e))}))),LY=nm(e=>nH(e[0]),(e,t,r)=>r?.discard?nS(LK(()=>e[Symbol.iterator]()),LU(e=>{let r=L0(()=>{let n=e.next();return n.done?L1:nS(t(n.value),LU(()=>r))});return r})):L0(()=>s1(e).reduce((e,r)=>LZ(e,t(r),(e,t)=>(e.push(t),e)),LW([])))),LX=((e,t)=>LB(e,{onFailure:e=>Lz(t(e)),onSuccess:LW}),nm(2,(e,t)=>LM(e,e=>t))),L0=((e,t,r)=>{let n;return n=n=>LU(r,r=>LX(e,uU(n,t,r))),LU(LD((e,t,r)=>r),n)},e=>LU(LK(e),ng)),L1=LW(void 0),L2=Symbol.for("effect/TRef"),L3=(e,t)=>{if(t.has(e))return t.get(e);let r=((e,t)=>({ref:e,isNew:t,isChanged:!1,expected:e.versioned,newValue:e.versioned.value}))(e,!1);return t.set(e,r),r};(e,t)=>L3(e,t).newValue,(e,t,r)=>L0(()=>{let n=(t,r,i)=>r<t?LW(i):nS(e.takeUpTo(r),LU(s=>{let a=t-s.length;return 1===a?nS(e.take,LJ(e=>nS(i,oT(ow(s)),oE(e)))):a>1?nS(e.take,LU(e=>n(a-1,r-s.length-1,nS(i,oT(ow(s)),oE(e))))):LW(nS(i,oT(ow(s))))}));return LJ(n(t,r,om()),e=>Array.from(e))});class L5{capacity;array;size=0;current=0;constructor(e){this.capacity=e,this.array=Array.from({length:e},nv)}head(){return sC(this.array[this.current])}lastOrNull(){if(0===this.size)return;let e=0===this.current?this.array.length-1:this.current-1;return this.array[e]??void 0}put(e){this.array[this.current]=e,this.increment()}dropLast(){this.size>0&&(this.decrement(),this.array[this.current]=void 0)}toChunk(){let e=this.current-this.size;return oy(e<0?[...this.array.slice(this.capacity+e,this.capacity),...this.array.slice(0,this.current)]:this.array.slice(e,this.current))}increment(){this.size<this.capacity&&(this.size+=1),this.current=(this.current+1)%this.capacity}decrement(){this.size-=1,this.current>0?this.current-=1:this.current=this.capacity-1}}let L4=Symbol.for("effect/Stream/Handoff"),L6="Empty",L8="Full",L7=e=>({_tag:L6,notifyConsumer:e}),L9=(e,t)=>r=>{switch(r._tag){case L6:return e(r.notifyConsumer);case L8:return t(r.value,r.notifyProducer)}},Ue={_A:e=>e},Ut=()=>nS(mu(),ps(e=>xa(L7(e))),px(e=>({[L4]:Ue,ref:e}))),Ur=nm(2,(e,t)=>ps(mu(),r=>pl(xu(e.ref,n=>nS(n,L9(e=>[wI(mg(e,void 0),mh(r)),{_tag:L8,value:t,notifyProducer:r}],(r,i)=>[ps(mh(i),()=>nS(e,Ur(t))),n])))))),Un=e=>ps(mu(),t=>pl(xu(e.ref,r=>nS(r,L9(t=>[ps(mh(t),()=>Un(e)),r],(e,r)=>[fK(mg(r,void 0),e),L7(t)]))))),Ui="Emit",Us="Halt",Ua=e=>({_tag:Us,cause:e}),Uo=e=>({_tag:"End",reason:e}),Ul=Symbol.for("effect/Take"),Uu={_A:e=>e,_E:e=>e};class Uc{exit;[Ul]=Uu;constructor(e){this.exit=e}pipe(){return iw(this,arguments)}}let Uh=e=>new Uc(mr(e)),Uf=e=>pR(()=>e.exit),Up=new Uc(d5(s_())),Ud=e=>new Uc(d4(nS(e,ul(i4)))),Um=nm(2,(e,{onEnd:t,onFailure:r,onSuccess:n})=>me(e.exit,{onFailure:e=>sw(mE(e),{onNone:t,onSome:r}),onSuccess:n})),Ug=e=>new Uc(mr(ob(e))),Ub="ScheduleEnd",Uy="UpstreamEnd",Ux={_tag:Ub},Uv={_tag:Uy},US="DrainLeft",U_="DrainRight",Uw="PullBoth",Uk="PullLeft",UO="PullRight",UE={_tag:US},UC={_tag:U_},UF={_tag:Uw},UR=e=>({_tag:Uk,rightChunk:e}),UI=e=>({_tag:UO,leftChunk:e}),UT="PullBoth",UA="PullLet",UN="PullRight",UM={_tag:UT},Uj=e=>({_tag:UA,rightChunk:e}),UP=e=>({_tag:UN,leftChunk:e}),UD=Symbol.for("effect/Stream"),U$={_R:e=>e,_E:e=>e,_A:e=>e};class Uz{channel;[UD]=U$;constructor(e){this.channel=e}pipe(){return iw(this,arguments)}}let UL=e=>nL(e,UD)||fH(e),UU=4096,UB=((e,t,r)=>U8(UB(e,t,r),e=>su(e,{onLeft:s_,onRight:i4})),nm(3,(e,t,r)=>Bo(wf([Ut(),xa(Ux),xa(om()),Ew(r),xa(!1),xa(!1)])).pipe(U7(([r,n,i,s,a,o])=>{let l=DF({onInput:e=>D_(Dk(nS(r,Ur({_tag:Ui,elements:e}),x7(()=>o$(e)))),()=>l),onFailure:e=>Dk(Ur(r,Ua(e))),onDone:()=>Dk(Ur(r,Uo(Uv)))}),u=nS(xl(i,om()),ps(e=>o$(e)?nS(xo(a,!0),wI(pF(nS(DM(e),D_(()=>u))))):nS(Un(r),px(e=>{switch(e._tag){case Ui:return nS(Dk(xo(a,!0)),ze(DM(e.elements)),ze(Dk(o.get)),D_(e=>e?DN:u));case Us:return Dv(e.cause);case"End":if(e.reason._tag===Ub)return nS(a.get,px(e=>e?Dk(nS(xo(n,Ux),wI(xo(o,!0)))):nS(Dk(nS(xo(n,Ux),wI(xo(o,!0)))),D_(()=>u))),$3);return nS(xo(n,e.reason),wI(xo(o,!0)),Dk)}}))),$3),c=e=>s.next(e),h=(e,s,l)=>{let f=nS(xo(a,!1),wI(xo(o,!1)),wI(nS(u,$K(zM(t)),Dp,$G,kp(l)))),p=(e,t,r)=>nS(xo(i,oP(e)),wI(px(n.get,e=>{switch(e._tag){case Ub:return nS(wf([a.get,f,nS(c(i4(t)),kp(l))]),px(([e,n,i])=>{let s=nS(r,sw({onNone:()=>ob(si(t)),onSome:e=>og(si(t),sn(e))}));return e?nS(DM(s),D_(()=>h(n,i,l))):h(n,i,l)}),$3);case Uy:return nS(a.get,px(e=>e?DM(ob(si(t))):DN),$3)}})),$3);return $3(wq(vx(e),vx(s),{onSelfDone:(e,t)=>nS(pW(s),wI(nS(pR(()=>e),px(([e,t])=>p(e,t,s_()))))),onOtherDone:(t,n)=>pc(pR(()=>t),{onFailure:t=>su(ui(t),{onLeft:()=>nS(r,Ur(Uo(Ux)),wb,wI(nS(vx(e),px(([e,t])=>p(e,t,s_()))))),onRight:t=>nS(r,Ur(Ua(t)),wb,wI(nS(vx(e),px(([e,t])=>p(e,t,s_())))))}),onSuccess:t=>nS(r,Ur(Uo(Ux)),wb,wI(nS(vx(e),px(([e,r])=>p(e,r,i4(t))))))})}))};return B6(r=>DO(Bs(e),l).pipe($G,kp(r),wI($K(u,zM(t)).pipe(Dp,$G,kp(r),ps(e=>c(s_()).pipe(kp(r),px(t=>new Uz(h(e,t,r)))))))))})))),Uq=((e,t)=>px(BY(e,t),e=>Bn(Bu(e))),(e,t)=>{let r=(e,t)=>{let n=r=>nS(t.get,pT(mh),wI(mu()),ps(n=>nS(j1(e,[r,n]),wI(xo(t,n)),wI(mh(n)))),fG,Dk);return DF({onInput:n=>nS(mu(),ps(r=>nS(j1(e,[Uh(n),r]),ps(e=>nS(xo(t,r),x7(()=>e))))),fG,Dk,D_(()=>r(e,t))),onFailure:e=>n(Ud(e)),onDone:()=>n(Up)})};return $5(nS(e,ps(e=>nS(mu(),pT(e=>mg(e,void 0)),ps(n=>nS(xa(n),ps(n=>nS(t,DO(r(e,n)),$Q,kd)),fK((e=>{let t=nS(Dk(j3(e)),D_(([e,r])=>ze(Dk(mg(r,void 0)),Um(e,{onEnd:()=>DN,onFailure:Dv,onSuccess:e=>nS(DM(e),D_(()=>t))}))));return t})(e))))))))}),UJ=nm(2,(e,t)=>UH(e,e=>su(ui(e),{onLeft:t,onRight:U6}))),UH=nm(2,(e,t)=>new Uz(nS(Bs(e),Df(e=>Bs(t(e)))))),UV=nm(2,(e,t)=>nS(e,UH(e=>nS(t(e),sk(()=>U6(e)))))),UW=e=>f1(xF(e),e=>"None"===e._tag?xX:f9(e.value)),UK=nm(4,(e,t,r,n)=>{let i=(e,t)=>ze(Dk(Un(t)),DF({onInput:r=>D_(Dk(nS(e,Ur(Uh(r)))),()=>i(e,t)),onFailure:t=>Dk(Ur(e,Ud(t))),onDone:()=>Dk(Ur(e,Up))}));return new Uz($4(s=>wf([Ut(),Ut(),Ut(),Ut()]).pipe(pT(([t,r,n])=>DO(Bs(e),i(t,n)).pipe(D6(s),kp(s))),pT(([e,r,n,a])=>DO(Bs(t),i(r,a)).pipe(D6(s),kp(s))),px(([e,t,i,s])=>{let a=Ur(i,void 0).pipe(wI(Un(e).pipe(ps(Uf)))),o=Ur(s,void 0).pipe(wI(Un(t).pipe(ps(Uf))));return Bs(B3(r,e=>ps(n(e,a,o),UW)))}))))}),UG=nm(2,(e,t)=>new Uz(nS(Bs(e),ze(Bs(t))))),UZ=((e,t)=>U7(e,()=>t),nm(2,(e,t)=>nS(mu(),ps(r=>nS(e,UX({maximumLag:t.maximumLag,decide:e=>ps(mh(r),t=>t(e))}),ps(e=>nS(wf(oB(((e,t)=>e<=t?oQ(t-e+1,t=>e+t):ob(e))(0,t.size-1),t=>px(e,([e,r])=>[[e,t],r]))),px(ow),ps(e=>{let[n,i]=aD(e,[new Map,om()],([e,t],[r,n])=>[e.set(r[0],r[1]),nS(t,oC(n))]);return nS(mg(r,e=>px(t.decide(e),e=>t=>e(n.get(t)))),fK(Array.from(i)))})))))))),UQ={ref:0},UY=()=>{let e=UQ.ref;return UQ.ref=e+1,e},UX=nm(2,(e,t)=>U0(e,t.maximumLag,t.decide,()=>pj)),U0=nm(4,(e,t,r,n)=>nS(wc(xa(new Map),(e,t)=>nS(e.get,ps(e=>nS(e.values(),wp(Ph))))),ps(i=>Cx(function*(){let s=yield*Cw(1),a=yield*xa(nS(Po(t),ps(e=>{let t=UY();return nS(xc(i,r=>r.set(t,e)),fK([t,e]))}))),o=e=>s.withPermits(1)(nS(xo(a,nS(Po(1),pT(t=>j1(t,e)),ps(e=>{let t=UY();return nS(xc(i,r=>r.set(t,e)),fK(sL(t,e)))}))),wI(nS(i.get,ps(t=>nS(oy(t.values()),wp(t=>nS(j1(t,e),xI(e=>l9(e)?i4(pj):s_()))))))),wI(n(e)),fG));return yield*nS(e,BL(e=>nS(r(e),ps(t=>nS(i.get,ps(r=>nS(r.entries(),xY(om(),(r,[n,i])=>t(n)?nS(j1(i,mr(e)),pc({onFailure:e=>l9(e)?pF(nS(r,oC(n))):pt(e),onSuccess:()=>pF(r)})):pF(r)),ps(e=>o$(e)?xc(i,t=>{for(let r of e)t.delete(r);return t}):pj))))),fG)),pc({onFailure:e=>o(d4(nS(e,ul(i4)))),onSuccess:()=>o(d5(s_()))}),kd),s.withPermits(1)(pl(a.get))})))),U1=((e,t)=>{let r=e=>DC({onInput:t=>{let n=nS(t,oR(e)),i=Math.max(0,e-t.length);return oD(t)||i>0?r(i):nS(DM(n),ze($M()))},onFailure:Dx,onDone:()=>DN});return new Uz(nS(Bs(e),$K(r(t))))},new Uz(DN)),U2=nm(2,(e,t)=>new Uz(nS(Bs(e),$R(t)))),U3=nm(2,(e,t)=>new Uz(Dy(Bs(e),t))),U5=e=>nS(Bo(mx),U7(e)),U4=e=>Bl(f9(i4(e))),U6=e=>Bo(pt(e)),U8=((e,t)=>{let r=e=>{let n=e.next();return n.done?DF({onInput:e=>r(e[Symbol.iterator]()),onFailure:Dv,onDone:DR}):nS(t(n.value),px(t=>t?nS(DM(ob(n.value)),D_(()=>r(e))):r(e)),$3)};return new Uz(DT(()=>nS(Bs(e),DO(r(om()[Symbol.iterator]())))))},nm(2,(e,t)=>Bb(e,oA(t)))),U7=nm(e=>UL(e[0]),(e,t,r)=>{let n=r?.bufferSize??16;return r?.switch?U9(r?.concurrency,()=>Be(e,1,n,t),r=>Be(e,r,n,t)):U9(r?.concurrency,()=>new Uz($E(Bs(e),e=>nS(e,oB(e=>Bs(t(e))),aP(DN,(e,t)=>nS(e,ze(t)))))),n=>new Uz(nS(Bs(e),$E($6),$H(e=>Bs(t(e)),r))))}),U9=(e,t,r)=>{switch(e){case void 0:return t();case"unbounded":return r(Number.MAX_SAFE_INTEGER);default:return e>1?r(e):t()}},Be=nm(4,(e,t,r,n)=>new Uz(nS(Bs(e),$E($6),$H(e=>Bs(n(e)),{concurrency:t,mergeStrategy:(e=>{let t=Object.create($p);return t._tag=$h,t})(),bufferSize:r})))),Bt=nm(e=>UL(e[0]),(e,t)=>U7(e,ng,t)),Br=e=>{let t=DF({onInput:e=>((e,t)=>{let[r,n]=nS(e,oH(e=>!dX(e))),i=nS(oz(n),sw({onNone:()=>t,onSome:me({onFailure:e=>sw(mE(e),{onNone:()=>DN,onSome:Dv}),onSuccess:()=>DN})}));return nS(DM(nS(r,oA(e=>dX(e)?i4(e.value):s_()))),D_(()=>i))})(e,t),onFailure:e=>Dv(e),onDone:()=>DN});return new Uz(nS(Bs(e),DO(t)))},Bn=e=>(e=>{let t=DF({onInput:e=>D_($6(e),()=>t),onFailure:Dv,onDone:()=>DN});return new Uz(nS(Bs(e),DO(t)))})(Br(nS(e,Bm(e=>e.exit)))),Bi=e=>new Uz(e),Bs=e=>{if("channel"in e)return e.channel;if(fH(e))return Bs(Bo(e));throw TypeError("Expected a Stream.")},Ba=e=>new Uz(oD(e)?DN:DM(e)),Bo=e=>nS(e,pS(i4),Bl),Bl=e=>new Uz($3(xD(e,{onFailure:sw({onNone:()=>DN,onSome:Dx}),onSuccess:e=>DM(ob(e))}))),Bu=(e,t)=>{let r=t?.maxChunkSize??UU;if(t?.scoped){let n=px(e.subscribe,e=>Bp(e,{maxChunkSize:r,shutdown:!0}));return t.shutdown?px(n,U2(e.shutdown)):n}let n=U7(BH(e.subscribe),e=>Bp(e,{maxChunkSize:r}));return t?.shutdown?U2(n,e.shutdown):n},Bc=e=>BV(()=>op(e)?Ba(e):Bh(e[Symbol.iterator]())),Bh=(e,t=UU)=>nS(pI(()=>{let r=[],n=e=>nS(pI(()=>{let i=e.next();if(1===t)return i.done?DN:nS(DM(ob(i.value)),D_(()=>n(e)));r=[];let s=0;for(;!1===i.done&&(r.push(i.value),!((s+=1)>=t));)i=e.next();return s>0?nS(DM(ow(r)),D_(()=>n(e))):DN}),$3);return new Uz(n(e))}),B5),Bf=e=>nS(e,px(BM),B4),Bp=(e,t)=>nS(j4(e,1,t?.maxChunkSize??UU),f0(t=>nS(e.isShutdown,ps(e=>e&&l9(t)?f9(s_()):pS(pt(t),i4)))),BM,t?.shutdown?U2(Ph(e)):ng),Bd=((e,t)=>{let r=e=>nS(e.poll,px(sw({onNone:()=>DC({onInput:t=>D_(DM(t),()=>r(e)),onFailure:Dx,onDone:()=>DN}),onSome:me({onFailure:Dv,onSuccess:()=>DN})})),$3);return new Uz($4(n=>t.pipe(kp(n),px(t=>Bs(e).pipe(DO(r(t)))))))},nm(2,(e,t)=>new Uz(nS(Bs(e),$j(t))))),Bm=((e,t)=>new Uz(nS(Bs(e),$P(t))),nm(2,(e,t)=>new Uz(nS(Bs(e),$U(oB(t)))))),Bg=((e,t,r)=>{let n=e=>DC({onInput:t=>{let[i,s]=oq(t,e,r);return D_(DM(s),()=>n(i))},onFailure:Dx,onDone:()=>DN});return new Uz(nS(Bs(e),DO(n(t))))},nm(3,(e,t,r)=>BV(()=>{let n=e=>DC({onInput:t=>nS(pR(()=>{let i=[];return nS(t,xY(e,(e,t)=>nS(r(e,t),ps(([e,t])=>nS(pI(()=>{i.push(t)}),fK(e))))),xD({onFailure:e=>0!==i.length?ze(DM(ow(i)),Dx(e)):Dx(e),onSuccess:e=>D_(DM(ow(i)),()=>n(e))}))}),$3),onFailure:Dx,onDone:()=>DN});return new Uz(nS(Bs(e),$K(n(t))))}))),Bb=nm(2,(e,t)=>new Uz(nS(Bs(e),$U(t)))),By=((e,t)=>nS(e,Bb(oM(t))),nm(2,(e,t)=>{let r=e=>{let n=e.next();return n.done?DF({onInput:e=>r(e[Symbol.iterator]()),onFailure:Dv,onDone:DR}):$3(px(t(n.value),t=>D_(DM(ob(t)),()=>r(e))))};return new Uz(nS(Bs(e),DO(DT(()=>r(om()[Symbol.iterator]())))))})),Bx=nm(3,(e,t,r)=>new Uz(nS(Bs(e),$E($6),$q(r,t),$U(ob)))),Bv=nm(2,(e,t)=>new Uz(nS(Bs(e),$z(t)))),BS=((e=>UL(e[1]),(e,t,r)=>Bw(e,t,{onSelf:ng,onOther:ng,haltStrategy:r?.haltStrategy})),nm(e=>Symbol.iterator in e[0],(e,t)=>Bt(Bc(e),t))),B_=nm(2,(e,t)=>Bw(e,t,{onSelf:sn,onOther:si})),Bw=nm(3,(e,t,r)=>{let n=r.haltStrategy?(e=>{switch(e){case"left":return zs;case"right":return za;case"both":return zo;case"either":return zl;default:return e}})(r.haltStrategy):zo,i=e=>t=>e||!dX(t)?$e(pR(()=>t)):$t(e=>pR(()=>e));return new Uz($V(Bs(Bm(e,r.onSelf)),{other:Bs(Bm(t,r.onOther)),onSelfDone:i("Either"===n._tag||"Left"===n._tag),onOtherDone:i("Either"===n._tag||"Right"===n._tag)}))}),Bk=((e,t)=>new Uz(nS(Bs(e),$W(()=>Bs(t())))),nm(2,(e,t)=>{let r=DC({onInput:e=>oD(e)?DT(()=>r):nS(DM(e),ze($M())),onFailure:Dx,onDone:()=>DT(()=>Bs(t()))});return new Uz(nS(Bs(e),DO(r)))})),BO=((e=>"function"==typeof e[1],(e,t,r)=>nS(By(e,t),UZ({size:2,maximumLag:r?.bufferSize??16,decide:su({onLeft:()=>pF(e=>0===e),onRight:()=>pF(e=>1===e)})}),ps(([e,t])=>pF([U8(Br(Bp(e,{shutdown:!0})),e=>su(e,{onLeft:i4,onRight:s_})),U8(Br(Bp(t,{shutdown:!0})),e=>su(e,{onLeft:s_,onRight:i4}))])))),nm(2,(e,t)=>new Uz(DO(Bs(e),t)))),BE=nm(2,(e,t)=>new Uz(nS(Bs(e),DE(t)))),BC=((e,t)=>BI(e,uV(t)),nm(2,(e,t)=>new Uz($4(r=>k5(t,r).pipe(px(t=>nS(Bs(e),DE(t)))))))),BF=nm(3,(e,t,r)=>BR(e,t,Bo(r))),BR=nm(3,(e,t,r)=>U5(n=>U7(r,r=>nS(e,BE(uU(n,t,r)))))),BI=nm(2,(e,t)=>U5(r=>nS(e,BE(t(r))))),BT=((e,t)=>nS(e,BC(nS(k7(),Oo(t)))),nm(2,(e,t)=>BV(()=>{let r=Math.max(t,1),n=BA(new BN(r),r);return new Uz(nS(Bs(e),DO(n)))}))),BA=(e,t)=>DF({onInput:r=>{if(r.length===t&&e.isEmpty())return D_(DM(r),()=>BA(e,t));if(r.length>0){let n,i=[],s=0;for(;s<r.length;){for(;s<r.length&&void 0===n;)n=e.write(nS(r,oO(s))),s+=1;void 0!==n&&(i.push(n),n=void 0)}return D_(((...e)=>$6(oy(e)))(...i),()=>BA(e,t))}return DT(()=>BA(e,t))},onFailure:t=>ze(e.emitIfNotEmpty(),Dv(t)),onDone:()=>e.emitIfNotEmpty()});class BN{n;builder=[];pos=0;constructor(e){this.n=e}isEmpty(){return 0===this.pos}write(e){if(this.builder.push(e),this.pos+=1,this.pos===this.n){let e=ow(this.builder);return this.builder=[],this.pos=0,e}}emitIfNotEmpty(){return 0!==this.pos?DM(ow(this.builder)):DN}}(e,t,r)=>new Uz($O(Bs(e),e=>sw(t(e),{onNone:()=>Dv(l3(r(e))),onSome:Dx})));let BM=e=>B3(e,e=>nS(px(e,t=>i4([t,e])),f1(sw({onNone:()=>pF(s_()),onSome:f9})))),Bj=e=>BM(nS(e,px(ob))),BP=((e,t)=>BP(e,t,{onElement:e=>si(e),onSchedule:sn}),nm(3,(e,t,r)=>nS(Ew(t),px(t=>{let n=nS(e,BF(Ef,t.iterationMeta.get),Bm(r.onElement),Bs),i=$3(xD(t.next(void 0),{onFailure:()=>DN,onSuccess:e=>D_(n,()=>ze(DM(ob(r.onSchedule(e))),i))}));return new Uz(ze(n,i))}),B5))),BD=((e,t)=>Ew(t).pipe(px(t=>{let r=Bs(BF(Ef,t.iterationMeta.get)(e)).pipe($B(e=>fK(t.reset,e)),$O(e=>t.next(e).pipe(xD({onFailure:()=>Dx(e),onSuccess:()=>r}),$3)));return r}),$3,Bi),nm(2,(e,t)=>Bs(e).pipe($K(zM(t)),$Z))),B$=((e,t,r,n)=>BD(e,zy(t,r,n)),nm(2,(e,t)=>BD(e,zC(t)))),Bz=nm(2,(e,t)=>BD(e,zF(t))),BL=nm(2,(e,t)=>nS(e,BJ(zC(t)))),BU=nm(2,(e,t)=>nS(e,Bq(t))),BB=((e,t)=>nS(e,Bq(t),C_),nm(2,(e,t)=>{let r=DF({onInput:e=>D_(Dk(j2(t,oB(e,mr))),()=>r),onFailure:e=>Dk(j1(t,d4(ul(e,i4)))),onDone:()=>Dk(j1(t,d5(s_())))});return nS(DO(Bs(e),r),$F,$Q,fG)})),Bq=nm(2,(e,t)=>{let r=DF({onInput:e=>D_(DM(Uh(e)),()=>r),onFailure:e=>DM(Ud(e)),onDone:()=>DM(Up)});return nS(DO(Bs(e),r),$B(e=>j1(t,e)),$F,$Q,fG)}),BJ=nm(2,(e,t)=>nS(Bs(e),$K(zM(t)),$F,$Q)),BH=((e,t)=>nS(e,Bg(s_(),(e,r)=>{switch(e._tag){case"None":return pF([i4(r),r]);case"Some":return nS(t(e.value,r),px(e=>[i4(e),e]))}})),e=>new Uz($R($Y(nS(e,px(ob))),pj))),BV=((e,t,r)=>t<=0||r<=0?Bo(f4(new dJ("Invalid bounds - `chunkSize` and `stepSize` must be greater than zero"))):new Uz(DT(()=>{let n=new L5(t),i=(e,i)=>{if(e<t){let e=n.toChunk();return nS(DM(oD(e)?om():ob(e)),D_(()=>i))}let s=e-(e-t)%r;if(s===e)return i;let a=nS(n.toChunk(),oW(e-(s-t+r)));return nS(DM(oD(a)?om():ob(a)),D_(()=>i))},s=e=>DF({onInput:i=>D_(DM(oA(i,(i,s)=>{n.put(i);let a=e+s+1;return a<t||(a-t)%r>0?s_():i4(n.toChunk())})),()=>s(e+i.length)),onFailure:t=>i(e,Dv(t)),onDone:()=>i(e,DN)});return nS(Bs(e),DO(s(0)))})),e=>new Uz(DT(()=>Bs(e())))),BW=nm(2,(e,t)=>{let r=DC({onInput:e=>{let n=nS(e,oK(t));return n.length===e.length?nS(DM(n),D_(()=>r)):DM(n)},onFailure:Dx,onDone:DR});return new Uz(nS(Bs(e),$K(r)))}),BK=((e,t)=>By(e,e=>fK(t(e),e)),(e,t,r,n,i)=>{let s=(e,a)=>DF({onInput:o=>nS(t(o),wF(gK),px(([t,l])=>{let u=e+(l-a)/ch(n)*r,c=r+i<0?1/0:r+i,h=u<0?c:Math.min(u,c);return t<=h?nS(DM(o),D_(()=>s(h-t,l))):s(e,a)}),$3),onFailure:Dv,onDone:()=>DN}),a=nS(gK,px(e=>s(r,e)),$3);return new Uz(nS(Bs(e),$K(a)))}),BG=(e,t,r,n,i)=>{let s=(e,a)=>DF({onInput:o=>nS(t(o),wF(gK),px(([t,l])=>{let u=e+(l-a)/ch(n)*r,c=r+i<0?1/0:r+i,h=(u<0?c:Math.min(u,c))-t,f=cs(Math.max(0,(h>=0?0:-h/r)*ch(n)));return cx(f,ct)?nS(Dk(xx(f)),ze(DM(o)),D_(()=>s(h,l))):D_(DM(o),()=>s(h,l))}),$3),onFailure:Dv,onDone:()=>DN}),a=nS(gK,px(e=>s(r,e)),$3);return new Uz(nS(Bs(e),$K(a)))},BZ=nm(3,(e,t,r)=>nS(BX(e),px(kb({onTimeout:()=>ul(t(),i4),duration:r})),Bf)),BQ=((e,t,r)=>{let n=new dz("Stream Timeout");return nS(e,BZ(()=>l3(n),t),UV(e=>"Die"===e._tag&&nL(e.defect,d$)&&void 0!==e.defect.message&&"Stream Timeout"===e.defect.message?i4(r):s_()))},e=>{if("number"==typeof e)return PH(e);if("unbounded"===e.capacity){let t;return t={replay:e.replay},pR(()=>PC((e=>new P_(e?.replay?new PB(e.replay):void 0))(t),new P$))}switch(e.strategy){case"dropping":return pR(()=>PC(Pm(e),new P$));case"sliding":return pR(()=>PC(Pm(e),new Pz));default:return PH(e)}}),BY=nm(2,(e,t)=>nS(wc(BQ(t),e=>e.shutdown),pT(t=>nS(e,BU(t),kd)))),BX=e=>{let t;return px((t=Bs(e),ps(wN,e=>$0(t,e))),e=>nS(e,pS(i4),ps(su({onLeft:()=>f9(s_()),onRight:pF}))))},B0=nm(e=>UL(e[0]),(e,t)=>pT(wc(t?.strategy==="unbounded"?Pc():t?.strategy==="dropping"?Pl(t.capacity??2):t?.strategy==="sliding"?Pu(t.capacity??2):Po(t?.capacity??2),e=>Ph(e)),t=>kd(Bq(e,t)))),B1=((e=>UL(e[0]),(e,t)=>pT(wc(Po(t?.capacity??2),e=>Ph(e)),t=>kd(BB(e,t)))),nm(e=>UL(e[0]),(e,t)=>px(kq(),r=>B2(e,r,t)))),B2=nm(e=>UL(e[0]),(e,t,r)=>{let n,i,s=kR(t),a=new ku(!1??!1);return new ReadableStream({start(t){(i=s(Bz(e,e=>0===e.length?pj:a.whenOpen(pI(()=>{for(let r of(a.unsafeClose(),e))t.enqueue(r);n(),n=void 0}))))).addObserver(e=>{try{"Failure"===e._tag?t.error(mC(e.cause)):t.close()}catch{}})},pull:()=>new Promise(e=>{n=e,kK(a.open)}),cancel(){if(i)return kV(fG(pW(i)))}},r?.strategy)}),B3=(e,t)=>BV(()=>{let r=e=>$3(px(t(e),sw({onNone:()=>DN,onSome:([e,t])=>D_(DM(e),()=>r(t))})));return new Uz(r(e))}),B5=e=>Bt(Bo(e)),B4=e=>Bt(BH(e)),B6=e=>{let t;return Bt((t=t=>e(t),new Uz($X(e=>t(e).pipe(px(ob))))))},B8=((e,t)=>nS(Bo(t),U7(t=>t?e:U1)),nm(3,(e,t,r)=>{let n=(e,t,r)=>{switch(e._tag){case UT:return nS(UW(t),wF(UW(r),{concurrent:!0}),ph({onFailure:e=>pF(d5(i4(e))),onSuccess:([e,s])=>i3(e)&&i3(s)?oD(e.value)&&oD(s.value)?n(UM,t,r):oD(e.value)?n(Uj(s.value),t,r):oD(s.value)?n(UP(e.value),t,r):pF(mr(i(e.value,s.value))):pF(d5(s_()))}));case UA:return ph(t,{onFailure:e=>pF(d5(e)),onSuccess:s=>oD(s)?n(Uj(e.rightChunk),t,r):oD(e.rightChunk)?n(UP(s),t,r):pF(mr(i(s,e.rightChunk)))});case UN:return ph(r,{onFailure:e=>pF(d5(e)),onSuccess:s=>oD(s)?n(UP(e.leftChunk),t,r):oD(e.leftChunk)?n(Uj(s),t,r):pF(mr(i(e.leftChunk,s)))})}},i=(e,t)=>{let[n,i]=r(e,t);switch(i._tag){case"Left":if(oD(i.left))return[n,UM];return[n,UP(i.left)];case"Right":if(oD(i.right))return[n,UM];return[n,Uj(i.right)]}};return nS(e,UK(t,UM,n))})),B7=(e,t,r)=>e.length>t.length?[nS(e,oF(t.length),oG(t,r)),sn(nS(e,oR(t.length)))]:[nS(e,oG(nS(t,oF(e.length)),r)),si(nS(t,oR(e.length)))],B9=nm(e=>UL(e[0]),(e,t="utf-8")=>BV(()=>{let r=new TextDecoder(t);return Bm(e,e=>r.decode(e))})),qe=Symbol.for("effect/GroupBy"),qt={_R:e=>e,_E:e=>e,_K:e=>e,_V:e=>e},qr=nm(e=>nL(e[0],qe),(e,t,r)=>U7(e.grouped,([e,r])=>t(e,Bn(Bp(r,{shutdown:!0}))),{concurrency:"unbounded",bufferSize:r?.bufferSize??16})),qn=nm(e=>"function"!=typeof e[0],(e,t,r)=>r?.key?qr(qs(e,r.key,{bufferSize:r.bufferSize}),(e,r)=>By(r,t)):U9(r?.concurrency,()=>By(e,t),n=>r?.unordered?U7(e,e=>Bo(t(e)),{concurrency:n}):Bx(e,n,t)));class qi extends bc{dequeue;f;[jq]={_Out:e=>e};constructor(e,t){super(),this.dequeue=e,this.f=t}capacity(){return this.dequeue.capacity()}get size(){return this.dequeue.size}unsafeSize(){return this.dequeue.unsafeSize()}get awaitShutdown(){return this.dequeue.awaitShutdown}isActive(){return this.dequeue.isActive()}get isShutdown(){return this.dequeue.isShutdown}get shutdown(){return Ph(this.dequeue)}get isFull(){return this.dequeue.isFull}get isEmpty(){return this.dequeue.isEmpty}get take(){return nS(j3(this.dequeue),px(e=>this.f(e)))}get takeAll(){return nS(this.dequeue.takeAll,px(oB(e=>this.f(e))))}takeUpTo(e){return nS(j5(this.dequeue,e),px(oB(e=>this.f(e))))}takeBetween(e,t){return nS(j4(this.dequeue,e,t),px(oB(e=>this.f(e))))}takeN(e){return nS(j6(this.dequeue,e),px(oB(e=>this.f(e))))}poll(){return nS(px(this.dequeue.takeUpTo(1),oz),px(sA(e=>this.f(e))))}pipe(){return iw(this,arguments)}commit(){return this.take}}let qs=nm(e=>"function"!=typeof e[0],(e,t,r)=>{let n=(e,i)=>DF({onInput:s=>D_(Dk(wp(qa(s,t),([t,n])=>{let s=e.get(t);return void 0===s?nS(Po(r?.bufferSize??16),ps(r=>nS(pI(()=>{e.set(t,r)}),wI(j1(i,Ug([t,r]))),wI(nS(j1(r,Uh(n)),xI(e=>ue(e)?i4(pj):s_())))))):xI(j1(s,Uh(n)),e=>ue(e)?i4(pj):s_())},{discard:!0})),()=>n(e,i)),onFailure:e=>Dk(j1(i,Ud(e))),onDone:()=>Dk(nS(wp(e.entries(),([e,t])=>nS(j1(t,Up),xI(e=>ue(e)?i4(pj):s_())),{discard:!0}),wI(j1(i,Up))))});return{[qe]:qt,pipe(){return iw(this,arguments)},grouped:B6(t=>Cx(function*(){let r=new Map,i=yield*Pc();return yield*dT(t,Ph(i)),yield*Bs(e).pipe(DO(n(r,i)),$F,D6(t),kp(t),fK(Bn(Bp(i,{shutdown:!0}))))}))}}),qa=nm(2,(e,t)=>{let r,n=[],i=e[Symbol.iterator](),s=new Map;for(;(r=i.next())&&!r.done;){let e=r.value,i=t(e);if(s.has(i))s.get(i).push(e);else{let t=[e];n.push([i,t]),s.set(i,t)}}return ow(n.map(e=>[e[0],ow(e[1])]))}),qo=(...e)=>{let t=1===e.length?e[0].evaluate:e[0],r=1===e.length?e[0].onError:e[1],n=1===e.length&&!0===e[0].releaseLockOnEnd;return B4(px(wc(pI(()=>t().getReader()),e=>n?pI(()=>e.releaseLock()):Cv(()=>e.cancel())),e=>Bj(ps(x4({try:()=>e.read(),catch:e=>i4(r(e))}),({done:e,value:t})=>e?f9(s_()):pF(t)))))},ql=e=>BD(e,zg),qu=Symbol.for("@effect/platform/Error"),qc=(e,t)=>{class r extends bs{_tag=t}return r.prototype[e]=e,r.prototype.name=t,r},qh=NC("Clipboard","Command","FileSystem","KeyValueStore","Path","Stream","Terminal");class qf extends jp("@effect/platform/Error/BadArgument")("BadArgument",{module:qh,method:N$,description:Mn(N$),cause:Mn(jO)}){[qu]=qu;get message(){return`${this.module}.${this.method}${this.description?`: ${this.description}`:""}`}}let qp=NC("AlreadyExists","BadResource","Busy","InvalidData","NotFound","PermissionDenied","TimedOut","UnexpectedEof","Unknown","WouldBlock","WriteZero");class qd extends jp("@effect/platform/Error/SystemError")("SystemError",{reason:qp,module:qh,method:N$,description:Mn(N$),syscall:Mn(N$),pathOrDescriptor:Mn(NU(N$,Nz)),cause:Mn(jO)}){[qu]=qu;get message(){return`${this.reason}: ${this.module}.${this.method}${void 0!==this.pathOrDescriptor?` (${this.pathOrDescriptor})`:""}${this.description?`: ${this.description}`:""}`}}let qm=uW("@effect/platform/FileSystem"),qg=e=>"bigint"==typeof e?e:BigInt(e),qb=e=>{let t=qy(e),r=[];for(let e=0;e<t.length;e++)if(Array.isArray(t[e][0])){let[n,i]=t[e];r.push([`${n[0]}[${n.slice(1).join("][")}]`,i])}else r.push(t[e]);return r},qy=e=>{let t=Symbol.iterator in e?s1(e):Object.entries(e),r=[];for(let[e,n]of t)if(Array.isArray(n))for(let t=0;t<n.length;t++)void 0!==n[t]&&r.push([e,String(n[t])]);else if("object"==typeof n)for(let[t,i]of qy(n))r.push([[e,..."string"==typeof t?[t]:t],i]);else void 0!==n&&r.push([e,String(n)]);return r},qx=((e,t,r)=>s6(aj(e,([e])=>e!==t),[t,String(r)]),nm(2,(e,t)=>{let r=qb(t),n=r.map(([e])=>e);return s8(aj(e,([e])=>n.includes(e)),r)})),qv=nm(3,(e,t,r)=>s6(e,[t,String(r)])),qS=((e,t)=>s8(e,qb(t)),Symbol.for("@effect/platform/HttpBody")),q_=Symbol.for("@effect/platform/HttpBody/HttpBodyError");class qw{[qS];constructor(){this[qS]=qS}[ih](){return this.toJSON()}toString(){return id(this)}}let qk=new class extends qw{_tag="Empty";toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"Empty"}}};class qO extends qw{body;contentType;_tag="Uint8Array";constructor(e,t){super(),this.body=e,this.contentType=t}get contentLength(){return this.body.length}toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"Uint8Array",body:this.contentType.startsWith("text/")||this.contentType.endsWith("json")?new TextDecoder().decode(this.body):`Uint8Array(${this.body.length})`,contentType:this.contentType,contentLength:this.contentLength}}}let qE=new TextEncoder,qC=(e,t)=>{let r;return r=qE.encode(e),new qO(r,t??"text/plain"??"application/octet-stream")},qF=e=>xR({try:()=>qC(JSON.stringify(e),"application/json"),catch:e=>(e=>{let t=void 0===e?Object.create(iH):hh(e);return t._tag="HttpBodyError",t})({[q_]:q_,reason:{_tag:"JsonError",error:e}})});class qR extends qw{stream;contentType;contentLength;_tag="Stream";constructor(e,t,r){super(),this.stream=e,this.contentType=t,this.contentLength=r}toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"Stream",contentType:this.contentType,contentLength:this.contentLength}}}let qI=(e,t,r)=>new qR(e,t??"application/octet-stream",r),qT=Symbol.for("@effect/platform/Cookies"),qA=e=>nL(e,qT),qN=Symbol.for("@effect/platform/Cookies/Cookie"),qM=Symbol.for("@effect/platform/Cookies/CookieError");class qj extends qc(qM,"CookieError"){get message(){return this.reason}}let qP={[qT]:qT,...im,toJSON(){return{_id:"@effect/platform/Cookies",cookies:sG(this.cookies,e=>e.toJSON())}},pipe(){return iw(this,arguments)}},qD=e=>{let t=Object.create(qP);return t.cookies=e,t},q$=e=>{let t={};for(let r of e)t[r.name]=r;return qD(t)},qz=q$([]),qL=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,qU={[qN]:qN,...im,toJSON(){return{_id:"@effect/platform/Cookies/Cookie",name:this.name,value:this.value,options:this.options}}};function qB(e,t,r){if(!qL.test(e))return sn(new qj({reason:"InvalidName"}));let n=encodeURIComponent(t);if(n&&!qL.test(n))return sn(new qj({reason:"InvalidValue"}));if(void 0!==r){if(void 0!==r.domain&&!qL.test(r.domain))return sn(new qj({reason:"InvalidDomain"}));if(void 0!==r.path&&!qL.test(r.path))return sn(new qj({reason:"InvalidPath"}));if(void 0!==r.maxAge&&"Infinity"===u4(r.maxAge).value._tag)return sn(new qj({reason:"InfinityMaxAge"}))}return si(Object.assign(Object.create(qU),{name:e,value:t,valueEncoded:n,options:r}))}(e,t)=>qD({...e.cookies,...t.cookies}),(e,t,r,n)=>qD(sQ(e.cookies,t,sh(qB(t,r,n),ng)));let qq=nm(2,(e,t)=>{let r={...e.cookies};for(let[e,n,i]of t){let t=qB(e,n,i);if(st(t))return t;r[e]=t.right}return si(qD(r))});function qJ(e){let t=e.name+"="+e.valueEncoded;if(void 0===e.options)return t;let r=e.options;if(void 0!==r.maxAge&&(t+="; Max-Age="+Math.trunc(cp(r.maxAge,{onMillis:e=>e/1e3,onNanos:e=>Number(e)/1e9}))),void 0!==r.domain&&(t+="; Domain="+r.domain),void 0!==r.path&&(t+="; Path="+r.path),void 0!==r.priority)switch(r.priority){case"low":t+="; Priority=Low";break;case"medium":t+="; Priority=Medium";break;case"high":t+="; Priority=High"}if(void 0!==r.expires&&(t+="; Expires="+r.expires.toUTCString()),r.httpOnly&&(t+="; HttpOnly"),r.secure&&(t+="; Secure"),r.partitioned&&(t+="; Partitioned"),void 0!==r.sameSite)switch(r.sameSite){case"lax":t+="; SameSite=Lax";break;case"strict":t+="; SameSite=Strict";break;case"none":t+="; SameSite=None"}return t}(e,t)=>sh(qq(e,t),ng);let qH=e=>{try{return decodeURIComponent(e)}catch{return e}},qV=Symbol.for("@effect/platform/Headers"),qW=Object.assign(Object.create(null),{[qV]:qV,[ix](e){return q1(this,bO(e,q2))}}),qK=e=>Object.assign(Object.create(qW),e),qG=Object.create(qW),qZ=e=>{if(void 0===e)return qG;if(Symbol.iterator in e){let t=Object.create(qW);for(let[r,n]of e)t[r.toLowerCase()]=n;return t}let t=Object.create(qW);for(let[r,n]of Object.entries(e))Array.isArray(n)?t[r.toLowerCase()]=n.join(", "):void 0!==n&&(t[r.toLowerCase()]=n);return t},qQ=nm(3,(e,t,r)=>{let n=qK(e);return n[t.toLowerCase()]=r,n}),qY=nm(2,(e,t)=>qK({...e,...qZ(t)})),qX=nm(2,(e,t)=>{let r=qK(e);return Object.assign(r,t),r}),q0=nm(2,(e,t)=>{let r=qK(e),n=t=>{if("string"==typeof t){let n=t.toLowerCase();n in e&&delete r[n]}else for(let n in e)t.test(n)&&delete r[n]};if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else n(t);return r}),q1=nm(2,(e,t)=>{let r={...e},n=t=>{if("string"==typeof t){let n=t.toLowerCase();n in e&&(r[n]=Nf(e[n]))}else for(let n in e)t.test(n)&&(r[n]=Nf(e[n]))};if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else n(t);return r}),q2=nF("@effect/platform/Headers/currentRedactedNames",()=>dl(["authorization","cookie","set-cookie","x-api-key"])),q3=Symbol.for("@effect/platform/HttpServerResponse"),q5=Symbol.for("@effect/platform/HttpServerRespondable");class q4 extends bh{status;statusText;cookies;body;[q3];headers;constructor(e,t,r,n,i){if(super(),this.status=e,this.statusText=t,this.cookies=n,this.body=i,this[q3]=q3,i.contentType||i.contentLength){let e={...r};i.contentType&&(e["content-type"]=i.contentType),i.contentLength&&(e["content-length"]=i.contentLength.toString()),this.headers=e}else this.headers=r}commit(){return pF(this)}[q5](){return pF(this)}[ih](){return this.toJSON()}toString(){return id(this)}toJSON(){return{_id:"@effect/platform/HttpServerResponse",status:this.status,statusText:this.statusText,headers:i_(this.headers),cookies:this.cookies.toJSON(),body:this.body.toJSON()}}}let q6=e=>"object"==typeof e&&null!==e&&q3 in e,q8=e=>new q4(e?.status??204,e?.statusText,e?.headers?qZ(e.headers):qG,e?.cookies??qz,qk),q7=nm(3,(e,t,r)=>new q4(e.status,e.statusText,qQ(e.headers,t,r),e.cookies,e.body)),q9=nm(2,(e,t)=>{let r=e.headers;return"Empty"===t._tag&&(r=q0(q0(r,"Content-Type"),"Content-length")),new q4(e.status,e.statusText,r,e.cookies,t)}),Je=(e,t)=>px(qF(e),e=>new q4(t?.status??200,t?.statusText,t?.headers?qZ(t.headers):qG,t?.cookies??qz,e)),Jt=Symbol.for("@effect/platform/HttpServerRespondable"),Jr=e=>nL(e,Jt),Jn=q8({status:400}),Ji=q8({status:404}),Js=e=>q6(e)?pF(e):pO(e[Jt]()),Ja=Symbol.for("@effect/platform/HttpServerError"),Jo=nF("@effect/platform/HttpServerError/clientAbortFiberId",()=>cV(-499,0)),Jl=q8({status:500}),Ju=q8({status:499}),Jc=q8({status:503}),Jh=Ja;class Jf extends qc(Jh,"RequestError"){[Jt](){return q8({status:400})}get methodAndUrl(){return`${this.request.method} ${this.request.url}`}get message(){return this.description?`${this.reason}: ${this.description} (${this.methodAndUrl})`:`${this.reason} error (${this.methodAndUrl})`}}class Jp extends qc(Jh,"RouteNotFound"){constructor(e){super(e),this.stack=`${this.name}: ${this.message}`}[Jt](){return q8({status:404})}get message(){return`${this.request.method} ${this.request.url} not found`}}let Jd=e=>{let[t,r]=ux(e,[pF(Jl),l1],(e,t)=>{switch(t._tag){case"Empty":return i4(e);case"Fail":return i4([((e,t)=>q6(e)?pF(e):Jr(e)?f0(e[Jt](),()=>pF(t)):nL(e,AR)?pF(Jn):nL(e,dH)?pF(Ji):pF(t))(t.error,Jl),t]);case"Die":return i4([((e,t)=>q6(e)?pF(e):Jr(e)?f0(e[Jt](),()=>pF(t)):pF(t))(t.defect,Jl),t]);case"Interrupt":if("Empty"!==e[1]._tag)return s_();return i4([pF(t.fiberId===Jo?Ju:Jc),t]);default:return s_()}});return px(t,e=>r._tag===lW?[e,l3(e)]:[e,l6(r,l3(e))])},Jm=Symbol.for("@effect/platform/HttpIncomingMessage"),Jg=(e,t)=>{let r=NO(e,t);return e=>ps(e.json,r)};class Jb extends uZ()("@effect/platform/HttpIncomingMessage/MaxBodySize",{defaultValue:s_}){}let Jy=(e,t)=>{let r,n=e.headers["content-type"]??"";if(n.includes("application/json"))try{r=kK(e.json)}catch{}else if(n.includes("text/")||n.includes("urlencoded"))try{r=kK(e.text)}catch{}let i={...t,headers:i_(e.headers),remoteAddress:e.remoteAddress.toJSON()};return void 0!==r&&(i.body=r),i},Jx=Symbol.for("effect/Mailbox"),Jv=Symbol.for("effect/Mailbox/ReadonlyMailbox"),JS=om(),J_=mr(JS),Jw=mr(!1),Jk=mr(!0),JO=[JS,!0];class JE extends bc{scheduler;capacity;strategy;[Jx]=Jx;[Jv]=Jv;state={_tag:"Open",takers:new Set,offers:new Set,awaiters:new Set};messages=[];messagesChunk=om();constructor(e,t,r){super(),this.scheduler=e,this.capacity=t,this.strategy=r}offer(e){return pR(()=>{if("Open"!==this.state._tag)return Jw;if(this.messages.length+this.messagesChunk.length>=this.capacity)switch(this.strategy){case"dropping":return Jw;case"suspend":if(this.capacity<=0&&this.state.takers.size>0)return this.messages.push(e),this.releaseTaker(),Jk;return this.offerRemainingSingle(e);case"sliding":return this.unsafeTake(),this.messages.push(e),Jk}return this.messages.push(e),this.scheduleReleaseTaker(),Jk})}unsafeOffer(e){return"Open"===this.state._tag&&(this.messages.length+this.messagesChunk.length>=this.capacity?"sliding"===this.strategy?(this.unsafeTake(),this.messages.push(e),!0):this.capacity<=0&&this.state.takers.size>0&&(this.messages.push(e),this.releaseTaker(),!0):(this.messages.push(e),this.scheduleReleaseTaker(),!0))}offerAll(e){return pR(()=>{if("Open"!==this.state._tag)return pF(oy(e));let t=this.unsafeOfferAllArray(e);return 0===t.length?J_:"dropping"===this.strategy?pF(ow(t)):this.offerRemainingArray(t)})}unsafeOfferAll(e){return ow(this.unsafeOfferAllArray(e))}unsafeOfferAllArray(e){if("Open"!==this.state._tag)return s1(e);if(this.capacity===1/0||"sliding"===this.strategy)return this.messages.length>0&&(this.messagesChunk=oT(this.messagesChunk,ow(this.messages))),"sliding"===this.strategy?this.messagesChunk=this.messagesChunk.pipe(oT(oy(e)),oW(this.capacity)):op(e)?this.messagesChunk=oT(this.messagesChunk,e):this.messages=s1(e),this.scheduleReleaseTaker(),[];let t=this.capacity<=0?this.state.takers.size:this.capacity-this.messages.length-this.messagesChunk.length;if(0===t)return s1(e);let r=[],n=0;for(let i of e)n<t?this.messages.push(i):r.push(i),n++;return this.scheduleReleaseTaker(),r}fail(e){return this.done(d5(e))}failCause(e){return this.done(d4(e))}unsafeDone(e){return"Open"===this.state._tag&&(0===this.state.offers.size&&0===this.messages.length&&0===this.messagesChunk.length?this.finalize(e):this.state={...this.state,_tag:"Closing",exit:e},!0)}shutdown=pI(()=>{if("Done"===this.state._tag)return!0;this.messages=[],this.messagesChunk=JS;let e=this.state.offers;if(this.finalize("Open"===this.state._tag?mn:this.state.exit),e.size>0){for(let t of e)"Single"===t._tag?t.resume(Jw):t.resume(mr(ow(t.remaining.slice(t.offset))));e.clear()}return!0});done(e){return pI(()=>this.unsafeDone(e))}end=this.done(mn);clear=pR(()=>{if("Done"===this.state._tag)return d0(this.state.exit,JS);let e=this.unsafeTakeAll();return this.releaseCapacity(),pF(e)});takeAll=pR(()=>{if("Done"===this.state._tag)return d0(this.state.exit,JO);let e=this.unsafeTakeAll();return 0===e.length?pJ(this.awaitTake,this.takeAll):pF([e,this.releaseCapacity()])});takeN(e){return pR(()=>{let t;if("Done"===this.state._tag)return d0(this.state.exit,JO);if(e<=0)return pF([JS,!1]);if((e=Math.min(e,this.capacity))<=this.messagesChunk.length)t=oF(this.messagesChunk,e),this.messagesChunk=oR(this.messagesChunk,e);else{if(!(e<=this.messages.length+this.messagesChunk.length))return pJ(this.awaitTake,this.takeN(e));this.messagesChunk=oT(this.messagesChunk,ow(this.messages)),this.messages=[],t=oF(this.messagesChunk,e),this.messagesChunk=oR(this.messagesChunk,e)}return pF([t,this.releaseCapacity()])})}unsafeTake(){let e;if("Done"===this.state._tag)return ms(this.state.exit,d5(new dV));if(this.messagesChunk.length>0)e=oL(this.messagesChunk),this.messagesChunk=oR(this.messagesChunk,1);else if(this.messages.length>0)e=this.messages[0],this.messagesChunk=oR(ow(this.messages),1),this.messages=[];else if(this.capacity<=0&&this.state.offers.size>0)return this.capacity=1,this.releaseCapacity(),this.capacity=0,this.messages.length>0?mr(this.messages.pop()):void 0;else return;return this.releaseCapacity(),mr(e)}take=pR(()=>this.unsafeTake()??pJ(this.awaitTake,this.take));await=fY(e=>"Done"===this.state._tag?e(this.state.exit):(this.state.awaiters.add(e),pI(()=>{"Done"!==this.state._tag&&this.state.awaiters.delete(e)})));unsafeSize(){let e=this.messages.length+this.messagesChunk.length;return"Done"===this.state._tag?s_():i4(e)}size=pI(()=>this.unsafeSize());commit(){return this.takeAll}pipe(){return iw(this,arguments)}toJSON(){return{_id:"effect/Mailbox",state:this.state._tag,size:this.unsafeSize().toJSON()}}toString(){return id(this)}[ih](){return id(this)}offerRemainingSingle(e){return fY(t=>{if("Open"!==this.state._tag)return t(Jw);let r={_tag:"Single",message:e,resume:t};return this.state.offers.add(r),pI(()=>{"Open"===this.state._tag&&this.state.offers.delete(r)})})}offerRemainingArray(e){return fY(t=>{if("Open"!==this.state._tag)return t(mr(ow(e)));let r={_tag:"Array",remaining:e,offset:0,resume:t};return this.state.offers.add(r),pI(()=>{"Open"===this.state._tag&&this.state.offers.delete(r)})})}releaseCapacity(){if("Done"===this.state._tag)return"Success"===this.state.exit._tag;if(0===this.state.offers.size)return"Closing"===this.state._tag&&0===this.messages.length&&0===this.messagesChunk.length&&(this.finalize(this.state.exit),"Success"===this.state.exit._tag);let e=this.capacity-this.messages.length-this.messagesChunk.length;for(let t of this.state.offers)if(0===e)break;else if("Single"===t._tag)this.messages.push(t.message),e--,t.resume(Jk),this.state.offers.delete(t);else{for(;t.offset<t.remaining.length;t.offset++){if(0===e)return!1;this.messages.push(t.remaining[t.offset]),e--}t.resume(J_),this.state.offers.delete(t)}return!1}awaitTake=fY(e=>"Done"===this.state._tag?e(this.state.exit):(this.state.takers.add(e),pI(()=>{"Done"!==this.state._tag&&this.state.takers.delete(e)})));scheduleRunning=!1;scheduleReleaseTaker(){this.scheduleRunning||(this.scheduleRunning=!0,this.scheduler.scheduleTask(this.releaseTaker,0))}releaseTaker=()=>{if(this.scheduleRunning=!1,"Done"===this.state._tag||0===this.state.takers.size)return;let e=(e=>{let t=e[Symbol.iterator]().next();if(t.done)throw Error("unsafeHead: empty iterable");return t.value})(this.state.takers);this.state.takers.delete(e),e(mn)};unsafeTakeAll(){if(this.messagesChunk.length>0){let e=this.messages.length>0?oT(this.messagesChunk,ow(this.messages)):this.messagesChunk;return this.messagesChunk=JS,this.messages=[],e}if(this.messages.length>0){let e=ow(this.messages);return this.messages=[],e}return"Done"!==this.state._tag&&this.state.offers.size>0?(this.capacity=1,this.releaseCapacity(),this.capacity=0,ob(this.messages.pop())):JS}finalize(e){if("Done"===this.state._tag)return;let t=this.state;for(let r of(this.state={_tag:"Done",exit:e},t.takers))r(e);for(let r of(t.takers.clear(),t.awaiters))r(e);t.awaiters.clear()}}(e,t)=>pM(r=>pc(r(e),{onFailure:e=>t.failCause(e),onSuccess:e=>t.end}));let JC=/; *([!#$%&'*+.^\w`|~-]+)=("(?:[\v\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\v\u0020-\u00ff])*"|[!#$%&'*+.^\w`|~-]+) */gu,JF=/\\([\v\u0020-\u00ff])/gu,JR=/^[!#$%&'*+.^\w|~-]+\/[!#$%&'*+.^\w|~-]+$/u,JI=/^[!#$%&'*+.^\w|~-]+$/u,JT={value:"",parameters:Object.create(null)};function JA(e,t=!1){let r,n,i;if("string"!=typeof e)return JT;let s=e.indexOf(";"),a=-1!==s?e.slice(0,s).trim():e.trim();if(!1===(t?JI:JR).test(a))return JT;let o={value:a.toLowerCase(),parameters:Object.create(null)};if(-1===s)return o;for(JC.lastIndex=s;n=JC.exec(e);){if(n.index!==s)return JT;s+=n[0].length,r=n[1].toLowerCase(),'"'===(i=n[2])[0]&&(i=i.slice(1,i.length-1),!t&&JF.test(i)&&(i=i.replace(JF,"$1"))),o.parameters[r]=i}return s!==e.length?JT:o}!function(e){e[e.key=0]="key",e[e.whitespace=1]="whitespace",e[e.value=2]="value"}(m||(m={}));let JN={_tag:"Continue"},JM=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1],Jj=[0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1];!function(e){e[e.headers=0]="headers",e[e.body=1]="body"}(g||(g={}));let JP={_tag:"InvalidDisposition"},JD={_tag:"EndNotReached"},J$={_tag:"ReachedLimit",limit:"MaxParts"},Jz={_tag:"ReachedLimit",limit:"MaxTotalSize"},JL={_tag:"ReachedLimit",limit:"MaxPartSize"},JU={_tag:"ReachedLimit",limit:"MaxFieldSize"},JB=new TextEncoder().encode("\r\n");function Jq(e){return void 0!==e.filename||"application/octet-stream"===e.contentType}function JJ(e){}let JH=new TextDecoder("utf-8"),JV=function({headers:e,onFile:t,onField:r,onError:n,onDone:i,isFile:s=Jq,maxParts:a=1/0,maxTotalSize:o=1/0,maxPartSize:l=1/0,maxFieldSize:u=1048576}){let c=JA(e["content-type"]).parameters.boundary;if(void 0===c)return n({_tag:"InvalidBoundary"}),{write:JJ,end(){}};let h={state:g.headers,index:0,parts:0,onChunk:JJ,info:void 0,headerSkip:0,partSize:0,totalSize:0,isFile:!1,fieldChunks:[],fieldSize:0};function f(){h.state=g.body,h.isFile=!0,h.onChunk=JJ}let p=function(){let e=new TextDecoder,t={state:m.key,headers:Object.create(null),key:"",value:void 0,crlf:0,previousChunk:void 0,pairs:0,size:0};function r(e){return t.state=m.key,t.headers=Object.create(null),t.key="",t.value=void 0,t.crlf=0,t.previousChunk=void 0,t.pairs=0,t.size=0,e}function n(e,t){let r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function i(e){return r({_tag:"Failure",reason:e,headers:t.headers})}return function(s,a){let o,l=0;if(void 0!==t.previousChunk){o=l=t.previousChunk.length;let e=new Uint8Array(s.length+l);e.set(t.previousChunk),e.set(s,l),t.previousChunk=void 0,s=e}let u=s.length;e:for(;a<u;){if(t.state===m.key){let r=a;for(;r<u;r++){if(t.size++>16384)return i("HeaderTooLarge");if(58===s[r]){if(t.key+=e.decode(s.subarray(a,r)).toLowerCase(),0===t.key.length)return i("InvalidHeaderName");32===s[r+1]&&32!==s[r+2]&&9!==s[r+2]?(a=r+2,t.state=m.value,t.size++):32!==s[r+1]&&9!==s[r+1]?(a=r+1,t.state=m.value):(a=r+1,t.state=m.whitespace);break}if(1!==JM[s[r]])return i("InvalidHeaderName")}if(r===u)return t.key+=e.decode(s.subarray(a,u)).toLowerCase(),JN}if(t.state===m.whitespace){for(;a<u;a++){if(t.size++>16384)return i("HeaderTooLarge");if(32!==s[a]&&9!==s[a]){t.state=m.value;break}}if(a===u)return JN}if(t.state===m.value){let c=a;for(void 0!==o&&(c=o,o=void 0);c<u;c++){if(t.size++>16384)return i("HeaderTooLarge");if(13===s[c]||t.crlf>0){let o=s[c];if(13===o&&0===t.crlf&&(t.crlf=1,c++,t.size++,o=s[c]),10===o&&1===t.crlf&&(t.crlf=2,c++,t.size++,o=s[c]),13===o&&2===t.crlf&&(t.crlf=3,c++,t.size++,o=s[c]),10===o&&3===t.crlf&&(t.crlf=4,c++,t.size++),t.crlf<4&&c>=u)return t.previousChunk=s.subarray(a),JN;if(t.crlf>=2){t.value=void 0===t.value?s.subarray(a,c-t.crlf):n(t.value,s.subarray(a,c-t.crlf));let o=e.decode(t.value);if(void 0===t.headers[t.key]?t.headers[t.key]=o:"string"==typeof t.headers[t.key]?t.headers[t.key]=[t.headers[t.key],o]:t.headers[t.key].push(o),a=c,t.size--,4!==t.crlf&&100===t.pairs)return i("TooManyHeaders");if(3===t.crlf)return i("InvalidHeaderValue");if(4===t.crlf)return r({_tag:"Headers",headers:t.headers,endPosition:a-l});t.pairs++,t.key="",t.value=void 0,t.crlf=0,t.state=m.key;continue e}}else if(1!==Jj[s[c]])return i("InvalidHeaderValue")}if(c===u)return t.value=void 0===t.value?s.subarray(a,u):n(t.value,s.subarray(a,u)),JN}}return a>u&&(t.size+=u-a),JN}}(),d=function(e,t,r){let n=function(e){let t=new TextEncoder().encode(e),r=t.length,n={};for(let e=0;e<r;e++){let r=t[e];void 0===n[r]&&(n[r]=[]),n[r].push(e)}return{needle:t,needleLength:r,indexes:n,firstByte:t[0],previousChunk:void 0,previousChunkLength:0,matchIndex:0}}(e);void 0!==r&&(n.previousChunk=r,n.previousChunkLength=r.length);let i=function(){if("Buffer"in globalThis&&!("Bun"in globalThis||"Deno"in globalThis))return function(e,t,r){return Buffer.prototype.indexOf.call(e,t,r)};let e=new Uint8Array(256).fill(n.needle.length);for(let t=0,r=n.needle.length-1;t<r;++t)e[n.needle[t]]=r-t;return function(t,r,i){let s=t.length,a=i+n.needleLength-1;for(;a<s;){for(let e=n.needleLength-1,i=a;e>=0&&t[i]===r[e];e--,i--)if(0===e)return i;a+=e[t[a]]}return -1}}();return{write:function(e){let r=e.length;if(void 0!==n.previousChunk){let t=new Uint8Array(n.previousChunkLength+r);t.set(n.previousChunk),t.set(e,n.previousChunkLength),e=t,r=n.previousChunkLength+r,n.previousChunk=void 0}if(r<n.needleLength){n.previousChunk=e,n.previousChunkLength=r;return}let s=0;for(;s<r;){let a=i(e,n.needle,s);if(a>-1){a>s&&t(n.matchIndex,e.subarray(s,a)),n.matchIndex+=1,s=a+n.needleLength;continue}if(e[r-1]in n.indexes){let i=n.indexes[e[r-1]],a=-1;for(let t=0,s=i.length;t<s;t++){let s=i[t];e[r-1-s]===n.firstByte&&t>a&&(a=s)}-1===a?0===s?t(n.matchIndex,e):t(n.matchIndex,e.subarray(s)):(r-1-a>s&&t(n.matchIndex,e.subarray(s,r-1-a)),n.previousChunk=e.subarray(r-1-a),n.previousChunkLength=a+1)}else 0===s?t(n.matchIndex,e):t(n.matchIndex,e.subarray(s));break}},end:function(){void 0!==n.previousChunk&&n.previousChunk!==r&&t(n.matchIndex,n.previousChunk),n.previousChunk=r,n.previousChunkLength=r?.length??0,n.matchIndex=0}}}(`\r
--${c}`,function(e,o){if(0===e)return void f();if(e!==h.index){if(h.index>0)if(h.isFile)h.onChunk(null),h.partSize=0;else{if(1===h.fieldChunks.length)r(h.info,h.fieldChunks[0]);else{let e=new Uint8Array(h.fieldSize),t=0;for(let r=0;r<h.fieldChunks.length;r++){let n=h.fieldChunks[r];e.set(n,t),t+=n.length}r(h.info,e)}h.fieldSize=0,h.fieldChunks=[]}if(h.state=g.headers,h.index=e,h.headerSkip=2,45===o[0]&&45===o[1])return i();h.parts++,h.parts>a&&n(J$)}if((h.partSize+=o.length)>l&&n(JL),h.state===g.headers){let e,r=p(o,h.headerSkip);if(h.headerSkip=0,"Continue"===r._tag)return;if("Failure"===r._tag)return f(),n({_tag:"BadHeaders",error:r});let i=JA(r.headers["content-type"]),a=JA(r.headers["content-disposition"],!0);if("form-data"===a.value&&!("name"in a.parameters))return f(),n(JP);if("filename*"in a.parameters){let t=a.parameters["filename*"].split("''");2===t.length&&(e=decodeURIComponent(t[1]))}if(h.info={name:a.parameters.name??"",filename:e??a.parameters.filename,contentType:""===i.value?void 0!==a.parameters.filename?"application/octet-stream":"text/plain":i.value,contentTypeParameters:i.parameters,contentDisposition:a.value,contentDispositionParameters:a.parameters,headers:r.headers},h.state=g.body,h.isFile=s(h.info),h.isFile&&(h.onChunk=t(h.info)),r.endPosition<o.length)if(h.isFile)h.onChunk(o.subarray(r.endPosition));else{let e=o.subarray(r.endPosition);(h.fieldSize+=e.length)>u&&n(JU),h.fieldChunks.push(e)}}else h.isFile?h.onChunk(o):((h.fieldSize+=o.length)>u&&n(JU),h.fieldChunks.push(o))},JB);return{write:e=>(h.totalSize+=e.length)>o?n(Jz):d.write(e),end(){d.end(),h.state===g.body&&n(JD),h.state=g.headers,h.index=0,h.parts=0,h.onChunk=JJ,h.info=void 0,h.totalSize=0,h.partSize=0,h.fieldChunks=[],h.fieldSize=0}}},JW=Symbol.for("@effect/platform/Path"),JK=uW("@effect/platform/Path");function JG(e,t){let r,n="",i=0,s=-1,a=0;for(let o=0;o<=e.length;++o){if(o<e.length)r=e.charCodeAt(o);else if(47===r)break;else r=47;if(47===r){if(s===o-1||1===a);else if(s!==o-1&&2===a){if(n.length<2||2!==i||46!==n.charCodeAt(n.length-1)||46!==n.charCodeAt(n.length-2)){if(n.length>2){let e=n.lastIndexOf("/");if(e!==n.length-1){-1===e?(n="",i=0):i=(n=n.slice(0,e)).length-1-n.lastIndexOf("/"),s=o,a=0;continue}}else if(2===n.length||1===n.length){n="",i=0,s=o,a=0;continue}}t&&(n.length>0?n+="/..":n="..",i=2)}else n.length>0?n+="/"+e.slice(s+1,o):n=e.slice(s+1,o),i=o-s-1;s=o,a=0}else 46===r&&-1!==a?++a:a=-1}return n}let JZ=function(){let e,t="",r=!1;for(let n=arguments.length-1;n>=-1&&!r;n--){let i;if(n>=0)i=arguments[n];else{let t=globalThis.process;void 0===e&&"process"in globalThis&&"object"==typeof t&&null!==t&&"function"==typeof t.cwd&&(e=t.cwd()),i=e}0!==i.length&&(t=i+"/"+t,r=47===i.charCodeAt(0))}if(t=JG(t,!r),r)if(t.length>0)return"/"+t;else return"/";return t.length>0?t:"."},JQ=/%/g,JY=/\\/g,JX=/\n/g,J0=/\r/g,J1=/\t/g,J2=JK.of({[JW]:JW,resolve:JZ,normalize(e){if(0===e.length)return".";let t=47===e.charCodeAt(0),r=47===e.charCodeAt(e.length-1);return(0!==(e=JG(e,!t)).length||t||(e="."),e.length>0&&r&&(e+="/"),t)?"/"+e:e},isAbsolute:e=>e.length>0&&47===e.charCodeAt(0),join(){let e;if(0==arguments.length)return".";for(let t=0;t<arguments.length;++t){let r=arguments[t];r.length>0&&(void 0===e?e=r:e+="/"+r)}return void 0===e?".":J2.normalize(e)},relative(e,t){if(e===t||(e=J2.resolve(e),t=J2.resolve(t),e===t))return"";let r=1;for(;r<e.length&&47===e.charCodeAt(r);++r);let n=e.length,i=n-r,s=1;for(;s<t.length&&47===t.charCodeAt(s);++s);let a=t.length-s,o=i<a?i:a,l=-1,u=0;for(;u<=o;++u){if(u===o){if(a>o){if(47===t.charCodeAt(s+u))return t.slice(s+u+1);else if(0===u)return t.slice(s+u)}else i>o&&(47===e.charCodeAt(r+u)?l=u:0===u&&(l=0));break}let n=e.charCodeAt(r+u);if(n!==t.charCodeAt(s+u))break;47===n&&(l=u)}let c="";for(u=r+l+1;u<=n;++u)(u===n||47===e.charCodeAt(u))&&(0===c.length?c+="..":c+="/..");return c.length>0?c+t.slice(s+l):(s+=l,47===t.charCodeAt(s)&&++s,t.slice(s))},dirname(e){if(0===e.length)return".";let t=e.charCodeAt(0),r=47===t,n=-1,i=!0;for(let r=e.length-1;r>=1;--r)if(47===(t=e.charCodeAt(r))){if(!i){n=r;break}}else i=!1;return -1===n?r?"/":".":r&&1===n?"//":e.slice(0,n)},basename(e,t){let r,n=0,i=-1,s=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let a=t.length-1,o=-1;for(r=e.length-1;r>=0;--r){let l=e.charCodeAt(r);if(47===l){if(!s){n=r+1;break}}else -1===o&&(s=!1,o=r+1),a>=0&&(l===t.charCodeAt(a)?-1==--a&&(i=r):(a=-1,i=o))}return n===i?i=o:-1===i&&(i=e.length),e.slice(n,i)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!s){n=r+1;break}}else -1===i&&(s=!1,i=r+1);return -1===i?"":e.slice(n,i)},extname(e){let t=-1,r=0,n=-1,i=!0,s=0;for(let a=e.length-1;a>=0;--a){let o=e.charCodeAt(a);if(47===o){if(!i){r=a+1;break}continue}-1===n&&(i=!1,n=a+1),46===o?-1===t?t=a:1!==s&&(s=1):-1!==t&&(s=-1)}return -1===t||-1===n||0===s||1===s&&t===n-1&&t===r+1?"":e.slice(t,n)},format:function(e){if(null===e||"object"!=typeof e)throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);let t=e.dir||e.root,r=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+r:t+"/"+r:r},parse(e){let t,r={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return r;let n=e.charCodeAt(0),i=47===n;i?(r.root="/",t=1):t=0;let s=-1,a=0,o=-1,l=!0,u=e.length-1,c=0;for(;u>=t;--u){if(47===(n=e.charCodeAt(u))){if(!l){a=u+1;break}continue}-1===o&&(l=!1,o=u+1),46===n?-1===s?s=u:1!==c&&(c=1):-1!==s&&(c=-1)}return -1===s||-1===o||0===c||1===c&&s===o-1&&s===a+1?-1!==o&&(0===a&&i?r.base=r.name=e.slice(1,o):r.base=r.name=e.slice(a,o)):(0===a&&i?(r.name=e.slice(1,s),r.base=e.slice(1,o)):(r.name=e.slice(a,s),r.base=e.slice(a,o)),r.ext=e.slice(s,o)),a>0?r.dir=e.slice(0,a-1):i&&(r.dir="/"),r},sep:"/",fromFileUrl:function(e){if("file:"!==e.protocol)return f9(new qf({module:"Path",method:"fromFileUrl",description:"URL must be of scheme file"}));if(""!==e.hostname)return f9(new qf({module:"Path",method:"fromFileUrl",description:"Invalid file URL host"}));let t=e.pathname;for(let e=0;e<t.length;e++)if("%"===t[e]){let r=32|t.codePointAt(e+2);if("2"===t[e+1]&&102===r)return f9(new qf({module:"Path",method:"fromFileUrl",description:"must not include encoded / characters"}))}return pF(decodeURIComponent(t))},toFileUrl:function(e){var t;let r=new URL("file://"),n=JZ(e);return 47===e.charCodeAt(e.length-1)&&"/"!==n[n.length-1]&&(n+="/"),(t=n).includes("%")&&(t=t.replace(JQ,"%25")),t.includes("\\")&&(t=t.replace(JY,"%5C")),t.includes("\n")&&(t=t.replace(JX,"%0A")),t.includes("\r")&&(t=t.replace(J0,"%0D")),t.includes("	")&&(t=t.replace(J1,"%09")),r.pathname=t,pF(r)},toNamespacedPath:ng}),J3=Symbol.for("@effect/platform/Multipart"),J5=Symbol.for("@effect/platform/Multipart/MultipartError");class J4 extends jp()("MultipartError",{reason:NC("FileTooLarge","FieldTooLarge","BodyTooLarge","TooManyParts","InternalError","Parse"),cause:jO}){[J5]=J5;get message(){return this.reason}}let J6=e=>"Success"===e._tag?DN:Dv(e.cause);class J8 extends ig{[J3];constructor(){super(),this[J3]=J3}}class J7 extends J8{key;contentType;value;_tag="Field";constructor(e,t,r){super(),this.key=e,this.contentType=t,this.value=r}toJSON(){return{_id:"@effect/platform/Multipart/Part",_tag:"Field",key:this.key,contentType:this.contentType,value:this.value}}}class J9 extends J8{_tag="File";key;name;contentType;content;contentEffect;constructor(e,t){super(),this.key=e.name,this.name=e.filename??e.name,this.contentType=e.contentType,this.content=Bi(t),this.contentEffect=t.pipe(DO(Ht),$G,pS(e=>new J4({reason:"InternalError",cause:e})))}toJSON(){return{_id:"@effect/platform/Multipart/Part",_tag:"File",key:this.key,name:this.name,contentType:this.contentType}}}let He=(e,t)=>ps(qm,r=>pS(BD(t.content,r.sink(e)),e=>new J4({reason:"InternalError",cause:e}))),Ht=DT(()=>{let e=new Uint8Array(0),t=DF({onInput(r){for(let t of r){let r=new Uint8Array(e.length+t.length);r.set(e,0),r.set(t,e.length),e=r}return t},onFailure:e=>Dv(e),onDone:()=>DR(e)});return t});class Hr extends J8{key;name;contentType;path;_tag="PersistedFile";constructor(e,t,r,n){super(),this.key=e,this.name=t,this.contentType=r,this.path=n}toJSON(){return{_id:"@effect/platform/Multipart/Part",_tag:"PersistedFile",key:this.key,name:this.name,contentType:this.contentType,path:this.path}}}class Hn extends uZ()("@effect/platform/Multipart/MaxParts",{defaultValue:s_}){}class Hi extends uZ()("@effect/platform/Multipart/MaxFieldSize",{defaultValue:nb(qg(0xa00000))}){}class Hs extends uZ()("@effect/platform/Multipart/MaxFileSize",{defaultValue:s_}){}class Ha extends uZ()("@effect/platform/Multipart/FieldMimeTypes",{defaultValue:nb(og("application/json"))}){}let Ho=Symbol.for("effect/FiberSet");Symbol.iterator;let Hl=new cM(-1,0),Hu=uv(void 0,{emptyCase:nx,failCase:nx,dieCase:nx,interruptCase:(e,t)=>lA(cU(t),-1),sequentialCase:(e,t,r)=>t||r,parallelCase:(e,t,r)=>t||r}),Hc=((e=>nL(e[0],Ho),(e,t,r)=>{if("Closed"===e.state._tag)return void t.unsafeInterruptAsFork(cz(r?.interruptAs??cH,Hl));e.state.backing.has(t)||(e.state.backing.add(t),t.addObserver(n=>{"Closed"!==e.state._tag&&(e.state.backing.delete(t),"Failure"!==n._tag||(r?.propagateInterruption===!0?Hu(n.cause):ue(n.cause))||mb(e.deferred,n))}))}),Symbol.for("@effect/platform/Socket/SocketError"));class Hh extends qc(Hc,"SocketError"){static is(e){return nL(e,Hc)&&"Close"===e.reason}static isClean(e){return function(t){return Hh.is(t)&&e(t.code)}}get message(){return this.closeReason?`${this.reason}: ${this.code}: ${this.closeReason}`:`${this.reason}: ${this.code}`}}let Hf=Symbol.for("@effect/platform/HttpServerRequest"),Hp=uW("@effect/platform/HttpServerRequest"),Hd=uW("@effect/platform/HttpServerRequest/ParsedSearchParams");class Hm extends ig{source;url;headersOverride;remoteAddressOverride;[Hf];[Jm];constructor(e,t,r,n){super(),this.source=e,this.url=t,this.headersOverride=r,this.remoteAddressOverride=n,this[Hf]=Hf,this[Jm]=Jm}toJSON(){return Jy(this,{_id:"@effect/platform/HttpServerRequest",method:this.method,url:this.originalUrl})}modify(e){return new Hm(this.source,e.url??this.url,e.headers??this.headersOverride,e.remoteAddress??this.remoteAddressOverride)}get method(){return this.source.method.toUpperCase()}get originalUrl(){return this.source.url}get remoteAddress(){return this.remoteAddressOverride?i4(this.remoteAddressOverride):s_()}get headers(){return this.headersOverride??=qZ(this.source.headers),this.headersOverride}cachedCookies;get cookies(){return this.cachedCookies?this.cachedCookies:this.cachedCookies=function(e){let t={},r=e.length,n=0,i=0;for(;i!==r;){-1===(i=e.indexOf(";",n))&&(i=r);let s=e.indexOf("=",n);if(-1===s)break;if(s>i){n=i+1;continue}let a=e.substring(n,s++).trim();if(void 0===t[a]){let r=34===e.charCodeAt(s)?e.substring(s+1,i-1).trim():e.substring(s,i).trim();t[a]=-1!==r.indexOf("%")?qH(r):r}n=i+1}return t}(this.headers.cookie??"")}get stream(){return this.source.body?qo(()=>this.source.body,e=>new Jf({request:this,reason:"Decode",cause:e})):U4(new Jf({request:this,reason:"Decode",description:"can not create stream from empty body"}))}textEffect;get text(){return this.textEffect||(this.textEffect=kK(Cy(x4({try:()=>this.source.text(),catch:e=>new Jf({request:this,reason:"Decode",cause:e})})))),this.textEffect}get json(){return x6(this.text,{try:e=>JSON.parse(e),catch:e=>new Jf({request:this,reason:"Decode",cause:e})})}get urlParamsBody(){return ps(this.text,e=>xR({try:()=>qb(new URLSearchParams(e)),catch:e=>new Jf({request:this,reason:"Decode",cause:e})}))}multipartEffect;get multipart(){return this.multipartEffect||(this.multipartEffect=kK(Cy(((e,t=He)=>Cx(function*(){let r=yield*qm,n=yield*JK,i=yield*r.makeTempDirectoryScoped(),s=Object.create(null);return yield*B$(e,e=>{if("Field"===e._tag)return e.key in s?"string"==typeof s[e.key]?s[e.key]=[s[e.key],e.value]:s[e.key].push(e.value):s[e.key]=e.value,pj;if(""===e.name)return pj;let r=n.join(i,n.basename(e.name).slice(-128)),a=new Hr(e.key,e.name,e.contentType,r);return Array.isArray(s[e.key])?s[e.key].push(a):s[e.key]=[a],t(r,e)}),s}).pipe(xA({SystemError:e=>f9(new J4({reason:"InternalError",cause:e})),BadArgument:e=>f9(new J4({reason:"InternalError",cause:e}))})))(this.multipartStream)))),this.multipartEffect}get multipartStream(){return BO(Bv(this.stream,e=>new J4({reason:"InternalError",cause:e})),((e,t=16)=>{let r,n,i,s;return r=wf([fV(t=>{let r=uJ(t.currentContext,Ha);return pF({headers:e,maxParts:sF(uJ(t.currentContext,Hn)),maxFieldSize:Number(uJ(t.currentContext,Hi)),maxPartSize:uJ(t.currentContext,Hs).pipe(sA(Number),sF),maxTotalSize:uJ(t.currentContext,Jb).pipe(sA(Number),sF),isFile:0===r.length?void 0:e=>!oY(r,t=>e.contentType.includes(t))&&Jq(e)})}),(s=t,fV(e=>pF(new JE(e.currentScheduler,"number"==typeof s?s:s?.capacity??1/0,"number"==typeof s?"suspend":s?.strategy??"suspend"))))]),n=([e,t])=>{let r=[],n=s_(),i=JV({...e,onField(e,t){r.push(new J7(e.name,e.contentType,(function(e){if("utf-8"===e||"utf8"===e||""===e)return JH;try{return new TextDecoder(e)}catch(e){return JH}})(e.contentTypeParameters.charset??"utf-8").decode(t)))},onFile(e){let t=[],n=!1,i=DT(()=>{if(0===t.length)return n?DN:ze(s,i);let e=ow(t);return t=[],n?DM(e):ze(DM(e),ze(s,i))});return r.push(new J9(e,i)),function(e){null===e?n=!0:t.push(e)}},onError(e){n=i4(d5(function(e){if("ReachedLimit"===e._tag)switch(e.limit){case"MaxParts":return new J4({reason:"TooManyParts",cause:e});case"MaxFieldSize":return new J4({reason:"FieldTooLarge",cause:e});case"MaxPartSize":return new J4({reason:"FileTooLarge",cause:e});case"MaxTotalSize":return new J4({reason:"BodyTooLarge",cause:e})}return new J4({reason:"Parse",cause:e})}(e)))},onDone(){n=i4(mn)}}),s=D_(t.takeAll,([e,t])=>DA(()=>{oj(e,oj(i.write)),t&&i.end()})),a=D_(s,()=>{if(0===r.length)return"None"===n._tag?a:J6(n.value);let e=ow(r);return r=[],ze(DM(e),"None"===n._tag?a:J6(n.value))});return Db(a,{awaitRead:()=>pj,emit:e=>t.offer(e),error:e=>(n=i4(d4(e)),t.end),done:e=>t.end})},i=([,e])=>e.shutdown,D_(Dk(xa(()=>pj)),e=>nS(Dk(pN(pT(r,t=>xo(e,e=>i(t,e))))),D_(n),Dy(t=>ps(e.get,e=>e(t)))))})(this.headers))}arrayBufferEffect;get arrayBuffer(){return this.arrayBufferEffect||(this.arrayBufferEffect=kK(Cy(x4({try:()=>this.source.arrayBuffer(),catch:e=>new Jf({request:this,reason:"Decode",cause:e})})))),this.arrayBufferEffect}get upgrade(){return f9(new Jf({request:this,reason:"Decode",description:"Not an upgradeable ServerRequest"}))}}let Hg=(e,t)=>ps(Hp,Jg(e,t)),Hb=e=>{let t=e.headers.host??"localhost",r="https"===e.headers["x-forwarded-proto"]?"https":"http";try{return i4(new URL(e.url,`${r}://${t}`))}catch{return s_()}},Hy=nF(Symbol.for("@effect/platform/HttpApp/preResponseHandlers"),()=>dl(s_())),Hx=/^[0-9a-f]{32}$/i,Hv=/^[0-9a-f]{16}$/i,HS=(()=>dl(!1),nF(Symbol.for("@effect/platform/HttpMiddleware/tracerDisabledWhen"),()=>dl(nx))),H_=uZ()("@effect/platform/HttpMiddleware/SpanNameGenerator",{defaultValue:()=>e=>`http.server ${e.method}`}),Hw=e=>fV(t=>{let r=uJ(t.currentContext,Hp);if(t.getFiberRef(HS)(r))return e;let n=sF(Hb(r));void 0!==n&&(""!==n.username||""!==n.password)&&(n.username="REDACTED",n.password="REDACTED");let i=t.getFiberRef(q2),s=q1(r.headers,i);return vt(uJ(t.currentContext,H_)(r),{parent:sF((e=>{let t=(e=>{if(!e.traceparent)return s_();let t=e.traceparent.split("-");if(4!==t.length)return s_();let[r,n,i,s]=t;return"00"!==r||!1===Hx.test(n)||!1===Hv.test(i)?s_():i4(x_({traceId:n,spanId:i,sampled:(1&parseInt(s,16))==1}))})(e);return"Some"===t._tag||"Some"===(t=(e=>{if(!("b3"in e))return s_();let t=e.b3.split("-");return t.length<2?s_():i4(x_({traceId:t[0],spanId:t[1],sampled:!t[2]||"1"===t[2]}))})(e))._tag?t:(e=>e["x-b3-traceid"]&&e["x-b3-spanid"]?i4(x_({traceId:e["x-b3-traceid"],spanId:e["x-b3-spanid"],sampled:!e["x-b3-sampled"]||"1"===e["x-b3-sampled"]})):s_())(e)})(r.headers)),kind:"server",captureStackTrace:!1},t=>{for(let e in t.attribute("http.request.method",r.method),void 0!==n&&(t.attribute("url.full",n.toString()),t.attribute("url.path",n.pathname),""!==n.search.slice(1)&&t.attribute("url.query",n.search.slice(1)),t.attribute("url.scheme",n.protocol.slice(0,-1))),void 0!==r.headers["user-agent"]&&t.attribute("user_agent.original",r.headers["user-agent"]),s)t.attribute(`http.request.header.${e}`,String(s[e]));return"Some"===r.remoteAddress._tag&&t.attribute("client.address",r.remoteAddress.value),ps(f7(vr(e,t)),e=>{let r=(e=>"Success"===e._tag?e.value:(e=>{let t,r=uo(e,e=>q6(e)?(t=e,i4(l1)):s_());return[t??Jl,r]})(e.cause)[0])(e);t.attribute("http.response.status_code",r.status);let n=q1(r.headers,i);for(let e in n)t.attribute(`http.response.header.${e}`,String(n[e]));return e})})}),Hk=Symbol.for("@effect/platform/HttpApp/handled"),HO=nF("@effect/platform/HttpApp/ejectedScopes",()=>new WeakSet),HE=e=>{let t=kB(e),r=kR(t);return(n,i)=>{let s=Symbol.for("@effect/platform/HttpApp/resolve"),a=((e,t,r)=>{let n,i=f0(fV(r=>ps(e,e=>{let n=uJ(r.currentContext,Hp),i=r.getFiberRef(Hy);return"None"===i._tag?(n[Hk]=!0,fK(t(n,e),e)):pT(i.value(n,e),e=>(n[Hk]=!0,t(n,e)))})),e=>fV(r=>ps(Jd(e),([e,n])=>{let i=uJ(r.currentContext,Hp),s=r.getFiberRef(Hy);return"None"===s._tag?(i[Hk]=!0,wI(t(i,e),pt(n))):wI(pT(s.value(i,e),e=>(i[Hk]=!0,t(i,e))),pt(n))})));return pN((n=ng(void 0===r?Hw(i):pc(r(Hw(i)),{onFailure:e=>fV(r=>{let n=uJ(r.currentContext,Hp);return Hk in n?pj:pc(Jd(e),{onFailure:e=>t(n,q8({status:500})),onSuccess:([e])=>t(n,e)})}),onSuccess:e=>fV(r=>{let n=uJ(r.currentContext,Hp);return Hk in n?pj:t(n,e)})})),ps(wP(),e=>p_(wD(n,e),t=>HO.has(e)?pj:dN(e,t)))))})(n,(t,r)=>(r=(e=>{if("Stream"!==e.body._tag)return e;let t=uJ(sT(sC(globalThis[vS])).currentContext,wA);return HO.add(t),q9(e,qI(U2(e.body.stream,dN(t,mn)),e.body.contentType,e.body.contentLength))})(r),t[s](((e,t)=>{let r=new globalThis.Headers(e.headers);if(!(e=>0===sZ(e.cookies).length)(e.cookies))for(let t of Object.values(e.cookies.cookies).map(qJ))r.append("set-cookie",t);if(t?.withoutBody)return new Response(void 0,{status:e.status,statusText:e.statusText,headers:r});let n=e.body;switch(n._tag){case"Empty":return new Response(void 0,{status:e.status,statusText:e.statusText,headers:r});case"Uint8Array":case"Raw":if(n.body instanceof Response){for(let[e,t]of r)n.body.headers.set(e,t);return n.body}return new Response(n.body,{status:e.status,statusText:e.statusText,headers:r});case"FormData":return new Response(n.formData,{status:e.status,statusText:e.statusText,headers:r});case"Stream":return new Response(B2(n.stream,t?.runtime??kJ),{status:e.status,statusText:e.statusText,headers:r})}})(r,{withoutBody:"HEAD"===t.method,runtime:e})),pj),i);return(n,i)=>new Promise(o=>{let l=new Map(e.context.unsafeMap);if(u$(i))for(let[e,t]of i.unsafeMap)l.set(e,t);let u=(e=>new Hm(e,(e=>{if("/"===e[0])return e;let t=e.indexOf("/",e.indexOf("//")+2);return -1===t?"/":e.slice(t)})(e.url)))(n);l.set(Hp.key,u),u[s]=o,t.context=uD(l);let c=r(a);n.signal?.addEventListener("abort",()=>{c.unsafeInterruptAsFork(Jo)},{once:!0})})}},HC=e=>`http.request.header.${e}`,HF=e=>`http.response.header.${e}`,HR=Symbol.for("@effect/platform/HttpClientError");class HI extends qc(HR,"RequestError"){get methodAndUrl(){return`${this.request.method} ${this.request.url}`}get message(){return this.description?`${this.reason}: ${this.description} (${this.methodAndUrl})`:`${this.reason} error (${this.methodAndUrl})`}}class HT extends qc(HR,"ResponseError"){get methodAndUrl(){return`${this.request.method} ${this.request.url}`}get message(){let e=`${this.response.status} ${this.methodAndUrl}`;return this.description?`${this.reason}: ${this.description} (${e})`:`${this.reason} error (${e})`}}let HA=Symbol.for("@effect/platform/HttpClientRequest"),HN={[HA]:HA,...im,toJSON(){return{_id:"@effect/platform/HttpClientRequest",method:this.method,url:this.url,urlParams:this.urlParams,hash:this.hash,headers:i_(this.headers),body:this.body.toJSON()}},pipe(){return iw(this,arguments)}};function HM(e,t,r,n,i,s){let a=Object.create(HN);return a.method=e,a.url=t,a.urlParams=r,a.hash=n,a.headers=i,a.body=s,a}let Hj=HM("GET","",[],s_(),qG,qk),HP=e=>(t,r)=>HJ(Hj,{method:e,url:t,...r??void 0}),HD=HP("GET"),H$=HP("POST"),Hz=HP("PUT"),HL=HP("PATCH"),HU=HP("DELETE"),HB=HP("HEAD"),Hq=HP("OPTIONS"),HJ=nm(2,(e,t)=>{let r=e;return t.method&&(r=HG(r,t.method)),t.url&&(r=HZ(r,t.url)),t.headers&&(r=HV(r,t.headers)),t.urlParams&&(r=HX(r,t.urlParams)),t.hash&&(r=H0(r,t.hash)),t.body&&(r=H1(r,t.body)),t.accept&&(r=HW(r,t.accept)),t.acceptJson&&(r=HK(r)),r}),HH=nm(3,(e,t,r)=>HM(e.method,e.url,e.urlParams,e.hash,qQ(e.headers,t,r),e.body)),HV=nm(2,(e,t)=>HM(e.method,e.url,e.urlParams,e.hash,qY(e.headers,t),e.body)),HW=nm(2,(e,t)=>HH(e,"Accept",t)),HK=HW("application/json"),HG=nm(2,(e,t)=>HM(t,e.url,e.urlParams,e.hash,e.headers,e.body)),HZ=nm(2,(e,t)=>{if("string"==typeof t)return HM(e.method,t,e.urlParams,e.hash,e.headers,e.body);let r=new URL(t.toString()),n=qb(r.searchParams),i=r.hash?i4(r.hash.slice(1)):s_();return r.search="",r.hash="",HM(e.method,r.toString(),n,i,e.headers,e.body)}),HQ=nm(2,(e,t)=>HM(e.method,t.endsWith("/")&&e.url.startsWith("/")?t+e.url.slice(1):t+e.url,e.urlParams,e.hash,e.headers,e.body)),HY=nm(3,(e,t,r)=>HM(e.method,e.url,qv(e.urlParams,t,r),e.hash,e.headers,e.body)),HX=nm(2,(e,t)=>HM(e.method,e.url,qx(e.urlParams,t),e.hash,e.headers,e.body)),H0=nm(2,(e,t)=>HM(e.method,e.url,e.urlParams,i4(t),e.headers,e.body)),H1=nm(2,(e,t)=>{let r=e.headers;if("Empty"===t._tag||"FormData"===t._tag)r=q0(r,["Content-type","Content-length"]);else{let e=t.contentType;e&&(r=qQ(r,"content-type",e));let n=t.contentLength;n&&(r=qQ(r,"content-length",n.toString()))}return HM(e.method,e.url,e.urlParams,e.hash,r,t)}),H2=nm(2,(e,t)=>px(qF(t),t=>H1(e,t))),H3=Symbol.for("@effect/platform/HttpClientResponse");class H5 extends ig{request;source;[Jm];[H3];constructor(e,t){super(),this.request=e,this.source=t,this[Jm]=Jm,this[H3]=H3}toJSON(){return Jy(this,{_id:"@effect/platform/HttpClientResponse",request:this.request.toJSON(),status:this.status})}get status(){return this.source.status}get headers(){return qZ(this.source.headers)}cachedCookies;get cookies(){return this.cachedCookies?this.cachedCookies:this.cachedCookies=(e=>{let t=[];for(let r of"string"==typeof e?[e]:e){let e=function(e){let t=e.split(";").map(e=>e.trim()).filter(e=>""!==e);if(0===t.length)return s_();let r=t[0].indexOf("=");if(-1===r)return s_();let n=t[0].slice(0,r);if(!qL.test(n))return s_();let i=t[0].slice(r+1),s=qH(i);if(1===t.length)return i4(Object.assign(Object.create(qU),{name:n,value:s,valueEncoded:i}));let a={};for(let e=1;e<t.length;e++){let r=t[e],n=r.indexOf("="),i=-1===n?r:r.slice(0,n).trim(),s=-1===n?void 0:r.slice(n+1).trim();switch(i.toLowerCase()){case"domain":{if(void 0===s)break;let e=s.trim().replace(/^\./,"");e&&(a.domain=e);break}case"expires":{if(void 0===s)break;let e=new Date(s);isNaN(e.getTime())||(a.expires=e);break}case"max-age":{if(void 0===s)break;let e=parseInt(s,10);isNaN(e)||(a.maxAge=ca(e));break}case"path":if(void 0===s)break;"/"===s[0]&&(a.path=s);break;case"priority":if(void 0===s)break;switch(s.toLowerCase()){case"low":a.priority="low";break;case"medium":a.priority="medium";break;case"high":a.priority="high"}break;case"httponly":a.httpOnly=!0;break;case"secure":a.secure=!0;break;case"partitioned":a.partitioned=!0;break;case"samesite":if(void 0===s)break;switch(s.toLowerCase()){case"lax":a.sameSite="lax";break;case"strict":a.sameSite="strict";break;case"none":a.sameSite="none"}}}return i4(Object.assign(Object.create(qU),{name:n,value:s,valueEncoded:i,options:Object.keys(a).length>0?a:void 0}))}(r.trim());i3(e)&&t.push(e.value)}return q$(t)})(this.source.headers.getSetCookie())}get remoteAddress(){return s_()}get stream(){return this.source.body?qo(()=>this.source.body,e=>new HT({request:this.request,response:this,reason:"Decode",cause:e})):U4(new HT({request:this.request,response:this,reason:"EmptyBody",description:"can not create stream from empty body"}))}get json(){return x6(this.text,{try:e=>""===e?null:JSON.parse(e),catch:e=>new HT({request:this.request,response:this,reason:"Decode",cause:e})})}textBody;get text(){return this.textBody??=x4({try:()=>this.source.text(),catch:e=>new HT({request:this.request,response:this,reason:"Decode",cause:e})}).pipe(Cy,kK)}get urlParamsBody(){return ps(this.text,e=>xR({try:()=>qb(new URLSearchParams(e)),catch:e=>new HT({request:this.request,response:this,reason:"Decode",cause:e})}))}formDataBody;get formData(){return this.formDataBody??=x4({try:()=>this.source.formData(),catch:e=>new HT({request:this.request,response:this,reason:"Decode",cause:e})}).pipe(Cy,kK)}arrayBufferBody;get arrayBuffer(){return this.arrayBufferBody??=x4({try:()=>this.source.arrayBuffer(),catch:e=>new HT({request:this.request,response:this,reason:"Decode",cause:e})}).pipe(Cy,kK)}}(e,t)=>pR(()=>t(e.status)?pF(e):f9(new HT({response:e,request:e.request,reason:"StatusCode",description:"invalid status code"})));let H4=e=>e.status>=200&&e.status<300?pF(e):f9(new HT({response:e,request:e.request,reason:"StatusCode",description:"non 2xx status code"})),H6=Symbol.for("@effect/platform/HttpClient"),H8=uW("@effect/platform/HttpClient"),H7=nF(Symbol.for("@effect/platform/HttpClient/tracerDisabledWhen"),()=>dl(nx)),H9=nF(Symbol.for("@effect/platform/HttpClient/currentTracerPropagation"),()=>dl(!0)),Ve=uZ()("@effect/platform/HttpClient/SpanNameGenerator",{defaultValue:()=>e=>`http.client ${e.method}`}),Vt={[H6]:H6,pipe(){return iw(this,arguments)},...im,toJSON:()=>({_id:"@effect/platform/HttpClient"}),get(e,t){return this.execute(HD(e,t))},head(e,t){return this.execute(HB(e,t))},post(e,t){return this.execute(H$(e,t))},put(e,t){return this.execute(Hz(e,t))},patch(e,t){return this.execute(HL(e,t))},del(e,t){return this.execute(HU(e,t))},options(e,t){return this.execute(Hq(e,t))}},Vr=(e,t)=>{let r=Object.create(Vt);return r.preprocess=t,r.postprocess=e,r.execute=function(r){return e(t(r))},r},Vn=nF("@effect/platform/HttpClient/responseRegistry",()=>{if("FinalizationRegistry"in globalThis&&globalThis.FinalizationRegistry){let e=new FinalizationRegistry(e=>{e.abort()});return{register(t,r){e.register(t,r,t)},unregister(t){e.unregister(t)}}}let e=new Map;return{register(t,r){e.set(t,setTimeout(()=>r.abort(),5e3))},unregister(t){let r=e.get(t);void 0!==r&&(clearTimeout(r),e.delete(t))}}}),Vi=nF("@effect/platform/HttpClient/scopedRequests",()=>new WeakMap);class Vs{original;controller;constructor(e,t){this.original=e,this.controller=t}[H3]=H3;[Jm]=Jm;applyInterrupt(e){return pR(()=>(Vn.unregister(this.original),pw(e,()=>pI(()=>{this.controller.abort()}))))}get request(){return this.original.request}get status(){return this.original.status}get headers(){return this.original.headers}get cookies(){return this.original.cookies}get remoteAddress(){return this.original.remoteAddress}get formData(){return this.applyInterrupt(this.original.formData)}get text(){return this.applyInterrupt(this.original.text)}get json(){return this.applyInterrupt(this.original.json)}get urlParamsBody(){return this.applyInterrupt(this.original.urlParamsBody)}get arrayBuffer(){return this.applyInterrupt(this.original.arrayBuffer)}get stream(){return BV(()=>(Vn.unregister(this.original),U3(this.original.stream,e=>((e=>{switch(e._tag){case iE:return l9(e.effect_instruction_i0);case iI:return!1}})(e)&&this.controller.abort(),pj))))}toJSON(){return this.original.toJSON()}[ih](){return this.original[ih]()}}let{del:Va,execute:Vo,get:Vl,head:Vu,options:Vc,patch:Vh,post:Vf,put:Vp}=new Proxy({},{get:(e,t,r)=>(...e)=>ps(H8,r=>r[t](...e))}),Vd=nm(2,(e,t)=>Vr(r=>t(e.postprocess(r)),e.preprocess)),Vm=nm(2,(e,t)=>Vr(e.postprocess,r=>px(e.preprocess(r),t))),Vg=e=>Vd(e,ps(H4)),Vb=e=>B5(px(e,e=>e.stream)),Vy=/\+/g,Vx=function(){};Vx.prototype=Object.create(null);let Vv=/^https?:\/\/.*?\//,VS=/(\/:[^/()]*?)\?(\/?)/;class V_{constructor(e={}){this.options={ignoreTrailingSlash:!0,ignoreDuplicateSlashes:!0,caseSensitive:!1,maxParamLength:100,...e}}options;routes=[];trees={};on(e,t,r){let n=t.match(VS);if(n&&void 0!==n.index){VR(t.length===n.index+n[0].length,"Optional Parameter needs to be the last parameter of the path");let i=t.replace(VS,"$1$2"),s=t.replace(VS,"$2");this.on(e,i,r),this.on(e,s,r);return}for(let n of(this.options.ignoreDuplicateSlashes&&(t=VI(t)),this.options.ignoreTrailingSlash&&(t=VT(t)),"string"==typeof e?[e]:e))this._on(n,t,r)}all(e,t){this.on(VM,e,t)}_on(e,t,r){void 0===this.trees[e]&&(this.trees[e]=new VE("/"));let n=t;if("*"===n&&0!==this.trees[e].prefix.length){let t=this.trees[e];this.trees[e]=new VE(""),this.trees[e].staticChildren["/"]=t}let i=this.trees[e].prefix.length,s=this.trees[e],a=[];for(let e=0;e<=n.length;e++){if(58===n.charCodeAt(e)&&58===n.charCodeAt(e+1)){e++;continue}let t=58===n.charCodeAt(e)&&58!==n.charCodeAt(e+1),r=42===n.charCodeAt(e);if(t||r||e===n.length&&e!==i){let t=n.slice(i,e);this.options.caseSensitive||(t=t.toLowerCase()),t=(t=t.split("::").join(":")).split("%").join("%25"),s=s.createStaticChild(t)}if(t){let t=!1,r=[],l=e+1;for(let u=l;;u++){let c=n.charCodeAt(u),h=40===c,f=45===c||46===c,p=47===c||u===n.length;if(h||f||p){let c=n.slice(l,u);if(a.push(c),t=t||h||f,h){var o;let e=function(e,t){let r=1;for(;t<e.length;){if("\\"===e[++t]){t++;continue}if(")"===e[t]?r--:"("===e[t]&&r++,!r)return t}throw TypeError('Invalid regexp expression in "'+e+'"')}(n,u),t=n.slice(u,e+1);r.push((94===(o=t).charCodeAt(1)&&(o=o.slice(0,1)+o.slice(2)),36===o.charCodeAt(o.length-2)&&(o=o.slice(0,o.length-2)+o.slice(o.length-1)),o)),u=e+1}else r.push("(.*?)");let d=u;for(;u<n.length;u++){let e=n.charCodeAt(u);if(47===e)break;if(58===e)if(58===n.charCodeAt(u+1))u++;else break}let m=n.slice(d,u);if(m&&(m=(m=m.split("::").join(":")).split("%").join("%25"),r.push(m.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"))),l=u+1,p||47===n.charCodeAt(u)||u===n.length){let a=t?"()"+m:m,o=n.slice(e,u);n=n.slice(0,e+1)+a+n.slice(u),e+=a.length;let l=t?RegExp("^"+r.join("")+"$"):void 0;s=s.createParametricChild(l,m,o),i=e+1;break}}}}else if(r&&(a.push("*"),s=s.createWildcardChild(),i=e+1,e!==n.length-1))throw Error("Wildcard must be the last character in the route")}for(let t of(this.options.caseSensitive||(n=n.toLowerCase()),"*"===n&&(n="/*"),this.routes))if(t.method===e&&t.pattern===n)throw Error(`Method '${e}' already declared for route '${n}'`);let l={method:e,path:t,pattern:n,params:a,handler:r};this.routes.push(l),s.addRoute(l)}has(e,t){let r=this.trees[e];if(void 0===r)return!1;let n=r.getStaticChild(t);return void 0!==n&&n.isLeafNode}find(e,t){let r,n,i,s=this.trees[e];if(void 0===s)return;47!==t.charCodeAt(0)&&(t=t.replace(Vv,"/")),this.options.ignoreDuplicateSlashes&&(t=VI(t));try{t=(r=function(e){let t=!1,r=!1,n="";for(let i=1;i<e.length;i++){let s=e.charCodeAt(i);if(37===s){let n=e.charCodeAt(i+1),s=e.charCodeAt(i+2);void 0===VA(n,s)?t=!0:(r=!0,50===n&&53===s&&(t=!0,e=e.slice(0,i+1)+"25"+e.slice(i+1),i+=2),i+=2)}else if(63===s||59===s||35===s){n=e.slice(i+1),e=e.slice(0,i);break}}return{path:t?decodeURI(e):e,querystring:n,shouldDecodeParam:r}}(t)).path,n=r.querystring,i=r.shouldDecodeParam}catch(e){return}this.options.ignoreTrailingSlash&&(t=VT(t));let a=t;!1===this.options.caseSensitive&&(t=t.toLowerCase());let o=this.options.maxParamLength,l=s.prefix.length,u=[],c=t.length,h=[];for(;;){if(l===c&&s.isLeafNode){let e=s.handlerStorage?.find();if(void 0!==e)return{handler:e.handler,params:e.createParams(u),searchParams:function(e){let t=new Vx;if("string"!=typeof e)return t;let r=e.length,n="",i="",s=-1,a=-1,o=!1,l=!1,u=!1,c=!1,h=!1,f=0;for(let p=0;p<r+1;p++)if(38===(f=p!==r?e.charCodeAt(p):38)){if((h=a>s)||(a=p),n=e.slice(s+1,a),h||n.length>0){if(u&&(n=n.replace(Vy," ")),o)try{n=decodeURIComponent(n)||n}catch{}if(h&&(i=e.slice(a+1,p),c&&(i=i.replace(Vy," ")),l))try{i=decodeURIComponent(i)||i}catch{}let r=t[n];void 0===r?t[n]=i:r.pop?r.push(i):t[n]=[r,i]}i="",s=p,a=p,o=!1,l=!1,u=!1,c=!1}else 61===f?a<=s?a=p:l=!0:43===f?a>s?c=!0:u=!0:37===f&&(a>s?l=!0:o=!0);return t}(n)}}let e=s.getNextNode(t,l,h,u.length);if(void 0===e){if(0===h.length)return;let t=h.pop();l=t.brotherPathIndex,u.splice(t.paramsCount),e=t.brotherNode}if("StaticNode"===(s=e)._tag){l+=s.prefix.length;continue}if("WildcardNode"===s._tag){let e=a.slice(l);i&&(e=VN(e)),u.push(e),l=c;continue}if("ParametricNode"===s._tag){let e=a.indexOf("/",l);-1===e&&(e=c);let t=a.slice(l,e);if(i&&(t=VN(t)),void 0!==s.regex){let e=s.regex.exec(t);if(null===e)continue;for(let t=1;t<e.length;t++){let r=e[t];if(r.length>o)return;u.push(r)}}else{if(t.length>o)return;u.push(t)}l=e}}}}class Vw{handlers=[];unconstrainedHandler;find(){return this.unconstrainedHandler}add(e){let t={params:e.params,handler:e.handler,createParams:function(e){let t=e.length;return function(r){let n={};for(let i=0;i<t;i++)n[e[i]]=r[i];return n}}(e.params)};this.handlers.push(t),this.unconstrainedHandler=this.handlers[0]}}class Vk{isLeafNode=!1;routes;handlerStorage;addRoute(e){void 0===this.routes?this.routes=[e]:this.routes.push(e),void 0===this.handlerStorage&&(this.handlerStorage=new Vw),this.isLeafNode=!0,this.handlerStorage.add(e)}}class VO extends Vk{staticChildren={};findStaticMatchingChild(e,t){let r=this.staticChildren[e.charAt(t)];if(void 0!==r&&r.matchPrefix(e,t))return r}getStaticChild(e,t=0){if(e.length===t)return this;let r=this.findStaticMatchingChild(e,t);if(void 0!==r)return r.getStaticChild(e,t+r.prefix.length)}createStaticChild(e){if(0===e.length)return this;let t=this.staticChildren[e.charAt(0)];if(t){let r=1;for(;r<t.prefix.length;r++)if(e.charCodeAt(r)!==t.prefix.charCodeAt(r)){t=t.split(this,r);break}return t.createStaticChild(e.slice(r))}let r=e.charAt(0);return this.staticChildren[r]=new VE(e),this.staticChildren[r]}}class VE extends VO{_tag="StaticNode";constructor(e){super(),this.setPrefix(e)}prefix;matchPrefix;parametricChildren=[];wildcardChild;setPrefix(e){if(this.prefix=e,1===e.length)this.matchPrefix=(e,t)=>!0;else{let t=e.length;this.matchPrefix=function(e,r){for(let n=1;n<t;n++)if(e.charCodeAt(r+n)!==this.prefix.charCodeAt(n))return!1;return!0}}}getParametricChild(e){if(void 0===e)return this.parametricChildren.find(e=>!1===e.isRegex);let t=e.source;return this.parametricChildren.find(e=>void 0!==e.regex&&e.regex.source===t)}createParametricChild(e,t,r){let n=this.getParametricChild(e);return void 0!==n?n.nodePaths.add(r):(n=new VC(e,t,r),this.parametricChildren.push(n),this.parametricChildren.sort((e,t)=>e.isRegex?t.isRegex?void 0===e.staticSuffix?1:void 0===t.staticSuffix?-1:t.staticSuffix.endsWith(e.staticSuffix)?1:e.staticSuffix.endsWith(t.staticSuffix)?-1:0:-1:1)),n}createWildcardChild(){return void 0===this.wildcardChild&&(this.wildcardChild=new VF),this.wildcardChild}split(e,t){let r=this.prefix.slice(0,t),n=this.prefix.slice(t);this.setPrefix(n);let i=new VE(r);return i.staticChildren[n.charAt(0)]=this,e.staticChildren[r.charAt(0)]=i,i}getNextNode(e,t,r,n){let i=this.findStaticMatchingChild(e,t),s=0;if(void 0===i){if(0===this.parametricChildren.length)return this.wildcardChild;i=this.parametricChildren[0],s=1}void 0!==this.wildcardChild&&r.push({paramsCount:n,brotherPathIndex:t,brotherNode:this.wildcardChild});for(let e=this.parametricChildren.length-1;e>=s;e--)r.push({paramsCount:n,brotherPathIndex:t,brotherNode:this.parametricChildren[e]});return i}}class VC extends VO{regex;staticSuffix;_tag="ParametricNode";constructor(e,t,r){super(),this.regex=e,this.staticSuffix=t,this.isRegex=!!e,this.nodePaths=new Set([r])}isRegex;nodePaths;getNextNode(e,t){return this.findStaticMatchingChild(e,t)}}class VF extends Vk{_tag="WildcardNode";getNextNode(e,t,r,n){}}let VR=(e,t)=>{if(!e)throw Error(t)};function VI(e){return e.replace(/\/\/+/g,"/")}function VT(e){return e.length>1&&47===e.charCodeAt(e.length-1)?e.slice(0,-1):e}function VA(e,t){return 50===e?53===t?"%":51===t?"#":52===t?"$":54===t?"&":66===t||98===t?"+":67===t||99===t?",":70===t||102===t?"/":void 0:51===e?65===t||97===t?":":66===t||98===t?";":68===t||100===t?"=":70===t||102===t?"?":void 0:52===e&&48===t?"@":void 0}function VN(e){let t=e.indexOf("%");if(-1===t)return e;let r="",n=t;for(let i=t;i<e.length;i++)if(37===e.charCodeAt(i)){let t=VA(e.charCodeAt(i+1),e.charCodeAt(i+2));r+=e.slice(n,i)+t,n=i+3}return e.slice(0,t)+r+e.slice(n)}let VM=["ACL","BIND","CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LINK","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCALENDAR","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REBIND","REPORT","SEARCH","SOURCE","SUBSCRIBE","TRACE","UNBIND","UNLINK","UNLOCK","UNSUBSCRIBE"],Vj=Symbol.for("@effect/platform/Etag/Generator"),VP=uW("@effect/platform/Etag/Generator"),VD=uW("@effect/platform/HttpServer"),V$=nm(e=>fH(e[0]),(e,t)=>Oc(ps(VD,r=>r.serve(e,t))));ps(VD,e=>(e=>ps(H8,t=>{if("UnixAddress"===e._tag)return f4(Error("HttpServer.layerTestClient: UnixAddress not supported"));let r="0.0.0.0"===e.hostname?"127.0.0.1":e.hostname;return pF(Vm(t,HQ(`http://${r}:${e.port}`)))}))(e.address));let Vz=Symbol.for("@effect/platform/HttpRouter"),VL=Symbol.for("@effect/platform/HttpRouter/Route"),VU=Symbol.for("@effect/platform/HttpRouter/RouteContext"),VB=uW("@effect/platform/HttpRouter/RouteContext"),Vq=nF("@effect/platform/HttpRouter/currentRouterConfig",()=>dl({}));class VJ extends bh{routes;mounts;[Vz];constructor(e,t){super(),this.routes=e,this.mounts=t,this[Vz]=Vz,this.httpApp=VH(this).pipe(ps(e=>this.httpApp=e))}httpApp;commit(){return this.httpApp}toJSON(){return{_id:"Router",routes:this.routes.toJSON(),mounts:this.mounts.toJSON()}}toString(){return id(this)}[ih](){return this.toJSON()}}let VH=e=>px(p6(Vq),t=>{let r=((e={})=>new V_(e))(t),n=ov(e.mounts).map(([e,t,r])=>[e,new VK(new VW("*",r?.includePrefix?`${e}/*`:"/*",t,r?.includePrefix?s_():i4(e),!1),{}),r]),i=n.length;return oj(e.routes,e=>{"*"===e.method?r.all(e.path,e):r.on(e.method,e.path,e)}),fV(e=>{let t=uD(new Map(e.getFiberRef(dh).unsafeMap)),s=uJ(t,Hp);if(i>0){let e=s.url.indexOf("?"),r=-1===e?s.url:s.url.slice(0,e);for(let e=0;e<i;e++){let[i,a,o]=n[e];if(r===i||r.startsWith(i+"/"))return t.unsafeMap.set(VB.key,a),o?.includePrefix!==!0&&t.unsafeMap.set(Hp.key,VV(s,i)),ds(ps(a.route.handler,Js),dh,t)}}let a=r.find(s.method,s.url);if(void 0===a&&"HEAD"===s.method&&(a=r.find("GET",s.url)),void 0===a)return f9(new Jp({request:s}));let o=a.handler;"Some"===o.prefix._tag&&t.unsafeMap.set(Hp.key,VV(s,o.prefix.value)),t.unsafeMap.set(Hd.key,a.searchParams),t.unsafeMap.set(VB.key,new VK(o,a.params));let l=uH(t,g$);"Some"===l._tag&&"Span"===l.value._tag&&l.value.attribute("http.route",o.path);let u=ps(o.handler,Js);return ds(o.uninterruptible?u:pb(u),dh,t)})});function VV(e,t){let r=t.length;return e.modify({url:e.url.length<=r?"/":e.url.slice(r)})}class VW extends ig{method;path;handler;prefix;uninterruptible;[VL];constructor(e,t,r,n=s_(),i=!1){super(),this.method=e,this.path=t,this.handler=r,this.prefix=n,this.uninterruptible=i,this[VL]=VL}toJSON(){return{_id:"@effect/platform/HttpRouter/Route",method:this.method,path:this.path,prefix:this.prefix.toJSON()}}}class VK{route;params;[VU];constructor(e,t){this.route=e,this.params=t,this[VU]=VU}}let VG=new VJ(om(),om()),VZ=nm(2,(e,t)=>new VJ(oE(e.routes,t),e.mounts)),VQ=nm(2,(e,t)=>VY(e,t)),VY=(...e)=>new VJ(e.reduce((e,t)=>oT(e,t.routes),om()),e.reduce((e,t)=>oT(e,t.mounts),om())),VX=e=>e.endsWith("/")?e.slice(0,-1):e,V0=nm(2,(e,t)=>(t=VX(t),new VJ(oB(e.routes,e=>new VW(e.method,"/"===e.path?t:t+e.path,e.handler,sO(sA(e.prefix,e=>t+e),()=>i4(t)),e.uninterruptible)),oB(e.mounts,([e,r])=>["/"===e?t:t+e,r])))),V1=nm(3,(e,t,r)=>VQ(e,V0(r,t))),V2=nm(e=>nL(e[0],Vz),(e,t,r,n)=>new VJ(e.routes,oE(e.mounts,[VX(t),r,n]))),V3=e=>nm(e=>nL(e[0],Vz),(t,r,n,i)=>new VJ(oE(t.routes,new VW(e,r,n,s_(),i?.uninterruptible??!1)),t.mounts)),V5=V3("*"),V4=V3("GET"),V6=V3("POST"),V8=V3("PUT"),V7=V3("PATCH"),V9=V3("DELETE"),We=V3("HEAD"),Wt=V3("OPTIONS"),Wr=nm(2,(e,t)=>new VJ(oB(e.routes,e=>new VW(e.method,e.path,t(ps(e.handler,Js)),e.prefix,e.uninterruptible)),oB(e.mounts,([e,r])=>[e,t(r)]))),Wn=((e,t)=>new VJ(oB(e.routes,e=>new VW(e.method,e.path,t(e.handler),e.prefix,e.uninterruptible)),oB(e.mounts,([e,r])=>[e,ps(t(r),Js)])),()=>{let e=VG;return{addRoute:t=>pI(()=>{e=VZ(e,t)}),all:(t,r,n)=>pI(()=>{e=V5(e,t,r,n)}),get:(t,r,n)=>pI(()=>{e=V4(e,t,r,n)}),post:(t,r,n)=>pI(()=>{e=V6(e,t,r,n)}),put:(t,r,n)=>pI(()=>{e=V8(e,t,r,n)}),patch:(t,r,n)=>pI(()=>{e=V7(e,t,r,n)}),del:(t,r,n)=>pI(()=>{e=V9(e,t,r,n)}),head:(t,r,n)=>pI(()=>{e=We(e,t,r,n)}),options:(t,r,n)=>pI(()=>{e=Wt(e,t,r,n)}),router:pI(()=>e),mount:(t,r)=>pI(()=>{e=V1(e,t,r)}),mountApp:(t,r,n)=>pI(()=>{e=V2(e,t,r,n)}),concat:t=>pI(()=>{e=VQ(e,t)})}}),Wi=Symbol.for("@effect/matcher/Matcher"),Ws={[Wi]:{_input:ng,_filters:ng,_remaining:ng,_result:ng,_return:ng},_tag:"TypeMatcher",add(e){return function(e){let t=Object.create(Ws);return t.cases=e,t}([...this.cases,e])},pipe(){return iw(this,arguments)}},Wa={[Wi]:{_input:ng,_filters:ng,_remaining:ng,_result:ng,_provided:ng,_return:ng},_tag:"ValueMatcher",add(e){return"Right"===this.value._tag?this:"When"===e._tag&&!0===e.guard(this.provided)||"Not"===e._tag&&!1===e.guard(this.provided)?Wo(this.provided,si(e.evaluate(this.provided))):this},pipe(){return iw(this,arguments)}};function Wo(e,t){let r=Object.create(Wa);return r.provided=e,r.value=t,r}let Wl=(e,t)=>({_tag:"When",guard:e,evaluate:t}),Wu=e=>{if("function"==typeof e)return e;if(Array.isArray(e)){let t=e.map(Wu),r=t.length;return e=>{if(!Array.isArray(e))return!1;for(let n=0;n<r;n++)if(!1===t[n](e[n]))return!1;return!0}}if(null!==e&&"object"==typeof e){let t=Object.entries(e).map(([e,t])=>[e,Wu(t)]),r=t.length;return e=>{if("object"!=typeof e||null===e)return!1;for(let n=0;n<r;n++){let[r,i]=t[n];if(!(r in e)||!1===i(e[r]))return!1}return!0}}return t=>t===e},Wc=e=>{if("ValueMatcher"===e._tag)return e.value;let t=e.cases.length;if(1===t){let t=e.cases[0];return e=>"When"===t._tag&&!0===t.guard(e)||"Not"===t._tag&&!1===t.guard(e)?si(t.evaluate(e)):sn(e)}return r=>{for(let n=0;n<t;n++){let t=e.cases[n];if("When"===t._tag&&!0===t.guard(r)||"Not"===t._tag&&!1===t.guard(r))return si(t.evaluate(r))}return sn(r)}},Wh=(e,t)=>r=>r.add(Wl(Wu(e),t));e.s(["LoggerTypeId",()=>Wp,"add",()=>Wm,"addEffect",()=>Wg,"addScoped",()=>Wb,"batched",()=>W_,"defaultLogger",()=>WL,"filterLogLevel",()=>Wv,"isLogger",()=>WX,"json",()=>WK,"jsonLogger",()=>WU,"logFmt",()=>WG,"logfmtLogger",()=>WB,"make",()=>Wd,"map",()=>WS,"mapInput",()=>Wy,"mapInputOptions",()=>Wx,"minimumLogLevel",()=>WY,"none",()=>WE,"pretty",()=>WZ,"prettyLogger",()=>WJ,"prettyLoggerDefault",()=>WH,"remove",()=>WC,"replace",()=>WF,"replaceEffect",()=>WR,"replaceScoped",()=>WI,"simple",()=>WT,"stringLogger",()=>Wq,"structured",()=>WQ,"structuredLogger",()=>WV,"succeed",()=>WA,"sync",()=>WN,"test",()=>WM,"tracerLogger",()=>WW,"withConsoleError",()=>WO,"withConsoleLog",()=>Ww,"withLeveledConsole",()=>Wk,"withMinimumLogLevel",()=>Wj,"withSpanAnnotations",()=>WP,"zip",()=>WD,"zipLeft",()=>W$,"zipRight",()=>Wz],28355);let Wf=nm(2,(e,t)=>e.log({fiberId:cP,logLevel:pX,message:t,cause:l1,context:bb(),spans:c8(),annotations:lu,date:new Date})),Wp=v_,Wd=vk,Wm=CI,Wg=CT,Wb=CA,Wy=vO,Wx=vE,Wv=vC,WS=vF,W_=wu,Ww=wt,Wk=e=>vk(t=>{let r=uJ(bO(t.context,gH),gI).unsafe;switch(t.logLevel._tag){case"Debug":return r.debug(e.log(t));case"Info":return r.info(e.log(t));case"Trace":return r.trace(e.log(t));case"Warning":return r.warn(e.log(t));case"Error":case"Fatal":return r.error(e.log(t));default:return r.log(e.log(t))}}),WO=e=>vk(t=>{uJ(bO(t.context,gH),gI).unsafe.error(e.log(t))}),WE={[v_]:vw,log:nv,pipe(){return iw(this,arguments)}},WC=CN,WF=CM,WR=Cj,WI=CP,WT=vR,WA=e=>vR(()=>e),WN=e=>vR(e),WM=Wf,Wj=CR,WP=e=>vE(e,e=>{let t=sN(bk(e.context,dh),uH(g$));return"None"===t._tag?e:{...e,annotations:nS(e.annotations,ld("effect.traceId",t.value.traceId),ld("effect.spanId",t.value.spanId),"Span"===t.value._tag?ld("effect.spanName",t.value.name):ng)}}),WD=vI,W$=vT,Wz=vA,WL=wr,WU=vz,WB=vP,Wq=vj,WJ=vG,WH=vY,WV=vD,WW=wo,WK=WF(wr,wn),WG=WF(wr,wi),WZ=WF(wr,ws),WQ=WF(wr,wa),WY=e=>Oc(wz(we,e)),WX=e=>"object"==typeof e&&null!=e&&v_ in e;var W0=e.i(28355);let W1="@effect/platform/FetchHttpClient/Fetch",W2=(e=>Vr(t=>ps(t,t=>fV(r=>{let n=Vi.get(t),i=n??new AbortController,s=((e,t,r)=>{try{let n=new URL(e,(()=>{if("location"in globalThis&&void 0!==globalThis.location&&void 0!==globalThis.location.origin&&void 0!==globalThis.location.pathname)return location.origin+location.pathname})());for(let e=0;e<t.length;e++){let[r,i]=t[e];void 0!==i&&n.searchParams.append(r,i)}return"Some"===r._tag&&(n.hash=r.value),si(n)}catch(e){return sn(e)}})(t.url,t.urlParams,t.hash);if("Left"===s._tag)return f9(new HI({request:t,reason:"InvalidUrl",cause:s.left}));let a=s.right;if(!r.getFiberRef(dO)||r.getFiberRef(H7)(t)){let s=e(t,a,i.signal,r);return n?s:pM(e=>pc(e(s),{onSuccess:e=>(Vn.register(e,i),pF(new Vs(e,i))),onFailure:e=>(l9(e)&&i.abort(),pt(e))}))}return vt(uJ(r.currentContext,Ve)(t),{kind:"client",captureStackTrace:!1},s=>{s.attribute("http.request.method",t.method),s.attribute("server.address",a.origin),""!==a.port&&s.attribute("server.port",+a.port),s.attribute("url.full",a.toString()),s.attribute("url.path",a.pathname),s.attribute("url.scheme",a.protocol.slice(0,-1));let o=a.search.slice(1);""!==o&&s.attribute("url.query",o);let l=r.getFiberRef(q2),u=q1(t.headers,l);for(let e in u)s.attribute(HC(e),String(u[e]));return t=r.getFiberRef(H9)?HV(t,(e=>Object.setPrototypeOf({b3:`${e.traceId}-${e.spanId}-${e.sampled?"1":"0"}${"Some"===e.parent._tag?`-${e.parent.value.spanId}`:""}`,traceparent:`00-${e.traceId}-${e.spanId}-${e.sampled?"01":"00"}`},qW))(s)):t,pM(o=>o(e(t,a,i.signal,r)).pipe(vr(s),pc({onSuccess:e=>{s.attribute("http.response.status_code",e.status);let t=q1(e.headers,l);for(let e in t)s.attribute(HF(e),String(t[e]));return n?pF(e):(Vn.register(e,i),pF(new Vs(e,i)))},onFailure:e=>(!n&&l9(e)&&i.abort(),pt(e))})))})})),pF))((e,t,r,n)=>{let i=n.getFiberRef(dh),s=i.unsafeMap.get(W1)??globalThis.fetch,a=i.unsafeMap.get("@effect/platform/FetchHttpClient/FetchOptions")??{},o=a.headers?qX(qZ(a.headers),e.headers):e.headers,l=n=>px(x4({try:()=>s(t,{...a,method:e.method,headers:o,body:n,duplex:"Stream"===e.body._tag?"half":void 0,signal:r}),catch:t=>new HI({request:e,reason:"Transport",cause:t})}),t=>new H5(e,t));switch(e.body._tag){case"Raw":case"Uint8Array":return l(e.body.body);case"FormData":return l(e.body.formData);case"Stream":return ps(B1(e.body.stream),l)}return l(void 0)}),W3=(u=pF(W2),Or(H8,ps(mx,e=>px(u,t=>Vd(t,mw(t=>uV(e,t)))))));class W5 extends uG(W1)(){}function W4(e,t){return ps(e.runtimeEffect,e=>fV(r=>(r.setFiberRefs(e.fiberRefs),r.currentRuntimeFlags=e.runtimeFlags,mS(t,e.context))))}let W6={...iV,[kO]:kO,pipe(){return iw(this,arguments)},commit(){return this.runtimeEffect}},W8={get url(){return`file://${e.P("node_modules/uploadthing/dist/upload-builder-BlFOAnsv.js")}`}},W7=gh().pipe(gy(()=>gf(new Map(Object.entries(Object.fromEntries(Object.entries(W8?.env??{}).filter(e=>null!=e[1])))),{pathDelim:"_"})),gb("uploadthing"),e=>gm(e,gi)),W9=(e=>{let t=g9("a boolean property",e=>{switch(e){case"true":case"yes":case"on":case"1":return si(!0);case"false":case"no":case"off":case"0":return si(!1);default:return sn(mP([],`Expected a boolean value but received ${e}`))}});return void 0===e?t:g6(t,e)})("isDev").pipe(g8(()=>bt("undefined"!=typeof process?"production":void 0).pipe(g3(e=>"development"===e))),bn(!1)),Ke=((e,t)=>{let r,n=AU(t.ast,!0,r);return be(e).pipe(g4(e=>n(e).pipe(so(e=>mP([],A8.formatIssueSync(e))))))})("token",jM).pipe(xA({ConfigError:e=>new nh({code:"InvalidData"===e._op?"INVALID_SERVER_CONFIG":"MISSING_ENV",message:"InvalidData"===e._op?"Invalid token. A token is a base64 encoded JSON object matching { apiKey: string, appId: string, regions: string[] }.":"Missing token. Please set the `UPLOADTHING_TOKEN` environment variable or provide a token manually through config.",cause:e})}));be("apiUrl").pipe(bn("https://api.uploadthing.com"),g5(e=>new URL(e)),g3(e=>e.href.replace(/\/$/,"")));let Kt=CE(function*(e){let{regions:t,ingestHost:r}=yield*Ke,n=e?t.find(t=>t===e)??t[0]:t[0];return yield*be("ingestUrl").pipe(bn(`https://${n}.${r}`),g5(e=>new URL(e)),g3(e=>e.href.replace(/\/$/,"")))});function Kr(e){return{message:e.message}}function Kn(e,t){let r=Object.keys(t)[0];return(r?t[r]?.errorFormatter??Kr:Kr)(e)}be("utfsHost").pipe(bn("utfs.io")),be("ufsHost").pipe(bn("ufs.sh")),bi("subdomain","path")("ufsAppIdLocation").pipe(bn("subdomain"));let Ki=(e=>{let t=g4(be(),e=>{let t=p3.find(t=>t._tag===e);return void 0===t?sn(mP([],`Expected a log level but received ${e}`)):si(t)});return void 0===e?t:g6(t,e)})("logLevel").pipe(bn(pX),pa(e=>W0.minimumLogLevel(e)),x3(e=>xH("Invalid log level").pipe(xC("error",e))),xT("ConfigError",e=>new nh({code:"INVALID_SERVER_CONFIG",message:"Invalid server configuration",cause:e})),Ov),Ks=bi("json","logFmt","structured","pretty")("logFormat"),Ka=Cx(function*(){let e=yield*W9;return W0[yield*Ks.pipe(bn(e?"pretty":"json"))]}).pipe(xT("ConfigError",e=>new nh({code:"INVALID_SERVER_CONFIG",message:"Invalid server configuration",cause:e})),Ov),Ko=(e,t)=>{let r=t?.mixin??"json",n=bG(t?.level??"Debug");return t=>ps("None"!==r?t[r]:pj,()=>((e,...t)=>xL(e)(...t))(n,`${e} (${t.status})`).pipe(xC("response",t)))},Kl=e=>t=>"ResponseError"===t._tag?Ko(e,{level:"Error"})(t.response):xH(e).pipe(xC("error",t));var Ku=class extends ba("ParserError"){message="Input validation failed. The original error with it's validation issues is in the error cause."},Kc=class extends bs{_tag="FileSizeMismatch";name="FileSizeMismatchError";constructor(e,t,r){super({reason:`You uploaded a ${e} file that was ${(e=>{if(0===e||-1===e)return"0B";let t=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,t)).toFixed(2)}${na[t]}`})(r)}, but the limit for that type is ${t}`})}},Kh=class extends bs{_tag="FileCountMismatch";name="FileCountMismatchError";constructor(e,t,r,n){super({reason:`You uploaded ${n} file(s) of type '${e}', but the ${t} for that type is ${r}`})}};let Kf=Symbol("uploadthing-region-symbol"),Kp=Symbol("uploadthing-custom-id-symbol");var Kd=class extends uG("uploadthing/AdapterArguments")(){};let Km=e=>Cx(function*(){let{uploadable:t}=e,r=yield*Hp,{apiKey:n}=yield*Ke,i=yield*nd((yield*r.text),r.headers["x-uploadthing-signature"]??null,n);if(yield*xB(`Signature verified: ${i}`),!i)return yield*xH("Invalid signature"),yield*new nh({code:"BAD_REQUEST",message:"Invalid signature"});let s=yield*Hg(Ml({fileKey:N$,error:N$}));yield*xB("Handling error callback request with input:").pipe(xC("json",s));let a=yield*Kd;return{body:null,fiber:yield*x4({try:async()=>t.onUploadError({...a,error:new nh({code:"UPLOAD_FAILED",message:`Upload failed for ${s.fileKey}: ${s.error}`}),fileKey:s.fileKey}),catch:e=>new nh({code:"INTERNAL_SERVER_ERROR",message:"Failed to run onUploadError",cause:e})}).pipe(x3(e=>xH("Failed to run onUploadError. You probably shouldn't be throwing errors here.").pipe(xC("error",e)))).pipe(CS,wb)}}).pipe(xV("handleErrorRequest")),Kg=e=>Cx(function*(){let t,{uploadable:r,fePackage:n,beAdapter:i}=e,s=yield*Hp,{apiKey:a}=yield*Ke,o=yield*nd((yield*s.text),s.headers["x-uploadthing-signature"]??null,a);if(yield*xB(`Signature verified: ${o}`),!o)return yield*xH("Invalid signature"),yield*new nh({code:"BAD_REQUEST",message:"Invalid signature"});let l=yield*Hg(Ml({status:N$,file:jD,origin:N$,metadata:function e(t,r,n){return class extends Mo({},[{key:t,value:r}],n){static annotations(n){return e(t,r,N_(this.ast,n))}static key=t;static value=r}}((t={key:N$,value:Nj}).key,t.value)}));return yield*xB("Handling callback request with input:").pipe(xC("json",l)),{body:null,fiber:yield*Cx(function*(){let e=yield*Kd,t=yield*x4({try:async()=>r.onUploadComplete({...e,file:{...l.file,get url(){return M("`file.url` is deprecated and will be removed in uploadthing v9. Use `file.ufsUrl` instead."),l.file.url},get appUrl(){return M("`file.appUrl` is deprecated and will be removed in uploadthing v9. Use `file.ufsUrl` instead."),l.file.appUrl}},metadata:l.metadata}),catch:e=>new nh({code:"INTERNAL_SERVER_ERROR",message:"Failed to run onUploadComplete. You probably shouldn't be throwing errors here.",cause:e})}),s={fileKey:l.file.key,callbackData:t??null};yield*xB("'onUploadComplete' callback finished. Sending response to UploadThing:").pipe(xC("callbackData",s));let o=(yield*H8).pipe(Vg);yield*H$("/callback-result").pipe(HQ(l.origin),HV({"x-uploadthing-api-key":Np(a),"x-uploadthing-version":N,"x-uploadthing-be-adapter":i,"x-uploadthing-fe-package":n}),H2(s),ps(o.execute),x3(Kl("Failed to register callback result")),ps(Jg(jL)),pT(xU("Sent callback result to UploadThing")),C_)}).pipe(CS,wb)}}).pipe(xV("handleCallbackRequest")),Kb=e=>Cx(function*(){let t,r,n=(yield*H8).pipe(Vg),{uploadable:i,fePackage:s,beAdapter:a,slug:o}=e,l=yield*Hg(jU);yield*xB("Handling upload request").pipe(xC("json",l)),yield*xB("Parsing user input");let u=yield*x4({try:()=>(function(e){if("parseAsync"in e&&"function"==typeof e.parseAsync)return e.parseAsync;if(NE(e))return t=>((e,t)=>{let r=NO(e,t);return(e,t)=>kV(r(e,t))})(e)(t).catch(e=>{throw new Ku({cause:mC(e[kM])})});if("~standard"in e)return async t=>{let r=await e["~standard"].validate(t);if(r.issues)throw new Ku({cause:r.issues});return r.value};throw Error("Invalid parser")})(i.inputParser)(l.input),catch:e=>new nh({code:"BAD_REQUEST",message:"Invalid input",cause:e})});yield*xB("Input parsed successfully").pipe(xC("input",u));let{metadata:c,filesWithCustomIds:h,preferredRegion:f}=yield*(t={json:{input:u,files:l.files},uploadable:i},Cx(function*(){let{json:{files:e,input:r},uploadable:n}=t;yield*xB("Running middleware");let i=yield*Kd,s=yield*x4({try:async()=>n.middleware({...i,input:r,files:e}),catch:e=>e instanceof nh?e:new nh({code:"INTERNAL_SERVER_ERROR",message:"Failed to run middleware",cause:e})});if(s[Kp]&&s[Kp].length!==e.length){let t=`Expected files override to have the same length as original files, got ${s[Kp].length} but expected ${e.length}`;return yield*xH(t),yield*new nh({code:"BAD_REQUEST",message:"Files override must have the same length as files",cause:t})}let a=yield*wp(e,(e,t)=>Cx(function*(){let r=s[Kp]?.[t];return r&&r.size!==e.size&&(yield*xJ("File size mismatch. Reverting to original size")),{name:r?.name??e.name,size:e.size,type:e.type,customId:r?.customId,lastModified:r?.lastModified??Date.now()}}));return{metadata:s,filesWithCustomIds:a,preferredRegion:s[Kf]}}).pipe(xV("runRouteMiddleware")));yield*xB("Parsing route config").pipe(xC("routerConfig",i.routerConfig));let p=yield*ni(i.routerConfig).pipe(xT("InvalidRouteConfig",e=>new nh({code:"BAD_REQUEST",message:"Invalid route config",cause:e})));yield*xB("Route config parsed successfully").pipe(xC("routeConfig",p)),yield*xB("Validating files meet the config requirements").pipe(xC("files",l.files)),yield*(r=l.files,Cx(function*(){let e={};for(let t of r){let r=yield*ns(t,nl(p));e[r]=(e[r]??0)+1;let n=p[r]?.maxFileSize;if(!n)return yield*new r9(r,"maxFileSize");let i=yield*no(n);if(t.size>i)return yield*new Kc(r,n,t.size)}for(let t in e){let r=p[t];if(!r)return yield*new r9(t);let n=e[t],i=r.minFileCount,s=r.maxFileCount;if(i>s)return yield*new nh({code:"BAD_REQUEST",message:"Invalid config during file count - minFileCount > maxFileCount",cause:`minFileCount must be less than maxFileCount for key ${t}. got: ${i} > ${s}`});if(null!=n&&n<i)return yield*new Kh(t,"minimum",i,n);if(null!=n&&n>s)return yield*new Kh(t,"maximum",s,n)}return null})).pipe(pS(e=>new nh({code:"BAD_REQUEST",message:`Invalid config: ${e._tag}`,cause:"reason"in e?e.reason:e.message}))),yield*xB("Files validated.");let d=yield*wp(h,e=>px(ns(e,nl(p)),t=>({name:e.name,size:e.size,type:e.type||t,lastModified:e.lastModified,customId:e.customId,contentDisposition:p[t]?.contentDisposition??"inline",acl:p[t]?.acl}))).pipe(xA({InvalidFileType:e=>f4(e),UnknownFileType:e=>f4(e)})),m=i.routeOptions,{apiKey:g,appId:b}=yield*Ke,y=yield*Kt(f),x=yield*W9;yield*xB("Generating presigned URLs").pipe(xC("fileUploadRequests",d),xC("ingestUrl",y));let v=yield*wp(d,e=>Cx(function*(){let t,r,n,i=yield*(t=m.getFileHashParts,t1(()=>{let r=JSON.stringify(t?.(e)??[e.name,e.size,e.type,e.lastModified,Date.now()]),n=function(e,t){let r,n,i=e.split(""),s=en(t);for(let e=0;e<i.length;e++)n=(s%(e+1)+e)%i.length,r=i[e],i[e]=i[n],i[n]=r;return i.join("")}(r8.alphabet,b),i=new r7({alphabet:n,minLength:36}).encode([Math.abs(en(r))]);return new r7({alphabet:n,minLength:12}).encode([Math.abs(en(b))])+i}).pipe(rR("generateKey")));return{url:yield*(r=`${y}/${i}`,n={ttlInSeconds:m.presignedURLTTL,data:{"x-ut-identifier":b,"x-ut-file-name":e.name,"x-ut-file-size":e.size,"x-ut-file-type":e.type,"x-ut-slug":o,"x-ut-custom-id":e.customId,"x-ut-content-disposition":e.contentDisposition,"x-ut-acl":e.acl}},rt(function*(){let e,t=new URL(r),i=n.ttlInSeconds?function(e){if("number"==typeof e)return e;let t=e.split(/(\d+)/).filter(Boolean);return Number(t[0])*({s:1,m:60,h:3600,d:86400})[(t[1]??"s").trim().slice(0,1)]}(n.ttlInSeconds):3600,s=Date.now()+1e3*i;t.searchParams.append("expires",s.toString()),n.data&&Object.entries(n.data).forEach(([e,r])=>{if(null==r)return;let n=encodeURIComponent(r);t.searchParams.append(e,n)});let a=yield*(e=t.toString(),rt(function*(){let t=yield*t6({try:()=>crypto.subtle.importKey("raw",np.encode(r6(g)),nf,!1,["sign"]),catch:e=>new nh({code:"BAD_REQUEST",message:"Invalid signing secret",cause:e})}),r=yield*ru(t6({try:()=>crypto.subtle.sign(nf,t,np.encode(e)),catch:e=>new nh({code:"BAD_REQUEST",cause:e})}),e=>{let t;return"string"==typeof(t=new Uint8Array(e))?r2(r1.encode(t)):r2(t)});return`hmac-sha256=${r}`}).pipe(rR("signPayload")));return t.searchParams.append("signature",a),t.href}).pipe(rR("generateSignedURL"))),key:i}}),{concurrency:"unbounded"}),S=yield*Hp,_=yield*Hb(S),w=yield*be("callbackUrl").pipe(bn(_.origin+_.pathname),px(e=>H$(e).pipe(HY("slug",o)))),k=H$("/route-metadata").pipe(HQ(y),HV({"x-uploadthing-api-key":Np(g),"x-uploadthing-version":N,"x-uploadthing-be-adapter":a,"x-uploadthing-fe-package":s}),H2({fileKeys:v.map(({key:e})=>e),metadata:c,isDev:x,callbackUrl:w.url,callbackSlug:o,awaitServerData:m.awaitServerData??!0}),ps(n.execute)),O=CE("handleDevStreamError")(function*(e,t){let r=ML(Ml({file:jD})),i=(yield*NO(r)(t)).file.key;yield*xH("Failed to forward callback request from dev stream").pipe(xC({fileKey:i,error:e.message}));let o=yield*H$("/callback-result").pipe(HQ(y),HV({"x-uploadthing-api-key":Np(g),"x-uploadthing-version":N,"x-uploadthing-be-adapter":a,"x-uploadthing-fe-package":s}),H2({fileKey:i,error:`Failed to forward callback request from dev stream: ${e.message}`}),ps(n.execute));yield*Ko("Reported callback error to UploadThing")(o)}),E=yield*pd(x,{onTrue:()=>{let e;return k.pipe(x1({onSuccess:Ko("Registered metadata",{mixin:"None"}),onFailure:Kl("Failed to register metadata")}),Vb,(e=e=>w.pipe(HV({"uploadthing-hook":e.hook,"x-uploadthing-signature":e.signature}),H1(qC(e.payload,"application/json")),n.execute,pT(Ko("Successfully forwarded callback request from dev stream")),xT("ResponseError",t=>O(t,e.payload)),xC(e),fG,CS,C_),t=>{let r="";return t.pipe(B9(),qn(e=>Cx(function*(){let t=(r+=e).split("\n"),n=[];for(let e of t)try{n.push(JSON.parse(e)),r=r.slice(e.length+1)}catch{}return yield*xB("Received chunks").pipe(xC("chunk",e),xC("parsedChunks",n),xC("buf",r)),n})),qn(NO(NG(j$))),qn(wp(t=>e(t))),ql,xV("handleJsonLineStream"))}))},onFalse:()=>k.pipe(x1({onSuccess:Ko("Registered metadata"),onFailure:Kl("Failed to register metadata")}),ps(Jg(jz)),C_)}).pipe(wb),C=v.map((e,t)=>({url:e.url,key:e.key,name:d[t].name,customId:d[t].customId??null}));return yield*xq("Sending presigned URLs to client").pipe(xC("presignedUrls",C)),{body:C,fiber:E}}).pipe(xV("handleUploadAction"));e.i(73730);var Ky=e.i(79898),Ky=Ky;e.i(51783);var Kx=e.i(79509),Kv=e.i(29173);let KS=globalThis.prisma||new Kv.PrismaClient;var Ky=Ky;let K_=async()=>{let{getUser:e}=(0,Ky.default)(),t=await e();if(!t)return null;let r=await KS.user.findUnique({where:{id:t.id}});if(!r)return console.log("syncUser: user not found in DB, skipping."),t;let n=t.picture&&!t.picture.includes("gravatar.com")?t.picture:null;return r.image!==n&&(await KS.user.update({where:{id:t.id},data:{image:n}}),console.log("syncUser: updated image for",t.id)),t},Kw=async()=>{try{let{isAuthenticated:e,getUser:t}=(0,Ky.default)(),r=await e();return r||(0,Kx.redirect)("/api/auth/login"),{user:await K_(),isUserAuthenticated:r}}catch(e){console.error("Error in userRequired:",e),(0,Kx.redirect)("/api/auth/login")}},Kk=(e=>(t,r)=>(function e(t={}){let r={$types:{},routerConfig:{image:{maxFileSize:"4MB"}},routeOptions:{awaitServerData:!0},inputParser:{parseAsync:()=>Promise.resolve(void 0),_input:void 0,_output:void 0},middleware:()=>({}),onUploadError:()=>{},onUploadComplete:()=>void 0,errorFormatter:t.errorFormatter??Kr,...t};return{input:t=>e({...r,inputParser:t}),middleware:t=>e({...r,middleware:t}),onUploadComplete:e=>({...r,onUploadComplete:e}),onUploadError:t=>e({...r,onUploadError:t})}})({routerConfig:t,routeOptions:r??{},...e}))(),{GET:KO,POST:KE}=(e=>{let t=((e,t,r,n)=>{let i=((e,t)=>((e,t)=>{let r;t=t??k3();let n=kK(wP()),i=fV(i=>(r||(r=kH(pT(wD(Og(e,t),n),e=>{s.cachedRuntime=e}),{scope:n,scheduler:i.currentScheduler})),pl(r.await))),s=Object.assign(Object.create(W6),{memoMap:t,scope:n,runtimeEffect:i,cachedRuntime:void 0,runtime:()=>void 0===s.cachedRuntime?kV(s.runtimeEffect):Promise.resolve(s.cachedRuntime),dispose:()=>kV(s.disposeEffect),disposeEffect:pR(()=>(s.runtimeEffect=f4("ManagedRuntime disposed"),s.cachedRuntime=void 0,dN(s.scope,mn))),runFork:(e,t)=>void 0===s.cachedRuntime?kH(W4(s,e),t):kR(s.cachedRuntime)(e,t),runSyncExit:e=>void 0===s.cachedRuntime?kG(W4(s,e)):k$(s.cachedRuntime)(e),runSync:e=>void 0===s.cachedRuntime?kK(W4(s,e)):kT(s.cachedRuntime)(e),runPromiseExit:(e,t)=>void 0===s.cachedRuntime?kW(W4(s,e),t):kL(s.cachedRuntime)(e,t),runCallback:(e,t)=>void 0===s.cachedRuntime?kI(kJ)(W4(s,e),t):kI(s.cachedRuntime)(e,t),runPromise:(e,t)=>void 0===s.cachedRuntime?kV(W4(s,e),t):kz(s.cachedRuntime)(e,t)});return s})(Ob(Ol(Ka,Ki,Oy(W3,Of(W5,e)),On(px(de(q2,e=>e.concat(["x-uploadthing-api-key"])),()=>uz))),Oc(wL(gH,uU(go,gf(new Map(aF((e=>{let t=(e,t)=>"string"==typeof t?sY([e,t]):"number"==typeof t||"boolean"==typeof t?sY([e,String(t)]):s7(t)?r(e,t):"object"==typeof t&&null!==t?n(e,t):aE(),r=(e,r)=>s3(r,{onEmpty:()=>sY([e,"<nil>"]),onNonEmpty:aR((r,n)=>t(s6(e,{_tag:"KeyIndex",index:n}),r))}),n=(e,r)=>Object.entries(r).filter(([,e])=>nB(e)).flatMap(([r,n])=>{let i=s6(e,{_tag:"KeyName",name:r}),s=t(i,n);return 0===s.length?sY([i,""]):s});return n(aE(),e)})(t??{}),([e,t])=>[(e=>{let t=[],r=0;for(;r<e.length;){let n=e[r];if("KeyName"===n._tag)if(r+1<e.length){let i=e[r+1];"KeyIndex"===i._tag?(t.push(`${n.name}[${i.index}]`),r+=2):(t.push(n.name),r+=1)}else t.push(n.name),r+=1}return t})(e).join("\uFEFF"),t])),{pathDelim:"\uFEFF",seqDelim:"\uFEFF"}).pipe(gy(()=>W7))))))))(r.config?.fetch,r.config),s=Cv(()=>i.runtime().then(HE));return async(...a)=>await s.pipe(Ck(((...t)=>px(Cv(()=>i.runPromise(((e,t)=>Cx(function*(){let r,n=yield*W9,i=yield*wp(nl(r=e.router),e=>px(ni(r[e].routerConfig),t=>({slug:e,config:t}))),s=e.config?.handleDaemonPromise?e.config.handleDaemonPromise:n?"void":"await";if(n&&"await"===s)return yield*new nh({code:"INVALID_SERVER_CONFIG",message:'handleDaemonPromise: "await" is forbidden in development.'});let a=Cx(function*(){return yield*Je(i)}),o=Cx(function*(){var r;let n,i,{"uploadthing-hook":a,"x-uploadthing-package":o,"x-uploadthing-version":l}=yield*ps(Hp,((e,t)=>{let r=NO(e,t);return e=>r(e.headers)})(Ml({"uploadthing-hook":jT.pipe(Mn),"x-uploadthing-package":N$.pipe(Mi({default:()=>"unknown"})),"x-uploadthing-version":N$.pipe(Mi({default:()=>N}))}),r));l!==N&&(yield*xJ("Client version mismatch. Things may not work as expected, please sync your versions to ensure compatibility.").pipe(xC({clientVersion:l,serverVersion:N})));let{slug:u,actionType:c}=yield*((e,t)=>{let r=NO(e,t);return ps(mx,e=>{let t=uJ(e,Hd),n=uJ(e,VB);return r({...t,...n.params})})})(Ml({actionType:jI.pipe(Mn),slug:N$})),h=e.router[u];if(!h){let e=`No file route found for slug ${u}`;return yield*xH(e),yield*new nh({code:"NOT_FOUND",message:e})}let{body:f,fiber:p}=yield*Wo(n={actionType:c,uploadthingHook:a},sn(n)).pipe(Wh({actionType:"upload",uploadthingHook:void 0},()=>Kb({uploadable:h,fePackage:o,beAdapter:t,slug:u})),Wh({actionType:void 0,uploadthingHook:"callback"},()=>Kg({uploadable:h,fePackage:o,beAdapter:t})),Wh({actionType:void 0,uploadthingHook:"error"},()=>Km({uploadable:h})),(i=()=>pF({body:null,fiber:null}),e=>{let t=Wc(e);return se(t)?"Right"===t._tag?t.right:i(t.left):e=>{let r=t(e);return"Right"===r._tag?r.right:i(r.left)}}));return p&&(yield*xB("Running fiber as daemon").pipe(xC("handleDaemon",s)),"void"===s||("await"===s?yield*p.await:"function"==typeof s&&s(kV(p.await)))),yield*xB("Sending response").pipe(xC("body",f)),yield*Je(f)}).pipe(xA({ParseError:t=>Je(Kn(new nh({code:"BAD_REQUEST",message:"Invalid input",cause:t.message}),e.router),{status:400}),UploadThingError:t=>Je(Kn(t,e.router),{status:nc[t.code]})})),l=px(q7("x-uploadthing-version",N));return VG.pipe(V4("*",a),V6("*",o),Wr(l))}).pipe(xV("createRequestHandler")))(r,n??"custom"))),xQ(Kd,e(...t))))(...a)),Ck(t(...a)),xV("requestHandler"),i.runPromise)})(e=>pF({req:e}),e=>pF(e),e,"nextjs-app");return{POST:t,GET:t}})({router:{imageUploader:Kk({image:{maxFileSize:"1MB",maxFileCount:3}}).middleware(async({req:e})=>{let{user:t}=await Kw();if(!t)throw new nh("Unauthorized");return{userId:t.id}}).onUploadComplete(async({metadata:e,file:t})=>(console.log("Upload complete for userId:",e.userId),console.log("file url",t.ufsUrl),{uploadedBy:e.userId})),documentUploader:Kk({"application/pdf":{maxFileSize:"1MB",maxFileCount:3}}).middleware(async({req:e})=>{let{user:t}=await Kw();if(!t)throw new nh("Unauthorized");return{userId:t.id}}).onUploadComplete(async({metadata:e,file:t})=>(console.log("Upload complete for userId:",e.userId),console.log("file url",t.ufsUrl),{uploadedBy:e.userId}))}});var KC=e.i(44838);let KF=new b.AppRouteRouteModule({definition:{kind:y.RouteKind.APP_ROUTE,page:"/api/uploadthing/route",pathname:"/api/uploadthing",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/uploadthing/route.ts",nextConfigOutput:"",userland:KC}),{workAsyncStorage:KR,workUnitAsyncStorage:KI,serverHooks:KT}=KF;function KA(){return(0,x.patchFetch)({workAsyncStorage:KR,workUnitAsyncStorage:KI})}async function KN(e,t,r){var n;let i="/api/uploadthing/route";i=i.replace(/\/index$/,"")||"/";let s=await KF.prepare(e,t,{srcPage:i,multiZoneDraftMode:!1});if(!s)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:a,params:o,nextConfig:l,isDraftMode:u,prerenderManifest:c,routerServerContext:h,isOnDemandRevalidate:f,revalidateOnlyGenerated:p,resolvedPathname:d}=s,m=(0,_.normalizeAppPath)(i),g=!!(c.dynamicRoutes[m]||c.routes[d]);if(g&&!u){let e=!!c.routes[d],t=c.dynamicRoutes[m];if(t&&!1===t.fallback&&!e)throw new T.NoFallbackError}let b=null;!g||KF.isDev||u||(b="/index"===(b=d)?"/":b);let x=!0===KF.isDev||!g,N=g&&!x,M=e.method||"GET",j=(0,S.getTracer)(),P=j.getActiveScopeSpan(),D={params:o,prerenderManifest:c,renderOpts:{experimental:{cacheComponents:!!l.experimental.cacheComponents,authInterrupts:!!l.experimental.authInterrupts},supportsDynamicResponse:x,incrementalCache:(0,v.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:null==(n=l.experimental)?void 0:n.cacheLife,isRevalidate:N,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>KF.onRequestError(e,t,n,h)},sharedContext:{buildId:a}},$=new w.NodeNextRequest(e),z=new w.NodeNextResponse(t),L=k.NextRequestAdapter.fromNodeNextRequest($,(0,k.signalFromNodeResponse)(t));try{let n=async r=>KF.handle(L,D).finally(()=>{if(!r)return;r.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let n=j.getRootSpanAttributes();if(!n)return;if(n.get("next.span_type")!==O.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${n.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let i=n.get("next.route");if(i){let e=`${M} ${i}`;r.setAttributes({"next.route":i,"http.route":i,"next.span_name":e}),r.updateName(e)}else r.updateName(`${M} ${e.url}`)}),s=async s=>{var a,o;let d=async({previousCacheEntry:a})=>{try{if(!(0,v.getRequestMeta)(e,"minimalMode")&&f&&p&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await n(s);e.fetchMetrics=D.renderOpts.fetchMetrics;let o=D.renderOpts.pendingWaitUntil;o&&r.waitUntil&&(r.waitUntil(o),o=void 0);let l=D.renderOpts.collectedTags;if(!g)return await (0,C.sendResponse)($,z,i,D.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,F.toNodeOutgoingHttpHeaders)(i.headers);l&&(t[I.NEXT_CACHE_TAGS_HEADER]=l),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==D.renderOpts.collectedRevalidate&&!(D.renderOpts.collectedRevalidate>=I.INFINITE_CACHE)&&D.renderOpts.collectedRevalidate,n=void 0===D.renderOpts.collectedExpire||D.renderOpts.collectedExpire>=I.INFINITE_CACHE?void 0:D.renderOpts.collectedExpire;return{value:{kind:A.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==a?void 0:a.isStale)&&await KF.onRequestError(e,t,{routerKind:"App Router",routePath:i,routeType:"route",revalidateReason:(0,E.getRevalidateReason)({isRevalidate:N,isOnDemandRevalidate:f})},h),t}},m=await KF.handleResponse({req:e,nextConfig:l,cacheKey:b,routeKind:y.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:c,isRoutePPREnabled:!1,isOnDemandRevalidate:f,revalidateOnlyGenerated:p,responseGenerator:d,waitUntil:r.waitUntil});if(!g)return null;if((null==m||null==(a=m.value)?void 0:a.kind)!==A.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==m||null==(o=m.value)?void 0:o.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,v.getRequestMeta)(e,"minimalMode")||t.setHeader("x-nextjs-cache",f?"REVALIDATED":m.isMiss?"MISS":m.isStale?"STALE":"HIT"),u&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let x=(0,F.fromNodeOutgoingHttpHeaders)(m.value.headers);return(0,v.getRequestMeta)(e,"minimalMode")&&g||x.delete(I.NEXT_CACHE_TAGS_HEADER),!m.cacheControl||t.getHeader("Cache-Control")||x.get("Cache-Control")||x.set("Cache-Control",(0,R.getCacheControlHeader)(m.cacheControl)),await (0,C.sendResponse)($,z,new Response(m.value.body,{headers:x,status:m.value.status||200})),null};P?await s(P):await j.withPropagatedContext(e.headers,()=>j.trace(O.BaseServerSpan.handleRequest,{spanName:`${M} ${e.url}`,kind:S.SpanKind.SERVER,attributes:{"http.method":M,"http.target":e.url}},s))}catch(t){if(P||t instanceof T.NoFallbackError||await KF.onRequestError(e,t,{routerKind:"App Router",routePath:m,routeType:"route",revalidateReason:(0,E.getRevalidateReason)({isRevalidate:N,isOnDemandRevalidate:f})}),g)throw t;return await (0,C.sendResponse)($,z,new Response(null,{status:500})),null}}}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_8fa0d486.js.map