module.exports=[21170,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"RedirectStatusCode",{enumerable:!0,get:function(){return d}});var d=function(a){return a[a.SeeOther=303]="SeeOther",a[a.TemporaryRedirect=307]="TemporaryRedirect",a[a.PermanentRedirect=308]="PermanentRedirect",a}({});("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},28859,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(c,{REDIRECT_ERROR_CODE:function(){return e},RedirectType:function(){return f},isRedirectError:function(){return g}});let d=a.r(21170),e="NEXT_REDIRECT";var f=function(a){return a.push="push",a.replace="replace",a}({});function g(a){if("object"!=typeof a||null===a||!("digest"in a)||"string"!=typeof a.digest)return!1;let b=a.digest.split(";"),[c,f]=b,g=b.slice(2,-2).join(";"),h=Number(b.at(-2));return c===e&&("replace"===f||"push"===f)&&"string"==typeof g&&!isNaN(h)&&h in d.RedirectStatusCode}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},44868,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(c,{getRedirectError:function(){return g},getRedirectStatusCodeFromError:function(){return l},getRedirectTypeFromError:function(){return k},getURLFromRedirectError:function(){return j},permanentRedirect:function(){return i},redirect:function(){return h}});let d=a.r(21170),e=a.r(28859),f=a.r(20635).actionAsyncStorage;function g(a,b,c){void 0===c&&(c=d.RedirectStatusCode.TemporaryRedirect);let f=Object.defineProperty(Error(e.REDIRECT_ERROR_CODE),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return f.digest=e.REDIRECT_ERROR_CODE+";"+b+";"+a+";"+c+";",f}function h(a,b){var c;throw null!=b||(b=(null==f||null==(c=f.getStore())?void 0:c.isAction)?e.RedirectType.push:e.RedirectType.replace),g(a,b,d.RedirectStatusCode.TemporaryRedirect)}function i(a,b){throw void 0===b&&(b=e.RedirectType.replace),g(a,b,d.RedirectStatusCode.PermanentRedirect)}function j(a){return(0,e.isRedirectError)(a)?a.digest.split(";").slice(2,-2).join(";"):null}function k(a){if(!(0,e.isRedirectError)(a))throw Object.defineProperty(Error("Not a redirect error"),"__NEXT_ERROR_CODE",{value:"E260",enumerable:!1,configurable:!0});return a.digest.split(";",2)[1]}function l(a){if(!(0,e.isRedirectError)(a))throw Object.defineProperty(Error("Not a redirect error"),"__NEXT_ERROR_CODE",{value:"E260",enumerable:!1,configurable:!0});return Number(a.digest.split(";").at(-2))}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},89798,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(c,{HTTPAccessErrorStatus:function(){return d},HTTP_ERROR_FALLBACK_ERROR_CODE:function(){return f},getAccessFallbackErrorTypeByStatus:function(){return i},getAccessFallbackHTTPStatus:function(){return h},isHTTPAccessFallbackError:function(){return g}});let d={NOT_FOUND:404,FORBIDDEN:403,UNAUTHORIZED:401},e=new Set(Object.values(d)),f="NEXT_HTTP_ERROR_FALLBACK";function g(a){if("object"!=typeof a||null===a||!("digest"in a)||"string"!=typeof a.digest)return!1;let[b,c]=a.digest.split(";");return b===f&&e.has(Number(c))}function h(a){return Number(a.digest.split(";")[1])}function i(a){switch(a){case 401:return"unauthorized";case 403:return"forbidden";case 404:return"not-found";default:return}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},16155,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"notFound",{enumerable:!0,get:function(){return e}});let d=""+a.r(89798).HTTP_ERROR_FALLBACK_ERROR_CODE+";404";function e(){let a=Object.defineProperty(Error(d),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});throw a.digest=d,a}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},34557,(a,b,c)=>{"use strict";function d(){throw Object.defineProperty(Error("`forbidden()` is experimental and only allowed to be enabled when `experimental.authInterrupts` is enabled."),"__NEXT_ERROR_CODE",{value:"E488",enumerable:!1,configurable:!0})}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"forbidden",{enumerable:!0,get:function(){return d}}),a.r(89798).HTTP_ERROR_FALLBACK_ERROR_CODE,("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},93845,(a,b,c)=>{"use strict";function d(){throw Object.defineProperty(Error("`unauthorized()` is experimental and only allowed to be used when `experimental.authInterrupts` is enabled."),"__NEXT_ERROR_CODE",{value:"E411",enumerable:!1,configurable:!0})}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unauthorized",{enumerable:!0,get:function(){return d}}),a.r(89798).HTTP_ERROR_FALLBACK_ERROR_CODE,("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},73808,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isPostpone",{enumerable:!0,get:function(){return e}});let d=Symbol.for("react.postpone");function e(a){return"object"==typeof a&&null!==a&&a.$$typeof===d}},1567,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isNextRouterError",{enumerable:!0,get:function(){return f}});let d=a.r(89798),e=a.r(28859);function f(a){return(0,e.isRedirectError)(a)||(0,d.isHTTPAccessFallbackError)(a)}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},94783,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unstable_rethrow",{enumerable:!0,get:function(){return function a(b){if((0,g.isNextRouterError)(b)||(0,f.isBailoutToCSRError)(b)||(0,i.isDynamicServerError)(b)||(0,h.isDynamicPostpone)(b)||(0,e.isPostpone)(b)||(0,d.isHangingPromiseRejectionError)(b))throw b;b instanceof Error&&"cause"in b&&a(b.cause)}}});let d=a.r(13091),e=a.r(73808),f=a.r(49640),g=a.r(1567),h=a.r(60384),i=a.r(96556);("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},60968,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unstable_rethrow",{enumerable:!0,get:function(){return d}});let d=a.r(94783).unstable_rethrow;("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},73727,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(c,{ReadonlyURLSearchParams:function(){return k},RedirectType:function(){return e.RedirectType},forbidden:function(){return g.forbidden},notFound:function(){return f.notFound},permanentRedirect:function(){return d.permanentRedirect},redirect:function(){return d.redirect},unauthorized:function(){return h.unauthorized},unstable_isUnrecognizedActionError:function(){return l},unstable_rethrow:function(){return i.unstable_rethrow}});let d=a.r(44868),e=a.r(28859),f=a.r(16155),g=a.r(34557),h=a.r(93845),i=a.r(60968);class j extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class k extends URLSearchParams{append(){throw new j}delete(){throw new j}set(){throw new j}sort(){throw new j}}function l(){throw Object.defineProperty(Error("`unstable_isUnrecognizedActionError` can only be used on the client."),"__NEXT_ERROR_CODE",{value:"E776",enumerable:!1,configurable:!0})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},58091,82496,7413,70396,10508,67788,94994,a=>{"use strict";a.s(["default",()=>x],58091);var b=a.i(11492),c=a.i(61931);a.s(["getAccessToken",()=>h],7413);var d=a.i(58227);a.s(["isTokenExpired",()=>f,"validateToken",()=>g],82496);var e=a.i(33598);let f=a=>{let b=(0,c.jwtDecoder)(a);return null==b||!b.exp||b.exp&&b.exp<Date.now()/1e3},g=async({token:a})=>{if(!a||"string"!=typeof a)return b.config.isDebugMode&&console.error("validateToken: invalid token or token is missing"),!1;if(!(await (0,e.validateToken)({token:a,domain:b.config.issuerURL})).valid)return b.config.isDebugMode&&console.error("validateToken: invalid token"),!1;let d=(0,c.jwtDecoder)(a);return b.config.isDebugMode&&console.log(`validateToken: token is valid - it will expire in ${d.exp-Date.now()/1e3} seconds`),d.iss===b.config.issuerURL||(b.config.isDebugMode&&console.error("validateToken: invalid issuer"),!1)},h=async(a,c)=>{try{let e=await (await (0,d.sessionManager)(a,c)).getSessionItem("access_token");return e&&"string"==typeof e?await g({token:e})?e:(b.config.isDebugMode&&console.error("getAccessToken: invalid token"),null):(b.config.isDebugMode&&console.warn("getAccessToken: invalid token or token is missing (are you logged in?)"),null)}catch(a){return b.config.isDebugMode&&console.error("getAccessToken",a),null}};a.s([],70396);var i=a.i(73727);let j=a=>{if(b.config.isDebugMode&&console.log("redirectOnExpiredToken: checking for expired token"),!a){b.config.isDebugMode&&console.log("redirectOnExpiredToken: no token, not redirecting");return}if(!f(a)){b.config.isDebugMode&&console.log("redirectOnExpiredToken: token is not expired, not redirecting");return}b.config.isDebugMode&&console.log("redirectOnExpiredToken: token is defined and expired, redirecting"),(0,i.redirect)(`${b.config.apiPath}/${b.routes.login}`)};a.i(6808);var k=a.i(85732),l=a.i(46955);let m=(a,b)=>async(c,e,f)=>{try{let g=await l.kindeClient.getClaimValue(await (0,d.sessionManager)(a,b),"feature_flags","access_token"),h=await l.kindeClient.getClaimValue(await (0,d.sessionManager)(a,b),"x-hasura-feature-flags","access_token"),i={...g,...h}[c];if(!i&&void 0===e)throw Error(`Flag ${c} was not found, and no default value has been provided`);if(null!=i&&i.t&&f&&f!==(null==i?void 0:i.t))throw Error(`Flag ${c} is of type ${k.FlagDataType[i.t]}, expected type is ${k.FlagDataType[f]}`);let j=(null==i?void 0:i.v)===void 0;return{is_default:j,value:(null==i?void 0:i.v)===void 0?e:null==i?void 0:i.v,code:c,type:!!j&&k.FlagDataType[(null==i?void 0:i.t)??f],defaultValue:e}}catch(a){if(a.message.includes("no default value has been provided"))throw a;return{value:e}}};a.i(5246);var n=a.i(30493);a.i(46844),a.s(["getIdToken",()=>o],10508);let o=async(a,c)=>{try{let e=await (await (0,d.sessionManager)(a,c)).getSessionItem("id_token");return e&&"string"==typeof e?await g({token:e})?e:(b.config.isDebugMode&&console.error("getIdToken: invalid token"),null):(b.config.isDebugMode&&console.warn("getIdToken: invalid token or token is missing (are you logged in?)"),null)}catch(a){return b.config.isDebugMode&&console.error("getIdToken",a),null}},p=a=>Object.fromEntries(Object.entries(a).filter(([a,b])=>void 0!==b));a.s(["generateUserObject",()=>q],67788);let q=(a,b)=>{let c={id:a.sub,email:a.email,family_name:a.family_name,given_name:a.given_name,picture:a.picture,username:a.preferred_username,phone_number:a.phone_number},d=c,e=a.user_properties||a["x-hasura-user_properties"]||{},f=b.user_properties||b["x-hasura-user_properties"]||{},g={...e,...f};{let{kp_usr_city:a,kp_usr_industry:b,kp_usr_is_marketing_opt_in:e,kp_usr_job_title:f,kp_usr_middle_name:h,kp_usr_postcode:i,kp_usr_salutation:j,kp_usr_state_region:k,kp_usr_street_address:l,kp_usr_street_address_2:m}=g,n=Object.keys(g).reduce((a,b)=>{var c;return a[b]=null==(c=g[b])?void 0:c.v,a},{});d={...p(c),properties:p({city:null==a?void 0:a.v,industry:null==b?void 0:b.v,is_marketing_opt_in:null==e?void 0:e.v,job_title:null==f?void 0:f.v,middle_name:null==h?void 0:h.v,postcode:null==i?void 0:i.v,salutation:null==j?void 0:j.v,state_region:null==k?void 0:k.v,street_address:null==l?void 0:l.v,street_address_2:null==m?void 0:m.v,...n})}}return d},r=(a,d)=>async()=>{try{let b=await o(a,d);if(!b)return null;let e=(0,c.jwtDecoder)(b),f=await h(a,d);if(!f)return null;let g=(0,c.jwtDecoder)(f);return q(e,g)}catch(a){return b.config.isDebugMode&&console.debug("getUser",a),null}};var s=a.i(90705),t=a.i(95158),u=a.i(29154),v=a.i(39214),v=v,w=v;let x=(a,e)=>({refreshTokens:async()=>{try{return await l.kindeClient.refreshTokens(await (0,d.sessionManager)(a,e))}catch(a){return b.config.isDebugMode&&console.error(a),null}},getAccessToken:async()=>{try{let d=await h(a,e);return b.config.isDebugMode&&console.log("getAccessTokenFactory: running redirectOnExpiredToken check"),j(d),(0,c.jwtDecoder)(d)}catch(a){return b.config.isDebugMode&&console.error(a),null}},getBooleanFlag:async(c,d)=>{try{return(await m(a,e)(c,d,"b")).value}catch(a){return b.config.isDebugMode&&console.error(a),null}},getFlag:m(a,e),getIdToken:async()=>{try{let d=await o(a,e);return b.config.isDebugMode&&console.log("getIdTokenFactory: running redirectOnExpiredToken check"),j(d),(0,c.jwtDecoder)(d)}catch(a){return b.config.isDebugMode&&console.error(a),null}},getIdTokenRaw:async()=>await (await (0,d.sessionManager)(a,e)).getSessionItem("id_token"),getAccessTokenRaw:async()=>await (await (0,d.sessionManager)(a,e)).getSessionItem("access_token"),getIntegerFlag:async(c,d)=>{try{return(await m(a,e)(c,d,"i")).value}catch(a){return b.config.isDebugMode&&console.error(a),null}},getOrganization:((a,e)=>async()=>{try{let b=await (await (0,d.sessionManager)(a,e)).getSessionItem("id_token");if(!b)throw Error("ID token is missing");let f=(0,c.jwtDecoder)(b),g=await h(a,e),i=(0,c.jwtDecoder)(g);return((a,b)=>{let c=b.org_code||b["x-hasura-org-code"],d=b.org_name||b["x-hasura-org-name"];return c?{orgCode:c,orgName:d,properties:((a,b)=>{let c=a.organization_properties||a["x-hasura-organization_properties"]||{},d=b.organization_properties||b["x-hasura-organization_properties"]||{},e={...c,...d},f={};return Object.keys(e).forEach(a=>{"b"===e[a].t||e[a].t,f[a]=e[a].v}),p({city:f.kp_org_city,industry:f.kp_org_industry,postcode:f.kp_org_postcode,state_region:f.kp_org_state_region,street_address:f.kp_org_street_address,street_address_2:f.kp_org_street_address_2,...f})})(a,b)}:null})(f,i)}catch(a){return b.config.isDebugMode&&console.error(a),null}})(a,e),getPermission:((a,c)=>async e=>{try{let b=await l.kindeClient.getPermission(await (0,d.sessionManager)(a,c),e);return!b.isGranted&&(await l.kindeClient.getClaimValue(await (0,d.sessionManager)(a,c),"x-hasura-permissions")).includes(e)?{isGranted:!0,orgCode:b.orgCode}:b}catch(a){return b.config.isDebugMode&&console.error(a),null}})(a,e),getPermissions:((a,c)=>async()=>{try{let b=await l.kindeClient.getPermissions(await (0,d.sessionManager)(a,c));return b.permissions?b:{permissions:await l.kindeClient.getClaimValue(await (0,d.sessionManager)(a,c),"x-hasura-permissions"),orgCode:await l.kindeClient.getClaimValue(await (0,d.sessionManager)(a,c),"x-hasura-org-code")}}catch(a){return b.config.isDebugMode&&console.error(a),null}})(a,e),getStringFlag:async(c,d)=>{try{return(await m(a,e)(c,d,"s")).value}catch(a){return b.config.isDebugMode&&console.error(a),null}},getUser:r(a,e),getUserOrganizations:async()=>{try{let b=await (0,d.sessionManager)(a,e),c=await l.kindeClient.getUserOrganizations(b),f=await l.kindeClient.getClaimValue(b,"organizations","id_token")??[],g=await l.kindeClient.getClaimValue(b,"x-hasura-organizations","id_token")??[],h=[...f,...g],i=await l.kindeClient.getClaimValue(b,"x-hasura-org-codes","id_token")??[],j=[...h].map(a=>({code:null==a?void 0:a.id,name:null==a?void 0:a.name})),k={orgCodes:[...c.orgCodes,...i],orgs:j};return j.length>0&&console.warn("Warning: organizations are not in ID token so names are missing."),k}catch(a){return b.config.isDebugMode&&console.debug("getUserOrganization error:",a),null}},isAuthenticated:((a,c)=>async()=>{let d=await h(a,c);b.config.isDebugMode&&console.log("isAuthenticatedFactory: running redirectOnExpiredToken check"),j(d);let e=await r(a,c)();return d&&!!e})(a,e),getRoles:((a,c)=>async()=>{try{return await l.kindeClient.getClaimValue(await (0,d.sessionManager)(a,c),"roles")||await l.kindeClient.getClaimValue(await (0,d.sessionManager)(a,c),"x-hasura-roles")}catch(a){return b.config.isDebugMode&&console.error(a),null}})(a,e),getClaim:async(c,f)=>{try{return await l.kindeClient.getClaim(await (0,d.sessionManager)(a,e),c,f)}catch(a){return b.config.isDebugMode&&console.error(a),null}},getEntitlements:async()=>{try{let b=await h(a,e);if(!b)return null;let c=new s.MemoryStorage;(0,t.setActiveStorage)(c),await c.setSessionItem(u.StorageKeys.accessToken,b);let d=await (0,v.D)();return(0,w.N)(),c.destroySession(),d}catch(a){return b.config.isDebugMode&&console.error(a),null}}});a.s(["withAuth",()=>E],94994);var y=a.i(43405);let z=()=>({maxAge:n.TWENTY_NINE_DAYS,domain:b.config.cookieDomain?b.config.cookieDomain:void 0,...n.GLOBAL_COOKIE_OPTIONS});var A=a.i(29657);let B=(a,b)=>(0,A.splitString)(b,n.MAX_COOKIE_LENGTH).map((b,c)=>({name:a+(0===c?"":c),value:b,options:z()}));var C=a.i(63681);let D=async(a,e,g)=>{let{pathname:i,search:j}=a.nextUrl,k=null==e?void 0:e.isReturnToCurrentPage,m=null==e?void 0:e.orgCode,n=(null==e?void 0:e.loginPage)||`${b.config.apiPath}/${b.routes.login}`,p=`${b.config.apiPath}/kinde_callback`,q=`${b.config.apiPath}/${b.routes.register}`,r=`${b.config.apiPath}/${b.routes.setup}`;if(n==i||p==i||q==i||r==i)return y.NextResponse.next();let s=["/_next","/favicon.ico"];(null==e?void 0:e.publicPaths)!==void 0&&Array.isArray(null==e?void 0:e.publicPaths)&&(s=e.publicPaths);let t=new URLSearchParams;m&&t.set("org_code",m),k&&t.set("post_login_redirect_url",i+j);let u=t.toString(),v=u?`${n}?${u}`:n,w=function(a,b,c=!1){return b.some(b=>{try{return b instanceof RegExp?b.test!==RegExp.prototype.test?b.test(a):new RegExp(b.source,b.flags).test(a):"/"===b?"/"===a:a.startsWith(b)}catch(a){return c&&console.error("isPublicPathMatch: error evaluating publicPath pattern:",a),!1}})}(i,s,b.config.isDebugMode),x=await h(a),A=await o(a);if((!x||!A)&&!w)return b.config.isDebugMode&&console.log("authMiddleware: no access or id token, redirecting to login"),y.NextResponse.redirect(new URL(v,(null==e?void 0:e.redirectURLBase)||b.config.redirectURL));let D=await (0,d.sessionManager)(a),E=null,F=y.NextResponse.next();if(f(x)||f(A)){b.config.isDebugMode&&console.log("authMiddleware: access token expired, refreshing");let c=a=>{if(b.config.isDebugMode&&console.error(a),!w)return y.NextResponse.redirect(new URL(v,(null==e?void 0:e.redirectURLBase)||b.config.redirectURL))};try{x=(E=await l.kindeClient.refreshTokens(D,!1)).access_token,A=E.id_token,b.config.isDebugMode&&console.log("authMiddleware: tokens refreshed",!!E.access_token,!!E.id_token)}catch{let a=c("authMiddleware: error refreshing tokens");if(a)return a}try{B("access_token",E.access_token).forEach(a=>{F.cookies.set(a.name,a.value,a.options)}),B("id_token",E.id_token).forEach(a=>{F.cookies.set(a.name,a.value,a.options)}),F.cookies.set("refresh_token",E.refresh_token,z()),((a,b)=>{let c=new C.ResponseCookies(b.headers),d=new Headers(a.headers),e=new C.RequestCookies(d);c.getAll().forEach(a=>e.set(a)),y.NextResponse.next({request:{headers:d}}).headers.forEach((a,c)=>{("x-middleware-override-headers"===c||c.startsWith("x-middleware-request-"))&&b.headers.set(c,a)})})(a,F),b.config.isDebugMode&&console.log("authMiddleware: tokens refreshed and cookies updated")}catch{let a=c("authMiddleware: error settings new token in cookie");if(a)return a}}if(w)return F;let G=null,H=null;try{G=(0,c.jwtDecoder)(x)}catch{return b.config.isDebugMode&&console.error("authMiddleware: access token decode failed, redirecting to login"),y.NextResponse.redirect(new URL(v,(null==e?void 0:e.redirectURLBase)||b.config.redirectURL))}try{H=(0,c.jwtDecoder)(A)}catch{return b.config.isDebugMode&&console.error("authMiddleware: id token decode failed, redirecting to login"),y.NextResponse.redirect(new URL(v,(null==e?void 0:e.redirectURLBase)||b.config.redirectURL))}let I=null==e||!e.isAuthorized||e.isAuthorized({req:a,token:G});if(I&&g){b.config.isDebugMode&&console.log("authMiddleware: invoking onSuccess callback");let a=await g({token:G,user:{family_name:H.family_name,given_name:H.given_name,email:H.email,id:H.sub,picture:H.picture}});return a instanceof y.NextResponse?(b.config.isDebugMode&&console.log("authMiddleware: onSuccess callback returned a response, copying our cookies to it"),F.cookies.getAll().forEach(b=>{a.cookies.set(b.name,b.value,{...b})}),F.headers.forEach((b,c)=>{a.headers.set(c,b)}),a):(b.config.isDebugMode&&console.log("authMiddleware: onSuccess callback did not return a response, returning our response"),F)}return I?(b.config.isDebugMode&&console.log("authMiddleware: customValidationValid is true, returning response"),F):(b.config.isDebugMode&&console.log("authMiddleware: default behaviour, redirecting to login"),y.NextResponse.redirect(new URL(v,(null==e?void 0:e.redirectURLBase)||b.config.redirectURL)))};function E(...a){if(!a.length||a[0]instanceof Request)return D(...a);if("function"==typeof a[0]){let b=a[0],c=a[1];return async(...a)=>await D(a[0],c,async({token:c,user:d})=>(a[0].kindeAuth={token:c,user:d},await b(...a)))}let b=a[0];return async(...a)=>await D(a[0],b)}},90354,45575,11491,15851,a=>{"use strict";a.s(["RegisterLink",()=>d],90354);var b=a.i(7997),c=a.i(11492);function d({children:a,orgCode:d,postLoginRedirectURL:e,authUrlParams:f,...g}){let h=new URLSearchParams,i={};for(let a in null!=d&&(i.org_code=d),null!=e&&(i.post_login_redirect_url=e),i={...f,...i})h.append(a,i[a]);return(0,b.jsx)("a",{href:`${c.config.apiPath}/${c.routes.register}${h?`?${h.toString()}`:""}`,...g,children:a})}function e({children:a,postLoginRedirectURL:d,orgCode:e,authUrlParams:f,...g}){let h=new URLSearchParams,i={};for(let a in null!=e&&(i.org_code=e),null!=d&&(null!=d&&d.startsWith("/")&&(d=`${process.env.KINDE_SITE_URL}${d}`),i.post_login_redirect_url=d),i={...f,...i})h.append(a,i[a]);let j=`${c.config.apiPath}/${c.routes.login}${h?`?${h.toString()}`:""}`;return(0,b.jsx)("a",{href:j,...g,children:a})}function f({children:a,postLogoutRedirectURL:d,...e}){return(0,b.jsx)("a",{href:`${c.config.apiPath}/${c.routes.logout}${d?`?post_logout_redirect_url=${d}`:""}`,...e,children:a})}function g({children:a,orgName:d,...e}){return(0,b.jsx)("a",{href:`${c.config.apiPath}/${c.routes.createOrg}${d?`?org_name=${d}`:""}`,...e,children:a})}a.s(["LoginLink",()=>e],45575),a.s(["LogoutLink",()=>f],11491),a.s(["CreateOrgLink",()=>g],15851)},75632,99399,a=>{"use strict";a.s([],75632);var b=a.i(58091);a.i(94994),a.i(90354),a.i(45575),a.i(11491),a.i(7997);var c=a.i(11492);a.i(15851),a.i(6808),a.i(86701),a.i(66832),a.i(39800),a.i(44828),a.i(40250),a.i(14556),a.i(84266),a.i(1149),a.i(97527),a.i(71929),a.i(70240),a.i(8423),a.i(23548),a.i(11637),a.i(75829),a.i(9532),a.i(58227),a.i(92919);a.i(61931),a.i(67788),a.i(7413),a.i(10508),a.i(82496),a.i(46955);a.i(43405),a.i(57301),a.i(90705),a.i(95158),a.i(29154);a.i(39214);a.i(36720),a.i(59606),a.i(5246),c.routes.createOrg,c.routes.register,c.routes.setup,c.routes.login,c.routes.logout,c.routes.health,c.routes.portal,a.i(70396),a.i(73727),a.s(["getKindeServerSession",()=>d.default],99399);var d=b}];

//# sourceMappingURL=node_modules_703e1270._.js.map